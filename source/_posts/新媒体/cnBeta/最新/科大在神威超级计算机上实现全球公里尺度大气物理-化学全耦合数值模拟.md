
---
title: '科大在神威超级计算机上实现全球公里尺度大气物理-化学全耦合数值模拟'
categories: 
 - 新媒体
 - cnBeta
 - 最新
headimg: 'https://static.cnbetacdn.com/thumb/article/2022/0405/b46b2c6db1171e4.png'
author: cnBeta
comments: false
date: Tue, 05 Apr 2022 08:04:05 GMT
thumbnail: 'https://static.cnbetacdn.com/thumb/article/2022/0405/b46b2c6db1171e4.png'
---

<div>   
近日，中国科学技术大学在新一代神威超级计算机上首次实现了长达7天的全球3公里空间分辨率大气物理-化学全耦合数值模拟试验，全面展现了新一代国产超级计算机软硬件系统的可靠性、稳定性和可用性，以及在其上构建全球高分辨率大气模拟系统的重大应用前景。<br>
 <p>研究成果以“Establishing a non-hydrostatic global atmospheric modeling system at 3-km horizontal resolution with aerosol feedbacks on the Sunway supercomputer of China”为题在线发表于《Science Bulletin》上。此项成果由地球和空间科学学院赵纯教授课题组与计算机科学与技术学院安虹教授课题组联合攻关，在国家气象局、国家超级计算无锡中心、北京大学、清华大学相关研究人员的紧密配合下完成。</p><p><a target="_blank" href="https://static.cnbetacdn.com/article/2022/0405/b46b2c6db1171e4.png"><img data-original="https://static.cnbetacdn.com/article/2022/0405/b46b2c6db1171e4.png" src="https://static.cnbetacdn.com/thumb/article/2022/0405/b46b2c6db1171e4.png" referrerpolicy="no-referrer"></a><br></p><p>图1 《Science Bulletin》期刊论文页面</p><p>应对日益变暖的全球气候以及频繁的极端和高影响天气是21世纪科学界面临的重大挑战之一。近年来，频繁发生的极端和高影响天气以及空气污染事件，如暴雨、暴雪、高温、干旱、雷暴、台风、冰雹、寒潮、霾、沙尘暴等，不仅对人民的生产生活带来严重影响，甚至会造成不可估量的生命和财产损失。而大气数值模拟是研究和预测此类灾害性天气事件的关键手段。尽管大气数值模式近几十年来得到了快速的发展，但目前仍存在着较大的预报偏差。由于大气系统中包含了不同时空尺度过程以及它们之间的相互作用，因此为了提高数值预报能力，模式需要具备精细的时空分辨率。此外，大气数值模式还需要包括许多复杂的物理和化学过程，来反映人类的活动和全球城市化的高度发展对大气系统产生的重要影响。而构建这样的大气数值模式会带来模拟计算量的指数增长和极大规模的数据读写需求，使得包含大气成份演变过程的全球高分辨率大气数值模式至今仍然是难以突破的挑战问题。</p><p>神威系列超级计算机是我国自主研发的超级计算机系统。新一代神威超级计算机上拥有的强大计算和系统通信能力来自我国自主设计的申威高性能计算和通信芯片，其上丰富的面向HPC、AI和大数据融合应用场景的大规模并行计算软件开发环境和工具，为各重大应用领域的计算模型创新与实现提供了强大、灵活的系统软件支撑，使多尺度、高分辨率、长时间、高精度的超大规模模拟成为可能，特别是已展现出对多学科、多物理、多时空分辨率的耦合模拟能力。与基于同时代的商用处理器构建的“CPU+加速器“体系架构的超算系统相比，神威超算系统具有更多层次和更大规模的多级并行计算单元、独特的系统存储和通信结构，在大幅度提高计算、访存、通信和读写的能力，以及降低功耗、体积、构建和运维成本的同时，其上的并行算法设计、实现与性能优化也面临诸多挑战，迫切需要在重大应用问题的驱动下，发展其上的并行算法设计和优化实现的方法。</p><p>本研究工作基于新一代国产神威超算平台，研发了包含大气成份演变过程的全球高分辨率非静力平衡大气数值模式iAMAS，在大规模数据读写速度、并行计算效率、规模可扩展性、运行时效性等多个方面填补了国内外大气数值模拟的空白。我们根据新一代神威超级计算机通信系统和文件系统的特点，通过重构数据读写策略充分利用了系统提供的读写带宽、释放文件系统性能，解决严重影响iAMAS模拟可扩展性的读写瓶颈；全面优化从系统到芯片各层次的并行计算方法，充分发挥新一代申威异构众核处理器芯片架构的计算特点，实现了进程级、线程级和数据级三个层次的并行，大幅提升了大气物理-化学全耦合数值模拟的并行计算效率。最终，将数值模拟试验的规模扩展到近4000万处理器核（约60万核组）时，并行效率仍保持在76.2%，在频繁的大规模数据读写的情景下实现了每小时模拟0.82天的速度，实现了全球3 km大气物理-气溶胶耦合的高效数值模拟试验, 达到了国际领先水平。</p><p><a target="_blank" href="https://static.cnbetacdn.com/article/2022/0405/a8f75e6560e987c.png"><img data-original="https://static.cnbetacdn.com/article/2022/0405/a8f75e6560e987c.png" src="https://static.cnbetacdn.com/thumb/article/2022/0405/a8f75e6560e987c.png" referrerpolicy="no-referrer"></a><br></p><p>A. 大规模并行计算方法与数据读写策略</p><p><a target="_blank" href="https://static.cnbetacdn.com/article/2022/0405/5f68bcef659d29f.png"><img data-original="https://static.cnbetacdn.com/article/2022/0405/5f68bcef659d29f.png" src="https://static.cnbetacdn.com/thumb/article/2022/0405/5f68bcef659d29f.png" referrerpolicy="no-referrer"></a><br></p><p>B. 全球3km大气模拟结果</p><p>图2  全球高分辨率大气数值模式iAMAS 大规模并行优化和模拟</p><p>本研究初步揭示了全球高分辨率大气物理-化学耦合模拟能显著改善极端天气事件预报的准确性，展现出高空间分辨率和耦合化学反馈效应对数值天气和空气质量预报的重要意义，对预报极端和高影响天气、以及大气污染事件具有重大应用前景。我们未来计划进一步优化该大气模式，提高其计算效率和稳定性，并将其耦合进高分辨率地球系统模式，从而可以开展长期的高分辨率气候模拟试验，探究气候变化规律及对人类的影响，服务于国家的“双碳”战略。此外，全球高分辨率大气物理-化学耦合模拟同样适用于研究行星大气成份的演变规律。团队也将在本研究的基础上，发展行星高分辨率大气模式，服务于国家的深空探测计划和科学研究。</p><p><a target="_blank" href="https://static.cnbetacdn.com/article/2022/0405/94ba00f3f42d219.jpg"><img data-original="https://static.cnbetacdn.com/article/2022/0405/94ba00f3f42d219.jpg" src="https://static.cnbetacdn.com/thumb/article/2022/0405/94ba00f3f42d219.jpg" referrerpolicy="no-referrer"></a><br></p><p>图3  全球大气3公里空间分辨率的大规模并行模拟效率示意图</p><p>赵纯教授和安虹教授为本论文的共同通讯作者，硕士研究生顾俊、方涛，博士研究生冯家望、郝晓宇为共同第一作者。该研究得到了国家自然科学基金、国家重点研发计划、中国科学技术大学“双一流工程”研究基金、中科院战略重点研究计划等项目的共同资助。同时，青岛海洋科学与技术试点国家实验室、中国科学技术大学超算中心、国家超级计算无锡中心、国家超级计算济南中心、国家超级计算广州中心等单位为本项目研究提供了超算资源的支持。</p><p><strong>参考文献：</strong></p><p>J. Gu, J. Feng, X. Hao, T. Fang, C. Zhao, H. An, J. Chen, M. Xu, J. Li, W. Han, C. Yang, F. Li, D. Chen: Establishing a non-hydrostatic global atmospheric modeling system at 3-km horizontal resolution with aerosol feedbacks on the Sunway supercomputer of China, Science Bulletin, <a href="https://doi.org/10.1016/j.scib.2022.03.009">https://doi.org/10.1016/j.scib.2022.03.009</a></p><p><strong>论文链接：</strong></p><p><a href="https://www.sciencedirect.com/science/article/pii/S2095927322000998">https://www.sciencedirect.com/science/article/pii/S2095927322000998</a></p><p><a href="https://authors.elsevier.com/a/1eqLc7SZmRWBvc" _src="https://authors.elsevier.com/a/1eqLc7SZmRWBvc" target="_blank">https://authors.elsevier.com/a/1eqLc7SZmRWBvc</a><br></p><p>（计算机科学与技术学院、地球和空间科学学院、科研部）</p>   
</div>
            