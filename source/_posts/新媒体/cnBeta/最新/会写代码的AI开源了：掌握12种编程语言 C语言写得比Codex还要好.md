
---
title: '会写代码的AI开源了：掌握12种编程语言 C语言写得比Codex还要好'
categories: 
 - 新媒体
 - cnBeta
 - 最新
headimg: 'https://static.cnbetacdn.com/article/2022/0309/83a25a0d9c18ec6.gif'
author: cnBeta
comments: false
date: Wed, 09 Mar 2022 05:58:17 GMT
thumbnail: 'https://static.cnbetacdn.com/article/2022/0309/83a25a0d9c18ec6.gif'
---

<div>   
比Codex还会写C语言的AI代码生成模型，现在开源了！这段时间，用AI写代码可以说是大火，其中最著名的要属OpenAI的Codex和DeepMind的AlphaCode。然而，这两个AI模型，全都没有开源：其中AlphaCode只给出了一些测试样例，而Codex只开放了API。<br>
 <p><img src="https://static.cnbetacdn.com/article/2022/0309/83a25a0d9c18ec6.gif" referrerpolicy="no-referrer"><br></p><p>△基于Codex的Copilot</p><p>为此，来自CMU的几个研究人员，用GPT-2搞出了一个名叫<strong>PolyCoder</strong>的AI代码生成模型，而且还是<strong>开源的</strong>。</p><p>据研究人员表示，虽然PolyCoder最大只有27亿参数（相比Codex有120亿参数），但它用<strong>C语言</strong>写出来的代码，比Codex的效果还要好。</p><p>这里面究竟有什么秘诀？</p><p>用12种编程语言代码集训练</p><p>首先来看训练用的<strong>数据集</strong>，这也是PolyCoder的最大特点之一。</p><p>此前，包括Codex、CodeParrot等AI代码生成模型，主要都是基于<strong>Python</strong>语言的代码来训练。</p><p>例如Codex的评估数据集之一HumanEval，评估的也是生成Python代码的效果。</p><p>相比之下，<strong>PolyCoder</strong>采用了<strong>多种编程语言</strong>代码集来训练，一共有12种：</p><blockquote id="0MVVHPK4">C、C#、C++、Go、Java、JavaScript、PHP、Python、Ruby、Rust、Scala和TypeScript。</blockquote><p><img src="https://static.cnbetacdn.com/article/2022/0309/63868607e07f2a0.jpg" referrerpolicy="no-referrer"><br></p><p>其中，C语言的代码量是最多的，达到了221GB；而Python代码的数据量比Codex和CodeParrot用得都要少。</p><p>这里PolyCoder用的是GitHub上的公开代码，主要选取的是各种编程语言中比较受欢迎的库，每个库至少有50 Stars。</p><p>据研究人员表示，每种编程语言库的Stars总数加起来不超过25k，以避免模型生成的代码效果太过于倾斜最流行的编程语言（通常编程语言越流行，库的Stars就越多）。</p><p>通过提取库中的文件、经过简单处理（包括消除重复代码）后，一共筛选出大约<strong>254GB</strong>的数据用于训练。</p><p>然后是<strong>预训练</strong>的方法。</p><p>语言模型的预训练方法通常有三种。</p><p>第一种是自左向右的语言模型，根据上文预测下文，比较适用于<strong>代码生成</strong>等；第二种是掩蔽语言模型，基于上下文预测屏蔽片段，比较适合<strong>代码分类</strong>等；第三种是编解码器模型，比较适用于<strong>代码注释</strong>等任务。</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/00417b658bc9dfc.jpg" referrerpolicy="no-referrer"><br></p><p>这里PolyCoder主要采用的是第一种预训练方法。</p><p>相比于同样采用GPT-2训练的CodeParrot和Codex，PolyCoder在超参数设置上也稍微有一些差异：</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/110c5d3ba090243.jpg" referrerpolicy="no-referrer"><br></p><p>PolyCoder一共提供了三种不同的模型，分别有27亿参数、4亿参数和1.6亿参数，研究人员可以根据自身需求和不同的训练能力来选取合适的模型。</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/a259e8393279a85.jpg" referrerpolicy="no-referrer"><br></p><p>那么，最终训练出来的AI模型，代码生成效果如何？</p><p>C语言写得尤其好，但Python不行</p><p>研究人员将PolyCoder与已有的AI代码生成模型进行了对比。</p><p>由于AlphaCode不好比较（接口没开放），所以研究人员主要分析了下面这些模型，包括GPT-Neo、CodeParrot和Codex等。</p><p>其中蓝色的是开源的，橙色的是没开源的：</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/0550848dd32cd38.jpg" referrerpolicy="no-referrer"><br></p><p>从参数量来看，PolyCoder并不是最顶尖的，最大的27亿参数模型也只有Codex的四分之一不到。</p><p>研究人员先是用语言模型评估常用的<strong>困惑度</strong>对一系列模型进行了比较。</p><blockquote id="0MVVHPK5">困惑度（Perplexity），用于衡量语言模型（LM）的好坏。困惑度越低，语言模型面对代码感到困惑的程度就越低，模型生成效果越好。</blockquote><p>从图中来看，PolyCoder在<strong>C语言</strong>中意外取得了最好的效果（困惑度最低）。</p><p>用大量C语言训练PolyCoder的结果说明，即使模型整体原理不变（基于GPT-2），单纯改变训练用的代码集，也能训练出擅长不同语言风格的AI代码生成模型。</p><p>可惜的是，从其他语言来看，生成的效果就完全没办法和Codex相比了：</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/0d1e90c2fc60a02.jpg" referrerpolicy="no-referrer"><br></p><p>例如，在主要用于评估Python代码的HumanEval上，PolyCoder的能力远不如Codex好：</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/a174b6082a843f4.jpg" referrerpolicy="no-referrer"><br></p><p>据论文分析，这可能是Python代码数据量、模型参数量不足等原因导致的。</p><p>此外，作者们也提到，做出PolyCoder的目的主要还是为了开源一个AI代码生成模型，让更多人参与研究和使用。</p><p>目前代码已经开源，无论是直接拿来用，还是试着在它的基础上开发新模型都可以。</p><p>感兴趣的小伙伴可以上手一试了~</p><p>作者介绍</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/2967c5cc7578689.jpg" referrerpolicy="no-referrer"><br></p><p>一作许方正（Frank Xu），目前在CMU读博，研究方向是NLP、信息抽取等，发表过多篇顶会论文，包括ICLR、ACL和EMNLP等。本硕毕业于上海交通大学，师从朱其立教授。</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/0a72c038b6f08e6.jpg" referrerpolicy="no-referrer"><br></p><p>Uri Alon，在CMU进行博士后工作，研究方向是编程语言处理（PLP）、NLP和深度学习。</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/35e503725651208.jpg" referrerpolicy="no-referrer"><br></p><p>Graham Neubig，CMU助理教授，研究方向是NLP、机器翻译和基于机器学习的自然语言理解。</p><p><img src="https://static.cnbetacdn.com/article/2022/0309/754b883344de3fd.jpg" referrerpolicy="no-referrer"><br></p><p>Vincent J. Hellendoorn，CMU计算机助理教授，主要研究方向是软件工程和机器学习，致力于利用智能方法帮助软件开发人员减少代码调试、程序优化等繁琐工作的时间。</p><p>不知道作者们是否已经在用这个AI撸代码了（手动狗头）</p><p>项目地址：</p><p><a href="https://github.com/VHellendoorn/Code-LMs" _src="https://github.com/VHellendoorn/Code-LMs" target="_blank">https://github.com/VHellendoorn/Code-LMs</a><br></p><p>论文地址：</p><p><a href="https://arxiv.org/abs/2202.13169" _src="https://arxiv.org/abs/2202.13169" target="_blank">https://arxiv.org/abs/2202.13169</a><br></p>   
</div>
            