
---
title: '详解 _ 结算系统设计'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 热门文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/S9OayvJaD24Ejg6OzFhx.jpg'
author: 人人都是产品经理
comments: false
date: Mon, 01 Mar 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/S9OayvJaD24Ejg6OzFhx.jpg'
---

<div>   
<blockquote><p>编辑导语：在生活中和企业里很多时候都会用到结算系统，在结算系统中一般会有比较复杂的流程，由很多板块组成，也有很多不同的结算方式；本文作者分享了关于结算系统设计的详细流程，我们一起来了解一下吧。</p></blockquote>
<p><img data-action="zoom" class="aligncenter size-full wp-image-4392436" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/S9OayvJaD24Ejg6OzFhx.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>每个月公司要给员工结算工资；陈老师在京东开了一个店铺，定期京东需要给我结算货款；你请了一个保姆，每个月要给阿姨结算服务费….等等，结算场景我们并不陌生，但是怎么设计一个结算系统，你知道么！今天我们就好好聊一聊。</p>
<h2 id="toc-1">01 什么是结算</h2>
<h3>1. 定义</h3>
<p>将平台的代收款结算给平台商家的资金转移过程。</p>
<p>展开来讲就是现在有很多平台比如滴滴，货拉拉，京东商城；作为一个服务平台上面有很多商家（我们将滴滴司机也成为商家），用户在平台购买商品或者服务，服务完成后，平台需要按照协议约定将服务款抽取一定费用后的剩余部分结算到商家的平台，结算账户中或者直接付款支商家银行账户的资金划转过程。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/epswUXaMYUuR1mI1KBlc.png" alt width="923" height="215" referrerpolicy="no-referrer"></p>
<h3>2. 结算名词解释</h3>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/YGLWoJsEjljxMAh00Qwt.png" alt width="682" height="520" referrerpolicy="no-referrer"></p>
<h2 id="toc-2">02 结算的模式</h2>
<p>结算我们常见的有2种模式：</p>
<ul>
<li>结算到银行卡：直接将结算款项直接付款到商家签约的结算银行卡账户中；</li>
<li>结算到虚拟户：将虚拟结算款结算入账到商家在平台开通的结算户中，后续可以商家自主提现。</li>
</ul>
<p>像微信支付宝在开通支付产品时都会获得一个商户号，每个商户号会有一套账户用于收款和结算，并且签约绑定一张结算卡，次日会将上一日的结算款先结算之虚拟户在一笔结算之绑定的对公户；当然结算到对公户的比例可以自己设定，可以全额结算也可以部分结算，将一部分资金留在虚拟户里，用于次日的退款或者其他付款需求。</p>
<h2 id="toc-3">03 关于结算产品</h2>
<p>结算产品其实就是指支撑不同类型结算模式的结算能力：</p>
<ul>
<li>T1结算：工作日结算，当天的服务款，在下一个工作日结算；</li>
<li>D1结算：日然日结算，当天的服务款，在下一个自然日结算；</li>
<li>D0结算：日然日结算，当天的服务款，在当天结算；</li>
<li>S0结算：交易完成后即可结算，按照订单号逐笔进行结算，像借贷的还款，一般逐笔；</li>
</ul>
<p>结算功能，用户可以选择系统自动结算，也可以选自主发起结算：</p>
<ul>
<li>自动：系统按照结算协议，在约定时间自动将服务款支付给结算卡；</li>
<li>自助：商家需要自主的在服务平台完成可结算周期内的款项的结算申请；</li>
</ul>
<p>结算签约，商家入驻平台时会进行资质认证以及签约一款适合自己的结算产品。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/6PoJlHgk1ZvoPtVA7oj5.png" alt width="977" height="319" referrerpolicy="no-referrer"></p>
<h2 id="toc-4">04 结算场景</h2>
<p>上面还是比较抽象，我们列举几个容易理解的结算场景</p>
<ul>
<li>支付公司将收单款结算给商户；</li>
<li>电商平台将交易款结算给商家；</li>
<li>滴滴平台将打车钱结算给司机；</li>
<li>电影院将票房结算给各方；</li>
<li>公司将工资结算给员工等等。</li>
</ul>
<p>所以，简而言之，结算就是将属于别人的钱给到别人。</p>
<h2 id="toc-5">05 如何评价结算产品的好坏</h2>
<p>评价结算系统的好和坏一个是站在公司角度，另一个是站在用户角度：</p>
<ul>
<li>站在公司角度：准确率高，资金安全，能容用户满意，投诉少。</li>
<li>站在用户角度：支持银行多，服务好就是后台好用，到账快，成本低。</li>
</ul>
<h2 id="toc-6">06 结算的业务架构</h2>
<p>业务完成后，到了结算节点，账务系统按照结算周期将已经入账待结算数据打包后推送给结算系统，结算系统对结算数据进行处理加工后生成结算记录和结算明细；然后请求账务系统进行结算打款，账务系统请求账户中心扣款之后调用打款中心进行打款申请。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/uSYzGBGQKRhF8CE7yy6B.png" alt width="1150" height="338" referrerpolicy="no-referrer"></p>
<h2 id="toc-7">07 结算系统系统架构</h2>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/K4XLgpoTRyQoTTwSu2xV.png" alt width="859" height="511" referrerpolicy="no-referrer"></p>
<p>对于不同结算产品，需要定时任务的管理去推动结算的进行：</p>
<ul>
<li>商户后台是商家自主发起结算，查询结算信息，变更信息的后台。</li>
<li>运营后台是公司内部运营的操作台。</li>
</ul>
<p>账务系统为结算系统提供结算数据，接受打款申请以及反馈出款通知：</p>
<ul>
<li>垫资系统是针对D0,S0的结算请求申请垫资的受理方。</li>
<li>计费系统是计算结算时商家需要支付的费用，比如一笔2元。</li>
<li>商家系统是用于查询商家的相关结算需要的信息。</li>
</ul>
<h2 id="toc-8">08 结算系统业务实体结构</h2>
<p>了解即可，从更小的颗粒度审视结算各信息记录之间的关系以及每个信息单元所记录的内容，便于对结算系统有个更精细的认知。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/twZx9PcIpF4QUUPePgjN.png" alt width="1013" height="1379" referrerpolicy="no-referrer"></p>
<ul>
<li>结算请求：一次同时结算所有可以结算的商家，记录多少个商家；</li>
<li>结算记录：一个商家生成一条结算记录，本次结算多少钱，以及打款状态；</li>
<li>结算明细：按照商家结算的支付产品类型记录每个支付产品结算多少笔，多少钱；</li>
<li>结算信息：记录这个商家签约了什么结算产品，结算的时间管理等。</li>
</ul>
<p>比如某一日一共结算了100个商家（一次结算请求）；其中A商家结算了1000块钱（一条结算记录）；其中A商家的快捷支付结算了100笔500块钱，网关支付结算了600笔500块钱（结算明细）。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/Gldl4Bw521wBEnxaoUD1.png" alt width="1254" height="301" referrerpolicy="no-referrer"></p>
<h2 id="toc-9">09 业务流程</h2>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/zFjOnfCj2U37jaXd0BSZ.png" alt width="563" height="757" referrerpolicy="no-referrer"></p>
<h2 id="toc-10">10 系统交互时序图</h2>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/Wfjm8OaoFzp9wkq62qqB.png" alt width="1302" height="1695" referrerpolicy="no-referrer"></p>
<h2 id="toc-11">11 详细流程图</h2>
<p>每个处理阶段的详细逻辑流程图，篇幅有限，为了更加易读，简化了流程图，仅绘制了核心的节点。</p>
<h3>1. 数据准备</h3>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/O81Kg7IKvp8seRebBtJk.png" alt width="697" height="696" referrerpolicy="no-referrer"></p>
<h3>2. 结算处理（以T1结算为例）</h3>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/KSM8X3M5dfAcvL9zAVvf.png" alt width="654" height="709" referrerpolicy="no-referrer"></p>
<h3>3. 打款处理</h3>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/AbeM1QMTf0Af56JQPUD4.png" alt width="886" height="656" referrerpolicy="no-referrer"></p>
<h3>4. 结算状态流转</h3>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/X6WKLw8NsFQD9YC87uTD.png" alt width="1340" height="392" referrerpolicy="no-referrer"></p>
<h3>5. 结算账单</h3>
<p>商户可以在后台下载结算账单，或者通过接口获取账单。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/02/J8NrEzJeHqwrRU7UOhdW.png" alt width="1089" height="581" referrerpolicy="no-referrer"></p>
<p>最后还有关于结算平台系统、商户结算服务平台、结算案例讲解就不多赘述了。</p>
<p>美好的时光总是很短暂，相信通过上面的文章介绍，大家已经可以设计出一个结算系统了，如果还有不明白的地方，可以在文章下面评论，深度交流。</p>
<p> </p>
<p>作者：陈晓光，一个会弹吉他会算命的产品经理老司机，微信公众号：陈晓光</p>
<p>本文由 @陈天宇宙 原创发布于人人都是产品经理。未经许可，禁止转载</p>
<p>题图来自Unsplash，基于CC0协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="4391371" data-author="94217" data-avatar="http://image.woshipm.com/wp-files/2021/02/a84xkWDMu44P1PnVp06z.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            