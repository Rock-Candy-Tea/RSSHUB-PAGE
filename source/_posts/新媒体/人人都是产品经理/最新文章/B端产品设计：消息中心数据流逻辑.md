
---
title: 'B端产品设计：消息中心数据流逻辑'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/lw9O05esQcJGhxra3dGf.jpg'
author: 人人都是产品经理
comments: false
date: Wed, 01 Dec 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/lw9O05esQcJGhxra3dGf.jpg'
---

<div>   
<blockquote><p>编辑导读：消息中心作为系统信息的集散地，是系统与用户之间对话的基础。本文作者梳理了B端产品的消息中心数据流逻辑，希望对你有帮助。</p></blockquote>
<p><img data-action="zoom" class="size-full wp-image-5236363 aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/lw9O05esQcJGhxra3dGf.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>此文是本人从事产品经理工作以来，在设计B端企业内部系统消息中心相关功能时的一些思考，偏重数据流逻辑梳理，内容讨论展开多基于B端企业内部产品的消息场景。</p>
<h2 id="toc-1">一、定位、来源及作用</h2>
<p>消息中心作为系统信息的集散地，是系统与用户之间对话的基础。通过这个集散地，系统可以向用户传达包括且不仅局限于以下信息：</p>
<ul>
<li>企业文化</li>
<li>产品价值观</li>
<li>待办或事务提醒</li>
<li>……</li>
</ul>
<p>特别地，针对IM类产品，消息更多是用户与用户之间的对话信息，此类不在这里讨论。</p>
<p>不同的系统，因其产品定位不同，其消息中心数据来源和作用也不相一致。一般系统的消息来源在大方向上可以分为2类，一类是站内消息，一类是站外消息。</p>
<ul>
<li>站内消息：指系统本身触发的消息内容，涵盖系统公告、待办提醒等；用于向用户传达其在当前系统需要执行或知悉的信息，用户行为一般限制在当前系统内，不与外界系统产生信息交流或动作交互。当然，也有一些消息来源是站内，但用户需要在外界系统完成信息处理的，不过相对比较少。</li>
<li>站外消息：指外部系统通过当前系统分发机制给用户同步的提醒信息；用户在收到此类消息，正常都可以通过当前系统链接到对应外部系统去完成信息处理动作，用户行为不局限于当前系统内，会频繁与外界系统产生信息交流或动作交互。</li>
</ul>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/sXcgkQrY106rldBwGTq7.png" alt width="590" height="466" referrerpolicy="no-referrer"></p>
<p>例如，某司针对HRBP群体有一个工作台系统，用于处理HRBP工作事务，其消息中心定位是作为HRBP获取与其相关的工作事务通知提醒的信息集散地。所以该消息中心的消息来源便不仅有工作台本身，同时支持外部系统消息接入，如招聘系统接入招聘入职相关消息、360评估系统接入评估提醒相关消息等。用户可以通过这个系统获知所有工作相关的信息，并有针对性地对消息进行处理，而不再需要登录其他40+个HR相关系统获取信息。</p>
<p>所以，在开展消息中心设计之前，我们一定是需要明确这个功能的定位和数据范围，也就是梳理清楚战略层和范围层的内容，在这之后才能更好地完善功能逻辑和甄别需求。</p>
<h2 id="toc-2">二、消息流逻辑</h2>
<p>无论站内还是站外消息，在消息数据进入消息中心之后，会通过其分发机制触发给相关用户，用户即可在前端系统的消息盒子中查看到具体的消息内容；如果涉及到转发外部系统提醒的，如邮件中心或短信中心等，则会由消息中心向对应系统发起请求，并触发短信或邮件至用户处。可见下面时序图：</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/sNXYrnLHSi5RzqBNRoL2.png" alt width="525" height="365" referrerpolicy="no-referrer"></p>
<p>我们可以看到，上述时序图涉及消息来源、消息中心、消息盒子和外部通知系统。</p>
<ul>
<li>消息来源：含站内消息和站外消息，可以是当前系统本身的提醒或公告，也可以是外部其他系统的提醒。</li>
<li>消息中心：当前系统的底层逻辑，用以消息分发、请求外部通知的集中处理模块。</li>
<li>消息盒子：当前系统的消息中心外在表现，用以与用户交互和信息交流的功能模块；用户可以在消息盒子中查阅所有与其相关的消息。</li>
<li>外部通知：部分需强提醒或对时效性要求高的消息，会通过一些外部系统辅助消息及时快速触达，使得用户没有登录当前系统也能获知消息。此类外部通知系统多指邮件服务中心、短信服务中心、企业微信、飞书、钉钉等。</li>
</ul>
<p>消息来源请求消息通知时，会向消息中心发送请求，请求中一般包含这些信息：来源标识ID、请求时间、接收对象ID、消息内容（标题+正文）、提醒方式等。消息中心可以理解为包含待发送池、已发送池两大数据表：</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/11/G7Txbwhs0OQRGfuRR3Jy.png" alt width="857" height="482" referrerpolicy="no-referrer"></p>
<p>消息来源信息会先进入待发送池排队，形成一个消息队列，遵循先进先出规则。消息中心会根据每个消息中所携带的接收对象ID进行消息分发，即将该消息发送至对应用户的消息盒子中；同时根据提醒方式判断是否调用外部通知系统启动其他提醒方式。外部通知系统一般有固定的消息模板和提醒逻辑，消息中心需要将提醒对象和应用模板ID、对应模板参数同步给外部通知系统，由外部通知系统判断并触发消息模板进行通知。</p>
<p>消息进入消息盒子，则可被用户所查阅。此时可以根据状态将消息分为2类，即未读消息和已读消息。用户重点关注会放在未读消息上，所以优先给用户呈现新触达的未读信息。2类消息之间转换也很简单，用户点击打开即为已读；逆操作（即已读变为未读）则看具体系统定位和用户需要，一般不会设置逆操作。</p>
<p>至此，消息流逻辑就基本梳理完成。特别地，消息中心在设计时尽量不要融入复杂逻辑，如定时发送、重复发送等，应尽量保持逻辑简单以支持大量的消息分发和保持其作为系统底层机制的包容性；而定时发送、重复发送等逻辑应归类于业务层逻辑，应由业务侧决定。</p>
<p>例如，某个少儿美术在线教育公司内部CRM客户管理系统，其业务上有众多重复提醒和定时发送提醒的逻辑，如给销售人员重复提醒某个销售任务没有完成，每周二、四晚定时提醒销售人员准备跟进体验课，等等。这些逻辑均是设置在业务层，由业务层判断是否需要触发提醒，如需要则向消息中心发出请求，传入相关参数进入消息队列排队发送。这样能保证消息中心简单而高效运转，不会因为复杂逻辑产生不必要的消息流问题（如无法兼容多种重发逻辑等）；也把运维的重心都偏移在业务层，使得不同业务消息互不影响。</p>
<h2 id="toc-3">三、总结</h2>
<p>消息中心是B端产品系统的基本功能，一个包容性强且设计合理的消息中心，能更好地支撑系统与用户之间的对话，传达我们想要告诉用户的信息。消息中心设计之初需要先确认系统定位和功能定位，才能规范好数据范围，从而在实现产品功能价值和满足业务需求。消息流逻辑也需要尽量梳理清楚，使其成为系统基础服务，不要与业务逻辑强融合，才能保证其良好地包容性和避免返工。</p>
<p>以上是个人工作过程的一些经验总结和思考，仍有不足，正在努力。</p>
<p> </p>
<p>本文由 @群子 原创发布于人人都是产品经理，未经许可，禁止转载</p>
<p>题图来自Unsplash，基于 CC0 协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5234724" data-author="664437" data-avatar="https://static.woshipm.com/APP_U_201812_20181222003435_2175.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            