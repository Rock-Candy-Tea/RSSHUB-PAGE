
---
title: '新零售电商支付平台的搭建'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://image.yunyingpai.com/wp/2022/06/658oKGX98Uy11ctXI4ah.jpg'
author: 人人都是产品经理
comments: false
date: Mon, 06 Jun 2022 00:00:00 GMT
thumbnail: 'https://image.yunyingpai.com/wp/2022/06/658oKGX98Uy11ctXI4ah.jpg'
---

<div>   
<blockquote><p>编辑导语：随着电商行业的发展，每个电商企业都会自建业务系统，其中支付是必不可少的一个环节，本文将讲述如何构建一个新零售电商的支付平台。以及支付平台的业务边界以及各业务模块的交互逻辑。</p></blockquote>
<p><img data-action="zoom" class="wp-image-818378 aligncenter" src="https://image.yunyingpai.com/wp/2022/06/658oKGX98Uy11ctXI4ah.jpg" alt width="800" height="371" referrerpolicy="no-referrer"></p>
<h2 id="toc-1">一、业务边界梳理</h2>
<p>在进行平台规划前，先梳理支付上下游的业务关系有哪些。 梳理的流程主要通过业务场景进行。例如从用户下单交易场景为例：</p>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/CkNv3wMB07zPvzup3lTH.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图1-1用户下单流程</p>
<p>图1-1是一个简单的下单交易场景，在提交订单后，就跳转至支付收银台进行选择支付方式时，提交订单后续动作属于支付平台的业务范畴，那么我们上面的提交订单的业务就属于支付平台的上游，我们可以按照这种方法，先将支付平台的边界梳理清楚，确定支付平台的上下游业务有哪些组成。</p>
<h2 id="toc-2">二、支付平台框架规划</h2>
<p>通过业务边界梳理，将业务边界以及平台框架规划图2-1所示：</p>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/GBZZm9gmFD5vcHoYexXx.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p>电商支付平台主要由支付中心、账户中心、对账中心、清算中心构成。国内的电商平台搭建账户体系需要有支付牌照才能建立，像拼多多、快手电商、字节跳动都先后购买牌照，就是为了合规性处理二清问题，同时可以降低自身手续费。</p>
<p>无支付牌照的电商企业，可以依托于第三方支付平台或银行内部户搭建相应的账户体系，在电商支付平台内只做数据的记录，便于对账。所有的资金清分由第三方支付平台或银行进行清分，避免电商平台违规进行二清的业务。</p>
<h2 id="toc-3">三、各业务模块介绍</h2>
<h3>1. 支付中心</h3>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/aiEGOBaa53aWFbtW7LwL.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图3-1支付中心</p>
<p><strong>(1）支付中心</strong></p>
<p>包含了通道管理、订单管理、路由管理、预警通知这四个模块。与支付中心对接内部模块有订单中心、账户中心、会员中心、SAP、资金管理系统等。</p>
<p><strong>(2）通道管理</strong></p>
<p>通道管理连着支付中心与外部系统的，管理着整个支付系统对接了多少的支付通道、鉴权通道、通道的秘钥等相关数据。</p>
<p><strong>(3）订单管理</strong></p>
<p>由于支付中心和订单中心是解耦的关系，所以支付中心的订单单独记录。</p>
<p><strong>(4）路由管理</strong></p>
<p>路由管理是为了支付的成功率、降低支付成本，主要是用在电商平台自由的快捷支付通道中，但是随着用户对于自身数据保护意识提高，导致很多用户不愿意在电商平台进行绑卡。 这就使得电商平台需要接入微信、支付宝这些支付方式。</p>
<p>接入微信支付宝需要平台下的商户分别在支付公司和微信、支付宝进行进件获取商户号（为了合规性，避免二清问题）。这就导致电商平台每个更换渠道，都需要将所有商户重复进件（微信还需要进行实名认证才能进行收款），所以使得切换成本巨大。导致很多企业都放弃了原本快捷支付横行时的路由管理，直接与某个支付渠道进行战略合作，深度捆绑。</p>
<h3>2. 账户&清算中心</h3>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/eTflzLzdCN7kOpA9SOp3.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图3-2</p>
<p><strong>(1）清算中心是为了将每笔交易中的交易金额，根据订单的属性进行清分以及结算。</strong></p>
<p>比如一笔订单中，用户将多个商家的商品同时加入购物车，同时使用了商家优惠券、平台优惠券进行支付。订单在支付完成后需要清楚计算出用户实际支付金额、每个商户的结算金额、平台手续费金额、平台优惠活动出资金额等。</p>
<p><strong>(2）为什么子系统的交互流程是订单中心->清算中心->账户中心，而不是订单中心->支付中心->清算中心->账户中心这样的业务流程。</strong></p>
<p>是因为这个新零售的电商模式有线下门店的存在，线下门店有很多现金支付部分，这部分交易是不与支付金额交互的，但是又需要将线下部分的手续费、优惠金额等计算清楚，所以就由订单将数据同步至清算中心进行计算清楚，然后进行账户入账处理。</p>
<p><strong>(3）账户中心</strong></p>
<p>账户中心是处理整个新零售电商系统的记账本，里面包含各式各样的记账本，包含支付渠道账户、门店账户、会员账户、营销账户、预付卡账户。每个账户用途不一样，但是背后是对应的实际资金用途。通过各类的业务记账簿，管理层面可以清晰的查看每种账户的流水情况，便于查看公司目前的经营状况。同时有记账簿，可以一定程度的避免伪造数据的存在。</p>
<p>由于门店有部分收银是使用现金收银的，所以记账户单独会有现金余额记录。自营门店的现金余额将需要进行上缴，然后进行冲销。而加盟商的现金仅仅作为记账处理。日切后，生成日终余额的快照，然后将现金余额进行归零处理。</p>
<p>同时加盟商模式是货款是通过销售款进行冲销的，当总部代加盟商收款（线上收银）不足以冲销货款时，那么此时账户余额会出现透支。每个加盟商根据信用良好情况会有一个透支额度，后续销售额代收款优先冲销透支额度。每个加盟商的透支额度都会有一个期限，到期后未缴纳将进行预警通知。</p>
<h3>3. 对账中心</h3>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/Bmb6MnZh5ubx9fbrhxRp.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图3-3</p>
<p>对账中心主要是将针对内外部记账进行自动核对，对账过程先是需要将对账方的账单进行解析，并且入库处理。对账第一步总账核对，先看总笔数、总交易额是否正确。</p>
<p>然后再进行明细核对，明细核对时需要将双方的对账单进行正向核对、反向核对，将差异的数据流入到差错池进行处理。将错误的结果流入差错池进行差错处理。在完成差错处理后给各业务提供对应的账单，让各业务部门进行对账处理。</p>
<h2 id="toc-4">四、业务流程设计</h2>
<h3>1. 订单支付流程</h3>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/iEuwTyssu9QENXyOsg5J.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图4-1</p>
<p>订单整体的支付流程主要分为以下几步完成：</p>
<p><strong>(1）由订单中心创建交易订单后，在交易环节请求支付中心，支付中心创建对应的支付订单</strong>。由支付中心统一调用支付渠道接口，最终将支付的结果返回给订单中心。</p>
<p><strong>(2）订单中心根据支付中心返回支付结果进行下一步动作。</strong></p>
<p>如果是支付失败，则订单整体失败处理。支付成功将调用清分接口进行清分处理，清分这一步是异步处理的。不影响C端用户前端的体验。清分计算完成后，将调用记账接口进行记账处理，此时清分状态为已清分待结算状态。</p>
<p><strong>(3）由于是新零售的电商体系，所以还有一个线下履约过程。</strong></p>
<p>订单履约完成后，才能够将对应的交易金额结算给门店（加盟商）。门店结算还有一个判断依据是是否到了结算周期，不同区域的门店会有对应不同的结算周期的配置。</p>
<p>一般结算周期有T\D+N，T是指工作日，D是指自然日，例如T+1是指下一个工作日结算，以周五举例，周五的交易在周一进行结算（周六日也是在周一进行结算）。D+1是指下一个自然日结算，还是以周五举例，周五的交易资金将在周六进行结算。具体的结算周期，根据公司政策进行拟定。</p>
<p><strong>(4）交易结算最后还是要调用记账接口，将账户余额资金从待结算账户划拨至可结算账户。</strong>门店可使用可结算的账户余额进行提现操作或用于支付货款。</p>
<h3>2. 自动对账流程</h3>
<p><img data-action="zoom" class="aligncenter" src="https://image.yunyingpai.com/wp/2022/06/DuzjxY5J9WPzqp8FsJz8.png" alt width="400" height="106" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图4-2</p>
<p><strong>(1）自动对账流程主要将内外部的交易订单进行抽取，解析生成对账中心所需的数据，然后进行核对</strong>。</p>
<p>内部对账处理可以不依赖上游的对账文件。 可以自行进行处理，例如可以2小时完成一次内部的数据对账。保证能够及时的发现系统的数据问题，并且进行修复处理。与外部的对账，需要根据上游的对账文件生成时间获取。</p>
<p>某一些上游可能没有在线生成账单功能，还需要半人工进行操作（或自动的爬虫进行账单抓取），去对方的系统将对账文件下载后，导入到交易系统中。</p>
<p><strong>(2）对账比较复杂的是自动化的差错处理流程。</strong></p>
<p>需要根据财务部门的要求将差错类型进行归类。常见的差错，例如长款、短款、交易金额错误、手续费错误等，将比对错误的订单流入到差错池进行处理，有部分可以根据财务配置的差错处理规则自动进行处理。</p>
<p>部分需要财务人工介入处理。具体的处理方式方式需要看财务部门的具体要求。对账还可能出现大批量的数据错误，那么此时需要进行重新抽取数据对账，需要将已经解析的数据进行删除处理，还有本次对账进行差错池的数据进行删除处理。</p>
<h2 id="toc-5">五、总结</h2>
<p>支付平台是否需要搭建，还是看公司的体量而定，不是所有的公司都需要搭建这么支付系统。大多数支付系统都是嵌入在订单中心的。有订单中心进行完成。只有达到一定的体量后才会着手建立一整套支付、清分、结算、 对账体系。</p>
<p>以上的流程设计只列出的一部分的正向流程（余额支付、结算流程没有进行展示），反向流程（退款）则没有进行展示。这部分内容感兴趣的同学自行思考，根据自身业务情况进行梳理一下。</p>
<p>最后感谢大家阅读完本文，本人知识也有盲点，如有写的不对的地方，请批评指正错误，欢迎大家一起来探讨。</p>
<p> </p>
<p>本文由 @TOM 原创发布于人人都是产品经理，未经作者许可，禁止转载。</p>
<p>题图来自Unsplash，基于CC0协议。</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5472108" data-author="1025180" data-avatar="https://static.qidianla.com/woshipm_def_head_4.jpg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            