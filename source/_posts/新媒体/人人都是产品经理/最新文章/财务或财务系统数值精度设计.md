
---
title: '财务或财务系统数值精度设计'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/07/xzrgkzZzFWpzCN6nipP5.jpg'
author: 人人都是产品经理
comments: false
date: Mon, 26 Jul 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/07/xzrgkzZzFWpzCN6nipP5.jpg'
---

<div>   
<blockquote><p>编辑导语：如今随着互联网的不断发展，我们开始使用一些财务系统进行交易；在财务系统中，对于这些数值的计算精度需要非常注意，商品资金等等交易都具有严谨性；本文作者分享了关于财务系统数值精度设计，我们一起来了解一下。</p></blockquote>
<p><img data-action="zoom" class="aligncenter size-full wp-image-4937792" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/07/xzrgkzZzFWpzCN6nipP5.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<h2 id="toc-1"><span class="md-plain">一、类型</span></h2>
<ul>
<li><span class="md-plain">计量型数值</span></li>
<li><span class="md-plain">结算型数值</span></li>
<li><span class="md-plain">计算型数值</span></li>
</ul>
<p class="md-end-block md-p"><span class="md-plain">计量型数值即通常说的数量，数值的后面会有一个计量单位，两者共同来描述（实体/虚拟）物品。</span></p>
<p class="md-end-block md-p"><span class="md-plain">交易双方在资金给付时使用的资金数值为结算型数值，结算型数值由交易双方约定同时收到货币最小支付单位的限制。税额、金额、合计金额都是结算型金额。</span></p>
<p class="md-end-block md-p md-focus"><span class="md-plain md-expand">举个例子：A 向 B 购买商品 XX 5 件，每件商品 ¥1.01。理论上 A 应该向 B 支付 ¥5.05 ，B 和 A 说我们结算到元即可，那么 A 只需要支付 ¥5.00 向 B 就行了。</span></p>
<p class="md-end-block md-p"><span class="md-plain">由于人民币最小的支付单位是分，我们就只能定义分以上的单位结算。此时如果改为比特币支付，最小单位就是聪，1聪=0.00000001比特币。</span></p>
<p class="md-end-block md-p"><span class="md-plain">最后是计算型数值，这种类型的数值往往是系统设计过程中最容易出问题的。因为结算型的数值绝大部分是由计量型数值和计算型数值计算后得出的结果，计量值是一个物理上的结果不具有可变性，要保证结算数值的准确就必须保证计算型数值的准确。不含税价就是计算型数值。</span></p>
<h2 class="md-end-block md-heading" id="toc-2"><span class="md-plain">二、精度为什么重要</span></h2>
<p class="md-end-block md-p"><span class="md-plain">在一次交易中，购买方向销售方购买多个商品，每个商品有一个固定的价格，价格乘购买数量得出这个商品的交易金额；再把所有的商品交易金额相加后得出此次交易的总金额，买卖双方在根据总金额进行资金给付。</span></p>
<p class="md-end-block md-p"><span class="md-plain">为什么一定要把每一个商品都计算出一个合计金额在结算呢，原因有两个：①每个商品的销售价格不同；②商品的属性不同税率也不相同，合法的交易中必须根据商品的税率和无税价格计算出税额，开具发票并报税。</span></p>
<p class="md-end-block md-p"><span class="md-plain">此时就出现了无税单价、含税单价、不含税金额、含税金额、税额、数量、合计金额这么多的与结算有关的数字，下面我们看看他们间的关系：</span></p>
<p class="md-end-block md-p"><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/07/jPxPkidVXtKkOVOosRtv.png" alt width="842" height="465" referrerpolicy="no-referrer"></p>
<p class="md-end-block md-p"><span class="md-plain">现实中我们描述的商品价格指的是含税的价格，比如买个手机 ¥999.00 ，手机的实际价格为 ¥884.07 ，税率为 13%，税额为 ¥114.93。</span></p>
<p class="md-end-block md-p"><span class="md-plain">再看一下购买汽油的情况，汽油的不含税价格是一个8位的小数，但油价（含税价格）是 ¥6.90。</span></p>
<p class="md-end-block md-p"><span class="md-plain">一个准确的精度能够保证再整个计算的过程中能够尽可能的避免乘除过程中的无限循环小数以及四舍五入造成的计算结果偏差。<img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/07/hejOi88y5T8BcIiv0Qb5.png" alt width="851" height="567" referrerpolicy="no-referrer"></span></p>
<h2 class="md-end-block md-heading" id="toc-3"><span class="md-plain">三、精度设计</span></h2>
<p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">计量型数值：</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">计量型数值由用户输入，在现实中有一个固定的衡量标准。一般情况下3位小数可满足需求，如果有更精确的计量系统要支持自定义精度。</span></p>
<p class="md-end-block md-p"><span class="md-plain">计量型数值都是在前台输入或获取的，不允许系统在后端重新计算或调整，所以不存在精度误差问题。因为误差已经在线下解决。</span></p>
<p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">计算型数值：</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">用户不能直接修改，必须修改其它值后由系统计算得出结果。一般情况下 8 位小数即可保证计算精度，精度越高结果的准确性也越高，考虑系统的计算性能和稳定性尽可能支持更高精度。</span></p>
<p class="md-end-block md-p"><span class="md-pair-s"><strong><span class="md-plain">结算型数值：</span></strong></span></p>
<p class="md-end-block md-p"><span class="md-plain">结算型数值的精度要根据货币交易的最小单位设计，人民币小数点后两位。这里误差主要因为计算结果的的小数精度大于结算小数精度，一般采用误差更小的四舍六入五成双法舍弃多余的小数。</span></p>
<p> </p>
<p>本文由 @小莱沃 原创发布于人人都是产品经理，未经作者许可，禁止转载。</p>
<p>题图来自Unsplash，基于CC0协议。</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="4928942" data-author="22091" data-avatar="https://static.woshipm.com/APP_U_201708_20170825154252_2520.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            