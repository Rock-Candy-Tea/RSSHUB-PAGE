
---
title: '关于资金调拨系统的设计方法论'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/tKglJl7zS6dODjV4ylmw.jpg'
author: 人人都是产品经理
comments: false
date: Sun, 02 May 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/tKglJl7zS6dODjV4ylmw.jpg'
---

<div>   
<blockquote><p>编辑导语：如今随着互联网的不断发展，资金账户等等都会用互联网的方式进行操作，比如资金调拨，把一部分账户的资金转移到另一个账户中去使用，在这一个操作需要注意什么？本文作者分享了关于资金调拨系统的设计方法论，我们一起来了解一下。</p></blockquote>
<p><img data-action="zoom" class="aligncenter size-full wp-image-4506163" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/tKglJl7zS6dODjV4ylmw.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>大家可能对资金调拨不太陌生，但是对调拨系统可能就接触的少了；那么什么是资金调拨系统呢？其实就是系统化实现资金账户之间资金的转移过程的系统，可大可小，可简可繁，一个拥有四五百个备付金账户的支付机构，这些账户之间资金调拨频率和体量是巨大的。</p>
<p>今天我们就聊一聊资金调拨系统的设计方法，以及需要关注的设计点。</p>
<h2 id="toc-1">一、资金调拨</h2>
<p>我们都知道一个企业，支付机构，银行等都会用于多个银行资金账户；每个账户都会有不同的用途，每个账户中也会有不同体量的资金；当然每个账户中的资金的利息以及其他收益率也是不同的；所以基于业务需要开通了众多资金账户，又基于利益需要或者合规需要又将资金按照一定规则存放于不同的资金账户。</p>
<p>这样就会在一些场景下需要将一些账户的资金转到另一些账户中去使用，这个转移资金的业务就是调拨业务。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/JVcnMu5bU5Sft2ZMI0vh.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-2">二、为什么要调拨</h2>
<p>调拨系统的建立一个是基于调拨频率和调拨效率的需要，另一个就是可以实现全线上化的资金监控和管理；例如支付机构，会在一家银行开通备付金监管户，在其他很多银行开通备付金收付户以及备付金汇缴户。</p>
<p>基于监管需要资金日终会向上归集到监管户，日间又基于出款业务需要，将资金调拨至各个备付金收付户；因为账户数量多，调拨频繁，可能几分钟就需要调拨一次；那么人工处理是不现实的，这时就需要基于具体资金账户的资金需要通过系统完成资金的自动调拨。</p>
<p><img data-action="zoom" class="rich_pages js_insertlocalimg aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/AM6hXQjddRzfa7nqDmRe.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-3">三、调拨的方式</h2>
<p>最原始的就是可以通过人工做调拨：比如资金同事到对公户网银平台，操作资金转账，将资金划拨至另一个公司名下的账户里，或者一个集团子公司名下的对公账户里；这种模式多用于资金调拨频率低，资金账户数量少的情况，一般的企业基本人工调拨即可满足业务的需要。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/iQPTAlw5ceQT4jnt6nnY.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>另一种就是系统自动调拨：就如2中提到的场景，基于出款需要或者其他业务需要实现系统化的自动调拨；当然调拨系统也可以是一个简单的调拨收后台，由人工提交调拨单据，发起调拨请求；另一种就是完全基于业务实际资金需要自动调拨申请；比如基于实际出款的总量，来决定目标出款账户资金余额是否充足，不充足时需要调拨多少，要从哪个账户调拨资金等系统处理。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/7utucJqmG2WdNBCr5o2V.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-4">四、资金调拨系统概述</h2>
<p>调拨系统就是接受业务系统的调拨申请，完成调拨的判断以及调拨的发起；并记录所有调拨的业务数据的资金处理系统。</p>
<p>下面是一个比较通用的调拨业务架构：</p>
<p><img data-action="zoom" class="rich_pages js_insertlocalimg aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/yaMXmjIuaVmHxKVv5wFH.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>调拨的请求来自各业务方，比如出款业务，还款业务，归集业务，或者其他的需要划拨资金的业务。</p>
<p>业务方将要发生的业务封装成调拨请求，发送调拨系统；调拨系统来判断该次需不需要进行资金调拨。</p>
<p>这个过程需要去查询出款账户的资金余额是否充足；预计其他资金预留规则综合得到需要调拨的资金数量。</p>
<p>然后生成调拨单据；基于调拨通道的限额情况对调拨单据进行拆单处理，然后生成调拨记录。</p>
<p>最后发起调拨打款申请完成调拨。</p>
<h2 id="toc-5">五、资金账户管理</h2>
<p>资金账户管理其实就是维护所有可以参与的账户信息；一个是为了获得调拨需要的账户信息，另一个就是资金安全需要，仅允许在账户管理里存在的账户才能执行调拨业务；其他账户不允许作为调拨收款账户。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/EtbWKNEXDIgIwMdeAMCS.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-6">六、调拨通道管理</h2>
<p>因为资金调拨的金额一般都比较大，一般的通道是无法满足的；所以就需要签约一些大额通道；比如银企直联，银行直签的巨额通道；我接过的一些超大额像单笔10亿，日累计50亿的通道，可以满足业务需要。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/54x34nXDiBZtowjn6nZp.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>对于一般企业来说银企直联就可以满足需要。</p>
<h2 id="toc-7">七、调拨预留规则</h2>
<p>基于业务需要判断资金调拨金额的时候其实还要考虑其他情况，比如调拨收款账户需要保留一定的资金量，不能全部用完，也就是有一个存量规则。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/T4jowSoj372KoyCfo44y.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>还有一种情况对比高频调拨出款的账户，比如一个支付机构的用于出款的备付金账户，可能每5分钟就需要一次批量出款，每5分钟就需要进行一次资金调拨；在如此高频率的调拨场景下如果预设一个底线存量那也是没问题的；但是考虑到资金的利用效率，以及收益情况。</p>
<p>另一个原因就是降低调拨频次，我们可以设定为30分钟调拨一次；因为每5分钟有一次出款批次，为了保证金资金充足，我们就需要基于一定的算法来保证金30分钟内的每次出款的资金充足；这时候，我们就需要一个合理的算法来计算每次调拨需要为接下来的30分钟的出款预留资金；我们假设这个预留资金为Ax，x代表调拨的场次。</p>
<p>这里不过多介绍如何计算，大家可以思考一下这个算法，我们可以再交流群沟通，假设我们得出的每个场次的调拨资金为 Mx。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/NwAL1QmcFJGeKstxI1ox.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-8">八、调拨金额计算</h2>
<p>基于上面的假设我们就知道了每次调拨应该调拨多少资金了，假设业务第2场次要从“招行1001账户”出款10亿，此时请求到调拨系统。</p>
<p>出款需求：chukuan=10亿。</p>
<p>此时通过招商查询接口查询到此时的账户余额是9亿，并且查询到账户在第2场次后要预留资金量为5亿。</p>
<p>所以本次是需要调拨资金的，告诉业务方账户余额不足请等待调拨结果。</p>
<p>这时计算需要调拨的资金量：xudiaobo=10亿-9亿+5亿=6亿，所以需要调拨的资金量是6亿人民币。</p>
<p><img data-action="zoom" class="rich_pages js_insertlocalimg aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/DG2B7Gdjz9M1UYvugXm8.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>查询获得给该账户调拨的账户是存管户2001，生成调拨单。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/rNcRTNdHXkwohKDrbwLX.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>由于通道限额单笔是5亿，所以需要对调拨单进行拆单。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/dOZVwRWN5RmnvaOERC3O.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-9">九、账户调拨关系模型</h2>
<p>该模式就是决定哪个账户往哪个账户调拨，利用出款账户来查询要从哪个账户调拨资金。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/Hoy1AdVYOmCIxtPht1q3.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-10">十、调拨发起</h2>
<p>主要是业务发起以及人员从后台直接发起；所以需要向外提供调拨申请接口，后台需要调拨申请管理功能；这个就不过多介绍了，相信大家都能设计出来，认真思考一下吧。</p>
<h2 id="toc-11">十一、调拨审核</h2>
<p>这个基于实际需要不同类型的调拨请求需不需要审核，视情况而定，人工提交的调拨申请肯定是需要审核的。</p>
<h2 id="toc-12">十二、调拨记录</h2>
<p>调拨记录主要是调拨申请记录、调拨单记录、调拨子单记录、调拨打款记录、调拨审批记录等。</p>
<p>调拨单记录：</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/7o7b0Pm1wJHB0XnMeqqY.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<p>调拨子单记录：</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="调拨系统设计方法论" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/04/uGDexpbEHIUgnOfnMF0F.png" alt="调拨系统设计方法论" referrerpolicy="no-referrer"></p>
<h2 id="toc-13">十三、调拨出款</h2>
<p>生成调拨子单以后，调用打款中心的调拨通道发起资金划拨申请；基于通道返回的结果变更调拨单的打款状态；并且将最后的调拨结果告知业务方，以便业务方进行下面的业务流程。</p>
<h2 id="toc-14">十四、调拨异常的处理</h2>
<p>一般的异常就是调拨没有收到通道侧的最终反馈，这个就需要人工干预去查看资金有没有调拨完成；另一个就是调拨失败，这时候就需要一个失败重新出款的操作流。</p>
<p> </p>
<p>10年产品设计经验，4年社交，2年电商，5年支付；曾任职于某头部金融，某头部支付机构；云对账创始人获千万融资；把所见·所闻·所想·所做，在夜深人静处沉淀成文字留给这个世界！</p>
<p>本文由 @陈天宇宙 原创发布于人人都是产品经理。未经许可，禁止转载</p>
<p>题图来自Unsplash，基于CC0协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="4505967" data-author="94217" data-avatar="http://image.woshipm.com/wp-files/2021/02/a84xkWDMu44P1PnVp06z.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            