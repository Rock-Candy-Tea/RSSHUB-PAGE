
---
title: '不会写模型代码？可以这么来做销量预估'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/68kEaFQ3CUBTAMynUuzU.jpg'
author: 人人都是产品经理
comments: false
date: Tue, 28 Dec 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/68kEaFQ3CUBTAMynUuzU.jpg'
---

<div>   
<blockquote><p>编辑导语：产品经理往往需要对之后的业务发展进行预测，这时就可以利用预测模型。但假若你不会写代码、跑模型，怎么办？本篇文章里，作者结合三个案例，对不会写模型代码的产品经理如何做销量预估一事进行了总结，一起来看一下吧。</p></blockquote>
<p><img data-action="zoom" class="size-full wp-image-5267775 aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/68kEaFQ3CUBTAMynUuzU.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>工作中为了对业务未来的发展有个大致的评估与掌握，经常需要对下月、下个季度、明年等做预测，往往需要预测模型的参与，为公司抓住未来的机遇做铺垫策。那么对于不会写代码跑模型的产品经理，怎么来做预估呢？</p>
<p>本文以三个案例着手，来给大家讲一下。</p>
<h2 id="toc-1">一、案例一：Excel操作方式来预测</h2>
<p>根据历史月度销量预测2021-09、10、11、12月的销量数据。</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/m7rQZLa5xS3CTBGfWMgU.jpeg" alt="销量预测模型案例实战" width="250" height="470" referrerpolicy="no-referrer"></p>
<p>先看下散点图，大致浏览下是否存在极值（若有，则排除掉）以及两个变量之间是否存在关联趋势：</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/ceAwB4quImhjrcZCS06l.jpeg" alt="销量预测模型案例实战" width="596" height="304" referrerpolicy="no-referrer"></p>
<p>拟合注意事项：</p>
<ol>
<li>用Excel拟合的时候尽量将各个趋势线均尝试下，选择R²较为接近1的方式。R²越接近1，代表拟合效果越好。</li>
<li>尝试下来，发现多项式拟合效果较好，且“顺序”越往上增加，R²越接近1。但本数据源不多，且多项式拟合多采取二项式或三项式即可满足需求，所以为避免过拟合，取3即可。</li>
</ol>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/m12ixCsz9myNmPxq0nXX.jpeg" alt="销量预测模型案例实战" width="596" height="261" referrerpolicy="no-referrer"></p>
<p>拟合出的结果如下，多项式公式如图中所示：</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/UdBX86IEGzmtT3RFyWOo.jpeg" alt="销量预测模型案例实战" width="591" height="258" referrerpolicy="no-referrer"></p>
<p>给数据源增加一列辅助列；</p>
<p>将21、22、23、24分别带入y = -0.5908x^3 + 19.576x^2 – 73.697x + 2128.3</p>
<p>则得到2021-09、10、11、12月的预测销量。</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/Mtc3ApqB8BnZPriBCLRv.jpeg" alt="销量预测模型案例实战" width="251" height="377" referrerpolicy="no-referrer"></p>
<h2 id="toc-2">二、案例二：Tableau操作方式来预测</h2>
<p>数据源如下：</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/Sad4iRf7fgxaLA8V8MAq.jpeg" alt="销量预测模型案例实战" width="251" height="472" referrerpolicy="no-referrer"></p>
<h3>操作步骤</h3>
<p>步骤1：先将月份拉列，销量拉行，制作出折线图。数据源中“月份”是文本格式，需改成日期格式。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/LTVdJsIAKLXnTf132gX7.png" alt="销量预测模型案例实战" width="253" height="229" referrerpolicy="no-referrer"></p>
<p>步骤2：点击列上的“月份”，改成离散。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/jw53ZoCkBn2lYTzmU5bE.png" alt="销量预测模型案例实战" width="554" height="848" referrerpolicy="no-referrer"></p>
<p>步骤3：点击折线图选择“显示趋势线”。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/mg96PajWbL3TJ302G9rc.png" alt="销量预测模型案例实战" width="552" height="350" referrerpolicy="no-referrer"></p>
<p>点击折线图表，选择“编辑所有趋势线”，可以看到该预测模型为“线性”预测。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/wo41Z1NFU6VCvGIalyvl.png" alt="销量预测模型案例实战" width="592" height="212" referrerpolicy="no-referrer"></p>
<p>点击折线图表，选择“描述趋势模型”，可以看到该“线性”预测的R平方值。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/pPEnOhgmi0Qs4zzJ425v.png" alt="销量预测模型案例实战" width="594" height="243" referrerpolicy="no-referrer"></p>
<p>步骤4：按照步骤3的方法，选择“编辑所有趋势线”依次选择“线性”、“指数”、“多项式”2度、“多项式”3度，并查看对应的R平方值，选择其中R平方值最靠近1 的模型来作为最终的预测模型。</p>
<p>可以看到：“线性”预测R方为：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/ta5iopaYkQItu0OZYRWq.png" alt="销量预测模型案例实战" width="593" height="347" referrerpolicy="no-referrer"></p>
<p>“指数”预测R方为：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/DHdc42m0hOB16JUSojdX.png" alt="销量预测模型案例实战" width="592" height="284" referrerpolicy="no-referrer"></p>
<p>2度“多项式”预测R方为：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/gC57FskwBRgZyNrBJjep.png" alt="销量预测模型案例实战" width="592" height="290" referrerpolicy="no-referrer"></p>
<p>3度“多项式”预测R方为：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/A2aGkWSYgL5sj6sKN6hC.png" alt="销量预测模型案例实战" width="590" height="285" referrerpolicy="no-referrer"></p>
<p>综合对比得出：3度“多项式”预测模型R方更接近1，因此最终采取该预测模型。</p>
<p>步骤5：鼠标移动到趋势线上，可以看到拟合公式如下，如案例一中给数据源添加一列辅助列，并将需要预测的月份的辅助列的数字代入公式中，即可得到预测销量。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/t5RZ4VPz23c3of5EaKle.png" alt="销量预测模型案例实战" width="589" height="139" referrerpolicy="no-referrer"></p>
<p>另外说明：Tableau自带预测功能，但是在本案例中不采用，原因如下：</p>
<p>将月份上的“精确日期”去掉，格式选择月份，点击折线图选择“显示预测”。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/6Zgmzq9sccLcxwExVI8f.png" alt="销量预测模型案例实战" width="570" height="440" referrerpolicy="no-referrer"></p>
<p>结果如下图：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/tdGcXhE4Zp08B9YcPvxV.png" alt="销量预测模型案例实战" width="594" height="443" referrerpolicy="no-referrer"></p>
<p>再点击图表选择“预测描述”，可以发现该自动预测模型用的是“指数平滑法”，然而在上述步骤的拟合中发现指数相关预测方法的R方并不是最优。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/1Nd5gws4XgKoK44pwOCa.png" alt="销量预测模型案例实战" width="592" height="204" referrerpolicy="no-referrer"></p>
<h2 id="toc-3">三、案例三：季节性销量预测</h2>
<p>数据源如下：</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/9WJnKYg67r8rZTwSUnmO.png" alt="销量预测模型案例实战" width="236" height="384" referrerpolicy="no-referrer"></p>
<p>先画出普通折线图，看下是否呈现明显季节性。</p>
<p>下图展示出该销量数据确实呈现季节性，其中第2季度为旺季。则要针对该数据进行去季节化处理。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/Rc38rESs79dyKJYpU4cN.png" alt="销量预测模型案例实战" width="594" height="359" referrerpolicy="no-referrer"></p>
<p>将数据源通过数据透视表处理成下图所示：</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/7O0aHLmTyvmJy2GU14Ex.png" alt="销量预测模型案例实战" width="591" height="152" referrerpolicy="no-referrer"></p>
<ul>
<li>计算每个季度的年度均值，如下图“年平均值”；</li>
<li>计算15个样本的总体平均值，如下图“总平均值”；</li>
<li>用“年平均值”/“总平均值”计算出“季节性指数”。</li>
</ul>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/x9jTpcYR3MUqMikqiIiF.png" alt="销量预测模型案例实战" width="593" height="143" referrerpolicy="no-referrer"></p>
<p>来看一张总结之后的表格。</p>
<p>① 将计算出的“季节指数”重复添加进下图中的“季节指数”列。</p>
<p>② 去季节化=销量/季节指数。</p>
<p>③ 根据“辅助列”和“去季节化”后的销量拟合出线性预测公式。</p>
<p>y=-2.4907x+2532</p>
<p>之所以拟合线性公式是因为在第②步中已经将季节性因素排除掉了。</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/VmXXFlRjs12NByOc8EBw.png" alt="销量预测模型案例实战" width="590" height="289" referrerpolicy="no-referrer"></p>
<p>④ 将辅助列代入公式，计算出“线性预测”列。</p>
<p>⑤ 将“线性预测”列乘以“季节指数”计算出“季节性调整”列，此列即为最终的预测销量。</p>
<p>⑥ 将“线性预测”列减去“销量”列计算误差，再除以“销量”列计算误差率。</p>
<p>⑦ 用STDEV（）函数选中销量一列，计算出总体标准偏差。</p>
<p>显著性水平参数写为0.05，即置信度是95%；样本量写15。</p>
<p>用CONFIDENCE（）函数计算出置信区间的可浮动值，结果如下截图。</p>
<p>即，有95%的可能性预测值比处于真实值的上下195.92范围内。</p>
<p>可以看到误差都在正常的置信区间内。</p>
<p><img data-action="zoom" class="rich_pages wxw-img aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/tln3Ss4NPtzm2XtdeMcb.png" alt="销量预测模型案例实战" width="592" height="366" referrerpolicy="no-referrer"></p>
<p>⑧ 将16（辅助列）代入公式，可预测2021Q4的销量。</p>
<p><img data-action="zoom" class=" aligncenter" title="销量预测模型案例实战" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/12/Y3GvfahcUVFdjlcMTSgz.png" alt="销量预测模型案例实战" width="594" height="192" referrerpolicy="no-referrer"></p>
<p> </p>
<p>作者：Janie Liu；公众号：溜溜笔记说</p>
<p>本文由 @溜溜笔记说 原创发布于人人都是产品经理。未经许可，禁止转载</p>
<p>题图来自Unsplash，基于CC0协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5266263" data-author="1294107" data-avatar="https://static.woshipm.com/APP_U_202112_20211216233502_9365.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            