
---
title: '数据埋点：如何标识你的用户'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/UhlHN3UZLBkM4ZFrkHjZ.jpg'
author: 人人都是产品经理
comments: false
date: Fri, 03 Sep 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/UhlHN3UZLBkM4ZFrkHjZ.jpg'
---

<div>   
<blockquote><p>编辑导语：用户标识可以助力于用户行为的分析，而用户账号ID标识是用户标识的有效方式。那么，针对没有账号体系的产品，用户标识又可以如何操作？本篇文章里，作者就如何借用设备信息作为用户标识进行了阐述和总结，一起来看一下。</p></blockquote>
<p><img data-action="zoom" class="size-full wp-image-5122859 aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/UhlHN3UZLBkM4ZFrkHjZ.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>选取合适的用户标识对于提高用户行为分析的准确性有非常大的影响，也是我们进行数据埋点时需要最优先考虑的问题。因此，我们在进行任何数据接入之前，都应当先确定如何来标识用户。</p>
<p>很多同学看到这可能会有点纳闷，如何标识用户？难道不是通过用户的账号ID吗？</p>
<p>你说得没错，不过用户账号是针对于有账号体系的产品，而对于那些没有账号体系，例如官网、活动落地页，或者需要分析游客行为这样的场景下，我们怎么才能对不同的用户进行标识呢？</p>
<p>我们很容易发现，任何用户在获取线上服务时，都需要通过设备。</p>
<p>所以，我们很自然地就会想到使用设备的一些信息来近似作为用户标识。</p>
<p>那么，设备的哪些信息可以作为用户标识呢？</p>
<h2 id="toc-1">一、如何获取移动端设备唯一标识</h2>
<p>移动端主要的设备就是手机，我们这里主要讲如何获得Android和iOS的设备ID。</p>
<h3>1. 如何获取Android设备的唯一标识</h3>
<p>首先我们来看下Android的设备信息。</p>
<p><img data-action="zoom" class=" aligncenter" title="数据埋点：如何标识你的用户" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/FnzOWpWqp6izbixP7FKw.png" alt="数据埋点：如何标识你的用户" width="695" height="492" referrerpolicy="no-referrer"></p>
<p><img data-action="zoom" class=" aligncenter" title="数据埋点：如何标识你的用户" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/Nw1OyHo4X9ZEnMEnGzn1.png" alt="数据埋点：如何标识你的用户" width="694" height="492" referrerpolicy="no-referrer"></p>
<p><img data-action="zoom" class=" aligncenter" title="数据埋点：如何标识你的用户" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/XszHWktkzvXHX4oMDFQy.png" alt="数据埋点：如何标识你的用户" width="692" height="489" referrerpolicy="no-referrer"></p>
<p>可以看到，上述Android的设备信息中，UDID是最靠谱的，但是Android ID是最容易获取到的。</p>
<p>所以，一般市场上的策略，会使用 UUID。</p>
<p>但是App 卸载重装 UUID 会变，为了保证设备 ID 不变，可以把UUID写入.so的文件，这样即使重装APP也不会改变。</p>
<p>还有一种策略是使用 Android Id 作为设备 ID，虽然刷机、重装系统或恢复出厂设置会改变，但是一般用户不会这么操作。</p>
<h3>2. 如何获取iOS设备的唯一标识</h3>
<p>iOS设备也有IMEI、MEID、MAC地址、UDID、UUID等设备信息，前几个现在都禁止获取了，而UUID是会变化的。</p>
<p>iOS也有一些独有的设备信息。</p>
<p><img data-action="zoom" class=" aligncenter" title="数据埋点：如何标识你的用户" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/kDu9iU3os8J7CFSiMq6y.png" alt="数据埋点：如何标识你的用户" width="695" height="491" referrerpolicy="no-referrer"></p>
<p>所以总结起来，iOS好像没有什么靠谱的标记用户的方法，别急，牛逼的程序员们总是能想出各种骚操作。</p>
<p>现在iOS一般标记用户的方式是获取每台设备的UUID，将其写入keychain中进行固化，这样即使用户重装APP，保存在keychain中的UUID也不会改变了。</p>
<h2 id="toc-2">二、如何获取web端和微信小程序的设备唯一标识</h2>
<p>说完移动设备的，我们再来看一下如何获取web端和微信小程序的设备唯一标识。</p>
<p>web端其实也分为两种访问方式，PC端浏览器和移动端浏览器，但其实都是一样的。</p>
<p>web端默认情况下使用 cookie_id，当用户首次访问网站时，我们会自动生成一串cookie数据，然后存贮在浏览器的 cookie 中。</p>
<p>cookie的生成规则可以是五段不同含义的字段拼接而成来保证唯一性，其中包括两段时间戳，一段屏幕宽高，一段随机数，一段 UA 值。</p>
<p>而微信小程序端，默认情况下使用 UUID，但是删除小程序，UUID 会变。</p>
<p>为了保证设备 ID 不变，建议获取并使用 openid。</p>
<p>如果选择使用 openid 的话，要注意将获取到openid之前用户的操作暂存。</p>
<p>因为获取 openid 是一个异步的操作，而冷启动事件等会先发生，这时候这个冷启动事件还没有获取到openid。</p>
<p>所以我们需要把先发生的操作暂存起来，等获取到 openid 后拼接好再发送数据。</p>
<h2 id="toc-3">三、最后</h2>
<p>让我们最后来总结一下Android、iOS、web和小程序是如何获取设备唯一标识的：</p>
<ol>
<li>Android有两种方式，第一种是获取UUID写入.so文件固化成UDID，第二种是获取Android ID。</li>
<li>iOS是获取UUID，然后写入keychain中进行保存，然后每次从keychain中取用户标识。</li>
<li>web一般是生成cookie并存在设备的浏览器中。</li>
<li>微信小程序，可以使用UUID，但是用户删除小程序后会变化，建议使用openID。使用openID要注意冷启动的时候，要暂存操作事件，获取到openID后再上传。</li>
</ol>
<p> </p>
<p>作者：Jarvan；公众号：产品叨比叨</p>
<p>本文由 @Jarvan 原创发布于人人都是产品经理。未经许可，禁止转载</p>
<p>题图来自Unsplash，基于CC0协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5121917" data-author="678750" data-avatar="https://static.woshipm.com/APP_U_201904_20190428221614_6166.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            