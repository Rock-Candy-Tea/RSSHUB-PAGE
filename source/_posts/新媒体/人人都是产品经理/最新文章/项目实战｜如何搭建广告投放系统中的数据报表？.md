
---
title: '项目实战｜如何搭建广告投放系统中的数据报表？'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/1wkIXg9ga3COHZQOpJZf.jpg'
author: 人人都是产品经理
comments: false
date: Mon, 06 Jun 2022 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/1wkIXg9ga3COHZQOpJZf.jpg'
---

<div>   
<blockquote><p>编辑导语：在进行广告投放时，需要将产品侧与广告侧数据打通，才能够直观地看出广告投放的效果。那么要如何搭建广告投放系统中的数据报表呢？本文作者从搭建的前、中、后三个环节进行分析，一起来看一下吧。</p></blockquote>
<p><img data-action="zoom" class="aligncenter size-full wp-image-5474046" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/1wkIXg9ga3COHZQOpJZf.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>广告投放中会涉及两侧数据：产品侧与广告侧。只有将两侧数据打通，才可以直观地看出广告投放的效果。本文将以在巨量引擎投放广告为例，展开说明在搭建数据报表时的三个重要环节。</p>
<h2 id="toc-1">一、搭建前准备</h2>
<h3>1. 业务描述</h3>
<p>本文的广告数据报表针对的是公司内部付费小说投放业务，广告投放过程中涉及产品侧与广告侧。产品侧中，一个广告投放人员（优化师）可以拥有多个渠道，渠道主要产生用户数据与订单数据；在广告侧，一个优化师可以拥有多个账户，账户主要产生消耗、千展、付费用户成本等数据。</p>
<p>产品侧的渠道可以生成唯一的监测链接，广告平台通过监测链接下发用户触达数据至产品端并完成数据归因。通俗来说，监测链接会让优化师知道<strong>消耗的钱带来了哪批用户。</strong></p>
<h3>2. 绑定关系</h3>
<p>与投放业务部门沟通后，在这个系统中，需要将账户与渠道绑定。整体绑定关系如下图所示，一个优化师可拥有多个渠道和账户，一个渠道可与多个账户绑定，但一个账户只能绑定一个渠道。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/upXsNwdYmWFB303k1scM.jpg" alt width="606" height="246" referrerpolicy="no-referrer"></p>
<h3>3. 账户/渠道操作</h3>
<p>作为数据报表，数据的展示仅仅是表现在前端页面的一种形式。在这个背后，需要有众多的机制作基础，其中之一就是需要考虑到在实际使用过程中，投放部门对账户或渠道的操作。例如，变更账户的所有权、变更渠道与账户的绑定关系、人员离职后的数据交接等等。</p>
<p>这一系列操作虽然并不在数据报表的主业务流程中，但是如果不去把这类“潜在需求”考虑进的话，一旦发生因变更操作而造成的bug、数据不准等问题，会让产品的易用程度大大降低。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/kdQKkqJf2qIBx7ZjIHtT.png" alt width="897" height="84" referrerpolicy="no-referrer"></p>
<h2 id="toc-2">二、搭建中流程</h2>
<h3>1. 账户/渠道导入&渠道绑定</h3>
<p>作为一个To B的广告投放工具，广告账户管理模块必不可少。本文的数据报表利用广告平台的Marketing API能力，完成Oauth授权流程。完成授权后即可使用广告账户对应的token拉取需要的数据。</p>
<p>渠道数据的导入方法与账户导入类似，通过产品侧的开发的API获取到所有的渠道列表，并将渠道数据保存在系统中，供后续的绑定操作使用。</p>
<p>渠道绑定的业务通过系统内部的账户管理模块完成。在完成对广告账户的Oauth授权后，通过交互弹窗将账户与渠道完成绑定。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/x4Xz5E2WulGWLu0ovTHd.png" alt width="452" height="829" referrerpolicy="no-referrer"></p>
<h3>2. 报表搭建</h3>
<p>搭建报表需要从以下几点考虑：</p>
<ul>
<li><strong>数据字段：</strong>与业务部门敲定需要查看的产品侧与广告侧的数据字段及其计算公式</li>
<li><strong>刷新频率：</strong>确认报表需要查看的是实时数据还是小时级数据</li>
<li><strong>统计维度：</strong>通常这与系统架构有关，通常可查看账户数据、优化师汇总数据、部门汇总数据</li>
</ul>
<p>在考虑完成以上几点后，仍有一个问题需要解决：准确性。这是作为数据报表最基础的特性，若无法满足数据准确，再完备的设计那也将会是徒劳。为了提高准确性，可以从<strong>数据拉取、数据交接、数据校验三</strong>个环节考虑。</p>
<p><strong>1）数据拉取</strong></p>
<p>数据拉取过程中，我们需要注意接口调用的频次以及广告平台侧数据刷新的频率。过高的频率首先会增加自身服务器的压力，阻塞的队列会让一些定时任务“挂掉”，然后导致应该更新的数据未及时更新。</p>
<p>其次，也由于API侧会对调用QPS做限制，在无法及时沟通提升QPS的情况下，自己在业务侧做好数据拉取的限制也尤为重要。例如，不拉取未绑定渠道的账户数据或不拉取30天无消耗的账户数据等等。</p>
<p><strong>2）数据交接</strong></p>
<p>数据交接也是在先前段落提到的问题。通用的绑定模型中，广告投放优化师、广告账户和渠道都是一定的绑定关系。但是实际投放过程中，会存在账户交接、渠道换绑等绑定关系变动的情况。在这里将以变更渠道绑定关系这一场景为例说明数据交接的做法。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/tmP2u7PqSFWOJgznvC4K.jpg" alt width="635" height="169" referrerpolicy="no-referrer"></p>
<p>变更渠道关系，即使用新账户B投放已有的渠道A，先前的绑定关系为账户A绑定渠道A。因为之前我们提到，广告投放的核心是明确消耗的钱带来了哪批用户。若直接将渠道A的历史数据绑定至新账户B，就会产生疑义：<strong>为什么要将账户A消耗带来的用户充值算在新的账户B上？</strong></p>
<p>显然这样的简单粗暴的数据交接流程并不能满足数据报表在准确性上的要求，而失去准确性的数据报表对广告投放起不到任何帮助作用，甚至错误的数据会影响优化师的判断。</p>
<p>如下图所示，这个系统中所使用的方案是将所有数据<strong>按小时维度存储</strong>，这样的好处就是，所有数据（产品侧数据和广告侧数据）都会按小时记录当时的归属人员、绑定账户/渠道，这样不论是出现账户从属关系变更或者账户渠道绑定关系变更，都可以从下个整点开始基于新的关系进行数据展示。历史数据也会按交接前的绑定关系进行展示，这样就解决了因数据交接带来的误差。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/VP5Z2HPWPfrStUIdbMGr.jpg" alt width="628" height="162" referrerpolicy="no-referrer"></p>
<p><strong>3）数据校验</strong></p>
<p>当数据成功拉取下来后，这也并不意味着广告平台返回的数据是准确的。因为广告平台自身也有自己的数据归因窗口期。当早上8:00平台返回消耗数据为100时，经过其自身的数据归因后，会有可能出现消耗数据修正为150的情况。所以，可以考虑在当天下午或是次日，重新调用API将前一天的数据做一次校准，这样可以避免因广告平台侧数据变更而导致的准确性问题。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/cMEr43jtc7kNA7WIyI0c.png" alt width="804" height="304" referrerpolicy="no-referrer"></p>
<h2 id="toc-3">三、搭建后总结</h2>
<p>当完成数据报表搭建后需要对报表数据进行核对，确保各项字段数值与广告平台返回的数据一致。另外，不同广告平台返回字段的精度格式也需要注意。例如巨量引擎对金额的返回精度为“元”，而腾讯广告返回的是“分”。</p>
<p>在本文涉及的业务场景中，渠道数据与广告账户数据为相同维度。但实际情况中，使用不同的监测链接可以做到将渠道数据与广告计划数据放在相同维度做关联，不过这背后的逻辑都是一样的。</p>
<p> </p>
<p>本文由 @PMing 原创发布于人人都是产品经理，未经许可，禁止转载</p>
<p>题图来自 Unsplash，基于 CC0 协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5470910" data-author="1256680" data-avatar="http://image.woshipm.com/wp-files/2021/08/WwzsNBvTZDGCUMAK9rU7.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            