
---
title: '浅谈权限配置能力设计'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/HZBycvDPRMuln4Sps40c.jpg'
author: 人人都是产品经理
comments: false
date: Sun, 12 Jun 2022 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/HZBycvDPRMuln4Sps40c.jpg'
---

<div>   
<blockquote><p>编辑导语：权限配置能力，可以为各应用提供权限配置原子能力，帮助应用快速集成权限配置，提高系统权限管理体验。本文作者分析了如何以RBAC模型设计可配置的权限中心，一起来看一下吧。</p></blockquote>
<p><img data-action="zoom" class="aligncenter size-full wp-image-5482517" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/HZBycvDPRMuln4Sps40c.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>权限配置能力作为权限控制器，为各应用提供权限配置原子能力。这里聊聊，如果想要以RBAC模型设计可配置的权限中心，该怎么入手。</p>
<p>笔者根据自己的行业经验总结了一下思路，欢迎大家批评指正。</p>
<p>所谓权限配置能力，就是以权限、角色为中心，把权限配置单独作为原子能力服务，高度抽象，为开发者、运营人员提供一整套对菜单、接口和数据资源进行授权，同时提供标准授权界面，帮助应用快速集成权限配置，为业务运营集成权限统一管理，形成标准化流程，提高系统权限管理体验。</p>
<p>权限配置能力，主要实现的是从用户角色到功能应用的权限控制器，提供管理功能权限、数据权限的基础能力，提供权限服务（管理+控制）能力给每一个应用使用，免除重复开发、考虑不全的问题。</p>
<h2 id="toc-1">一、什么是RBAC模型</h2>
<p>首先，我们来说说什么是RBAC模型。</p>
<p>RBAC认为权限授权的过程可以抽象地概括为：Who是否可以对What进行How的访问操作，并对这个逻辑表达式进行判断是否为True的求解过程，也即是将权限问题转换为What、How的问题，可以说，Who、What、How构成了访问权限三元组。</p>
<h3>1. RBAC的组成</h3>
<p>在RBAC模型里面，有3个基础组成部分，分别是：用户、角色和权限。</p>
<p>RBAC通过定义角色的权限，并对用户授予某个角色从而来控制用户的权限，实现了用户和权限的逻辑分离（区别于ACL模型），极大地方便了权限的管理。</p>
<ul>
<li>用户-角色映射：用户和角色之间的映射关系</li>
<li>角色-权限映射：角色和权限之间的映射关系</li>
</ul>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/KmojZG53bAYyesBU16wm.png" alt width="489" height="245" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">（注：图来源于网络，如侵权可告知删除）</p>
<h3>2. RBAC的原则</h3>
<p>RBAC支持三个著名的安全原则：最小权限原则、责任分离原则和数据抽象原则。</p>
<ul>
<li>最小权限原则：RBAC可以将角色配置成其完成任务所需的最小权限集合。</li>
<li>责任分离原则：可以通过调用相互独立互斥的角色来共同完成敏感的任务，例如要求一个计账员和财务管理员共同参与统一过账操作。</li>
<li>数据抽象原则：可以通过权限的抽象来体现，例如财务操作用借款、存款等抽象权限，而不是使用典型的读、写、执行权限。</li>
</ul>
<h3>3. RBAC的优缺点</h3>
<p>RBAC模型优点是简化了用户和权限的关系易扩展、易维护。</p>
<p>但也存在一定的局限性，比如，RBAC模型没有提供操作顺序的控制机制，这一缺陷使得RBAC模型很难适应哪些对操作次序有严格要求的系统。</p>
<h2 id="toc-2">二、权限控制框架</h2>
<p>聊完了RBAC模型，我们可以先看看权限控制框架设计。</p>
<p>刚刚提到过，所谓权限，就是对资源、数据等进行配置，不同的人分配不同的权限。可以说，权限控制框架其实就是将不同的资源、数据分配给不同的角色，从而完成授权行为。</p>
<h3>1. 权限配置</h3>
<p>针对不同的角色配置相应的授控资源（包括菜单、接口、数据资源等）完成授权配置。</p>
<p>具体配置流程需要对应用系统的资源进行录入（包括菜单资源、接口资源、数据资源）后，对业务应用系统的资源进行重新配置为权限策略，最后对角色进行赋权以及角色绑定用户。</p>
<p>完成配置后，业务系统通过调用对外服务的SDK标准组件或接入API接口，判断资源与用户/角色的关联关系后进行权限控制即可。</p>
<p>实际上，授权不仅仅可以对角色进行授权，实际上还可以通过将角色与组织机构、行政区划、标签等纬度进行关联授权，甚至是直接将用户与组织机构、行政区划、标签等纬度进行关联授权。但在本文中，暂时先不考虑这种多维度的授权逻辑，只讨论常规授权逻辑。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/sk4intJOlpfo38dX48Wc.png" alt width="612" height="195" referrerpolicy="no-referrer"></p>
<h3>2. 鉴权服务</h3>
<p>针对具体的运行环境，判断授权对象是否对授控资源具有某种操作或数据范围的权限。</p>
<h2 id="toc-3">三、资源管理</h2>
<p>权限策略的前提时，需要对应用系统的资源（包括菜单资源、接口资源、数据资源）进行录入。</p>
<p>在系统初始化时，由超级管理员或开发人员完成码资源管理的录入和管理，后续可集成到相应的管理平台中，为产品运营提供灵活可控的权限控制。</p>
<h3>1. 菜单资源</h3>
<p>菜单资源，指的是对业务系统的前端功能菜单/页面资源进行录入管理，以独立的URL进行区分，可进行分层级管理。</p>
<ul>
<li>新增菜单资源：需要填写资源名称、资源编码、资源路径、排序号、打开方式等信息</li>
<li>新增子菜单：需要填写资源名称、资源编码、资源路径、菜单等级和上级菜单、排序号、打开方式等信息</li>
<li>查询：比如可根据菜单名称、ID等进行搜索</li>
<li>编辑：编辑菜单资源的基本信息，这里需要注意的是，要确定资源的唯一性及是否可修改等等</li>
<li>删除：删除菜单资源，可设置一定的校验规则，比如需要删除下级菜单，才可以删除上级菜单</li>
<li>批量导入：可按照标准文档要求，批量导入菜单信息</li>
</ul>
<h3>2. 接口资源</h3>
<p>接口资源，指的是对业务系统的后端接口资源进行录入、管理，可以录入URL关键字段和接口请求方式。</p>
<ul>
<li>新增接口资源：需要填写选择资源名称、资源编码、资源路径、请求方式等</li>
<li>查询：比如根据接口名称、接口地址进行搜索</li>
<li>编辑：编辑接口资源</li>
<li>删除：删除接口资源</li>
<li>批量导入：可按照标准文档要求，批量导入接口信息</li>
</ul>
<h3>3. 数据资源</h3>
<p>数据资源，主要指业务系统中存储的数据资源，通过字段信息进行区分，可以通过唯一编码录入权限管理。</p>
<ul>
<li>新增数据资源：需要填写选择数据元素名称、元素编码、所属页面名称、所属菜单路径等</li>
<li>查询：比如根据字段名称进行搜索</li>
<li>编辑：编辑数据字段资源</li>
<li>删除：删除数据字段资源</li>
<li>批量导入：可按照标准文档要求，批量导入字段信息</li>
</ul>
<h2 id="toc-4">四、权限策略</h2>
<p>根据业务应用实际情况，建立权限策略管理功能，对已经纳入管理的资源，包括资源管理添加的菜单、接口、数据字段资源进行重新配置权限，管理权限与资源的关联逻辑。</p>
<p>从控制力度来看，权限管理分为两大类：功能权限管理和数据权限管理。</p>
<p>在系统初始化时，由超级管理员或开发人员完成码权限策略的配置和管理，后续可集成到管理平台中，为产品运营提供灵活可控的权限控制。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/C1atROMr7NTQzrTAAEaG.png" alt width="611" height="228" referrerpolicy="no-referrer"></p>
<h3>1. 功能权限</h3>
<p><strong>1）定义</strong></p>
<p>通俗的说，功能权限指用户登录系统后能看到哪些模块，操作哪些按钮。每个角色有配置固定的功能权限，角色之间权限相互隔离。所有角色的对应功能权限由管理后台进行配置。</p>
<p><strong>2）分类</strong></p>
<p>功能权限包括：业务功能、授权功能。</p>
<ul>
<li>业务功能：根据业务场景，定义不同的业务功能。结合实际业务场景，进行业务功能与角色关联配置，完成相关角色的权限配置。</li>
<li>授权功能：若该角色具有“授权管理”功能，则需要通过管理后台配置允许该角色进行授权的子角色。</li>
</ul>
<h3>2. 数据权限</h3>
<p><strong>1）定义</strong></p>
<p>如果所有信息都是公开透明的，也就不需要做数据权限的控制。可城市码的业务形态多而杂，每个人、每个角色需要看到的、应该看到的数据不同，数据权限便应这些需要和规则而生。</p>
<p>数据权限较比于其他两个权限较为抽象，指的是用户是否有针对某些数据的浏览权限，用户在某个模块里能看到哪些范围的数据。不同角色在同一个页面看到的信息是不同的，可以通过组织架构来区分。</p>
<p><strong>2）业务决定</strong></p>
<p>对于数据权限的管理比较复杂，这个主要还是有具体的业务来决定的。数据权限一般和组织架构相关。根据组织机构的层级关系，结合业务实际场景，实现不同角色的数据权限的划分。</p>
<p>比如A业务经理只能看到自己的客户数据，但是A的业务总监可以查看到各个区域业务员的客户数据。</p>
<p><strong>3）数据权限向上兼容原则</strong></p>
<p>数据权限向上兼容，若出现多层级授权场景，上级可以对查看下级信息（包括统计信息、授权信息等）。当用户获取数据时，根据自己当前的部门和职位，获取到所有下属的职员信息。</p>
<p>例：业务管理员可以查看其管辖范围内次级管理员或业务员的所有信息。</p>
<h3>3. 权限策略</h3>
<p>对已经在【资源管理】已经录入的资源，在【权限策略】进行重新配置为权限策略。</p>
<ul>
<li>新增权限策略：需要填写功能名称、功能URL路径、功能描述、行政区划、组织机构等，对【权限策略列表】进行勾选</li>
<li>查看：对已授权功能进行展示，并可以展开查看所有资源明细</li>
<li>编辑：编辑功能权限</li>
<li>删除：删除功能权限</li>
<li>关联角色：关联角色，对角色进行赋权</li>
</ul>
<h2 id="toc-5">五、角色管理</h2>
<p>在系统初始化时，由超级管理员或开发人员完成角色管理的配置和管理，后续可集成到管理平台中，为产品运营提供灵活可控的权限控制。</p>
<h3>1. 角色授权</h3>
<p>在功能权限策略管理功能已经完成功能权限配置后，需要对角色进行赋权，赋权后展示角色对已授权功能权限和资源明细全景图，便于配置维护。可将角色与用户进行绑定，完成角色授权。</p>
<ul>
<li>新增角色：需填写角色的名称、角色类型、角色层级（行政区划、组织机构）</li>
<li>编辑角色：编辑角色</li>
<li>关联权限：关联权限策略，对角色进行赋权</li>
<li>关联用户：将角色与用户关联起来，从而实现对用户授权</li>
</ul>
<h3>2. 角色的组织属性</h3>
<p><strong>1）行政区划</strong></p>
<p>行政区划是行政区域划分的简称，是国家为了进行分级管理而实行的区域划分。一般来说，我国的行政区划管理体系颗粒度可到省-市-区-街道-社区村居5级管理。</p>
<p>一个管理员只对应一个行政区划，管理员下的查验员都跟着管理员的行政区划。</p>
<p>注意：很多时候，行政区划不是必要的组织属性，一般的to B企业基本不会用到该字段信息。但有时候对于政务行业相关的应用系统，行政区划信息还是必要的。</p>
<p><strong>2）组织架构</strong></p>
<p>组织机构是行政组织机构管理的简称，是为了实现在不同组织机构、部门等层级的分级管理设计。根据组织机构的层级关系，结合业务实际场景，实现不同角色的功能权限、数据权限的划分。</p>
<h3>3. 角色层级</h3>
<p><strong>1）定义</strong></p>
<p>角色层级可配置3-5个层级，包括普通用户、管理端的管理人员和业务角色。所有角色根据不同场景、不同业务需求决定，角色之间的授权限制条件也与业务场景相关。</p>
<p><strong>2）分类</strong></p>
<p>角色可以分为管理角色、业务角色。</p>
<ul>
<li>管理角色：具备数据查看权限、具备授权功能，同时也可以拥有业务角色的功能权限</li>
<li>业务角色：具备业务功能，根据实际业务场景判断是否具备授权功能（一般不具备）</li>
</ul>
<p><strong>3）角色权限说明</strong></p>
<p>所有角色与用户的关联可通过管理后台进行授权操作。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/XlRdT7vK9gotRSdQJefe.png" alt width="556" height="622" referrerpolicy="no-referrer"></p>
<h2 id="toc-6">六、用户赋权</h2>
<h3>1. 用户管理</h3>
<p>用户管理当前提供后台系统账号的新增和批量导入功能，添加用户时需要添加用户的业务属性，包括角色和角色权限。</p>
<h3>2. 用户授权</h3>
<p>通过管理后台或小程序，将用户与角色绑定关联，实现用户赋权。一旦用户被分配了适当的角色后，该用户就拥有此角色的所有操作权限。</p>
<p>用户与角色是多对多的关系。一个用户可以拥有若干角色，一个角色也可以赋予若干用户。</p>
<h3>3. 多角色并存机制</h3>
<p>多个角色并存的时候，不同角色的拥有不同功能权限的功能模块。这里需要分两种情况进行分析。</p>
<p><strong>1）角色权限向上兼容原则</strong></p>
<p>用户可以通过角色切换来进行功能模块的切换，但角色权限也存在向上兼容原则，也就是说，高级权限可以覆盖低层级权限。</p>
<p>比如，一个用户可能即是公司员工又是管理人员，那么这时候他既有普通员工的角色权限，也有管理层（比如业务经理）的角色权限，这时候他登录时无需进行角色切换，而是直接以他所拥有的最高层级角色登陆系统，显示他最高层级角色的功能页面即可。</p>
<p><strong>2）角色权限无法兼容</strong></p>
<p>但也会存在另一种情况，就是可能在系统内，某个用户他既是财务人员，又身兼监管部门要职，而这两种角色的功能业务可能会存在某种冲突，系统不允许同一用户同时兼容这两种身份，但实际上企业内部又出现了这种情况。那么我们就得对这两种角色的权限进行隔离，让同一用户能在系统中身兼多任（注：这里提供的案例可能不是非常准确）。</p>
<p>这里提供一个笔者的解决方案，各位如果有更好的解决思路，欢迎补充~</p>
<p>当面临这种角色权限无法兼容时，可以通过角色切换实现对角色权限的隔离。比如：</p>
<p>若用户只有1个角色或同时拥有2哥及以上的角色但角色可向上兼容，登录时默认使用该用户最高层级的角色登录，加载最高层级角色的功能页面；</p>
<p>若用户有2个及以上的角色，但角色之间可能存在无法兼容的情况，登录时弹框加载该用户所有角色的列表，让用户自己选择角色后，加载该角色的功能页面。</p>
<p>同时提示可以在【我的】->【角色切换】进行角色的切换，并在本地缓存该角色的记录，下次登录时通过读取缓存，自动加载该角色的功能页面。</p>
<p><img data-action="zoom" class="aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2022/06/6c6r55raNPdwfv4YwuHY.png" alt width="461" height="386" referrerpolicy="no-referrer"></p>
<h2 id="toc-7">七、其他授权</h2>
<p>这里需要说明的是，授权不仅仅可以对角色进行功能授权，实际上还可以通过将角色与组织机构、行政区划、标签等纬度进行关联授权，甚至是直接将用户与组织机构、行政区划、标签等纬度进行关联授权。</p>
<p>但在本文中，暂时先不考虑这种多维度的授权逻辑，只讨论常规的功能授权。</p>
<p>这里笔者只根据自己的经验整理了一下思路，欢迎大家积极吐槽，期待能与大家一起讨论找到更好的解决方案，谢谢各位的赏读~</p>
<p> </p>
<p>本文由 @Elaine 原创发布于人人都是产品经理，未经许可，禁止转载。</p>
<p>题图来自Pexels，基于 CC0 协议。</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="4311666" data-author="170254" data-avatar="http://image.woshipm.com/wp-files/2022/06/evPkvHSB6233hO2mOBsx.png"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            