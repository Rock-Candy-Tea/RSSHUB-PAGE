
---
title: 'EPR系统篇：我接手了一个烂尾楼（一）'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/IiyRbvtl3yXspUrcMvfJ.jpg'
author: 人人都是产品经理
comments: false
date: Tue, 07 Sep 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/IiyRbvtl3yXspUrcMvfJ.jpg'
---

<div>   
<blockquote><p>编辑导语：在工作中，经常需要接手一些遗留下来的项目，这些项目往往存在着不少问题。本篇文章作者结合亲身经历，根据项目中存在的问题，一一拆解解决过程，与大家分享如何快速有效的接手项目。</p></blockquote>
<p><img data-action="zoom" class="size-full wp-image-5127604 aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/09/IiyRbvtl3yXspUrcMvfJ.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<h2 id="toc-1">一、项目背景</h2>
<p>中途接手一个已经在开发中的ERP项目，收集到的信息如下：</p>
<ul>
<li>该项目原本由不存在相关经验的产品和技术进行跟进，且短期内不会有专业供应链开发入职；</li>
<li>业务方非常不满意，认为开发进度缓慢，无法有效支持开展业务；</li>
<li>当前库存混乱且长期无法解决，财务做账困难，且无法进一步分析该项目运营情况；</li>
<li>运营该项目的团队此前没有类似经验，相关业务流程及规范不完善；</li>
<li>收银系统为外购部分，生态比较闭环，不适用我司实际情况；</li>
<li>第三方仓库为外包，仓库管理混乱，仓库账面库存和实物不准确。</li>
</ul>
<p>基于以上情况，该项目目前产出的成果质量问题严重，人力储备不足且不专业，运营管理及仓储管理混乱，可谓是内忧外患；因此优先考虑收尾并关闭项目，重新外购一套成熟系统；但最终出于成本的考虑，公司还是决定继续自研。</p>
<h2 id="toc-2">二、项目开展规划</h2>
<p>既然已经定下继续自研，因此进行以下方面准备：</p>
<ul>
<li>收集当前所有相关方的业务瓶颈及功能述求，提出相关解决方案；</li>
<li>结合已有成果及业务述求，对系统功能框架，数据流，表结构进行整理，重新制定整体框架；</li>
<li>向公司申请更多产品及技术资源，包括招聘专业的人才；确保有足够且有经验的人力。</li>
<li>进行以上准备工作后，开始着手对系统进行优化及完善；整体方向以稳定原有业务功能为主，其次开发新功能满足业务刚需。</li>
</ul>
<h2 id="toc-3">三、库存问题根本原因分析</h2>
<p>目前已知的实际情况为：门店与ERP系统库存不一致，仓库与ERP系统库存不一致，门店账面与实物库存不一致且差异较大，仓库账面与实物库存不一致且差异较大。</p>
<p>对于门店系统或仓库系统实物与账面不一致的情况，可以通过对门店/仓库进行盘点，找出盘点差异数值比较大的库存记录，通过与业务及三方系统开发核实查找问题；这里不详细展开。</p>
<p>对于ERP系统与门店或仓库库存不一致的情况，理论上可以通过对比两边系统的库存变动明细，来发现库存变动确实或数量有差异的场景；但由于缺少库存变动明细数据，因此我们决定对比库存差异变动趋势来发现问题，若两边库存的差异在逐步扩大，则该商品库存在两边系统的库存处理可能会存在问题。</p>
<h3>1. 门店库存差异分析</h3>
<p>库存对比监控：拉取每天凌晨门店库存数据与ERP门店库存进行对比，计算当天库存差异值，第二天再次拉取数据并计算差值；相邻的两天库存差异纯在的变动即delta值；当delta值不等于0的情况下，则代表该商品的库存处理在门店系统和ERP系统存在差异。</p>
<p>通过对异常库存的商品出入库记录进行分析，发现库存差异原因如下：</p>
<p><strong>1）门店部分收货，但是门店系统回传的实际收货数量=应收数量，导致ERP库存偏小</strong></p>
<p>根本原因：部分收货时，门店系统回传数值错误。</p>
<p><strong>2）门店负库存销售，但是ERP系统不允许负库存出库，且相关单据未做进一步处理</strong></p>
<p>根本原因1：门店日常实物与账面不一致，但为了保持正常业务进行，需要临时负卖。</p>
<p>根本原因2：配货单下发到门店系统，门店未验收即开始上架销售。</p>
<p>根本原因3：由于系统记录的商品条码错误，导致商品无法扫码出库，重新建一个商品用于出库。</p>
<p>根本原因4：仓库送错货，门店从不知来源渠道收货并销售。</p>
<p>根本原因5：门店入库大包装商品，但按照小包装出售。</p>
<p><strong>3）门店盘点及报损数据未处理，导致数据偏大</strong></p>
<p>根本原因：门店系统进行报损和盘点，但是相关单据并未被拉回ERP处理。</p>
<h3>2. 仓库库存差异分析</h3>
<p>同门店差异分析方法，对ERP和仓库库存差异变动进行分析，发现库存差异原因如下：</p>
<p><strong>1）仓库部分发货时，EPR冻结库存未释放，可用库存偏小</strong></p>
<p>根本原因：ERP采购单未能同步WMS采购单完结状态，并释放冻结库存。</p>
<p><strong>2）ERP不允许库存为负数，两边库存总数不一致</strong></p>
<p>根本原因：WMS出库单重复回传至ERP处理，导致库存偏小。</p>
<p><strong>3）WMS自建单据的其他出库操作，数据未同步至ERP</strong></p>
<p>根本原因：WMS系统进行报损和盘点，但是相关业务未同ERP进行对接。</p>
<h2 id="toc-4">四，库存问题优化</h2>
<h3>1. 问题优化方向</h3>
<p>经过以上差异数据监控对比及根本原因分析，从以下几个方面进行处理：</p>
<ul>
<li>对于仓库和门店系统产生的问题提出，并要求三方系统进行优化或规范。如：数据回传不能重复，部分收货时回传数据修正等。</li>
<li>对于系统已有功能的问题进行修复，包括：冻结库存处理，负库存处理等。</li>
<li>为各种异常场景梳理业务流程，提出系统解决方案，并进行相关功能开发。</li>
</ul>
<p>由于前期缺少监控措施，导致库存出现异常，相关问题未及时排查，最终库存差异越来越大；因此需对监控措施进行完善。</p>
<h3>2. 监控措施完善</h3>
<p>结果层面：通过每日定时导或拉取wms及门店系统库存数据，记录相关库存差异值，delta值，生成库存异常记录，并将汇总对比结果推送至企业微信；技术每日检查相关数据，若已处理则提交处理结果并修改状态。</p>
<p>过程层面：对重复回传出/入库单结果，回传出/入库单且可能导致ERP库存为负，两种情况做监控，监控到异常情况，则直接推送告警信息至企业微信；此外由于门店负卖情况比较多，所以对于无法出库的单，增加页面集中展示，便于业务集中查看及处理（理论上门店系统自动生成调整单更合适）。</p>
<h3>3. 库存问题解决方案</h3>
<p><strong>1）商品多规格/中小包装方案混卖方案</strong></p>
<p>入库时，确定可能最小售卖单位，库存即以该最小规格进行存储；（防止可能出现的中包装卖到一半，需要转换成小包装去卖的场景—该场景下只能换一个商品去销售了）—这里的最小售卖单位原则上是能划分多细就多细，以防止后期可能出现问题。</p>
<p>以上最小规格商品创建后，若后续需要按照中包装或多种商品组合出售时，可以创建组合商品；组合商品由上述最小规格的商品组成，但可以独立设置价格及商品信息进行出售；当商品下发至门店系统时，组合商品也需要下发。</p>
<p><strong>2）门店负卖解决方案</strong></p>
<p>销售排队出库，库存足够则直接出库，并生成出库单；库存不足则状态为待出库，定时轮询直到库存满足再进行出库，并生成出库单和扣减库存（考虑到出库单也需要取成本价，因此取不到成本价的情况下，也不能生成出库单）。</p>
<p>此外为了确保库存能准确体现，可采取类似于在途库存的形式，在相关库存汇总报表里面，展示“待出库数”（考虑增加“待出库库存”表，便于页面展示时汇总统计待出库库存）。</p>
<p>对移动加权平均价的影响：库存总价值还是为正（因为还没真实出库），移动加权平均价也为正；计算移动加权平均价的时候，不考虑在途和待出库库存（若直接允许库存为负数，则会同时存在正数和负数的库存明细，影响移动加权平均价的计算）。</p>
<p><strong>3）门店在途库存和冻结库存</strong></p>
<p>重新检查并设计在途库存和冻结库存逻辑。</p>
<p>在途库存：仓库或门店入库业务单据生效后，即增加在途库存（总库存不变）；当业务单据取消或完成入库后，减少对应数量的在途库存（总库存伴随入库单回传后增加）。</p>
<p>冻结库存：仓库或门店出库业务单据生效后，即增加冻结库存（总库存不变，冻结库存增加）；当业务单据取消或完成出库后，减少对应数量的冻结库存（总库存减少，可用库存=总库存-冻结库存）。</p>
<p><strong>4）商品资料存储及下发方案</strong></p>
<p>商品下发跟采购单/调拨单/配货单走，否则没有入过库的商品，就会被业务盘点等，导致无缘无故增加库存，或在被盘盈/盘亏时，对应的盘盈入库单无法取到成本价，此外还可以避免门店在门店没有收货的情况下，就直接销售出库了。</p>
<p>正常使用商品名称，规格，条形码，生产厂家，批准文号其中的一项或多项来确定商品的唯一性，但是商品ID需要与这些信息区分开来，便于必要时刻对商品信息进行修改（如商品条码录入错误）；商品ID一般用商品分类+固定长度数字的组合，作为通信的唯一ID。</p>
<h3>4. 系统功能完善</h3>
<p><strong>1）门店收货异常</strong></p>
<p>门店入库单回传至erp系统时，拉取原仓库配货出库单，对比数据并自动生成差异记录，对于差异记录可在仓管进行定责后，自动生成入库单和出库单下发至wms系统（可根据单据类型对不同单据进行虚拟出入库）。</p>
<p><strong>2）仓库报损</strong></p>
<p>由于仓库那边不支持上传报损数据，因此，从erp系统推送报损数据至wms系统；业务操作层面由仓库确定报损的商品后，发邮件至仓管员，仓管员在erp系统上创建报损单，经过相关审批流后，通过出库单的形式推送至仓库进行出库。</p>
<p><strong>3）仓库盘点</strong></p>
<p>由于仓库那边不支持上传盘点数据，因此，从erp系统推送盘点数据至wms系统；业务操作层面由仓库确定盘点的商品后，发邮件至仓管员，仓管员在erp系统上创建盘点单，经过相关审批流后，通过出库单+入库单的形式推送至仓库进行出/入库。</p>
<p><strong>4）仓库内移库</strong></p>
<p>良品/残次品切换：为了便于仓库的作业，同时提供更精准的库存给业务方参考；库存分为两种：良品，不良品；其中良品可用于正常出库作业，不良品可用于报损及退货等；对于ERP系统来说，需要区分以上两种商品状态（也有用库存来区分的），所以当仓库做移库或库存调整导致商品状态变更的情况下，WMS相关单据同步回ERP进行变更。</p>
<p>商品批次控制：为了精准控制仓库的不同批次不同效期的商品数量，库存按照批号（有效期至）进行存储。</p>
<h3>5. 库存处理框架</h3>
<p>对库存相关处理框架进行改造，分为业务单据-出/入库单-库存的结构；在业务单据产生后，可以直接下发至下游仓库和门店系统，门店和仓库出入库单回传，必须先生成出/入库单，并根据出/入库单对库存进行调整。</p>
<p>对于业务发生在其他系统的（如门店销售，仓库报损及盘点等），统一拉取业务单据存储并排队进行出库，若库存满足则生成出库单后再进行库存调整操作。</p>
<h2 id="toc-5">五、结语</h2>
<p>经过以上的问题查找-分析-解决，基本完成对库存的处理框架的优化，但是整个过程还是比较艰辛且阻力比较大。</p>
<p>由于项目前期严重质量问题，需要重新树立团队信心，取得业务方谅解并降低其期望值；在详细的解决方案上，落实到具体的业务操作流程及管理规范，以确保最终方案最终能落地；此外，需要持续对使用方进行培训及考核，包括集中培训及考核（制作问题并给业务方进行填写）等。</p>
<h3>#专栏作家#</h3>
<p>本文由 @不桡 原创发布于人人都是产品经理，未经许可，禁止转载</p>
<p>题图来自 Unsplash，基于 CC0 协议</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="5125835" data-author="659142" data-avatar="https://static.woshipm.com/APP_U_201810_20181016232107_3596.jpeg"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            