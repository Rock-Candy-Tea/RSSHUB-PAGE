
---
title: '一文解密交易金额退款时，资金如何原路退还？'
categories: 
 - 新媒体
 - 人人都是产品经理
 - 最新文章
headimg: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/6DyQ13DPpiCLa3X7FgHB.jpg'
author: 人人都是产品经理
comments: false
date: Thu, 17 Jun 2021 00:00:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/6DyQ13DPpiCLa3X7FgHB.jpg'
---

<div>   
<blockquote><p>编辑导语：在线支付是用户在电子商务软件上常用的功能，其中，当用户对商品或者服务感到不满意时，则可能会发起退款操作。那么，你了解在线支付功能中的退款操作流程吗？本文作者以支付宝为例，分析了退款金额的原路返还流程，一起来看一下。</p></blockquote>
<p><img data-action="zoom" class="size-full wp-image-4719347 aligncenter" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/6DyQ13DPpiCLa3X7FgHB.jpg" alt width="900" height="420" referrerpolicy="no-referrer"></p>
<p>买卖双方在互联网上的电子商务网站进行交易时，大多数情况下都会使用在线支付功能，常见的在线支付方式有支付宝、微信支付、Apple支付等等，那么我们一起归纳一下。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/FCcksHkKBJKegoIces1f.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="591" height="192" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图1：在线支付方式</p>
<p>当买卖成功后，不管是买家原因或卖家原因，可能会需要退款操作。现在以常规电商平台为例，使用支付宝作为支付方式，来介绍本文重点内容：退款金额是如何原路退还的。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/IqsHwzbP7jC1V462cOyg.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="596" height="79" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图2：退款节点</p>
<p>通过图2可以发现，用户可以在订单状态为待发货、待收货、交易成功时，均可以发起退款操作。</p>
<p><strong>待发货：</strong>商品还未发出，用户可能因为未使用优惠券或拍错了等原因发起退款。</p>
<p><strong>待收货：</strong>用户收到商品，发现商品有瑕疵等商家原因，就不确认收货。这时候状态还是处于待收货中，用户可发起退款。</p>
<p>例子：用户买了一箱苹果，发现里面有一半的苹果已经坏了，这时候用户跟商家协商要退回一半的钱。</p>
<p><strong>交易成功：</strong>用户确认收货后，在一定时间内依旧可发起退款。</p>
<p>例子：用户买了一件衣服，手快点了确认收货，但是发现衣服线头比较多，不过呢还是很喜欢，又不想换货。于是就和商家沟通，按需退回一些钱补偿自己，不然就给差评。</p>
<p>上述场景，商家收到用户退款申请，审核无误，点击同意退款后，按照退款规则将支付款原路退到用户的支付宝帐号上。</p>
<p><img data-action="zoom" class=" aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/vBLplYcLDwrUDkklP50i.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="591" height="292" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">余额方式</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/XkYtM6Y7HCzBxKPv8te5.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="591" height="282" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">余额宝方式</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/X31VP0rdjlQws2NNV9VT.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="595" height="287" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">花呗方式</p>
<p>很多小伙伴就会疑问：为什么我用余额支付就退还到余额，用余额宝支付就退还到余额宝？接下来我们一步一步解密这过程。</p>
<h2 id="toc-1">一、用户付款</h2>
<p>用户的常规的下单、支付流程：</p>
<ol>
<li>在APP中选择商品下单、确认购买，进入支付环节，用户点击确认支付；</li>
<li>进入到支付宝页面，调起支付宝支付，出现确认支付界面；</li>
<li>确认收款方和金额，点击立即支付后出现输入密码界面或者指纹识别等操作；</li>
<li>输入正确密码等操作后，支付宝端显示支付结果；</li>
<li>自动回跳到APP中，技术人员根据付款结果个性化展示订单处理结果。</li>
</ol>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/weZF4kCLciln47kEzFCd.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="596" height="436" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图3：支付流程</p>
<p>最终支付成功后，支付宝会生成一条支付信息，记录商家和支付宝平台的交易数据。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/AqxIStM1BQpVDPeDUAMC.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="286" height="466" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图4：支付宝账单详情</p>
<p>图4账单详情包含了以下主要字段：</p>
<ul>
<li><strong>付款方式</strong>：账户余额、花呗、银行卡等，优先展示支付顺序排第一的支付方式；</li>
<li><strong>商品说明</strong>：平台可自定义文案，当做参数传给支付宝；</li>
<li><strong>创建时间</strong>：订单支付成功的时间；</li>
<li><strong>订单号</strong>：订单支付成功后，生成支付流水号；</li>
<li><strong>商家订单号</strong>：也叫支付编号，平台按照规则，退款时当做参数传给支付宝。</li>
</ul>
<h2 id="toc-2">二、退款操作</h2>
<p>当用户因为在上述三种节点下发起退款操作，商家在后台确认售后信息无误，并同意用户退款申请后，通常在一定时间内将退款金额原路返还到用户账号上。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/x4eTh7obYafJNcasjLrJ.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="597" height="100" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图5：商家退款操作</p>
<p><strong>到账时间</strong></p>
<ul>
<li>退回支付宝余额：资金是实时到账；</li>
<li>退回到银行卡：一般3-7天入账；</li>
<li>退回余额宝：资金实时入账。</li>
</ul>
<h2 id="toc-3">三、技术层面上：如何实现退款金额原路退还</h2>
<p>当商家点击“同意退款”的时候，如果订单是用支付宝付款，就会选择触发支付宝退款接口API，按照官方退款文档说明选择上传3个参数，如下所示：</p>
<ul>
<li><strong>out_trade_no</strong>：图4：支付宝账单详情中的商家订单号，由平台自定义生成；</li>
<li><strong>refund_amount</strong>：需要退款的金额，该金额不能大于订单金额,单位为元，支持两位小数；</li>
<li><strong>out_request_no</strong>：用来标记是全部退款或部分退款；这里提个建议：不管用户在终端选择的是全部退款、还是部分退款，默认最好都是传入部分退款的标识。</li>
</ul>
<p>当然这里只上传了3个必要参数就满足我这边项目场景，而你们想要上传多少个参数，就要结合实际情况来定。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/liDJccMtC22M3ndJzspC.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="596" height="674" referrerpolicy="no-referrer"></p>
<p style="text-align: center;">图6：退款流程</p>
<p>大致背后代码逻辑是这样的：</p>
<p>1）付款成功的时候，平台会生成商户订单号（支付编号），然后传给支付宝的支付接口，进行保存，将商户订单号和交易号进行绑定关联。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/y21ClJctJ3uvNtWYDZeF.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="593" height="244" referrerpolicy="no-referrer"></p>
<p>2）当时商家同意退款时，传入商户订单号等必要参数给支付宝的退款接口，然后通过商户订单号找到交易号，再通过交易号查询到当前退款订单的数据，比如实付金额、支付时间、支付方式、用户信息等数据。</p>
<p>3）根据所要退款的金额，通过各种异常情况的校验，最终完成金额原路返还。</p>
<p><img data-action="zoom" class="rich_pages aligncenter" title="一文解密交易金额退款时，资金如何原路退还？" src="https://cors.zfour.workers.dev/?http://image.woshipm.com/wp-files/2021/06/BLXRgWbD342NK47VfkjC.png" alt="一文解密交易金额退款时，资金如何原路退还？" width="595" height="417" referrerpolicy="no-referrer"></p>
<p>常见的异常情况有以下几种情况：</p>
<ul>
<li><strong>卖家余额不足</strong>：商户支付宝账户充值后重新发起退款即可；</li>
<li><strong>交易已完结</strong>：该交易已完结（已超过退款期限），不允许进行退款（即使重试也无法成功），建议联系买家进行线下退款处理；</li>
<li><strong>买家状态异常</strong>：联系支付宝小二确认买家状态异常原因，或者可联系买家进行线下退款处理；</li>
<li><strong>退款金额超限</strong>：请检查退款金额是否正确，请求的退款金额不能大于交易总金额；如果不是全额退款，退款请求号必填，请检查是否传入了退款请求号。</li>
</ul>
<p>实际上支付宝退款文档提供的异常情况比较多，大家可以通过接口文档自行查看（https://opendocs.alipay.com/apis/api_1/alipay.trade.refund）。针对不同异常情况，要做好各种异常提示以告知商家，有些情节严重可以考虑生成工单进行处理。</p>
<p>看似简单的功能，其实背后做了大量的操作。支付宝支付方式，退款金额原路返还流程大致是这样的，是不是奇怪的技术知识又增加了？</p>
<p>同样的微信支付方式，也差不多是这样的逻辑，这里提供一个退款接口（https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_4），供大家课外阅读。。</p>
<p>最后，感谢大家阅读！</p>
<h3>#专栏作家#</h3>
<p>道三，微信公众号：产品大秘籍，人人都是产品经理专栏作家。以前写过代码，现在产品圈摸爬滚打，专注于电商领域产品设计、主要分享电商和供应链领域知识点。</p>
<p>本文原创发布于人人都是产品经理，未经作者许可，禁止转载。</p>
<p>题图来自Unsplash，基于CC0协议。</p>
<div class="support-author"><div class="support-title">给作者打赏，鼓励TA抓紧创作！</div><button class="button--pay" data-post-id="4716524" data-author="705970" data-avatar="https://static.woshipm.com/TTW_USER_202011_20201102145118_7292.png"><svg width="13" height="16" class="svgIcon--use" viewBox="0 0 13 16"><path d="M9.113,4.571 C9.951,3.771 10.895,2.742 10.685,2.057 C10.475,1.485 10.056,0.799 9.427,0.571 C8.903,0.342 8.379,0.456 7.750,0.799 C7.540,0.342 7.016,0.114 6.596,-0.001 C5.863,-0.001 5.234,0.228 4.814,0.914 C4.080,0.571 3.451,0.685 2.927,1.028 C2.613,1.256 2.298,1.713 2.298,2.628 C2.298,3.542 3.137,4.228 3.766,4.685 C2.508,5.599 -0.218,7.885 -0.008,12.228 C-0.218,15.656 2.613,15.999 2.613,15.999 L10.371,15.999 C11.314,15.885 12.991,14.971 12.991,12.571 L12.991,12.228 C13.201,7.771 10.371,5.371 9.113,4.571 L9.113,4.571 ZM8.932,11.835 L6.940,11.835 L6.940,13.207 C6.940,13.435 6.731,13.549 6.521,13.549 C6.311,13.549 6.102,13.435 6.102,13.207 L6.102,11.835 L4.110,11.835 C3.900,11.835 3.795,11.606 3.795,11.378 C3.795,11.149 3.900,10.921 4.110,10.921 L6.102,10.921 L6.102,10.121 L4.949,10.121 C4.739,10.121 4.634,9.892 4.634,9.664 C4.634,9.435 4.739,9.206 4.949,9.206 L5.892,9.206 L4.739,7.950 C4.634,7.835 4.739,7.606 4.949,7.492 C5.158,7.378 5.368,7.264 5.473,7.378 L6.521,8.635 L7.674,7.264 C7.779,7.149 7.989,7.264 8.198,7.378 C8.408,7.492 8.408,7.721 8.408,7.835 L7.150,9.321 L8.094,9.321 C8.303,9.321 8.408,9.549 8.408,9.778 C8.408,10.007 8.303,10.235 8.094,10.235 L6.940,10.235 L6.940,11.035 L8.932,11.035 C9.142,11.035 9.247,11.264 9.247,11.493 C9.247,11.606 9.037,11.835 8.932,11.835 L8.932,11.835 Z"/></svg>
赞赏</button></div>                      
</div>
            