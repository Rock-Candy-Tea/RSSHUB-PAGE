
---
title: '用Excel做回归分析'
categories: 
 - 新媒体
 - 鸟哥笔记
 - 首页
headimg: 'https://qnssl.niaogebiji.com/301693339604cc84ded2f86.46744162.png'
author: 鸟哥笔记
comments: false
date: Wed, 28 Jul 2021 09:51:25 GMT
thumbnail: 'https://qnssl.niaogebiji.com/301693339604cc84ded2f86.46744162.png'
---

<div>   
<div style="height: 6px"></div>
                        <p><strong>Excel数据分析工具库是个很强大的工具，可以满足基本的统计分析，这里介绍用Excel数据分析工具库中的回归做回归分析。</strong></p><p><strong><br></strong></p><p><strong>本节知识点：</strong></p><p><br></p><p>Excel数据分析工具库—回归</p><p><br></p><p>线性回归和非线性回归</p><p><br></p><p>简单线性回归和多重线性回归</p><p><br></p><p>逻辑斯蒂回归</p><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">一、什么是回归分析（Regression）</h2><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">1、定义</h2><p>确定两种或两种以上变量间相关关系的一种统计分析方法。通过数据间相关性分析的研究，进一步建立自变量(i=1,2,3,…)与因变量Y之间的回归函数关系，即回归分析模型，从而预测数据的发展趋势。</p><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">2、分类</h2><p>按照涉及的变量的多少，分为一元回归和多元回归分析；</p><p><br></p><p>按照因变量的多少，可分为简单回归分析和多重回归分析；</p><p><br></p><p>按照自变量和因变量之间的关系类型，可分为线性回归分析和非线性回归分析。</p><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">二、线性回归</h1><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">1、简单线性回归</h2><p>简单线性回归又叫一元线性回归，即回归模型中只有一个自变量和一个因变量，其回归方程可以表示为：</p><p style="text-align: center;"></p><p style="text-align: center;">Y=a+bx+<img src="https://qnssl.niaogebiji.com/301693339604cc84ded2f86.46744162.png" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" referrerpolicy="no-referrer"></p><p><br></p><p>其中，Y表示因变量，x表示自变量，a是 常数，b是斜率，<img src="https://qnssl.niaogebiji.com/301693339604cc84ded2f86.46744162.png" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" referrerpolicy="no-referrer">是随机误差。</p><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">2、最小二乘法：</h2><p>如何确定参数a和b,则要用最小二乘法来实现。通过最小化误差的平方和寻找数据的最佳函数匹配，即使得观测点和估计点的距离的平方和最小。</p><p> </p><p>3、线性回归分析的步骤：</p><p><br></p><p>确定自变量和因变量</p><p><br></p><p>绘制散点图，确定回归模型类型</p><p><br></p><p>估计模型参数，建立回归模型：最小二乘法进行模型参数估计</p><p><br></p><p>对回归模型进行检验</p><p><br></p><p>利用回归模型进行预测</p><h2 label="二级标题" style="background-image: url("/img/article/h2_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 18px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">4、多重线性回归</h2><p>定义：一个因变量与多个自变量的线性回归问题，是一元线性回归的推广。其回归方程可以写为：</p><p><br></p><p style="text-align:center;"><img src="https://qnssl.niaogebiji.com/237444894604cc84e657b63.56404674.png" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" referrerpolicy="no-referrer"></p><p> <br></p><p>多重线性回归方程中回归系数的估计也是用到最小二乘法</p><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">三、用Excel做回归分析</h1><p>我们研究销售额Y和推广费用X1之间的关系，数据如下：</p><p><br></p><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/2046176090604cc84eecffe6.11605415.jpeg" width="500" height="335" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 500px; height: auto;" referrerpolicy="no-referrer"></p><p><br></p><p>首先我们用数据分析—相关系数分析计算一下自变量和因变量之间的相关系数为0.95157，为强相关。<br></p><p><br></p><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/1127872980604cc84f6f57a8.60977731.png" width="400" height="114" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 400px; height: auto;" referrerpolicy="no-referrer"></p><p><br></p><p>绘制散点图如下：</p><p><br></p><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/1812781215604cc84fcc59e8.77082838.png" width="600" height="361" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p><br></p><p>然后，我们用数据分析库里的回归来做分析</p><p><br></p><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/2097482733604cc8505e10e2.28004985.png" width="600" height="320" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p><br></p><p>注意Y值和X值输入区域，X值是自变量，Y是因变量。</p><p><br></p><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/810622402604cc850efd8e4.36890704.jpeg" width="600" height="352" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">四、线性回归方程的检验<br></h1><p><strong>评价回归拟合程度好坏（重要）：</strong></p><p><strong><br></strong></p><p style="text-align:center;"><img src="https://qnssl.niaogebiji.com/1480847830604cc851934b13.68051185.jpeg" width="500" height="296" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" alt="鸟哥笔记,数据运营,虾壳可乐,策略,Excel,数据分析,线性回归,策略,数据分析" style="width: 500px; height: auto;" referrerpolicy="no-referrer"></p><p><br></p><p>1、先看回归统计表，Multiple R即相关系数R的值，和我们之前做相关分析得到的值一样，大于0.8表示强正相关。</p><p><br></p><p>2、回归统计表中的R Square是R平方值，R平方即R的平方，又可以叫判定系数、拟合优度，取值范围是[0,1],R平方值越大，表示模型拟合的越好。一般大于70%就算拟合的不错，60%以下的就需要修正模型了。这个案例里R平方0.9054，相当不错。</p><p><br></p><p>3、Adjusted R是调整后的R方，这个值是用来修正因自变量个数增加而导致模型拟合效果过高的情况，多用于衡量多重线性回归。</p><p><br></p><p>4、第二张表，方差分析表，df是自由度，SS是平方和，MS是均方，F是F统计量，Significance F是回归方程总体的显著性检验，其中我们主要关注F检验的结果，即Significance F值，F检验主要是检验因变量与自变量之间的线性关系是否显著，用线性模型来描述他们之间的关系是否恰当，越小越显著。这个案例里F值很小，说明因变量与自变量之间显著。</p><p><br></p><p>5、残差是实际值与预测值之间的差，残差图用于回归诊断，回归模型在理想条件下的残差图是服从正态分布的。</p><p><br></p><p>6、第三张表我们重点关注P-value，也就是P值，用来检验回归方程系数的显著性，又叫T检验，T检验看P值，是在显著性水平α（常用取值0.01或0.05）下F的临界值，一般以此来衡量检验结果是否具有显著性，如果P值>0.05，则结果不具有显著的统计学意义，如果0.01<P值<0.05，则结果具有显著的统计学意义，如果P<=0.01，则结果具有极其显著的统计学意义。T检验是看某一个自变量对于因变量的线性显著性，如果该自变量不显著，则可以从模型中剔除。</p><p><br></p><p>7、从第三张表的第一列我们可以得到这个回归模型的方程：y=4361.486+1.198017x，此后对于每一个输入的自变量x,都可以根据这个回归方程来预测出因变量Y。</p><p> </p><p><strong>这里简单总结了一下什么是回归分析，如何用excel做线性回归分析，以及如何评价回归方程拟合程度的好坏。入门很简单，精通还很遥远，我们都在学习中。</strong><br></p><p label="图片描述" style="font-size: 12px; color: rgb(129, 131, 134); text-align: center; font-weight: 300; line-height: 30px; margin-bottom: 25px;">-END-<br></p>                        <div style="height: 1px"></div>
                      
</div>
            