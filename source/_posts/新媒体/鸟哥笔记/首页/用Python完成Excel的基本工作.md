
---
title: '用Python完成Excel的基本工作'
categories: 
 - 新媒体
 - 鸟哥笔记
 - 首页
headimg: 'https://qnssl.niaogebiji.com/31665207660b6fb256542b3.09647403.png'
author: 鸟哥笔记
comments: false
date: Wed, 02 Jun 2021 03:40:01 GMT
thumbnail: 'https://qnssl.niaogebiji.com/31665207660b6fb256542b3.09647403.png'
---

<div>   
<div style="height: 6px"></div>
                        <p>因为对Python的很多数据分析语句不是很熟练，所以日常在数据清洗分析的时候会优先Excel操作，Excel实在做不了再用Python。这也导致我对Python的用法经历了边用边学，学完就忘的尴尬经历。本文将Excel数据清洗处理的需求和Python的实现一一对应起来，从而让自己也能轻车熟路地用Python做数据清洗以及分析。<br></p><section data-role="outer" label="Powered by 135editor.com"><section data-role="paragraph" data-width="95%"><section><section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title>1</span>数据获取</h1></section></section></section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 打开Excel文件,读取第一个sheet</strong></h3><p>import pandas as pd import numpy as nppd.read_excel("XXXX.xlsx") </p><p>#如果是多个sheet，默认读取第一个sheet</p><section><section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>2. 打开Excel文件，读取多个sheet</strong></h3><p>DataFrame= pd.read_excel("XXXX.xlsx",sheet_name=None)DataFrame[sheet_name] </p><p>#获取sheet_name对应sheet的数据</p><p><br></p></section></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/31665207660b6fb256542b3.09647403.png" class="article_img" width="600" height="199" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>3. 查询数据有几行几列，有哪些字段</strong></h3><p>读入数据后，一般会先看下数据有多大，有哪些数据。</p><p><br></p><p>DataFrame.shape</p><p> #输出这个表格有行数和列数DataFrame.columns #查询表格的列名</p><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">4. 查看数据的样例</h3><section><p>DataFrame.head() #查看数据的前五行DataFrame.sample(n, replace=False, radom_state =1) </p><p>#不放回地随机抽样n行</p></section><section data-tools="135编辑器" data-id="99882"><section hm_fix="411:492"><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title data-num="2">2</span>数据预处理</h1></section></section></section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 统计下各行各列是否有空值，及空值占比</strong></h3><p>DataFrame.isnull().sum(axis=0) </p><p>#统计每列空值数量</p><p><br></p><p>DataFrame.isnull().sum(axis=1) </p><p>#统计每行空值数量</p><section><p><br></p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/130571923560b6fb25df6da1.33614429.png" class="article_img" width="600" height="363" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>2. 删除空值行或者空值列</strong></h3><p>DataFrame[~DataFrame[col].isnull()]  </p><p>#删除col列为空的行</p><p><br></p><p>DataFrame.dropna(axis=0) </p><p>#删除有空值的行,使用参数</p><p><br></p><p>axis=0DataFrame.dropna(axis=1) </p><p>#删除有空值的列,使用参数</p><p><br></p><p>axis=1DataFrame.dropna(how='all',axis=0) </p><p>#删除所有值都为空值的行</p><p><br></p><p>DataFrame.dropna(how='all',axis=1) </p><p>#删除所有值都为空值的列</p><p><br></p><p>DataFrame.dropna(subset=[col1,col2]) </p><p>#删除 col1或者col2列有空值的行</p><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>3. 统计是否存在重复数据</strong></h3><p>DataFrame.duplicated().value_counts() </p><p>#统计所有列重复的行数</p><p><br></p><p>DataFrame[[col1,col2]].duplicated().value_counts() </p><p>#统计指定列有重复的行数</p><p><br></p><p>DataFrame.drop_duplicates() </p><p>#删除所有列重复的行</p><p><br></p><p>DataFrame.drop_duplicates(subset = [col1,col2]) </p><p>#删除指定两列重复的行</p><section><p><br></p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/85772544460b6fb264df7a2.09247163.png" class="article_img" width="600" height="234" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>4. 按某字段排序</strong></h3><p>DataFrame.sort_values(by=col1,ascending=False) </p><p>#按col1列升序排列</p><p><br></p><p>DataFrame.sort_values(by=[col1,col2],ascending=(True,False))</p><p>#按col1列升序，col2列降序</p><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>5. 对某数值列调整数据格式</strong></h3><p>Excel中我们经常需要将数值设置成百分百或者保留两位小数等。现在看看Python怎么做：</p><p><br></p><p>'&#123;:.2%&#125;'.format(x) </p><p>#转换为两位小数的百分百</p><p><br></p><p>round(x,2) </p><p>#转化为小数，保留2位小数</p><section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title data-num="3">3</span>数据选择</h1></section></section></section><p>数据处理最基本的需求就是筛选出指定行列。Python基本的筛选方式有三种：</p><p><br></p><section data-role="list"><section data-role="list"><p>1、DataFrame.loc #根据行的指标和列的列名来选择</p><p><br></p><p>2、DataFrame.iloc #根据行列的序列来选，如第2行、第4列</p><p><br></p><p>3、DataFrame.ix #上面两种方法的混合，即可用行列名，也可用序列</p><p><br></p></section></section><p>具体用法可看下面的示例：</p><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/147706444460b6fb26cf8d67.30093570.png" class="article_img" width="600" height="332" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><p><br></p><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 筛选出满足某种条件的数据</strong></h3><p><br></p><p>某列等于某值的行</p><p>DataFrame.loc[DataFrame[col]=='F'] </p><p># 选出col列等于F的行</p><p><br></p><p>DataFrame.loc[DataFrame[col].isin(['E', 'F']) </p><p># 选出col列等于E或者F的行</p><section><p><br></p></section><p>某列包含某个字段的行<br></p>DataFrame.loc[DataFrame[col].str.contains(X)] # 选出col列含有X字符串的行<section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title data-num="4">4</span>数据操作运算</h1></section></section></section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 多列数值列做函数计算</strong></h3><p>Excel常用的场景之一就是：对不同行或不同列做加减乘除计算等；这个非常简单只需拿出对应的行或列计算即可。</p><p><br></p><p>df1['a']+df1['b'] </p><p>#a列和b列相加，同理可换其他运算</p><p><br></p><p>df1.loc[0] +df1.loc[1] </p><p>#0行和1行相加，同理可换其他运算</p><section><p><br></p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/202382949860b6fb276a94d7.17439523.png" class="article_img" width="600" height="326" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>2. 某数值列做函数变换</strong></h3><p>还有一个场景是，我们需要对某列做函数变换，如提取出某部分字符串，计算字符串长度，字符串倒序等等。这种情况，需要用到apply函数，</p>DataFrame[col].apply(func,axis=0) #把func函数作用到col列<br><section><ul class=" list-paddingleft-2"><li><p><br></p></li></ul></section><p>这里的func可以用python已有的函数，也可以用lambda自定义。</p><p><br></p><section><p>DataFrame[col].apply(lambda x:x.func) #用lambda自定义函数作用于col列</p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/155576545160b6fb27e97ad2.91101240.jpeg" class="article_img" width="600" height="128" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;">0<span data-original-title title data-num="5">5</span>数据分组／数据透视表</h1></section></section></section><p>在Excel里数据透视表是非常有用且常用的一个功能，他可以实现各种分组统计计算。Python里有三种函数，作用和Excel透视表一致。</p><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 统计某列的数值分布</strong></h3><section><p>DataFrame[col].value_counts() #统计col列的数量分布</p></section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>2. 某列分组后对其他列进行数值运算</strong></h3><section><p>DataFrame.groupby(col1)[col2].count() </p><p>#对col1列分组，统计col2列的数量</p><p><br></p><p>DataFrame.groupby(col1)[col2].mean()  </p><p>#对col1列分组，统计col2列的均值</p><p><br></p><p>DataFrame.groupby(col1)[col2].sum()   </p><p>#对col1列分组，统计col2列的和</p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/99982373460b6fb28595dd2.65335837.png" class="article_img" width="600" height="333" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>3. 数据透视表的替代</strong></h3><section><p>pd.pivot_table(DataFrame,values=[col1],index=[col2], columns=[col3],aggfunc=(np.size,np.mean,np.sum))</p><p><br></p><p>这里的index相当于透视表里的行，columns相当于透视表里的列，value表示透视表里计算的值，aggfunc表示作用于value的函数。</p></section><figure data-size="normal" style="text-align: center;"><img src="https://qnssl.niaogebiji.com/4071846760b6fb28d1a390.56374892.png" class="article_img" width="600" height="282" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></figure><section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title data-num="6">6</span>多表拼接</h1></section></section></section><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>1. 多个表格上下拼接或左右拼接</strong></h3>pd.concat([DataFrame1.DataFrame2],axis=0) #axis为0是上下连接，1是左右连接<figure data-size="normal"><img src="https://qnssl.niaogebiji.com/48787130160b6fb293be6d4.82042751.jpeg" class="article_img" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" referrerpolicy="no-referrer"></figure><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px;"><strong>2. VLOOKUP</strong></h3><p>Python里的merge函数可以实现同样的作用。</p><p><br></p><p>当两个表的关联列名一样的时候：</p><section><p>DataFrame1.merge(DataFrame12,on=[col1,col2],how=’left/right/inner/outer’)</p><p><br></p></section><p>当两个表的关联列名不一样的时候：</p><section><p>DataFrame1.merge(DataFrame12,left_on=col1,right_on=col2,how=’left/right/inner/outer’)</p><p><br></p></section><p style="text-align: center;"><img src="https://qnssl.niaogebiji.com/40856402060b6fb29a014b5.57285297.jpeg" class="article_img" width="600" height="142" border="0" vspace="0" title="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" alt="鸟哥笔记,数据运营,须臾即永恒,Python,Excel,数据分析,数据清洗" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section><section data-tools="135编辑器" data-id="99882"><section><section><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; background-position: 0px 5px; background-repeat: no-repeat; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; text-align: center;">0<span data-original-title title data-num="7">7</span>数据导出</h1></section></section></section><p>数据导出和导入很类似，具体用法如下：</p><p><br></p><section><p>df1.to_csv('XXXX.csv') </p><p>#将df1导出为csv文件，文件名为XXXXdf1.to_excel('XXXX.xlsx')  </p><p>#将df1导出为xlsx文件，文件名为XXXX</p><p><br></p></section><p>以上就是我要分享的内容，想要熟练掌握用Python做数据分析，上述的语句一定要多用多练。如果需要截图中的代码，可私信我「python代码」，感谢大家阅读～</p><section data-tools="135编辑器" data-id="102192"><section><section hm_fix="392:455"><p label="图片描述" style="font-size: 12px; color: rgb(129, 131, 134); text-align: center; font-weight: 300; line-height: 30px; margin-bottom: 25px;">-END-</p></section></section></section></section></section></section></section>                        <div style="height: 1px"></div>
                      
</div>
            