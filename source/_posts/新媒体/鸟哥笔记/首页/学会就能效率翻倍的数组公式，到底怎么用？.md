
---
title: '学会就能效率翻倍的数组公式，到底怎么用？'
categories: 
 - 新媒体
 - 鸟哥笔记
 - 首页
headimg: 'https://qnssl.niaogebiji.com/1324084018607cee819230e3.35308455.png'
author: 鸟哥笔记
comments: false
date: Mon, 19 Apr 2021 03:16:12 GMT
thumbnail: 'https://qnssl.niaogebiji.com/1324084018607cee819230e3.35308455.png'
---

<div>   
<div style="height: 6px"></div>
                        <p></p><section data-mpa-powered-by="yiban.io"><mpprofile data-pluginname="mpprofile" data-id="MzI3NjA5MzA4NQ==" data-headimg="http://mmbiz.qpic.cn/mmbiz_png/tshfkGY4QClPQZu6ibp3N1S4EcTaE06xcdQcKRFegIccOQRAhexAM3uqoNLlLhofSoVux1VAmSg5Yu29VQa1Jiaw/0?wx_fmt=png" data-nickname="可乐的数据分析之路" data-alias="the_way_of_data_cola" data-signature="分享数据分析 | 可视化 | python | Excel | SQL | 数据思维的文章，以及生活中的数据分析案例"></mpprofile></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">你好，我是可乐</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">Excel的数组公式很好用，能解决很多普通公式解决不了的问题，因此这篇文章就来聊聊数组公式，也是填上篇文章的坑</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;"><a href="https://www.niaogebiji.com/article-70118-1.html" target="_self">《Excel里关于if的9个函数》</a></p><p></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">01 什么是数组公式</h1></section></section></section></section></section><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">在研究数组公式前，先要明确什么是<strong>数组</strong>？</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">数组嘛，可以理解为若干相同数据的组合</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">比如&#123;1,2,3,4&#125;是数值组合在一起，&#123;“c”;“o”;“l”;“a”&#125;是字符的组合，这种只有1行的数组是<strong>横向数组</strong>，1列的是<strong>垂直</strong>的数组，他们是<strong>一维数组</strong>。多行多列的是<strong>二维数组</strong>。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1324084018607cee819230e3.35308455.png" width="600" height="128" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">那什么是数组公式呢？</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">Excel里会看到<strong>带大括号的公式&#123;&#125;</strong>，就是数组公式，但这个大括号不是手动加上去的，而是输入公式后同时按下ctrl+shift+enter后自动带的。比如下图将数组1和数组2相加。<br></p><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1436973812607cee82194715.48603458.gif" width="600" height="227" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">02 数组公式的计算</h1></section></section></section></section></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">理解并且创建了数组以后，要思考如何计算数组，数组公式当然也就是计算数组的公式。</p><p></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">举个例子：</p></h2></section></section></section><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">比如要求总销售额，等于单价乘以销售数量，求一个产品的销售额，=C2*D2</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">如果要求很多产品的销售额，当然，可以直接把公式往下拖，但我们也可以换个思路，就是用数组公式。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">选择F2:F11区域，输入=C2:C11*D2:D11，然后<strong>同时按下ctrl+shift+enter键</strong></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1507453051607cee82af42c7.15405009.png" width="600" height="260" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">这里，用数组公式的好处是：</p><p></p><ul class=" list-paddingleft-2"><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">假如数据量很多，可以避免使用普通公式拖动的情况</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">文件小，数组公式只有一个公式，F2和F11都是一个公式，但普通公式从F2到F11拥有10个不同的公式，如C2<em>D2，C11</em>D11</p></li></ul><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">另外，数组公式求总计和用sumproduct公式是一个原理，但和sum就很不一样了，比用sum方便许多。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1319040891607cee83238164.58209436.png" width="600" height="445" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">通过上面的栗子，我们知道了数组计算的过程：</p><p></p><ol class=" list-paddingleft-2"><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">首先要选定区域</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">然后输入公式</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">最后同时按下ctrl+shift+enter键</p></li></ol><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">我们可以再系统地理解一下数组的计算</p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">2.1 数组和单值的计算</h3></section></section><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">对数组1&#123;1,2,3,4&#125;乘以2，是对数组中的每个元素都乘以2，首先选中A5:D5区域，然后输入=A2:D2*2 ，同时按下ctrl+shift+enter键完成数组运算，结果如图得到&#123;2,4,6,8&#125;</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/937025124607cee839bc419.41623815.png" width="600" height="287" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">2.2 一维数组间的计算</h3></section></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">第一小节说，数组有一维和二维之分，并且还有方向的区别。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">-> 同方向一维数组的计算</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">两个横向的一维数组的计算，就是元素对应相加即可。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">数组1+数组2，选中A8:D8区域，输入=A2:D2+A5:D5，同时按下ctrl+shift+enter键完成数组运算，结果如图得到&#123;6,8,10,12&#125;</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1438434957607cee84437c49.30566973.png" width="600" height="363" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">元素不对应怎么办？</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">如下图，数组1是4个元素，数组2是5个元素，数组1缺了一个元素和数组2的9相加，如果还硬要选择A11:E11区域的话，系统就只能用<strong>缺失值代替</strong>了。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/986557487607cee84a06153.14310608.png" width="600" height="327" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">-> 不同方向的一维数组的计算</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;"><strong>一个横向的X列一维数组和一个垂直的Y行一维数组计算的结果是，一个X列Y行的二维数组。</strong></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">比如数组3是含有4个元素4列，数组4是含有3个元素的3行，他们相加，结果是一个3行4列的二维数组。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">其中的原理是这样的，数组3可以看成3行4列的一个二维数组，数组4也可以看成是一个3行4列的二维数组，将其中的元素一一对应相加就得到了数组3数组4的结果。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1832226658607cee856d0017.78305285.png" width="600" height="266" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">2.3 一维数组和二维数组的计算</h3></section></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">一个一维数组和一个二维数组计算</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">有了2.2的不同方向的一维数组计算的原理，我们其实明白了，数组间的计算首先还是要把它们调到同一个频道上，比如数组4和数组5相加，可以把数组4看成是一个3行2列的二维数组再和同纬度的数组5相加，就可以一一对应了。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1923180745607cee86332212.49658922.png" width="600" height="266" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">2.4 二维数组间的计算</h3></section></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">二维数组间的计算，就更好理解了，直接两两对应计算即可，对应不上的，就用缺失值填充。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">如数组5和数组6相加</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/593840050607cee86d6cde2.01773040.png" width="600" height="484" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><section data-mid mpa-from-tpl="t"><h1 label="一级标题" style="background-image: url("/img/article/h1_icon.png"); background-size: 16px 20px; margin: 25px 0px 20px; padding-left: 22px; font-size: 20px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">03 数组公式可以解决哪些问题</h1></section></section></section></section></section><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">Excel已经有很多公式了，为什么我们还要学数组公式呢？数组公式可以解决什么问题呢？</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">相比于普通公式，数组公式可以：</p><p></p><ul class=" list-paddingleft-2"><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">快速创建示例数据集</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">对包含错误值的区域进行计算</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">条件计算</p></li></ul><p></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">3.1 创建数据集</h3></section></section><h3 label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">使用逗号分隔各个项，将创建水平数组（一行）。<br></h3><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">选择A1:C1单元格，输入=&#123;1,2,3&#125;，然后同时按下ctrl+shift+enter键，Excel 使用大括号 (&#123; &#125;) 将公式括在选定区域的每个单元格中，得到A1=1，A2=2，A3=3的结果。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/899926841607cee874fbf33.17542931.png" width="600" height="206" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">使用分号分隔项，将创建垂直数组（一列）。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1663492178607cee87c94c39.07890730.png" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">若要创建二维数组，应在每行中使用逗号分隔项，并使用分号分隔每行。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/850512729607cee882dce86.72436237.png" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">3.2 对包含错误值的区域计数</h3></section></section><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">当对包含错误值（例如 #N/A）的区域求和时，SUM 函数不起作用。那么如何对包含错误的区域求和或求平均、计数等一系列数值运算的操作呢？就可以用数组公式。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">如下图单价中包含一个错误值#N/A，直接用average函数是计算不出平均值的，输入=**ERAGE(IF(ISERROR(D2:D11),"",D2:D11))，同时按下ctrl+shift+enter键完成数组运算。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">ISERROR(D2:D11)是判断D2:D11区域有无错误值，有的话返回TRUE，没有返回FALSE</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">IF(ISERROR(D2:D11),"",D2:D11)，IF函数再来判断，有错误值时（也就是为TRUE时）返回一个空值“”，没有错误值（FALSE）时返回自己所在的区域。这样错误值就被空值“”避免了，也就可以计算了。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1343212496607cee88ae4763.93126364.png" width="600" height="348" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><section data-mpa-template="t" mpa-from-tpl="t"><section mpa-from-tpl="t"><h2></h2><h3 label="三级标题" style="background-image: url("/img/article/h3_icon.png"); background-size: 8px 20px; margin: 25px 0px 20px; padding-left: 12px; font-size: 16px; font-weight: 600; color: rgb(33, 38, 41); line-height: 30px; background-position: 0px 5px; background-repeat: no-repeat no-repeat;">3.3 条件计算</h3></section></section><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">比如上节内容里最后提到的用数组公式计算不同条件下数值的标准差。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">输入=STDEV(IF(A:A=D2,B:B,""))，然后ctrl+shift+enter 一起按，这个数组公式的意思是，如果A列的值等于D2单元格，那么值区域就等于D2单元格对应的值，否则就为空，接着对值区域求标准差。如果用dstdev公式还需要自己构建条件区域，数组公式就方便一点。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/1744126815607cee89b2d842.27015643.png" width="600" height="304" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">还可以计算深圳和广州的平均分，输入公式=**ERAGE(IF(A:A=D2,B:B,""))，再同时按下ctrl+shift+enter键，得到的结果和我们用averageif算的是一样的，这个数组公式的意思是，如果D列的值等于D2单元格深圳，那么值区域就是深圳对应的得分，否则就为空，然后再对值区域求平均。</p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px; text-align: center;"><img src="https://qnssl.niaogebiji.com/2035930665607cee8b2495e7.33607414.png" width="600" height="304" border="0" vspace="0" title="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" alt="鸟哥笔记,数据运营,虾壳可乐,Excel,数据分析,数据模型,数据运营" style="width: 600px; height: auto;" referrerpolicy="no-referrer"></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">数组公式有好处，但是也有缺点，比如：</p><p></p><ul class=" list-paddingleft-2"><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">不可更改，单个单元格无法更改，若要更改，需要整体处理，这也可以当成优点，安全！</p></li><li><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">大型数组公式可能会降低计算速度，具体取决于计算机的处理速度和内存。</p></li></ul><p></p><p label="正文" style="font-size: 16px; color: rgb(33, 38, 41); margin-bottom: 25px;">看到这，你学会用数组公式了吗？</p><p label="图片描述" style="font-size: 12px; color: rgb(129, 131, 134); text-align: center; font-weight: 300; line-height: 30px; margin-bottom: 25px;">-END-<br></p><p></p>                        <div style="height: 1px"></div>
                      
</div>
            