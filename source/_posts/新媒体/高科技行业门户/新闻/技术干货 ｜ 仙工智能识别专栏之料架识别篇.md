
---
title: '技术干货 ｜ 仙工智能识别专栏之料架识别篇'
categories: 
 - 新媒体
 - 高科技行业门户
 - 新闻
headimg: 'https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997204483090959.png'
author: 高科技行业门户
comments: false
date: Thu, 30 Sep 2021 10:21:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997204483090959.png'
---

<div>   
<p style="text-indent: 2em; text-align: left;"><strong>一、料架识别的应用场景</strong></p><p style="text-indent: 2em; text-align: left;">为什么要进行料架识别？</p><p style="text-indent: 2em; text-align: left;">因为料架不是一直都能固定摆放在某个位置上。AMR 对货架进行拉取或顶升等操作，需要精准货架位置。地图可准确定位 AMR，却无法定位料架所在位置，所以需要进行料架识别，以确定料架的位置。</p><p style="text-indent: 2em; text-align: left;">料架标准要求：</p><p style="text-indent: 2em; text-align: left;">1、料架四腿需形成一个矩形；</p><p style="text-indent: 2em; text-align: left;">2、料架的其他部分都须成轴对称的形式，包含：和顶升机构配合的限位孔、料架腿上支撑的料架部分；</p><p style="text-indent: 2em; text-align: left;">3、料架内侧宽度须大于<span class="hrefStyle"><a href="https://robot.ofweek.com/" target="_blank" title="机器人">机器人</a></span>最大宽度 20cm，左右各冗余 10cm 的钻料架调整空间；</p><p style="text-indent: 2em; text-align: left;">4、料架高度要求，根据顶升模块的行程确定；</p><p style="text-indent: 2em; text-align: left;"><strong><span style="text-indent: 2em;">二、仙工智能选用的识别方式</span></strong></p><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em;">1、反光贴识别</span></p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997204483090959.png" title="1632997204483090959.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: center;">图示：常用的3M反光贴</p><p style="text-indent: 2em; text-align: left;">作用原理：反光贴是常用的强度高反射材料，反光贴识别主要利用激光接收反光贴的反射率远高于环境中的普通物体，因此可以很容易通过反射率来提取反光贴的具体位置。</p><p style="text-indent: 2em; text-align: left;">使用反光贴方式所需的简单改造：</p><p style="text-indent: 2em; text-align: left;">（1）操作方式：</p><p style="text-indent: 2em; text-align: left;">剪取两小块反光贴贴于 AMR 要钻入的那个侧面的料架腿上。</p><p style="text-indent: 2em; text-align: left;">（2）粘贴要求：</p><p style="text-indent: 2em; text-align: left;">①反光条的中心与 AMR 上安装的激光雷达扫描平面在高度上要对齐</p><p style="text-indent: 2em; text-align: left;">②反光条内侧与料架腿内侧平齐，如下图所示：</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997212543095852.png" title="1632997212543095852.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">使用参数配置说明：</p><p style="text-indent: 2em; text-align: left;">使用 Roboshop Pro 软件，点击【识别文件】标签页进入配置界面，选择一个【shelf】文件，在右侧的属性窗进行货架描述文件的参数配置。如下图所示：</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997225401003575.png" title="1632997225401003575.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997232839012291.png" title="1632997232839012291.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">width： 改造后，钻入方向上两个货架腿的外侧宽度。这里的宽度，是指改造后，两块反光条的最外侧宽度；</p><p style="text-indent: 2em; text-align: left;">length： 垂直于钻入方向的两个货架腿的最外侧宽度；</p><p style="text-indent: 2em; text-align: left;">leg＿width： 反光条宽度，若选用标准 3M 汽车反光贴，即为 0．05（米）；</p><p style="text-indent: 2em; text-align: left;">除了这三个配置参数外，还留有丰富的配置接口，这些接口与使用形状识别是共享的，如钻入的深度（align＿depth）、不同方向识别和钻入（detect＿direction）、考虑货架重心用来调整钻入的偏移量（rec＿off＿x， rec＿off＿y， rec＿off＿angle）等参数。</p><p style="text-indent: 2em; text-align: left;"><span style="text-indent: 2em;">2、使用形状识别：</span></p><h2 style="text-indent: 2em; text-align: left;"><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997242768073855.png" title="1632997242768073855.png" alt="image.png" referrerpolicy="no-referrer"></p></h2><p style="text-indent: 2em; text-align: left;">激光雷达形状识别图示：图中蓝色坐标系为 AMR 的车体坐标系，虚线方形为可配置的激光雷达识别区域，方形中的虚线为激光雷达扫描 scan 的示意图</p><p style="text-indent: 2em; text-align: left;">作用原理：通过激光点云进行形状识别，无需粘贴反光贴。在使用激光雷达形状识别时，需保证待识别的料架腿在激光雷达的识别范围内，识别区域可根据现场环境进行配置。</p><p style="text-indent: 2em; text-align: left;">对料架腿的形状和材料的要求：</p><p style="text-indent: 2em; text-align: left;">（1）料架腿的表面光滑平整；</p><p style="text-indent: 2em; text-align: left;">（2）料架腿的形状为规则的方体；</p><p style="text-indent: 2em; text-align: left;">（3）料架腿的表面不能为：呈镜面反射材料、半透明的材料、黑色的材料。</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997254741075820.png" title="1632997254741075820.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">图示：典型的可用货架腿</p><p style="text-indent: 2em; text-align: left;">使用参数配置说明：</p><p style="text-indent: 2em; text-align: left;">使用 Roboshop Pro 软件，点击【识别文件】标签页进入配置界面，选择一个【shelf】文件，在右侧的属性窗进行货架描述文件的参数配置。如下图所示：</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997280100052650.png" title="1632997280100052650.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997286332060577.png" title="1632997286332060577.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">需要配置如图上所示的 5 数：</p><p style="text-indent: 2em; text-align: left;">1：rightStandardLength，右侧料架腿的长度；</p><p style="text-indent: 2em; text-align: left;">2：rightVerticalLength，右侧料架腿的宽度</p><p style="text-indent: 2em; text-align: left;">3：leftVerticalLength，左侧料架腿的宽度；</p><p style="text-indent: 2em; text-align: left;">4：leftStandardLength，左侧料架腿的长度；</p><p style="text-indent: 2em; text-align: left;">5：distance，料架腿内侧之间的距离；</p><p style="text-indent: 2em; text-align: left;">此外，料架腿长和宽之间的夹角默认为 90°，也可以额外配置，为了保证识别的精度，料架腿的长宽应大于 6cm。</p><p style="text-indent: 2em; text-align: left;"><strong><span style="text-indent: 2em;">三、识别操作使用说明</span></strong></p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997446488067646.png" title="1632997446488067646.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">在完成上述反光膜或者形状识别的配置之后，只需在货架点位对应的前置点属性中配置识别模型文件，即 shelf 文件，然后将线路属性中的 ObsExpansion 设置为 0，避免钻料架过程中机器人停障。接着要进行执行动作的配置：</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997455645078477.png" title="1632997455645078477.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">1．需要识别料架所在位置，并钻入料架顶升起来，需要勾选 Recognize，点击 Load；</p><p style="text-indent: 2em; text-align: left;">2．不需要识别料架所在位置，开环的钻入到一个固定位置上，并顶升起来，不需要勾选Recognize，直接点击 Load；</p><p style="text-indent: 2em; text-align: left;">3．需要识别位置上有没有料架，并放置料架，勾选 Recognize，点击 Unload，若有料架占用的话，会报错；不需要识别，直接开环放置，不用勾选 Recognize，直接点击 Unload；</p><p style="text-indent: 2em; text-align: left;">4．需要点击 Wait 的情况比较少，若勾选了 Recognize，再点击 Wait，机器人就会识别料架位置，钻入料架底部，然后结束任务，不会动作顶升模块；若不勾选 Recognize，直接点击 Wait，机器人就会固定路径导航到工作站，然后结束任务，不会动作顶升。</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997469796057806.png" title="1632997469796057806.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;">那么在执行路径规划的时候选择执行动作，AMR 在这个前置点上会自动切换到识别模式，根据识别到料架腿的位置来推算出料架的中心位置并自动生成到达此位置的路线。</p><p style="text-indent: 2em; text-align: left;"><strong><span style="text-indent: 2em;">四、不同方向识别说明</span></strong></p><p style="text-indent: 2em; text-align: left;">针对车头车尾都安装激光雷达的全向车，可通过配置实现车头、车尾、车左侧和车右侧各个方向的识别，配置如下图所示：</p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997477689087612.png" title="1632997477689087612.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-align:center"><img src="https://cors.zfour.workers.dev/?http://images.ofweek.com/Upload/News/2021-09/30/Sunny/1632997486588029062.png" title="1632997486588029062.png" alt="image.png" referrerpolicy="no-referrer"></p><p style="text-indent: 2em; text-align: left;"><strong>五、其他说明</strong></p><p style="text-indent: 2em; text-align: left;">1、为了减小误识别的情况，使用激光识别料架时要求料架的前面两条腿中心距离和前置识别点的距离小于 2m，中心点到识别位置激光的连线和车体的角度偏差小于 10°，料架本身的角度和识别时的 AMR 的角度偏差小于 20°；</p><p style="text-indent: 2em; text-align: left;">2、使用激光点云形状识别功能，需要将参数配置 method＿type 配置为 by＿legShape，在激光雷达的识别区域要避免遮挡住货架腿；</p><p style="text-indent: 2em; text-align: left;">3、在使用反光贴的方法时，需要将参数配置 method＿type 配置为 by＿reflector，同样要保证不能遮挡料架腿；</p><p style="text-indent: 2em; text-align: left;">4、反光板识别：x，y 方向的精度高于 ±1cm，角度精度高于 1°；</p><p style="text-indent: 2em; text-align: left;">5、形状识别：x，y 方向精度高于 ±1cm，角度精度高于 1°。</p> 
  
</div>
            