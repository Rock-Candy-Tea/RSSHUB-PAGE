
---
title: '怎麽用Excel VBA實現_複製貼上_（上），鑫大叔Excel VBA第一期'
categories: 
 - 新媒体
 - Matters
 - 最新、熱議、精華
headimg: 'https://assets.matters.news/embed/f6fb1f82-0a21-4c57-8151-4cf830a4b62d.png'
author: Matters
comments: false
date: Fri, 08 Oct 2021 18:12:06 GMT
thumbnail: 'https://assets.matters.news/embed/f6fb1f82-0a21-4c57-8151-4cf830a4b62d.png'
---

<div>   
<p>第一期内容按<a class="mention" href="https://matters.news/@knb190322" target="_blank" data-display-name="小本" data-user-name="knb190322" data-id="VXNlcjoyODEyNw">﻿<span>@小本</span>﻿</a> 要求，講解怎麽用VBA從A分頁自動複製貼上到B分頁。原本沒打算分上下集，但是第一期總要説明下VBA是什麽，使用起來有哪些要注意的，編程環境雖然不複雜也還是得提一下。是以只能分成上下了~</p><hr><hr><h2>🔷<strong> 介紹 </strong>🔷</h2><p>❇️ <strong>VBA是什麽：</strong>一種主要用於Microsoft Office的編程語言，原名是Visual Basic for Application。這裏主要討論如何在Excel執行和編輯VBA。</p><p>❇️ <strong>Excel VBA能做什麽：</strong>實現自動化/半自動化，把原本你需要自己一步一脚印用滑鼠和鍵盤做的東西，變成點擊一個按鈕就能搞定。能寄電郵、整理資料、生成網頁，大部分重複性強的操作。</p><p>❇️ <strong>適用人群：</strong>工作經常使用Excel，<strong>缺乏編程背景</strong>但想要加快工作效率的人。</p><hr><hr><h2>🔷<strong> 編程界面和試著運行一個巨集 </strong>🔷</h2><p><strong>❇️ 第一步，開啓編輯器：</strong>打開Excel後，按快速鍵（Alt + F11）開啓VB編輯器（編輯和執行VBA程式碼的地方）。</p><figure class="image"><img src="https://assets.matters.news/embed/f6fb1f82-0a21-4c57-8151-4cf830a4b62d.png" data-asset-id="f6fb1f82-0a21-4c57-8151-4cf830a4b62d" referrerpolicy="no-referrer"><figcaption><span>VB編輯器，編輯和運行VBA程式碼的地方</span></figcaption></figure><hr><hr><p><strong>❇️ 第二步，插入模組（Module）：</strong>滑鼠右鍵鍵點擊<strong>“Microsoft Excel Objects”</strong>，在表單中選取<strong>“Insert”</strong> >> <strong>“Module”</strong>。</p><figure class="image"><img src="https://assets.matters.news/embed/aab22b0f-59a4-4776-945f-4b79c251d3bf.png" data-asset-id="aab22b0f-59a4-4776-945f-4b79c251d3bf" referrerpolicy="no-referrer"><figcaption><span>插入模組（Module）</span></figcaption></figure><hr><hr><p><strong>❇️ 第三步，貼上程式碼：</strong>滑鼠左鍵雙擊<strong>“Module1”</strong>，黏貼下面的代碼到<strong>“Module1”</strong>的編輯窗口。</p><pre class="ql-syntax">Sub Macro1()
    Sheets("B").Cells(1, 2) = 1
    Sheets("C").Cells(1, 3) = Sheets("B").Cells(1, 2)   
    MsgBox "Hello World!"  
End Sub
</pre><figure class="image"><img src="https://assets.matters.news/embed/ba015787-4c59-4127-96ac-3e3c1e6675f5.png" data-asset-id="ba015787-4c59-4127-96ac-3e3c1e6675f5" referrerpolicy="no-referrer"><figcaption><span>複製貼上程式碼</span></figcaption></figure><hr><hr><p><strong>❇️ 第四步，執行程式：</strong>滑鼠左鍵單擊<strong>工具欄綠色向右箭頭</strong>會運行代碼，分頁B的A1單元格出現數字“1”，分頁C的C1單元格也出現數字“1”，並彈出視窗顯示編程經典文字<strong>“Hello world!"</strong></p><figure class="image"><img src="https://assets.matters.news/embed/6deb3c6e-34ef-46b7-ae4e-5d0d3ded17b9.png" data-asset-id="6deb3c6e-34ef-46b7-ae4e-5d0d3ded17b9" referrerpolicy="no-referrer"><figcaption><span>程式執行結果</span></figcaption></figure><hr><hr><p><strong>❇️ 單擊箭頭沒有運行代碼，反而跳出視窗怎麽辦？</strong>選擇要執行的程式（這裏也就只有一個可以選），再點擊<strong>“Run”</strong>執行。</p><figure class="image"><img src="https://assets.matters.news/embed/d6cabc5e-8c64-4e25-8c3d-0005c41f67aa.png" data-asset-id="d6cabc5e-8c64-4e25-8c3d-0005c41f67aa" referrerpolicy="no-referrer"><figcaption><span>看在是我寫的，程式聽話哦，快點執行，不要丟我的臉</span></figcaption></figure><hr><hr><h2>🔷<strong> 文中範例下載 </strong>🔷</h2><ul><li>如果上面沒有成功，也可以下載範本來試試看，<a href="https://drive.google.com/file/d/195wxtI98TIPQ2Wp9q2dI8xD7z9ciolfW/view?usp=sharing" target="_blank">點我下載</a>。</li><li>檔案打開後注意下是不是有下圖的警告，這是要使用者確認這個巨集是否可信，以免執行了有問題的巨集。點擊“Enable Content”就可以正常使用了。</li><li>下圖中的“Macro1”是這次的範例，“Macro2”是下次的範例，有興趣的可以先睹爲快。</li></ul><figure class="image"><img src="https://assets.matters.news/embed/38e32bbd-4b20-43ba-abf6-e7e62261eea9.png" data-asset-id="38e32bbd-4b20-43ba-abf6-e7e62261eea9" referrerpolicy="no-referrer"><figcaption><span>如果害怕這個檔案有問題就不要點“Enable Content”</span></figcaption></figure><hr><hr><h2>🔷<strong> 範例VBA程式碼解説 </strong>🔷</h2><pre class="ql-syntax">Sub Macro1()
End Sub
</pre><ul><li>一個完整的巨集（英文Macro，中國好像叫宏”），格式為Sub開頭，End Sub結尾，<strong>"Macro1"</strong>可以改成自己喜歡的名字（不能用數字開頭，名字之間也不可有空白，更不能有除了“_”以外的特殊符號，最好是英文，尤其像我這樣電腦用英文系統的人），注意事項可以參考<a href="https://zhuanlan.zhihu.com/p/26215635" target="_blank">這篇文章</a>。要運行的内容放在它們之間。</li><li>巨集的定義是一段可執行的VBA代碼，現階段只要知道你每個程式都要有它就行。</li></ul><hr><hr><pre class="ql-syntax">Sheets("B").Cells(1, 2) = 1
</pre><ul><li>Sheets(“B”)：代表分頁B。</li><li>Cells(1,2): 代表單元格B1（第一行，第二列）。</li><li>整行代碼會將數字1輸入分頁B的單元格B2（第一行，第二列）</li></ul><hr><hr><pre class="ql-syntax">Sheets("C").Cells(1, 3) = Sheets("B").Cells(1, 2)   
</pre><ul><li>這行代碼就是讓分頁C的單元格C1（第一行，第三列）等於分頁B的單元格B2（第一行，第二列），用這種方式取得複製貼上的效果。</li></ul><hr><hr><pre class="ql-syntax">MsgBox "Hello World!"  
</pre><ul><li>跳出一個視窗，顯示<strong>“Hello World!"</strong>。</li><li>每個編程課第一堂課必備内容，理由參考<a href="https://baike.baidu.com/item/hello%20world/85501" target="_blank">百度百科</a>。</li></ul><hr><hr><h2>🔷<strong> 給按鍵設置要運行的巨集 </strong>🔷</h2><p>一般VBA教學的書籍都喜歡用正規但是醜不拉幾的按鈕，我偏不教。</p><p><strong>❇️ 第一步，找個你喜歡的圖案：</strong>如果沒有喜歡的，隨便放張喜歡的圖代替也可以。</p><figure class="image"><img src="https://assets.matters.news/embed/65b15e44-1043-4f33-8222-bf190279193d.png" data-asset-id="65b15e44-1043-4f33-8222-bf190279193d" referrerpolicy="no-referrer"><figcaption><span>插入用來啓動範例巨集的按鈕</span></figcaption></figure><hr><hr><p><strong>❇️ 第二步，用滑鼠右鍵點擊按鈕，選“Assign Macro..."</strong></p><figure class="image"><img src="https://assets.matters.news/embed/92a28430-3458-4273-892f-682cf8bb9499.png" data-asset-id="92a28430-3458-4273-892f-682cf8bb9499" referrerpolicy="no-referrer"><figcaption><span>用滑鼠右鍵點擊按鈕，選“Assign Macro..."</span></figcaption></figure><hr><hr><p><strong>❇️ 第三步，點擊想要讓按鈕執行的巨集，再點”Ok“，</strong>這樣以後點擊按鈕就會執行該巨集了。</p><figure class="image"><img src="https://assets.matters.news/embed/b0acf51c-b146-4c74-b1fb-abbf5289e190.png" data-asset-id="b0acf51c-b146-4c74-b1fb-abbf5289e190" referrerpolicy="no-referrer"><figcaption><span>選擇想要讓按鈕執行的巨集</span></figcaption></figure><hr><hr><h2>🔷 下期預告 🔷</h2><p>下次在本期的基礎上，套用循環結構重複執行“複製貼上”。</p><hr><hr><h2>🔷 吐槽廢文 🔷</h2><ul><li>用英文版的Excel寫中文教學感覺好難，很多功能我都不知道中文叫什麽，還要去參考中文教學書籍，乾脆直接上圖，希望讀者能看懂（不負責任的大叔）。</li><li>這期其實跳過了很多原本應該做的設定，但是擔心各位看到要做這麽多設定直接關掉，所以還是後面慢慢補上（如果還有的話）。</li></ul>  
</div>
            