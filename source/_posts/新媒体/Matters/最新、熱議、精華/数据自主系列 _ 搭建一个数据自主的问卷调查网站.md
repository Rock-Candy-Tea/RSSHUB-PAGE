
---
title: '数据自主系列 _ 搭建一个数据自主的问卷调查网站'
categories: 
 - 新媒体
 - Matters
 - 最新、熱議、精華
headimg: 'https://assets.matters.news/embed/c4849b85-9d85-4cb8-9c6c-488825955e5a.png'
author: Matters
comments: false
date: Sun, 16 May 2021 06:41:07 GMT
thumbnail: 'https://assets.matters.news/embed/c4849b85-9d85-4cb8-9c6c-488825955e5a.png'
---

<div>   
<h2>缘起</h2><p>网络空间越来越逼仄，生活在互联网和大数据时代的我们想要活得自在，不那么容易。除非做原始人，几乎无人能完美躲避来自政府的言论审查和来自 IT 巨头的数据剥削两方面的夹击。</p><p>即使这样，我们仍想尽力挤出一点空间来，让这个网络更自由和更自主。</p><p>如果你一直在苦苦寻找一个不被言论审查的问卷调查服务，而且问卷数据可以自己掌控（比如导出、删除），那何不自己搭建一个呢？雖然 GFW 能輕易地把我們自己搭建的網站給牆了，但不至於問卷上的問題發不出來（通常對於小網站 GFW 只會進行 DNS 污染 ——這樣只需要換個域名就可）。</p><p>現在搭建網站的技術門檻越來越低啦，只需要 2 條命令就能搭建啦！需要的條件只是：擁有一個域名 + 租一台虛擬主機（VPS，$5/月）；當然如果你的電腦是 mac 或 Linux 就更好了。</p><h2><br></h2><h2>OhMyForm: 自由開源問卷服務軟件</h2><p>幸好這個世界有<a href="https://www.gnu.org/philosophy/free-sw.html" target="_blank">自由開源軟件</a>（Free and Open Source Software, FOSS），僅僅公開了源代碼是不夠的，還需要允許任何人使用、運營、修改和發佈自己的版本，即 Free as in Freedom。</p><p><a href="https://ohmyform.com/" target="_blank">OhMyForm</a> 是一款 nodejs 寫的很輕量的自由開源軟件，雖然功能較為簡單但實際夠用了，它有十幾種表單可選（包括選擇、填空等等）。</p><p>OhMyForm 再加上 <a href="https://caprover.com/docs/get-started.html" target="_blank">Caprover</a> —— 一個自動化軟件發佈平台軟件（PaaS），不需要理解軟件發佈的原理就能把很多常用的服務端軟件（包括 OhMyForm）發佈到你指定的 VPS 服務器上，通常只需要<a href="https://caprover.com/docs/one-click-apps.html" target="_blank">幾個點擊</a>， 兩個命令只是用來在你的本地電腦安裝 CapRover 而已。</p><h2><br></h2><h2>第一步：租 VPS 并部署 Caprover</h2><p>由於 Caprover 跟 主機服務商 DigitalOcean (DO) 有合作，所以在 DO 上開個 VPS 後可以直接一鍵部署 Caprover。（如果不選擇 DO，其他的主機服務商都可以，不過就是多一些部署命令，詳見：<a href="https://caprover.com/docs/get-started.html#caprover-setup" target="_blank">Caprover 官方文檔 的第一和第二步</a></p><p>選擇創建（Create）一個 Droplet（即雲主機）： </p><figure class="image"><img src="https://assets.matters.news/embed/c4849b85-9d85-4cb8-9c6c-488825955e5a.png" data-asset-id="c4849b85-9d85-4cb8-9c6c-488825955e5a" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p>
在創建頁面選擇【Marketplace】，找到 <code>Caprover</code>，其他按照默認的就好（如果你預期會有很大的訪問量則可以選擇大的 Plan；也可以選擇一下地點，地點不同速度也不同）。 </p><figure class="image"><img src="https://assets.matters.news/embed/9abaa58e-e6bb-42aa-8846-e6ca20aa196c.png" data-asset-id="9abaa58e-e6bb-42aa-8846-e6ca20aa196c" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p>
靜等片刻，部署好了之後，你應該能用 VPS 的 IP 加端口號（3000）來訪問到 Caprover 啦（比如：<a href="http://xx.xx.xx.xx:3000）。" target="_blank">http://xx.xx.xx.xx:3000）。</a></p><h2><br></h2><h2>第二步：設置 DNS</h2><p>去你買域名的服務商那裡，在 DNS 紀錄那一頁（每個服務商的頁面會不一樣），修改 A 紀錄。比如你的域名是 <code>mdrights.club</code>，你想讓問卷網站的地址是 <code>mysurvey.mdrights.club</code>，那麼需要添加一條紀錄（这里不详细介绍了）：</p><pre class="ql-syntax">Type  Name   IPv4 address
A       *      xx.xx.xx.xx （<--你的 IP）
</pre><figure class="image"><img src="https://assets.matters.news/embed/0218119c-4a59-4c1a-a6ca-7ea2c9827059.png" data-asset-id="0218119c-4a59-4c1a-a6ca-7ea2c9827059" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>设置好 DNS 后可能需要等几分钟～几小时才能生效。生效后可以用域名访问你的 Caprover 服务器咯，比如我的就是 <code>mdrights.club</code>。這個時候還只能訪問 3000 端口，所以要這樣訪問：<code><a href="http://mdrights.club:3000/" target="_blank">http://mdrights.club:3000</a></code>（注意是 <strong>http://</strong>）。</p><p>登录到上面的这个网址，默认初始密码是 <code>captain42</code>。进入后第一件事就是要改密码（在「设置」里）。 </p><figure class="image"><img src="https://assets.matters.news/embed/7f9477d9-2bbe-4d41-ac22-c3519d2c1280.png" data-asset-id="7f9477d9-2bbe-4d41-ac22-c3519d2c1280" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>
讓 Caprover 知道我們的域名。在「Dashboard」页面，填上在第二步设置 DNS 时用到的域名，比如我的就是 <code>mdrights.club</code>。然后点击「Update Domain」，記得之後再点下「Enable HTTPS」，然後是【Force HTTPS】。</p><figure class="image"><img src="https://assets.matters.news/embed/1e0e45fb-6e8b-4412-83d5-4341f4d7b798.png" data-asset-id="1e0e45fb-6e8b-4412-83d5-4341f4d7b798" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><blockquote>然而，官方說這裡可能會有bug，最好用命令行最高效可靠。</blockquote><p>如果刚才这步遇到报错，那么请立即打開你的 macbook 的 Terminal （終端），輸入：</p><pre class="ql-syntax">  sudo npm i -g caprover  （會要求輸入你的登錄密碼）
</pre><p>然後把 DNS 配上（照著它的提問填入相關信息即可）：</p><pre class="ql-syntax">  caprover serversetup
</pre><figure class="image"><img src="https://assets.matters.news/embed/a5d02783-683c-454b-801b-b06ba5b4b17b.png" data-asset-id="a5d02783-683c-454b-801b-b06ba5b4b17b" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>這時我們應該能訪問正式的安全的域名啦：<code><a href="https://captain.mdrights.club/" target="_blank">https://captain.mdrights.club</a></code>（我的例子）。</p><h2><br></h2><h2>第三步：部署 OhMyForm</h2><p>点击「Apps」页面，我们要开始安装 OhMyForm了。点击「One-click Apps/Databases」。</p><figure class="image"><img src="https://assets.matters.news/embed/bdb8cd04-defe-4a20-b942-08b05401f037.png" data-asset-id="bdb8cd04-defe-4a20-b942-08b05401f037" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>点击上图的 OhMyForm 框框，就进入到安装页面，需要输入一些关于你的软件的信息，包括：</p><p>- App Name: 起个名字，会成为网址的一部分（这里以 <code>csoform</code> 为例）；</p><p>- Admin E-Mail: 设置管理员邮箱，用于找回密码；</p><p>- Admin user name: 设置管理员账号，会是整个软件里最高权限的账号；</p><p>- Admin password: 系统生成的密码，请保存好；</p><p>- Database user: 存储问卷数据的账号；</p><p>- Database password: 数据库账号的密码；</p><p>- Title: 显示在浏览器的标题栏上。</p><p>点击「Deploy」后等待一小会，就大功告成啦～</p><figure class="image"><img src="https://assets.matters.news/embed/5ddc862e-33ad-4d4d-99a5-f2e922622397.png" data-asset-id="5ddc862e-33ad-4d4d-99a5-f2e922622397" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><ol><li>接下来我们还需要为我们的网站加上 HTTPS，加强安全。在「App」页面，分别点击链接「csoform」和「csoform-api」（你可以是你自己定义的名称），点击蓝色的「enable HTTPS」按钮，然后点击「save & update」。</li></ol><figure class="image"><img src="https://assets.matters.news/embed/8dc153ab-0bd7-4279-b837-9dadb9ebc26a.png" data-asset-id="8dc153ab-0bd7-4279-b837-9dadb9ebc26a" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>然后 --></p><figure class="image"><img src="https://assets.matters.news/embed/a2789c3a-9e3d-49ca-b7c8-9aa2b8d7e77b.png" data-asset-id="a2789c3a-9e3d-49ca-b7c8-9aa2b8d7e77b" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>记得 「csoform-api」（你有你定义的名称）也要这么操作。</p><p>最后，访问 <code><a href="https://csoform.xxxxxx.xxx/" target="_blank">https://csoform.xxxxxx.xxx</a></code> 试试看～ （以后日常使用都是访问这个地址了）</p><figure class="image"><img src="https://assets.matters.news/embed/62e6b61a-219f-44bb-b097-7ed4a0536085.png" data-asset-id="62e6b61a-219f-44bb-b097-7ed4a0536085" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><p>----------------------------- 以上是部署时才需要的操作，以下是使用时经常要操作的 --------------------</p><h2><br></h2><h2>創建用戶並賦權</h2><p>首先，只有部署時創建的那個用戶<code>ohmyadmin</code> （是Super User）和被賦予 admin 的用戶可以製作問卷。</p><p>請你的同事/隊友在登錄頁面註冊一個帳號，你（網站的搭建者）用 ohmyadmin 登錄並為他們賦予 admin 權限。</p><figure class="image"><img src="https://assets.matters.news/embed/93ac3c1f-3fea-43b8-803a-cf0bff14cf58.png" data-asset-id="93ac3c1f-3fea-43b8-803a-cf0bff14cf58" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><h2><br></h2><h2>製作問卷</h2><p>進入【Forms】頁面即可一步一步開始製作問卷啦～</p><figure class="image"><img src="https://assets.matters.news/embed/b56cf86e-1b67-44d0-a608-bd1895ac155f.png" data-asset-id="b56cf86e-1b67-44d0-a608-bd1895ac155f" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><h2><br></h2><h2>發放問卷</h2><p>每個問卷頁面會生成一個可任何人訪問的網址，不需要認證或註冊。</p><figure class="image"><img src="https://assets.matters.news/embed/209204cb-d029-4431-906b-73efe4ef5679.png" data-asset-id="209204cb-d029-4431-906b-73efe4ef5679" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><h2><br></h2><h2>查看並導出問卷數據</h2><p>在每個問卷頁面都有【Submissions】這樣的按鈕，即填問卷的人提交的答案。當然也可以導出啦～！問卷數據都存在你的開通的服務器上（比如 DO），不會與第三方分享。</p><figure class="image"><img src="https://assets.matters.news/embed/c0825542-2f5f-4afc-9af2-5ed6ea7375b3.png" data-asset-id="c0825542-2f5f-4afc-9af2-5ed6ea7375b3" referrerpolicy="no-referrer"><figcaption><span></span></figcaption></figure><p><br></p><hr><p><strong>本文最新版本链接在这里</strong>：https://github.com/mdrights/Digital-rights/blob/master/T教程和笔记/2021-05-04-how-to-selfhost-ohmyform.md</p><p>注：本教程将适用于 OhMyForm 1.0.0 正式版，所以在正式版发布之前，部署方法可能会略有不同。</p><p>欢迎来 Matrix 房间交流探讨：<strong>#liveslack:privacytools.io </strong></p><h2>Enjoy!</h2>  
</div>
            