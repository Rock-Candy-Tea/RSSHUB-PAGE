
---
title: 'MLog #20211201'
categories: 
 - 新媒体
 - Matters
 - 最新、熱議、精華
headimg: 'https://picsum.photos/400/300?random=70'
author: Matters
comments: false
date: Wed, 01 Dec 2021 11:04:18 GMT
thumbnail: 'https://picsum.photos/400/300?random=70'
---

<div>   
<p>以及虽然和主题没什么关系，但是 <a class="mention" href="https://matters.news/@RitaShields" target="_blank" data-display-name="RitaShields" data-user-name="RitaShields" data-id="VXNlcjo1MjA1MQ">﻿<span>@RitaShields</span>﻿</a> 前几天决定要隐退了，还是要感谢他/她之前的贡献。</p><h2>关于 LikeCoin Chain 的第 23 号提案</h2><p><a href="https://likecoin.bigdipper.live/proposals/23" rel="noopener noreferrer" target="_blank">可以在 BigDipper 查看提案的摘要。</a></p><p>有熟悉 LikeCoin 和赞赏公民的马特市民应该都知道，「化赞为赏」除了有赞赏公民的直接支持（不管是 Classic 的均分还是 2.0 的定点支持）以外，还有一笔每日根据拍手数按比例分配的「创作基金」。</p><p>一直以来，创作基金都是由 Liker Land 团队持有的钱包负责派发的（大概是这个意思吧，<a class="mention" href="https://matters.news/@edmond" target="_blank" data-display-name="黃牛山人" data-user-name="edmond" data-id="VXNlcjo3ODM">﻿<span>@黃牛山人</span>﻿</a> 😶），除了广大 Liker 和赞赏公民从官方口径中知道创作基金是按拍手数比例分配，而且赞赏公民的拍手比重更大以外，这个创作基金分配的方法差不多算是个黑箱了。（笑）</p><p>当然山人他自己也是想做出些改变的，这个把创作基金分配从 Liker Land 团队向一个非中心的社群间转移的计划也是他想出来的。</p><p>出于效率等等的考虑，这个小组的人数不会太多，最好也是奇数。所以原定的计划是三人，但是没想到在 Discord 讨论的时候大家反应激烈，最后有……多达七人有参加的意愿😂</p><p>所以就愉快的决定先从七个人开始了，虽然启发这一提案的 <a class="mention" href="https://matters.news/@edmond" target="_blank" data-display-name="黃牛山人" data-user-name="edmond" data-id="VXNlcjo3ODM">﻿<span>@黃牛山人</span>﻿</a> 其实一开始是不想作为这个新小组的成员的，就像 LikeCoin Chain 刚启动时的七大验证人并没有 LikeCoin 自己一样。以及其间 <a class="mention" href="https://matters.news/@leafwind" target="_blank" data-display-name="leafwind" data-user-name="leafwind" data-id="VXNlcjo1ODU">﻿<span>@leafwind</span>﻿</a> 担心自己可能没有那么多时间在这个工作上面。但都被咱们强行留下来了（不是）。</p><p>那么这个小组的工作是什么呢，基本上就是下面两点：</p><ul><li>决定每月和每日派发的创作基金的金额。</li><li>检讨和优化创作基金的分配机制，以及根据分配机制操作创作基金钱包分发创作基金。</li></ul><p>例如用什么样的方法计算创作基金的分配比例、不同内容或创作者的权重（例如 Liker.Social 上赞赏键的权重就相对低一些，这是 Liker.Social 运营方面自己主动提出的。后续也可能会考虑用清晰的方法来减少刷拍手对创作基金的影响这样子的。）等等。至于发放创作基金的钱包也正在计划转移到由小组成员共同持有的 Multisign 钱包里。</p><p>虽然还有些问题没有考虑到，例如该如何向 Likers 和 赞赏公民们传达小组活动的消息、以及公开分配方式的程度（全藏着掖着又会被骂黑箱，全部公开也许会被不怀好意的家伙学到反制的方法，好难啊……），但毕竟千里之行始于足下嘛。</p><p>那么作为初期成员的咱会有啥想法呢？</p><p>咱目前能想到的大概就只有想让这个小组的成员更加多元化了吧，目前的七名成员好像都来自大中华地区。虽然也是因为 LikeCoin 的开发者和创作者大部分都在汉字文化圈的缘故。假以时日 LikeCoin 能在其它语系的用户之间流行起来的话，就有必要有能够流畅理解不同语言内容的小组成员了吧，如果有计划以文章的内容作为创作基金分派考虑的因素的话。</p><h2>备份 LikeCoin 验证人节点的手段</h2><p><s>这一切都要从 <a class="mention" href="https://matters.news/@thumbb13555" target="_blank" data-display-name="碼農日常大小事-裏" data-user-name="thumbb13555" data-id="VXNlcjo1NzI3NA">﻿<span>@碼農日常大小事-裏</span>﻿</a> 的跑路操作说起……</s></p><p><s>虽然咱后来也差不多干了和他差不多的事情…… </s>（不过还好咱的 Key 没被咱删掉，算不算是删库跑路 Lite 版（笑））<br class="smart"></p><p>关于备份验证人节点的方法嘛，其实已经有验证人同仁们给出自己的解决方案了。例如 Nukken <a href="https://public.nnkken.dev/liked-data-archive/snapshot.sh" rel="noopener noreferrer" target="_blank">有一个脚本</a>每日生成验证人节点数据的快照。</p><p>咱的话，因为咱把仓库和验证人数据放在了一个 btrfs 子卷（btrfs 的子卷差不多是一种特殊的目录，可以作为挂载点独立挂载）里，所以很自然的就用 btrfs 的快照和发送/接收命令定期将子卷的数据发回到家里的 NAS 上。</p><pre class="ql-syntax" spellcheck="false">sdc   8:32  0 200G 0 disk 
└─sdc1  8:33  0 200G 0 part /likecoin-chain
                /home/horo/likecoin-chain 
</pre><p>在咱这个例子里， /likecoin-chain 是整个 btrfs 卷，而 /home/horo/likecoin-chain 是其中一个子卷，所以 /likecoin-chain 目录大概像这个样子：</p><pre class="ql-syntax" spellcheck="false">horo@localhost ~ % ls /likecoin-chain
likecoin-chain likecoin-chain-20211128 likecoin-chain-20211129
...
</pre><p>出于不知道验证人节点运行的时候会更新什么文件，所以在备份之前需要先让节点停下来。然后创建快照：</p><blockquote># btrfs subvolume snapshot 原始子卷 快照子卷<br class="smart">加上 -r 参数的话，就会创建一个只读快照。<br class="smart">date 命令返回今天的日期和时间，也可以指定一个格式字符串来按某个特定的格式输出。<br class="smart">以 $ 包围的命令会以它的结果填充，例如 echo "root_$(date +"%Y%m%d")" 的 结果是 root_20211201 （咱写完这篇文章的时间，汝自己运行的话结果肯定会和咱有变化）。<br class="smart"></blockquote><blockquote># btrfs subvolume snapshot -r likecoin-chain likecoin-chain-$(date +"%Y%m%d")</blockquote><p>创建完快照以后就可以把节点重新开起来了，以及可以通过 btrfs send 和 btrfs recieve 在两个 btrfs 卷之间传送子卷（或子卷的快照），不过要是只读的才行：</p><blockquote># btrfs send <path/to/your/subvolume> | btrfs recieve <path/to/your/save/place></blockquote><p>如果创建快照时忘记设置只读，可以通过 btrfs property 命令设置上（当然也可以取消只读）：</p><blockquote># btrfs property set -ts <path/to/your/subvolume> ro [true|false]</blockquote><p>汝也可以传递增量快照，就像这样：</p><blockquote># btrfs send <path/to/your/subvolume> -p <path/to/your/parent_subvolume> | btrfs recieve <path/to/your/save/place></blockquote><p>不过汝要先把父快照传送到目标才行。</p><p>这个命令也能和 ssh 命令搭配使用，像这样：</p><blockquote># btrfs send /likecoin-chain/likecoin-chain-20211128 | ssh root@somewhere "btrfs receive /data/backups/"</blockquote><p>把上面的内容整理成一个 Shell 脚本，再搭配上 Crontab 或者 Systemd Timer，就可以定时备份了。要点就是 btrfs 的大部分命令需要以 root 用户运行，而定时运行的时候又不太方便输入 root 用户的密码（以及正经人不会允许 root 用密码登录 ssh 的），所以最好是设置一对密钥。 </p><p>虽然还是没什么关系，在写这篇文章的时候咱也在一边看 Discord 的聊天记录， WeLike 的验证人节点所在的 VPS 服务商似乎出了问题让它的节点 Jailed 了…… </p><h2>One More Thing - 设计和 Discord 搭配使用的 LikeCoin 辅助机器人</h2><p>前几天 Phoebe 在 Discord 里问有没有方法通过机器人在链上有新提案的时候发消息提醒大家、像是存入保证金或者投票什么的，然后咱就去查了一些资料。</p><p>Cosmos SDK 有 REST API 可以拿到链上的提案列表。于是接下来就是找个方法写机器人了。结果咱之前了解到的一个比较流行的 Python 绑定（咱也就稍微多会写一点 Python 了嘛……）因为 Discord 强行要求更新到 APIv2 而决定停止开发了（<a href="https://gist.github.com/Rapptz/4a2f62751b9600a31a0d3c78100287f1" rel="noopener noreferrer" target="_blank">具体的细节可以看作者的 Gist</a>），后面提及的几个完成实现的绑定里也就只有 JavaScript 咱还能算是用过了。（<s>剩下的都是些什么玩意儿啊……</s>）</p><p>于是如果咱真的有想法来做的话，大概对咱来说也许是个挑战吧。虽然 Liker.Social 还鼓励咱去申请 Grants 来着。</p><h2>One More Thing Again</h2><p>刚才看了眼咱自己的验证人节点的 RPC Status，大概快能赶上大部队了吧（还有几万块的样子，但是同步的速度还算是挺快的）。所以咱大概马上就能再次连线了，如果咱还能再回到活跃验证人的行列的话，咱就去下调佣金率去了。（虽然每天只能变化 10%……）</p><p>以及如果咱拿佣金充实自我委托或者拿去 Osmosis 一类的地方提供流动性的话，不知道会不会招来反对意见😢……</p><p> </p>  
</div>
            