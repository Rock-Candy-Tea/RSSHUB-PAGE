
---
title: '知名开源库惊现666版本：神秘Bug影响超2万个项目，亚马逊云也躺枪'
categories: 
 - 新媒体
 - 36kr
 - 资讯
headimg: 'https://img.36krcdn.com/20220110/v2_0db61b737a8c400fab14cc1c2f0bb761_img_png'
author: 36kr
comments: false
date: Mon, 10 Jan 2022 06:14:07 GMT
thumbnail: 'https://img.36krcdn.com/20220110/v2_0db61b737a8c400fab14cc1c2f0bb761_img_png'
---

<div>   
<p><img src="https://img.36krcdn.com/20220110/v2_0db61b737a8c400fab14cc1c2f0bb761_img_png" data-img-size-val="699,272" referrerpolicy="no-referrer"></p> 
<p><strong>新智元报道</strong></p> 
<p><strong>【导读】</strong>程序突然乱码，开发者紧急「修复」！然而……</p> 
<p>这两天，一些开发者感觉有点懵…… </p> 
<p class="image-wrapper"><img data-img-size-val="225,225" src="https://img.36krcdn.com/20220110/v2_5c9da6a3e1184d8a8bfa14bc3a5dc8cb_img_000" referrerpolicy="no-referrer"></p> 
<p>一觉醒来发现，自己程序跑出来的全都是「乱码」。 </p> 
<p class="image-wrapper"><img data-img-size-val="612,386" src="https://img.36krcdn.com/20220110/v2_b16effed7e164a2584b1b870cb49cbf6_img_000" referrerpolicy="no-referrer"></p> 
<p>说起来，这些开发者的共同点就是都使用了开源库「colors」和「faker」。 </p> 
<p>而且这两个库相当受欢迎！ </p> 
<p>仅仅在npm上，colors库每周的下载量就超过2000万次，并且有将近19000个项目正在使用。 </p> 
<p>faker在npm上每周的下载量超过280万次，有超过2500个项目使用。 </p> 
<p>甚至连亚马逊的云计算开发工具包（aws-cdk）也用上了。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,695" src="https://img.36krcdn.com/20220110/v2_9a3f0fea493647bc9aa0d9034194dc78_img_000" referrerpolicy="no-referrer"></p> 
<p>最初，用户怀疑这些项目所使用的库「colors」和「faker」被入侵，类似于去年coa、rc和ua-parser-js库被恶意分子劫持的情况。 </p> 
<p>看到各种反馈之后，开发者也赶紧发文表示已经在努力「修复」了。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,114" src="https://img.36krcdn.com/20220110/v2_4a2b93c587664722930b9fa109da1b31_img_000" referrerpolicy="no-referrer"></p> 
<p>但事实证明，故事并没有这么简单。 </p> 
<p class="image-wrapper"><img data-img-size-val="500,214" src="https://img.36krcdn.com/20220110/v2_10a6872e87af4df28ffb1f0de5829650_img_000" referrerpolicy="no-referrer"></p> 
<h2 label="一级标题" style><strong>老子，不干了！</strong></h2> 
<p>事件的开端要从这位名为「Marak Squires」的开发者说起。 </p> 
<p>近期，Marak在「colors」（GitHub上又名colors.js）加入了v1.4.44-liberty-2，并且发布了「faker」（GitHub上又名faker.js）的6.6.6版本。 </p> 
<p>稍微对西方有所了解的朋友们很容易就能注意到，这个「666」有些不太对劲啊。 </p> 
<p class="image-wrapper"><img data-img-size-val="600,243" src="https://img.36krcdn.com/20220110/v2_5d5656246dcc41ef8f7e4a33ec426597_img_000" referrerpolicy="no-referrer"></p> 
<p>找了一圈发现，网上的图都不太能放…… </p> 
<p>总之，就是和「恶魔」有着千丝万缕的联系。 </p> 
<p>而Marak所做的，正是引入了一个无限循环的bug，让数以千计的依赖「color」和「faker」的项目直接崩溃。 </p> 
<p class="image-wrapper"><img data-img-size-val="224,225" src="https://img.36krcdn.com/20220110/v2_7e292fa3d3164ca5b9350f76802c3861_img_000" referrerpolicy="no-referrer"></p> 
<p>这些信息包括文本「LIBERTY LIBERTY LIBERTY」，以及在后面跟着的一大串非ASCII字符。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,546" src="https://img.36krcdn.com/20220110/v2_888a95d043724c058440a0cd7ae338c5_img_000" referrerpolicy="no-referrer"></p> 
<p>这些字符也被称为「Zalgo文本」。 </p> 
<p>当然，这又是另一个非常有意思的故事了，感兴趣的朋友可以自己搜一下。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,762" src="https://img.36krcdn.com/20220110/v2_07d1b171a3f54220a4c71e3b2ad2665c_img_000" referrerpolicy="no-referrer"></p> 
<p>然而，时间一分一秒地过去了，自己的程序跑不了，项目的开发者也迟迟没有提交解决方案。 </p> 
<p>开发者们不得不开始自己寻求解决方案。 </p> 
<p class="image-wrapper"><img data-img-size-val="480,480" src="https://img.36krcdn.com/20220110/v2_94b71980f8fc45e284954d0648a1c0d3_img_000" referrerpolicy="no-referrer"></p> 
<p>很快就有人发现，只要回滚到之前的1.4.0版本，问题就解决了。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,181" src="https://img.36krcdn.com/20220110/v2_50b68b9183824d248392a37d3da31152_img_000" referrerpolicy="no-referrer"></p> 
<p>由此也就可以推断，这个bug很有可能就来自于最新提交的「v1.4.44-liberty-2」。 </p> 
<p>通过查看项目的历史发现，Marak在v1.4.44-liberty-2版本的colors.js库中添加了一个「新的美国国旗模块」，并将其推送到GitHub和npm。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,572" src="https://img.36krcdn.com/20220110/v2_c9075655be384d76a69b9577b0764e4a_img_000" referrerpolicy="no-referrer"></p> 
<p>就新的在代码中，有一段无限循环，会让所有使用「colors」的程序在控制台无休止地打印各种非ASCII字符序列。 </p> 
<p>对于「faker」，Marak除了炸了自己程序之外，还修改了GitHub repo的README页面。 </p> 
<p>这次，Marak直接摊牌了：endgame。 </p> 
<p>Marak还提到了一个人：亚伦·斯沃茨。写到：「Aaron Swartz到底发生了什么？」 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,693" src="https://img.36krcdn.com/20220110/v2_0acb648b41d74d6098252c31b98551e7_img_000" referrerpolicy="no-referrer"></p> 
<p>斯沃茨是一名美国程序员、企业家和著名的黑客<a class="project-link" data-id="43253" data-name="活动家" data-logo="https://img.36krcdn.com/20210807/v2_022ad407262a4627a5f582ce083fe2cf_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/43253" target="_blank">活动家</a>，在一场法律诉讼后「自杀」身亡。 </p> 
<p>为了使所有人都能自由获取信息，这位黑客从麻省理工学院校园网上的JSTOR数据库下载<a class="project-link" data-id="4260438" data-name="了数" data-logo="https://img.36krcdn.com/20210422/v2_8e636ec7be434dd5bf7deebc8bed2b62_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/4260438" target="_blank">了数</a>百万篇期刊文章，据称他通过反复旋转自己的IP和MAC地址来绕过JSTOR和麻省理工学院设置的技术封锁。 </p> 
<p class="image-wrapper"><img data-img-size-val="440,352" src="https://img.36krcdn.com/20220110/v2_1bdeaef32ccd4cd3841b5623fd6f6f4d_img_000" referrerpolicy="no-referrer"></p> 
<p>此前，在2020年11月，Marak就曾警告说，他将不再用他的「免费工作」来支持大公司了，而这些企业应该考虑用每年「六位数」的工资来补偿。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,343" src="https://img.36krcdn.com/20220110/v2_4e36e7d86dd84850a8aabb93c6e4f624_img_000" referrerpolicy="no-referrer"></p> 
<p>「恕我直言，我将不再用我的免费工作来支持财富500强（和其他较小规模的公司）。」 </p> 
<p>「你们可以把这当作一个机会，给我发一份六位数的年薪合同，或者把这个项目fork之后，让别人来做。」 </p> 
<p class="image-wrapper"><img data-img-size-val="400,300" src="https://img.36krcdn.com/20220110/v2_7f86c33e92fa4fcf9c6958afb38078d3_img_000" referrerpolicy="no-referrer"></p> 
<p>于是，整件事的缘由逐渐明晰了起来，Marak似乎是在报复那些大型企业以及拿着<a class="project-link" data-id="4262185" data-name="开源项目" data-logo="https://img.36krcdn.com/20210603/v2_43fe3145b6494227bd8db07dcdc0147b_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/4262185" target="_blank">开源项目</a>赚钱的开发者。 </p> 
<p>他认为，这些人不仅大量地使用开源社区的免费软件，但是对社区又毫无贡献。 </p> 
<h2 label="一级标题" style><strong>敢乱改自己项目？看我封你账号</strong></h2> 
<p>对Marak的这波迷之操作，开源社区一部分开发者表示理解，另一部分则直接「口吐芬芳芳」。 </p> 
<p>「显然，『colors.js』的作者为没有<a class="project-link" data-id="95377" data-name="得到" data-logo="https://img.36krcdn.com/20210807/v2_966db147ab4646ef82349f069ce61219_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/95377" target="_blank">得到</a>报酬而生气......。所以他决定在每次加载他的库时打印美国国旗......。」 </p> 
<p>嚯，有点意思啊！（doge） </p> 
<p class="image-wrapper"><img data-img-size-val="1080,540" src="https://img.36krcdn.com/20220110/v2_2035323f85774242a98a3a51654607aa_img_000" referrerpolicy="no-referrer"></p> 
<p>信息安全专家VessOnSecurity称这种行为是「真**的不负责任」。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,607" src="https://img.36krcdn.com/20220110/v2_f84f9af5f85c44e5b10c25a11a9cc33c_img_000" referrerpolicy="no-referrer"></p> 
<p>「如果你对企业免费使用你的免费代码有意见，就不要发布免费代码。通过破坏你自己被开发者广泛使用的项目，你不仅伤害了大企业，也伤害了所有在使用它的人。」 </p> 
<p>但是有人则认为：「将代码发布到他们自己的库中，不需要对任何事情负责。如果你不同意我的观点，那么请阅读许可证中的实际法律条文，它没有给出任何保证。如果是不负责任的，那又怎样，他们不需要负责任。」 </p> 
<p>而GitHub一看，这个Marak怎么能瞎搞自己的项目，封了吧！ </p> 
<p class="image-wrapper"><img data-img-size-val="1080,354" src="https://img.36krcdn.com/20220110/v2_fc3811fe518a49958663a60479fd69c8_img_000" referrerpolicy="no-referrer"></p> 
<blockquote> 
 <p>NPM已经恢复到faker.js包的前一个版本，Github已经暂停了我对所有公共和私人项目的访问。我有100多个项目。 </p> 
</blockquote> 
<p class="image-wrapper"><img data-img-size-val="1080,1216" src="https://img.36krcdn.com/20220110/v2_d8c5a31fee2e4606a6d26a031cd68fc9_img_000" referrerpolicy="no-referrer"></p> 
<p>软件工程师Sergio Gómez对此表示非常不理解：「从GitHub上删除自己的代码是违反他们的服务条款的？WTF? 这是一种绑架行为。」 </p> 
<h2 label="一级标题" style><strong>Log4j：用爱发电，还得背锅</strong></h2> 
<p>Marak的「删库跑路」，不由得让我们想起最近闹得沸沸扬扬的「Log4j事件」。 </p> 
<p>据<a class="project-link" data-id="3967772" data-name="火线安全" data-logo="https://img.36krcdn.com/20210113/v2_4ced9e27ef864cec9abfb1c8c9738efc_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/3967772" target="_blank">火线安全</a>不完全统计，仅在Github上，就有60644个开源项目发布的321094软件包存在风险，这一漏洞可以说是影响了互联网上70%以上企业系统的正常运转。 </p> 
<p>由于Java应用程序通常会记录各种各样的事件，例如用户发送和接收的消息，或者系统错误的详细信息，因此该漏洞可以通过多种方式触发。 </p> 
<p>很快，Log4shell漏洞开始出现大规模的恶意利用。 </p> 
<p class="image-wrapper"><img data-img-size-val="300,223" src="https://img.36krcdn.com/20220110/v2_b76fe69173524cdca0d1e76eedb40be3_img_000" referrerpolicy="no-referrer"></p> 
<p>随着越来越多的问题被发现，Log4j的开发者们也不得不开启了假期无偿加班模式，为该项目打补丁。 </p> 
<p>虽然已经在「不眠不休地进行抢救：修复、文档、CVE、回复咨询了」，然而，依然有一些bug赏金猎人在对Log4j维护者进行围追堵截。 </p> 
<p class="image-wrapper"><img data-img-size-val="1080,512" src="https://img.36krcdn.com/20220110/v2_3ec851dbf60242759f729a2ed8c697b5_img_000" referrerpolicy="no-referrer"></p> 
<p>Log4j这件事也让更多人开始关注大企业是如何「压榨」开源的问题。 </p> 
<p>大量的网站、软件和应用程序依靠开源开发者来创造基本的工具和组件，他们不断地消费，却没有给予足够的回报。 </p> 
<p>而这些「孜孜不倦」地修复着安全问题的开发者们，不仅放弃了自己的闲暇时间，也没有得到任何资金的支持。 </p> 
<p>网友对此评论道：「对color.js/faker.js作者破坏他们自己的软件包的反应，恰好也说明了有多少企业开发者认为他们在道德上有权使用开源开发者的无偿劳动，而不用做出任何回报。」 </p> 
<p>对于开源代码的未来，大概只能等时间来告诉我们吧。 </p> 
<p>参考资料：</p> 
<p>https://www.bleepingcomputer.com/news/security/dev-corrupts-npm-libs-colors-and-faker-breaking-thousands-of-apps/</p> 
<p class="editor-note">本文来自<a class="project-link" data-id="3968527" data-name="微信" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968527" target="_blank">微信</a>公众号<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/Drz8_yLO3vvlbnTnEMSrLw">“新智元”（ID:AI_era）</a>，作者：好困，36氪经授权发布。</p>  
</div>
            