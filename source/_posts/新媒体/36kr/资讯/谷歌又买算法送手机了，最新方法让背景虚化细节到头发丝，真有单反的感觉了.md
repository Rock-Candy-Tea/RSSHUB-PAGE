
---
title: '谷歌又买算法送手机了，最新方法让背景虚化细节到头发丝，真有单反的感觉了'
categories: 
 - 新媒体
 - 36kr
 - 资讯
headimg: 'https://img.36krcdn.com/20220207/v2_83cab2975a984b5a9c3eb34ddd6a168e_img_000'
author: 36kr
comments: false
date: Mon, 07 Feb 2022 07:22:24 GMT
thumbnail: 'https://img.36krcdn.com/20220207/v2_83cab2975a984b5a9c3eb34ddd6a168e_img_000'
---

<div>   
<p>当真是买算法送手机！</p> 
<p>这不，<a class="project-link" data-id="3968996" data-name="谷歌" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968996" target="_blank">谷歌</a>又给“亲儿子”Pixel 6塞福利了，让手机抠图也能细节到头发丝。</p> 
<p>看这效果，原本模糊的头发轮廓，咻地一下，就变成了纤毫毕现的样子！</p> 
<p class="image-wrapper"><img data-img-size-val="640,360" src="https://img.36krcdn.com/20220207/v2_83cab2975a984b5a9c3eb34ddd6a168e_img_000" referrerpolicy="no-referrer"></p> 
<p>连发丝之间的缝隙也能精准抠到。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,735" src="https://img.36krcdn.com/20220207/v2_d9722abe1d62447a93241006148be1ae_img_000" referrerpolicy="no-referrer"></p> 
<p>这样一来，就避免了使用人像模式拍照时<a class="project-link" data-id="3969467" data-name="人物" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3969467" target="_blank">人物</a>与虚化背景割裂的情况，让人物照片的纵深感更加逼真。</p> 
<p>四舍五入一下，这不就是手握单反拍照？（手动狗头）</p> 
<h2><strong>Alpha遮罩+监督学习</strong></h2> 
<p>在介绍最新的方法之前，先来了解一下过去手机的人像模式拍照到底是怎么实现的。</p> 
<p>传统方法是使用<strong>二进制</strong>将图像分割，然后对分离出的背景进行虚化，在视觉上产生一种纵深感，由此也就能更加突出人物主体了。</p> 
<p class="image-wrapper"><img data-img-size-val="640,416" src="https://img.36krcdn.com/20220207/v2_edf671fecc1747b5a005effb05f867dc_img_000" referrerpolicy="no-referrer"></p> 
<p>虽然带来的视觉效果非常明显，但是在细节上的表现还不够强大。</p> 
<p>由此，谷歌将常用于电影制作和摄影修图的<strong>Alpha遮罩</strong>搬到了手机上，提出了一个全新的神经网络，名叫“Portrait matting”。</p> 
<p>其中，主干网络是<strong>MobileNetV3</strong>。</p> 
<p>这是一个轻<a class="project-link" data-id="103663" data-name="量级网络" data-logo="https://img.36krcdn.com/20210808/v2_0101d8f56a0440909a588f0efc6620b6_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/103663" target="_blank">量级网络</a>，特点是参数少、计算量小、推理时间短，在OCR、YOLO v3等任务上非常常见，具体结构长这样：</p> 
<p class="image-wrapper"><img data-img-size-val="1080,340" src="https://img.36krcdn.com/20220207/v2_97bb786f55f34cf9b24a102968bfe914_img_000" referrerpolicy="no-referrer"></p> 
<p>在推理时，Portrait matting首先将RGB图像和低分辨率的Alpha遮罩作为输入，用MobileNetV3来预测分辨率更高的Alpha遮罩。</p> 
<p>然后再利用一个浅层网络和一系列残差块，来进一步提升Alpha遮罩的精细度。</p> 
<p>其中，这个浅层网络更加依赖于低层特征，由此可以<a class="project-link" data-id="95377" data-name="得到" data-logo="https://img.36krcdn.com/20210807/v2_966db147ab4646ef82349f069ce61219_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/95377" target="_blank">得到</a>高分辨率的结构特征，从而预测出每个像素的Alpha透明度。</p> 
<p>通过这种方式，模型能够细化初始输入时的Alpha遮罩，也就实现了如上细节到头发丝的抠图效果。谷歌表示，神经网络Portrait matting可以使用Tensorflow Lite在Pixel 6 上运行。</p> 
<p class="image-wrapper"><img data-img-size-val="640,314" src="https://img.36krcdn.com/20220207/v2_37b98983f52a43ffa07590429c19f23c_img_000" referrerpolicy="no-referrer"></p> 
<p>此外，考虑到使用Alpha遮罩抠图时，背光太强往往会导致细节处理不好。</p> 
<p>谷歌使用了<strong>体积视频捕捉方案</strong>The Relightables来生成高质量的数据集。</p> 
<p>这是谷歌在2019年提出的一个系统，由一个球形笼子组成，装有331个可编程LED灯和大约100个用于捕获体积视频的摄像机。</p> 
<p>相比于一般的数据集，这种方法可以让人物主体的光照情况与背景相匹配，由此也就能呈现更为逼真的效果。</p> 
<p class="image-wrapper"><img data-img-size-val="639,426" src="https://img.36krcdn.com/20220207/v2_2c3e7a78702e45508cb179c9cfff66c5_img_000" referrerpolicy="no-referrer"></p> 
<p>而且这种方法还能满足人像被放置在不同场景中时，光线变化的需求。</p> 
<p class="image-wrapper"><img data-img-size-val="640,436" src="https://img.36krcdn.com/20220207/v2_8c32dc8ce0ba4ba58d08afabbe208ae9_img_000" referrerpolicy="no-referrer"></p> 
<p>值得一提的，谷歌还在这一方法中使用了监督学习的策略。</p> 
<p>这是因为神经网络在抠图上的准确度和泛化能力还有待提升，而纯人工标注的工作量又太大了。</p> 
<p>所以，研究人员利用标记好的数据集来训练神经网络，从而大量数据中来提高模型泛化能力。</p> 
<p class="image-wrapper"><img data-img-size-val="640,420" src="https://img.36krcdn.com/20220207/v2_99d05f2de7e944a7adb07f0780f3a691_img_000" referrerpolicy="no-referrer"></p> 
<h2><strong>One More Thing</strong></h2> 
<p>用算法来优化摄影效果，其实是谷歌的传统艺能了。</p> 
<p>比如Pixel 4中，就使用算法<a class="project-link" data-id="591302" data-name="来拍" data-logo="https://img.36krcdn.com/20210814/v2_dc3132f84ee944b5b5f179e43157f2cb_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/591302" target="_blank">来拍</a>摄星空。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,1279" src="https://img.36krcdn.com/20220207/v2_67a183cd4dfd46909594ae149966f8b4_img_000" referrerpolicy="no-referrer"></p> 
<p>HDR+算法更不必说，曾经引发过<a class="project-link" data-id="3969555" data-name="大众" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3969555" target="_blank">大众</a>热议。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,194" src="https://img.36krcdn.com/20220207/v2_b1016e8b9ab44eb7b1fcddfd9e0f5912_img_000" referrerpolicy="no-referrer"></p> 
<p>这一功能可以在相机启动时、没有按快门的情况下连续捕捉图像，并且会缓存最近保存的9张。这些照片将会与按下快门后的图像一并处理，最终得到一张最优的图像。</p> 
<p>同时它还能让Pixel在夜间模式下拍照时，不用像其他手机那样长时间停留。</p> 
<p>由于提升摄影效果不靠硬件，谷歌也将这些功能整合到一个APP上，适用于各种安卓手机。</p> 
<p>感兴趣的小伙伴，可以去试玩看看or分享自己的体验~</p> 
<p>参考链接：https://ai.googleblog.com/2022/01/accurate-alpha-matting-for-portrait.html</p> 
<p class="editor-note">本文来自<a class="project-link" data-id="3968527" data-name="微信" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968527" target="_blank">微信</a>公众号<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/venxQEKCgRgr2kSrMMVfow">“量子位”（ID:QbitAI）</a>，作者：明敏，36氪经授权发布。</p>  
</div>
            