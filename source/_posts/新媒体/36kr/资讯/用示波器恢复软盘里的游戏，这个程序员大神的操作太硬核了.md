
---
title: '用示波器恢复软盘里的游戏，这个程序员大神的操作太硬核了'
categories: 
 - 新媒体
 - 36kr
 - 资讯
headimg: 'https://img.36krcdn.com/20210524/v2_d988e9cb624d442fba8f6916b8b4a8fa_img_000'
author: 36kr
comments: false
date: Mon, 24 May 2021 03:28:51 GMT
thumbnail: 'https://img.36krcdn.com/20210524/v2_d988e9cb624d442fba8f6916b8b4a8fa_img_000'
---

<div>   
<p>编者按：本文来自<a class="project-link" data-id="3968527" data-name="微信" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968527" target="_blank">微信</a>公众号<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/b2kO244zDfR3SeSyK7U9Tg">“量子位”（ID:QbitAI）</a>，作者：鱼羊 萧箫，36氪经授权发布。</p> 
<p>又到了考（bao）验（lu）阅（nian）历（ling）的时候了。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,525" src="https://img.36krcdn.com/20210524/v2_d988e9cb624d442fba8f6916b8b4a8fa_img_000" referrerpolicy="no-referrer"></p> 
<p>盆友，你可识得此物？</p> 
<p>在80年代90年代，可是有不少宝贵的代码数据，都是存储在这样的载体之中的，比如DOS版的仙剑1。</p> 
<p class="image-wrapper"><img data-img-size-val="600,450" src="https://img.36krcdn.com/20210524/v2_b9e872573a2c4b51b4e440859ad47dfa_img_000" referrerpolicy="no-referrer"></p> 
<p>辣么，如果现在有一张存储古早代码的<strong>软盘</strong>到了你手里，你该如何解开其中的历史秘密？要知道，在今天，你可能连读取软盘的设备都很难找到……</p> 
<p>要是再磕了碰了，那就更完蛋了。</p> 
<p class="image-wrapper"><img data-img-size-val="221,228" src="https://img.36krcdn.com/20210524/v2_6e1944c396f7412e95cc1d24e1f0d8dc_img_000" referrerpolicy="no-referrer"></p> 
<p>最近，<strong>vsftpd</strong>作者、Google Project Zero创始人Chris Evans大佬就遇到了这样的难题：</p> 
<p>在和Phil Pemberton<a class="project-link" data-id="81906" data-name="一起" data-logo="https://img.36krcdn.com/20210518/v2_97476d1824c443389ec0dfa22d0d302a_img_000" data-refer-type="1" href="https://www.36dianping.com/space/4772100123" target="_blank">一起</a>恢复存储在软盘中的几个古早游戏代码时，他们发现，部分软盘出现了不同程度的损坏，以致于直接用<strong>Greaseweazle</strong>这样的设备是无法读取的。</p> 
<p class="image-wrapper"><img data-img-size-val="320,198" src="https://img.36krcdn.com/20210524/v2_e981ff40630343b5b24ce923efa596ac_img_000" referrerpolicy="no-referrer"></p> 
<p>怎么办？大佬决心要搞出一个船新的方案，抢救宝贵历史代码。</p> 
<p>设备也简单，就用万能的<strong>示波器</strong>。</p> 
<p>没错，就是那种用来测试电路、显示波形的仪器。</p> 
<p class="image-wrapper"><img data-img-size-val="888,588" src="https://img.36krcdn.com/20210524/v2_71462dc3311e4b8194f728bb3d71d454_img_000" referrerpolicy="no-referrer"></p> 
<p>恢复出来的游戏代码竟然还能玩，而且界面显示清晰：</p> 
<p class="image-wrapper"><img data-img-size-val="400,353" src="https://img.36krcdn.com/20210524/v2_a38478d68a5543d2839212ee2e464fb6_img_000" referrerpolicy="no-referrer"></p> 
<p>这波操作，看得网友直呼：数据考古不要太酷。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,146" src="https://img.36krcdn.com/20210524/v2_9712d9b133954dc7b3421dd272d0fcd5_img_000" referrerpolicy="no-referrer"></p> 
<h2><strong>手敲0和1，100%恢复古早代码</strong></h2> 
<p>软盘通常以<strong>模拟信号</strong>的方式存储数据。</p> 
<p>这里面存储的模拟信号，用的是最原始的<strong>FM调制</strong>（频率调制）。</p> 
<p>也就是说，它所存储的信号<strong>0</strong>和<strong>1</strong>，分别会以不同的波形频率表示。</p> 
<p class="image-wrapper"><img data-img-size-val="320,171" src="https://img.36krcdn.com/20210524/v2_fa78565bebe940c5a4f8aca720bb300d_img_000" referrerpolicy="no-referrer"></p> 
<p>以下面这段波形为例，单位周期下，在信号为0时，输出的频率是比较<strong>慢</strong>的；而当信号变成1时，频率就会突然变<strong>快</strong>。</p> 
<p class="image-wrapper"><img data-img-size-val="640,360" src="https://img.36krcdn.com/20210524/v2_b3922c0ef81a4b67b7d5658d05c9df8b_img_000" referrerpolicy="no-referrer"></p> 
<p>因此，只需要找到周期规律，就能判断一个周期里，信号代表的是0还是1。</p> 
<p>但也不能仅仅看峰值来判断信号是否为1。例如，在这个周期里，就出现了一个“<strong>假峰值</strong>”，然而人工解读的结果还是0。</p> 
<p class="image-wrapper"><img data-img-size-val="640,360" src="https://img.36krcdn.com/20210524/v2_5ab83bc1d2bb48539c2a7a30133b5712_img_000" referrerpolicy="no-referrer"></p> 
<p>因为这个峰值其实是一个噪音，信号的整体趋势仍然是下降的，波形的频率本质上并没有变化。（但信号为1时，波形会呈现一个完整的周期，起始点和终点的值是非常接近的）</p> 
<p>有网友给出了简单的判断方法：一个周期过去，如果信号值变化很大，则代表0；如果信号值几乎不变，则代表1。</p> 
<p class="image-wrapper"><img data-img-size-val="640,360" src="https://img.36krcdn.com/20210524/v2_e674b227a02a45d7b0c8af4372ac3fa3_img_000" referrerpolicy="no-referrer"></p> 
<p>据Chris Evans介绍，代表0的正弦<a class="project-link" data-id="217488" data-name="波信" data-logo="https://img.36krcdn.com/20201112/v2_1e0ce947f9614a67a3bce66231b6f948_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/217488" target="_blank">波信</a>号，是<strong>8μs</strong>一个周期；而代表1的正弦波信号，则是<strong>4μs</strong>一个周期。</p> 
<p>这种情况下，用Greaseweazle等“现代设备”直接读取数据，会出现一个问题。</p> 
<p>如果软盘中的数据，由于各种<strong>外部原因</strong>（时间久远、使用次数过多）出现了损坏，那么仅凭机器，是无法从这些带有大量噪音的数据中完成解读的。</p> 
<p class="image-wrapper"><img data-img-size-val="640,351" src="https://img.36krcdn.com/20210524/v2_e30e4e11f9944c0c90564c9876673120_img_000" referrerpolicy="no-referrer"></p> 
<p>但人却可以轻易看出这些数据中的“规律”，从而判断信号的状态。</p> 
<p>因此，用示波器将软盘中传输的模拟信号展示出来，再由人工进行解读，会是个更好的方法。</p> 
<p>于是Evans和Pemberton将示波器直接连上了软盘驱动器的<strong>测试点</strong>，看看软盘到底都输出了些什么信号。</p> 
<p>其中，输入信号会呈现<a class="project-link" data-id="533604" data-name="一正" data-logo="https://img.36krcdn.com/20210322/v2_252642325c1e42d2808f9b336d239a63_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/533604" target="_blank">一正</a>一负两个波形，用来消除一部分噪声。</p> 
<p class="image-wrapper"><img data-img-size-val="480,640" src="https://img.36krcdn.com/20210524/v2_84c80cc067d94f458fbc2486ff2ba3a0_img_000" referrerpolicy="no-referrer"></p> 
<p>从各种“年代久远”的软盘解读出的信号来看，难怪Greaseweazle这些设备读不出来……（连人也得仔细分辨一会儿）</p> 
<p class="image-wrapper"><img data-img-size-val="448,559" src="https://img.36krcdn.com/20210524/v2_352be4299f634ea69bacf246bfd7459e_img_000" referrerpolicy="no-referrer"></p> 
<p>接下来，就是处理这些神奇的波形了。</p> 
<p>为了更好地处理噪音、绘制信号图像，Evans和Pemberton还用上了<strong>Audacity</strong>来处理模拟信号。</p> 
<p>Audacity是一个免费开源的音频分析和编辑工具，能够快速放大和检查波形，还具有多功能低通滤波器，以及直接绘图的功能。</p> 
<p class="image-wrapper"><img data-img-size-val="891,570" src="https://img.36krcdn.com/20210524/v2_2c1ad9f9dc5f413a9134afbf8a712f5d_img_000" referrerpolicy="no-referrer"></p> 
<p>另外，Audacity也支持CSV文件的导入。</p> 
<p>Evans和他的小伙伴还利用这样的音频工具搞出了新的衍生玩法……</p> 
<p>比如将速度放慢100倍，听一听软盘记录的声音（软盘每转一次时间为0.2秒，该样本为20秒）：</p> 
<p>恢复出来的数据，效果还不错。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,305" src="https://img.36krcdn.com/20210524/v2_7120173cf1e24b33b02435c345f89898_img_000" referrerpolicy="no-referrer"></p> 
<p>但上面这些，还只能用于数据比较正常的信号。</p> 
<p>对于软盘本身有轻微损坏的信号，想要恢复就变得更困难了。</p> 
<h2><strong>软盘坏了怎么办？</strong></h2> 
<p>要是软盘上有划痕，这部分的信号就会变得非常难以辨认。</p> 
<p class="image-wrapper"><img data-img-size-val="300,400" src="https://img.36krcdn.com/20210524/v2_6803b9acee4646e3891905747ae46a8d_img_000" referrerpolicy="no-referrer"></p> 
<p>这是Evans和Pemberton还原的其中一个<strong>凹痕</strong>的信号，显然中间那部分，信号振幅（图中信号的强度）丢失得非常厉害，还自带<strong>噪音</strong>。</p> 
<p class="image-wrapper"><img data-img-size-val="640,351" src="https://img.36krcdn.com/20210524/v2_37beaad6404c4edba26403aa2bd2cec2_img_000" referrerpolicy="no-referrer"></p> 
<p>其中一种方法是，多用几种不同的软盘驱动器试试。</p> 
<p>先用MF504C软盘驱动器过滤一下噪音：</p> 
<p class="image-wrapper"><img data-img-size-val="640,351" src="https://img.36krcdn.com/20210524/v2_c821119861c94e9284450982a9caa87f_img_000" referrerpolicy="no-referrer"></p> 
<p>好像效果不大。</p> 
<p>换上另一个TEAC软盘驱动器后，显示的信号更加给力了，但强度还是很小：</p> 
<p class="image-wrapper"><img data-img-size-val="640,351" src="https://img.36krcdn.com/20210524/v2_67598a64e94345d39f699a1dd56880dc_img_000" referrerpolicy="no-referrer"></p> 
<p>用肉眼分辨的话，难度还是太高了。</p> 
<p>鉴于此，Evans和Pemberton又换上了TEC软盘驱动器，效果好多了，峰值也变得清晰可辨。</p> 
<p class="image-wrapper"><img data-img-size-val="640,351" src="https://img.36krcdn.com/20210524/v2_52db1a6556a14facb72a996674403635_img_000" referrerpolicy="no-referrer"></p> 
<p>除此之外，应对这类信号振幅丢失的情况，还有另一种方法：手工绘制修复。</p> 
<p>由于峰值缺失得实在太厉害，只能通过<strong>人为修复</strong>，绘制部分峰值信号，来解决强度过低的问题。</p> 
<p class="image-wrapper"><img data-img-size-val="640,360" src="https://img.36krcdn.com/20210524/v2_ea5872748cb24933be9190194546b951_img_000" referrerpolicy="no-referrer"></p> 
<p>但无论如何，这些信号都可以被修复。</p> 
<p>据作者介绍，上面这些办法<strong>100%</strong>可以恢复软盘中的数据。</p> 
<p>除非真的出现了不可抗力。</p> 
<p>例如，软盘的一部分被损坏得很彻底：</p> 
<p class="image-wrapper"><img data-img-size-val="300,400" src="https://img.36krcdn.com/20210524/v2_0a587a93c2f047749a1d9370e10f2613_img_000" referrerpolicy="no-referrer"></p> 
<p>这种情况下，软盘数据就彻底没办法恢复了。</p> 
<p>所以，家里有“上古宝物”的小伙伴，一定要保护好自己的软盘！</p> 
<h2><strong>关于作者</strong></h2> 
<p>这个项目的作者之一，是最受欢迎的Linux发行版FTP服务器程序<strong>vsftpd</strong>作者、著名黑客<strong>Chris Evans</strong>。</p> 
<p>他毕业于牛津大学，毕业后进入甲骨文工作，其后又在<a class="project-link" data-id="3968996" data-name="谷歌" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968996" target="_blank">谷歌</a>工作了9年时间，是Chrome浏览器安全团队和谷歌黑客团队Project Zero的创建者。</p> 
<p>据报道，Project Zero团队由谷歌内部顶尖安全工程师组成，使命是找出全球范围内高价值的安全漏洞，并将其彻底消除。</p> 
<p>2015年，<a class="project-link" data-id="132410" data-name="特斯拉" data-logo="https://img.36krcdn.com/20200729/v2_e76e3d3d44c440138f072b13bc84a6dc_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/132410" target="_blank">特斯拉</a>把这位黑客大神揽入麾下，负责领导安全工作。2016年，Evans从特斯拉离职。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,540" src="https://img.36krcdn.com/20210524/v2_d999332f94594b07aa5010ce3c1ced4b_img_000" referrerpolicy="no-referrer"></p> 
<p>Evans还是漏洞赏金平台HackerOne的成立顾问。</p> 
<p>现在，据老哥自己说，他处在“半退休”状态。</p> 
<p class="image-wrapper"><img data-img-size-val="948,450" src="https://img.36krcdn.com/20210524/v2_606192c7c9694fa8a38cdadbca271404_img_000" referrerpolicy="no-referrer"></p> 
<p>最后的最后，你是否也对80年代的游戏代码长啥样产生了好奇？</p> 
<p>Evans表示，这些恢复出来的源代码已经交给游戏原作者，是否开源就要看原作者的意思了，如果你感兴趣，不妨蹲个后续~</p> 
<p>不过，此前<a class="project-link" data-id="397416" data-name="量子位" data-logo="https://img.36krcdn.com/20200729/v2_ac002e38e2904e0280dae679728d9e3e_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/397416" target="_blank">量子位</a>还介绍过另一个<a target="_blank" rel="noopener noreferrer" href="http://mp.weixin.qq.com/s?__biz=MzIzNjc1NzUzMw==&mid=2247547745&idx=1&sn=f36efea34b4e1ef70cff7a5d6ee4094a&chksm=e8d08c13dfa7050595d8992eb323de08c410f27d50476d28786c2387b398754a128581c380ba&scene=21#wechat_redirect">从21张软盘中被“抢救”出来的红白机游戏</a>，代码已在GitHub上开源：</p> 
<p>https://github.com/DickBlackshack/Days-of-Thunder-NES-Unpublished/</p> 
<p>参考链接：[1]https://scarybeastsecurity.blogspot.com/2021/05/recovering-lost-treasure-filled-floppy.html [2]https://news.ycombinator.com/item?id=27187435</p>  
</div>
            