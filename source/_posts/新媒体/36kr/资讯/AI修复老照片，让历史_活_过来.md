
---
title: 'AI修复老照片，让历史_活_过来'
categories: 
 - 新媒体
 - 36kr
 - 资讯
headimg: 'https://img.36krcdn.com/20210712/v2_4ef4287e09494f40bea5beef11a0731c_img_000'
author: 36kr
comments: false
date: Mon, 12 Jul 2021 01:19:01 GMT
thumbnail: 'https://img.36krcdn.com/20210712/v2_4ef4287e09494f40bea5beef11a0731c_img_000'
---

<div>   
<p>本文来自<a class="project-link" data-id="3968527" data-name="微信" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968527" target="_blank">微信</a>公众号<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/sH8ZfxN8YI6kzhnK0ZWH3w">“光锥智能”（ID:guangzhui-tech）</a>，作者：陈思，编辑：罗宁，36氪经授权发布。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,613" src="https://img.36krcdn.com/20210712/v2_4ef4287e09494f40bea5beef11a0731c_img_000" referrerpolicy="no-referrer"></p> 
<blockquote> 
 <p>牺牲的烈士，露出微笑、用温柔的目光看着今日之中国......</p> 
 <p>已故的亲人，用慈祥的笑容看着儿孙们幸福的生活......</p> 
 <p>利用人工智能技术，不仅能让黑白照片彩色化，甚至可以让静态人物动起来。这在技术界早已不是什么新鲜事，但最近有了不少新的用武之地。</p> 
</blockquote> 
<p>在龙华烈士墓前，</p> 
<p>摆满了鲜花，</p> 
<p>延年和李大钊相遇了。</p> 
<p>他们的对话令人动容：</p> 
<p>“先生，他们爱我”</p> 
<p>“延年，因为你爱他们”</p> 
<p>这是一位网友在观看电视剧《觉醒年代》之后写的一段纪念先烈的文章节选。相信看过此剧的人都会对剧中陈独秀的两个儿子陈乔年、陈延年就义前的微笑印象深刻。</p> 
<p class="image-wrapper"><img data-img-size-val="650,356" src="https://img.36krcdn.com/20210712/v2_8e469caf51fa4cfd8201dc3d3b4fd0e4_img_000" referrerpolicy="no-referrer"></p> 
<p>这一幕的出现让无数观众落泪。</p> 
<p>为了纪念烈士，有人找到了陈延年烈士真实的照片，利用人工智能技术为照片上色，并让他露出“真实的”微笑：</p> 
<p class="image-wrapper"><img data-img-size-val="1080,451" src="https://img.36krcdn.com/20210712/v2_bf65a33101c347428a0a8db3a6e286fa_img_000" referrerpolicy="no-referrer"></p> 
<p>有网友在看到这张照片后说：当百年前就义的烈士看到今日之中国，想必也会这样欣慰地微笑吧。</p> 
<p>使用AI修复烈士照片的这位网友名叫“大谷Spitzer”，你或许曾看过他的一些其他修复作品：</p> 
<p class="image-wrapper"><img data-img-size-val="1080,571" src="https://img.36krcdn.com/20210712/v2_4fa783421d92449484de584631cb82d3_img_000" referrerpolicy="no-referrer"></p> 
<p>他曾经修复过李大钊于1924年9月22日在莫斯科大剧院演讲时的影像，这也是李大钊同志目前唯一留存的视频录像，相当珍贵。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,709" src="https://img.36krcdn.com/20210712/v2_38fc95266f6e41019d2e20d5b3cbec7c_img_000" referrerpolicy="no-referrer"></p> 
<p>从视频截图可以看出，经过AI修复的影像不仅清晰度高，对<a class="project-link" data-id="3969467" data-name="人物" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3969467" target="_blank">人物</a>细节的渲染也十分到位，比如上图中李大钊同志的头发与胡须的细节，在AI修复后显得非常细致。</p> 
<p>可能你会有疑问，大谷是如何做到的？或者说，AI技术是如何让原本黑白的影像变得鲜活起来？</p> 
<h2>AI如何给老照片上色？</h2> 
<p>照相技术诞生之初，照片都是黑白的，到了1940年代彩色照片才流行起来。所以在早些年如果你想将黑白照片变成彩色，需要手工进行，费时费力。因为当时用的是水彩、油画、蜡笔产色，所以起来并不是那么真实。</p> 
<p>如今，人工智能技术大行其道，甚至可以毫不费力地完成这项工作。</p> 
<p>17岁英国少年Finnian Anderson和18岁芬兰少年Oli Callaghan携手合作，开发了Colorise Bot，用户只需要在Twitter上传照片和视频并@Colorise Bot，就能在几秒内上色。</p> 
<p class="image-wrapper"><img data-img-size-val="839,472" src="https://img.36krcdn.com/20210712/v2_2d4900ba691b4e14bcccbcba5925eee1_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">（原图与修复后地效果 | 来源：原作者博客）</p> 
<p>作者之一的Finnian Anderson在博客上的一篇文章揭示了这项技术背后的秘密。</p> 
<p>受内存及性能限制，他们没有选择TensorFlow进行底层框架搭建，而是使用Caffe<a class="project-link" data-id="66172" data-name="E搭" data-logo="https://img.36krcdn.com/20200729/v2_df004eae95af4f8dadcd633d9981afdc_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/66172" target="_blank">e搭</a>建了原始网络，然后用开源数据集ImageNet中的图像对模型进行训练。</p> 
<p>根据他们发布在GitHub上的内容可以知道，他们引用的是加州伯克利大学的 Richard Zhang 等人开发出来的着色方法。其原理简单来说，就是给出一张黑白图片，然后预测图片上物体可能的颜色，不一定能完全还原物体本身的颜色，但合理即可。</p> 
<p>比如苹果，红色、青色都是人们普遍认知里合理的颜色，在训练过程中，如果模型给苹果上色的结果是这两种或者与之接近的，那么都可视为成功。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,281" src="https://img.36krcdn.com/20210712/v2_f00d56ca0f6549a185355900335bb810_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">（训练结果 | 来源：原作者GitHub）</p> 
<p>当然，模型对物体颜色的预测也是被大量的图片数据“喂”出来的，就比如上图中的汽车，原本的颜色可能是蓝色或者黑色，但是因为模型在识别了大量汽车的图片后学会了汽车可以有红色、黑色、白色、银色等等，因此给上图里的汽车染成红色也是合理的。</p> 
<p>不过，大谷使用的开源AI上色项目有别于上面这一种。</p> 
<p>根据大谷的<a class="project-link" data-id="38685" data-name="微博" data-logo="https://img.36krcdn.com/20210302/v2_f2cb7018ead34f4f9712a4e4fe4fc982_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/38685" target="_blank">微博</a>，它使用的上色工具有两种：DeOldify和Deep Exemplar-Based Colorization。虽然都可以用来上色，但是这两种工具的原理有所不同。</p> 
<p>前者使用的是一种名为NoGAN的新型GAN训练方法。大致的原理可以理解为，同时训练两个神经网络，一个叫鉴别器，另一个叫生成器。鉴别器会使用大量真实的彩色图片训练，而生成器则会根据输入的黑白图像随意上色，鉴别器根据学会了的彩色图片来判断上色的真实性。</p> 
<p>比如，鉴别器学会了树叶可以是绿色的、黄色的、红色的，干枯后可以是黑色的；这个时候生成器给一张树叶图片染成了蓝色，那鉴别器就会判断这个结果是假的，生成器要重新给图片上色，直到出现合理的色彩。</p> 
<p>而后者的原理就相对简单了，给定参考彩色图像，卷积神经网络会直接将灰度图像映射到输出彩色图像。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,135" src="https://img.36krcdn.com/20210712/v2_1bc4edb595394cab849ae75e7916264c_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">（图片来源：Deep Exemplar-Based Colorization论文）</p> 
<p>如上图所示，目标图像是最左边的黑白图像，如果给神经网络一个穿红衣服的女士的图像为参考，那么输出的结果里，人物的衣服颜色也是红色，肤色甚至也会更接近参考图像人物的肤色。</p> 
<p>由于大谷的图像、视频修复里采用了不止一种<a class="project-link" data-id="4262185" data-name="开源项目" data-logo="https://img.36krcdn.com/20210603/v2_43fe3145b6494227bd8db07dcdc0147b_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/4262185" target="_blank">开源项目</a>，因此本文对于其原理就不做过多分析了，上述结论想必已经能够部分解答读者们的疑问。</p> 
<p>此外，大谷还采用了一些开源的辅助工具，比如<a class="project-link" data-id="306899" data-name="旷视" data-logo="https://img.36krcdn.com/20210712/v2_96aedf8b92bd433db13a6655b37fcf58_img_000" data-refer-type="1" href="https://www.36dianping.com/space/4877100103" target="_blank">旷视</a>科技和北大共同推出的，用来给视频补帧的RIFE，它可以让老视频变得更加流畅；以及用于去除视频噪点和模糊的BasicSR等等。</p> 
<h2>AI还原的色彩准确吗？</h2> 
<p>如前文所述，AI修复的图像色彩只是“合理”，未必与真实的情况相符。不过，这也并不耽误AI还原色彩对历史学家的帮助。</p> 
<p>爱尔兰国立大学教授John Breslin和Sarah-Anne Buckley将数字技术与历史研究结合在<a class="project-link" data-id="81906" data-name="一起" data-logo="https://img.36krcdn.com/20210709/v2_647b9860d6f7437caf1be2501d37698a_img_000" data-refer-type="1" href="https://www.36dianping.com/space/4772100123" target="_blank">一起</a>，他们将很多历史照片由黑白变成彩色。教授们使用的AI工具是前文提到的DeOldify，在训练时，DeOldify会分析大量普通彩色照片，看看各种颜色与不同的形状、纹理是如何匹配的。</p> 
<p>当软件面对黑白照片时，它会努力搞清对象的颜色是什么，比如草、树、海洋的颜色，根据纹理判定它们是绿色或者蓝色。</p> 
<p>当然AI也<a class="project-link" data-id="4261660" data-name="有局" data-logo="https://img.36krcdn.com/20210512/v2_7e3f7a1913a54fda8beea2de0166c8f0_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/4261660" target="_blank">有局</a>限性，爱尔兰的一草一木有自己的特质，美国软件有时无法正确识别。</p> 
<p class="image-wrapper"><img data-img-size-val="571,322" src="https://img.36krcdn.com/20210712/v2_8647db4a42c4438092f66d11e21ac6ec_img_000" referrerpolicy="no-referrer"></p> 
<p>Breslin解释说，世界许多地区的房屋可能铺有陶瓦，呈现橙色或褐色，爱尔兰一般用石板瓦，呈现灰色或者黑色。此时，同为历史学者的Sarah-Anne Buckley就会参与进来，手动修正颜色和阴影。</p> 
<p>Constance Markievicz是爱尔兰历史上比较有名的政治家，他的眼睛到底是什么颜色呢？AI无法判断。怎么办？1890年代至1950年代，曾有很多移民前往美国，Constance Markievicz是其中之一，历史学家查看纽约埃利斯岛留下的乘客纪录，断定眼睛的颜色是蓝色。</p> 
<p>即使学者们如此严肃，还是有很多同行不认可，他们认为像DeOldify这样的软件只是带来误导，不能增强照片效果。Breslin并不认同，他认为自从有摄影以来人们一直就在做同样的探索，而且即使用AI上色也并不是想取代原照片。</p> 
<p>Jordan Lloyd是一名视觉历史学家，他为出版商、私人客户提供服务，给老照片上色，不过不是用计算机上色。虽然AI也能完成同样的工作，但无法达到Jordan Lloyd的要求。他说：“诺曼底纪念活动时，我曾发布一张照片，将登陆D-Day登陆的照片变成彩色。History Channel也曾展示照片，自动着色，虽然是同一张照片，但看起来很糟糕。” DeOldify、DeepAI和Algorithmia能在几秒内将黑白照片变成彩色，Jordan Lloyd却要花几十个小时才能处理一张照片。</p> 
<p>对于Jordan Lloyd来说AI不足为惧，因为它老是出错，颜色不准确。更糟糕的是连计算机专家也不明白AI为何会出错。DeOldify联合创始人Jason Antic指出：“这是一个‘黑盒’，AI从数据中抽取任何可能的规则。”</p> 
<p class="image-wrapper"><img data-img-size-val="571,322" src="https://img.36krcdn.com/20210712/v2_caef16f97f074cbaa44aaa52a4ca651c_img_000" referrerpolicy="no-referrer"></p> 
<p>DeOldify算是很先进的，它用一百万张黑白照片训练过，这些黑白照是从彩照转化而来的。尽管如此，DeOldify还是错误连连，部分是因为灰度图缺乏彩色照片独有的关键数据。</p> 
<p>前文提到的论文作者，来自加州伯克利大学研究人员Richard Zhang说：“着色实际上是很有难度的，因为我们要从1D转到3D。”色相，饱和度和亮度决定了我们对彩色的感知，但灰度图里只有亮度。许多不同的颜色可能有相同的亮度，即使它们在现实中非常不同，在黑白照片中也会呈现出相同的灰度。</p> 
<p>为了解决这一问题，计算机专家尝试用对象识别软件增强算法。Richard Zhang说：“对于照片的某些部分，我们可以确定颜色是什么。例如，我们知道天空一般是蓝色的，蔬菜是绿色的，山一般是褐色的。如果不确定，比如衬衫的颜色，上色系统就只能猜测。”</p> 
<p>正因如此，Jason Antic并不认为AI会成为研究历史的重要工具。他认为，图片的色彩与时间、地点、环境都有关，这些AI不太可能知道。</p> 
<p><a class="project-link" data-id="3968996" data-name="谷歌" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968996" target="_blank">谷歌</a>机器学习专家Emil Wallner倒是乐观一些，他认为最终AI能做到准确识别。他在邮件中回复称：“最难的部分在于开发一个机器学习模型，它能识别图片中的图案，它要寻找相关联的历史信息并推理，看看是否可以利用信息来判断照片中某物的颜色。”Emil Wallner相<a class="project-link" data-id="114052" data-name="信开" data-logo="https://img.36krcdn.com/20201106/v2_6f52a9a7891e4abaa843bcba19d0c1f3_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/114052" target="_blank">信开</a>发这样的算法是可能的，只是要提供一些环境信息给AI。</p> 
<p>所以说，用AI给黑白照片上色很有趣，但离完美还很遥远。</p> 
<h2>AI如何让老照片动起来的？</h2> 
<p>搞明白了上色的原理，那如何让静态照片动起来呢？</p> 
<p>说到这里就不得不提到一家名为MyHeritage的公司。</p> 
<p>当用户进入MyHeritage网站并上传照片后，MyHeritage Photo Enhancer会增强照片，然后让它动起来，动画中的人物甚至可以微笑、眨眼、移动。</p> 
<p class="image-wrapper"><img data-img-size-val="440,440" src="https://img.36krcdn.com/20210712/v2_da522e7d0a3f47a89faf9063f4b348d1_img_000" referrerpolicy="no-referrer"></p> 
<p>（光锥智能笔者用自己的照片测试的结果）</p> 
<p>据了解，该网站采用的是一种名叫Deep Nostalgia的技术，它能让静态照片中的人移动起来，就像视频一样。</p> 
<p>有意思的是，这家公司本身是做基因检测技术的，但为什么会忽然做起来动态老照片的活计？</p> 
<p>或许MyHeritage创始人、CEO Gilad Japhet能解答，他说：“使用Deep Nostalgia技术，看到珍贵的家族照片活起来，你会发出惊叹。看到祖先的脸在视频动画中活起来，你会忍不住遥想当年他们在现实中是怎样的，这样你与家族历史就能以新的方式联系起来。”</p> 
<p>不过遗憾的是，Deep Nostalgia并不是一项开源技术，目前在MyHeritage网站也只能免费试用5张图片，我们在这里无法深度解答它作用的原理。</p> 
<p>但是根据一些网友的分析，Deep Nostalgia极有可能脱胎于曾经在网络上风靡一时，且最终臭名昭著的深度换脸开源模型：DeepFake。</p> 
<p>DeepFake火爆的源头是有人利用这项技术，将《神奇女侠》女主角盖尔加朵的脸，换成了某色情片女主角的脸，并上传到了互联网。</p> 
<p>当时大多数网友对这项技术的态度是：坚决抵制！因为它对于人们的隐私造成了非常大的威胁，甚至后来一度发生过有人利用DeepFake和AI语音合成伪造政坛高管发言的案件。</p> 
<p>说回DeepFake的技术原理，整个流程分为三部：数据提取、训练、合成。</p> 
<p>还是以前面盖尔加朵的案例讲解。可以简单理解为，模型先从别的视频、图像里把盖尔加朵的脸“抠”出来，据说这个模型会给人脸标记36个关键点坐标，根据这些坐标能计算人脸的角度，最终抠出来的人脸是摆正后的人脸。</p> 
<p>然后再根据算法，对人脸进行各种角度的变换和扭曲，以适配最终合成的角色的脸，最后融合到目标图像或视频里。当然，这其中还有更复杂的技术细节，这里就不再多赘述了。</p> 
<p>如果Deep Nostalgia确实脱胎于DeepFake，那么其背后的技术原理应该不会有太大差别，只希望MyHeritage等拥有同样技术的公司能够将它用在正道，不要重蹈DeepFake的覆辙。</p> 
<h2>AI修复老照片不只带来感动</h2> 
<p>今年父亲节，一位网友给自己的父亲送上了一份特殊的礼物。</p> 
<p>他通过<a class="project-link" data-id="28215" data-name="百度" data-logo="https://img.36krcdn.com/20210325/v2_fa02010c4a8b46da9f4e1d3b1fd59f22_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/28215" target="_blank">百度</a>飞桨PaddleGAN生成对抗网络复原了爷爷的动态老照片，并实现了微笑、眨眼等各种表情，仿佛在与儿子交流，诉说这些年的思念，弥补了父亲没能见到爷爷最后一面的遗憾。</p> 
<p class="image-wrapper"><img data-img-size-val="585,897" src="https://img.36krcdn.com/20210712/v2_391c14a24af4453ab2d1c2d6e9daf57c_img_000" referrerpolicy="no-referrer"></p> 
<p>在国外的社交平台上，也有网友用类似的技术修复已过世的亲人的照片，同样带来了满满的感动。</p> 
<p class="image-wrapper"><img data-img-size-val="214,310" src="https://img.36krcdn.com/20210712/v2_0e4a256ce3bb47acac15773247a84f10_img_000" referrerpolicy="no-referrer"></p> 
<p>正如Gilad Japhet所说，当我们看到肤色鲜艳、表情生动的革命先烈，或者已故的家族长辈以这样的方式出现在我们面前时，我们对他们的怀恋会更深一层，与他们的联系也仿佛更加紧密了一些。</p> 
<p>科技如何向善？或许这是一种正确的打开方式。</p> 
<p>参考资料：</p> 
<p>https://www.digitaltrends.com/features/colorize-bot-twitter/</p> 
<p>https://www.usatoday.com/story/tech/2021/02/25/deep-nostalgia-technology-animates-faces-still-photos/6814516002/</p> 
<p>https://www.cnn.com/style/article/old-ireland-color-photos-breslin/index.html</p> 
<p>https://scienceline.org/2021/01/ai-cant-color-old-photos/</p>  
</div>
            