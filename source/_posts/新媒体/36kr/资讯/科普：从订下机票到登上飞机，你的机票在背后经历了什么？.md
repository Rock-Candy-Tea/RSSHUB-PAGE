
---
title: '科普：从订下机票到登上飞机，你的机票在背后经历了什么？'
categories: 
 - 新媒体
 - 36kr
 - 资讯
headimg: 'https://img.36krcdn.com/20210709/v2_7146a01e346e4f93b6e0e575a24652ec_img_000'
author: 36kr
comments: false
date: Fri, 09 Jul 2021 05:11:05 GMT
thumbnail: 'https://img.36krcdn.com/20210709/v2_7146a01e346e4f93b6e0e575a24652ec_img_000'
---

<div>   
<p>本文来自<a class="project-link" data-id="3968527" data-name="微信" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/3968527" target="_blank">微信</a>公众号<a target="_blank" rel="noopener noreferrer" href="https://mp.weixin.qq.com/s/TlEy_BJY3biF1YDM1HpsBg">“少数派”（ID:sspaime）</a>，作者：蔡菜寀，36氪经授权发布。</p> 
<p>在电视剧里，我们经常看到霸道总裁临时决定明天出行行程，在电话里跟秘书说一句：「帮我订一张明天的机票」；在工作中，我们时常也面临帮上司同事预定出行机票的情况；在生活中，全家出行一人订票更是家常便饭。</p> 
<p>那你有没有想过，在手机上打开<a class="project-link" data-id="559149" data-name="携程" data-logo="https://img.36krcdn.com/20200916/v2_811751a081924fa9af8741ce120bd7bf_img_png" data-refer-type="2" href="https://36kr.com/projectDetails/559149" target="_blank">携程</a>或航司们的 app，选择航班订购机票完成值机这<a class="project-link" data-id="93490" data-name="一气呵成" data-logo="https://img.36krcdn.com/20210601/v2_bc3fa050af9c4923b54d612533942dfe_img_000" data-refer-type="1" href="https://www.36dianping.com/space/4832500024" target="_blank">一气呵成</a>的操作背后，到底是怎样一套运行机制？</p> 
<p>它复杂吗？为什么 app 总是告诉我余票充足，而不告诉我这架飞机到底剩几个位置呢？为什么网上值机总会有一大堆灰色的不可选座位，但上机之后空空落落，只有中间几排坐了人？</p> 
<p>如果你有这些疑问，那这篇文章将一一作出解答。</p> 
<h2>购买机票的实际过程，其实并不简单</h2> 
<p>如果你需要登机，你就需要一张机票，这毋庸置疑。</p> 
<p>如果你是一个空中<a class="project-link" data-id="109309" data-name="飞人" data-logo="https://img.36krcdn.com/20200729/v2_7fd85869931247589f830aae98687575_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/109309" target="_blank">飞人</a>，你就会发现不同机场的纸质机票虽然有着不同的布局、不同的 logo、不同的背部广告等，但正面展示的信息基本相同，我们暂且认为这是旅客在机场完成值机、行李托运、安检、登机等一系列手续所需的基本信息，以不同的布局、不同的格式展现在这种不大不小的长方形卡纸上。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,675" src="https://img.36krcdn.com/20210709/v2_7146a01e346e4f93b6e0e575a24652ec_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">常见的纸质登机牌示意图</p> 
<p>那么，这些信息是否都必要呢？</p> 
<p>随着民航无纸化业务的普及，人们渐渐发现，很多业务的办理只需要票号、身份证就可以办理，比如值机或者行李托运，那么纸质登机牌上这些信息到底是为了什么呢？</p> 
<p>实际上，负责任的说，纸质登机牌上的明文信息更多是方便乘客去核对个人信息，找到对的登机口，找到对的座位号，除此之外，所有业务需要的信息，实际上都藏在登机牌角落里那不起眼的条形码或二维码里。</p> 
<p>要了解这个，我们就要谈谈机票业务的数据流转。</p> 
<h2>你买票的时候，到底发生了什么？</h2> 
<p>要了解买票的流程，你首先得明白一个航司内部的基础概念，叫做 GDS，全称 Global Distribution System，即「全球分销系统」。从名字你就能明白，这是一个大规模的销售网络系统，而在中国，这个系统叫做中航信（TravelSky）。</p> 
<p class="image-wrapper"><img data-img-size-val="507,377" src="https://img.36krcdn.com/20210709/v2_07defe5793a44e52af47aaed07d05c48_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">GDS 系统示意图，图片来自 travelpd.com</p> 
<p>目前来说，GDS 系统的运行方式，主要分为三部分，而大部分旅客购票时发生的信息流转，都跟这三个部分密切相关：</p> 
<ul> 
 <li>代理人机票销售系统 CRS，全称 Computer Reservation System。CRS 的作用在于由代理人（如携程、去哪儿等大型 OTA 及各个城市的小型代理人等）提供航班情况查询、航段销售、产品销售、订座记录查询、客票预定等功能，你在携程、去哪儿的购票行为，均跟 CRS 相关，由它们向相关航司统一提供旅客数据，完成预定过程。</li> 
 <li>航司订座系统 ICS，全称 Inventory Control System，ICS 向代理人和自营渠道提供作为控制、航班排期、运价或收益、航空联盟、销售控制等参数。</li> 
 <li>离港控制系统 DCS，全称 Departure Control System，主要控制旅客值机、航班配载、航班数据控制、登机联程等信息服务。</li> 
</ul> 
<p>你从 CRS 购票，CRS 会向 ICS 请求航<a class="project-link" data-id="110544" data-name="班信" data-logo="https://img.36krcdn.com/20200729/v2_49a6a9d51635461dba006e33965cc6d8_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/110544" target="_blank">班信</a>息，并随后传输你的订座信息给 ICS，而在航班初始化之后，你的数据会从 ICS 流转到 DCS，并由 DCS 完成最后的值机、登机等流程。</p> 
<p class="image-wrapper"><img data-img-size-val="490,283" src="https://img.36krcdn.com/20210709/v2_bbfd9a28932940758e53b1f099b87ffc_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">航空 GDS 系统示意图，图片来自 https://xueqiu.com/7392384735/42623778</p> 
<h2>在你起飞前，其实发生过很多事</h2> 
<p>人们说实践出真知，让我带你们走一遍从购票到值机，最后登机的全流程，你们就会发现实际上从订票到起飞，一切都没看起来这么简单。</p> 
<p>让我们从 CRS 端开始，当你在航空公司网站、app 或者第三方机票平台输入你想要查询的航班——比如「上海到北京，2021 年 6 月 15 号的机票」——点击搜索，这时候，CRS 会向 ICS 发送一个查询指令，这个指令一般是 AV（Availability 的缩写），格式为 AV SHAPKX/15JUN/0000/D。</p> 
<p>其中，SHA 是上海虹桥机场的三字码，PKX 是北京大兴机场的三字码，这套三字码系统是国际通用的 IATA 三字码标准，用来区分具体机场的不同（比如上海还有一个浦东机场为 PVG，而北京首都机场是 PEK）。在前端页面为了用户方便，一般会让用户输入上海这个城市，同时查出 SHA 和 PVG 分别到 PEK 和 PKX 信息，组合返回，并在航班列表页面标识出来。</p> 
<p>这时候，ICS 会返回航班列表以及对应的舱位等级和剩余数量。这里有个很有意思的点：如果剩余舱位数量小于 10，则会给出具体的数字，比如 1、2、3 等。但如果舱位充足，则会用 A 代替，这就是为什么你有时候查询只会看到「余票充足」四个字，那说明这个舱位的剩余数量超过了 9。至于实际数字是多少，CRS 也不知道。</p> 
<p>在你输入了个人信息并确认购票时，ICS 会获得你的姓名、证件号、联系方式等，并将航班信息和你的个人信息写入档案，返回给你一个档案编码，这个编码就是民航人员常说的 PNR（Passenger Name Record，即「个人信息记录」），并通过 PAT 指令生成运价信息，确认购票后，你就<a class="project-link" data-id="95377" data-name="得到" data-logo="https://img.36krcdn.com/20200929/v2_fcdf767846d041309970adf0877fc666_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/95377" target="_blank">得到</a>了我们常说的 13 位票号。至此，你的购票过程就成功了。</p> 
<p class="image-wrapper"><img data-img-size-val="595,626" src="https://img.36krcdn.com/20210709/v2_44b78e1301a74819aac144c180d0abb3_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">常见的 PNR 数据，图片来自 https://ask.qyer.com/question/3478273.html</p> 
<p>通常来说，13 位票号是不会重复的，因此在隐私保护协议中，票号会作为重要隐私保护。理论上来讲获得了票号，就能获得你的行程信息、个人信息，一旦泄露是十分危险的事情。PNR 则比较有趣，由于 PNR 只有六位，在目前全国旅客这么多的情况下，就算是 26 个字母加 10 个数字组成，也是不够用的，更遑论还要剔除 0 和 o 等相似字，所以 PNR 是有一个回收机制的——这个 PNR 服务完你的行程之后，会进入候选池，被下一个旅客随机抽取使用。</p> 
<p>有经验的朋友此时可能会发现，机票票号是有规律的。没错，机票票号通常为 13 位，其中前 3 位是航空公司的数字代码，后 10 位则是流水号，因此一般有经验的旅客看到前 3 位就能判断是哪家航司的票。</p> 
<p>言归正传，完成购票流程之后，我们就要等航班初始化之后，准备网上值机或者现场值机，然后起飞。「航班初始化」是一个业内用语，一般是代表航班及旅客信息从订座系统流转到离港系统后，由机场现场的小姐姐小哥哥点击航班初始化按钮确定初始化状态，这时候你才能在网络上完成值机动作。</p> 
<p>这个航班初始化的时间一般是由场站拟定的，所以你会发现有的场站起飞的航班，可以提前两天进行网上值机，而有的则只能提前一天甚至 12 小时进行值机。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,1507" src="https://img.36krcdn.com/20210709/v2_7f3d3d3bc7734d1f9fd0a393c47bce04_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">不同城市的航班初始化时间不同</p> 
<p>来，现在让我们来进行值机。</p> 
<p>现在一般航司自己搭建的值机系统，是通过 PE 系统和<a class="project-link" data-id="3966906" data-name="航信" data-logo="https://img.36krcdn.com/20210129/v2_4c7842b9bb564ebc96c7db2b3648599a_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/3966906" target="_blank">航信</a>底层进行交互，首先需要你的证件号，查出你的订座信息，但现在为了隐私保护，避免黑产通过穷举票号获得大量旅客的行程信息出售，一般会进行一次个人信息的校验，这就是为什么现在你们值机除了票号，还需要证件号、姓名、手机号、验证码等步骤。</p> 
<p>获得旅客订座信息之后，会有一张航班的座位图传输给航司，航司需要根据座位图上开放座位的数据，提示旅客哪些座位能网上值机，哪些座位则只能现场办理。</p> 
<p>这里又有一个有趣的知识点，一般为了航班配载考虑，头部和尾部的座位在网上值机的时候会被锁定，这是为了飞机在天空中飞行的平衡考虑；同样安全出口由于需要当面告知旅客相关注意事项，所以同样也是被锁定的，只能现场办理，所以有的旅客会发现网值能选的位置相对少得可怜，这就是出于安全需要了，如果想要这些特殊座位，还请麻烦移步现场值机。</p> 
<p>完成值机之后，有无纸化登机流程的航司会给旅客一张电子登机牌和二维码，这个二维码包含的信息可就丰富了，有你的行程信息、个人信息、登机序号等等等，可谓是大而全。所以，如果你要截图发在<a class="project-link" data-id="38685" data-name="微博" data-logo="https://img.36krcdn.com/20210302/v2_f2cb7018ead34f4f9712a4e4fe4fc982_img_000" data-refer-type="2" href="https://36kr.com/projectDetails/38685" target="_blank">微博</a>或者朋友圈请记得打码，这隐私泄露得可比你登机牌上明文可见的信息多多了。</p> 
<p class="image-wrapper"><img data-img-size-val="1080,1391" src="https://img.36krcdn.com/20210709/v2_dc8e220a43d044869aab2475c9180765_img_000" referrerpolicy="no-referrer"></p> 
<p class="img-desc">电子登机牌</p> 
<p>之后，你拿着这个二维码过安检，安检处会拿到你的个人数据，并给你登机牌盖上「安检验讫」的章。至此，你终于完成了起飞的前置步骤，可以移步至登机口进行登机。</p> 
<h2>结尾</h2> 
<p>怎么样，看完上述的步骤之后，是不是有一些常年积累的疑问得到了解答呢？比如为什么网值可选的座位图这么少，为什么购票的时候看不到剩余的具体舱位数量等。当然，这也不是航司或者 OTA（Online Travel Agent，不是大家熟知的那个 OTA 哈）特意刁难旅客，属实是「系统设定」。</p> 
<p>题图来自 Unsplash：@nicolegeri</p>  
</div>
            