
---
title: '给1万帧视频做目标分割，显存占用还不到1.4GB，代码已开源'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7c_1024.jpg'
author: ZAKER
comments: false
date: Tue, 19 Jul 2022 00:41:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7c_1024.jpg'
---

<div>   
<p>咦，怎么好好的藤原千花，突然变成了 " 高温红色版 "？</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_0" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7c_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7c_raw.gif" data-height="269" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7c_1024.jpg" referrerpolicy="no-referrer"></div></div>这大紫手，难道是灭霸在世？？<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_1" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7d_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7d_raw.gif" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7d_1024.jpg" referrerpolicy="no-referrer"></div></div>如果你以为上面的这些效果只是对物体后期上色了，那还真是被 AI 给骗到了。<p></p><p>这些奇怪的颜色，其实是对视频对象分割的表示。</p><p>但 u1s1，这效果还真是让人一时间分辨不出。</p><p>无论是萌妹子飞舞的发丝：</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_2" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7e_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7e_raw.gif" data-height="269" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb7e_1024.jpg" referrerpolicy="no-referrer"></div></div>还是发生形状改变的毛巾、物体之间来回遮挡：<p></p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_3" data-original="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb7f_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb7f_raw.gif" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb7f_1024.jpg" referrerpolicy="no-referrer"></div></div>AI 对目标的分割都称得上是严丝合缝，仿佛是把颜色 " 焊 " 了上去。<p></p><p>不只是高精度分割目标，这种方法还能处理超过<strong>10000 帧</strong>的视频。</p><p>而且分割效果始终保持在同一水平，视频后半段依旧丝滑精细。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb80_1024.jpg" data-height="299" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb80_1024.jpg" referrerpolicy="no-referrer"></div></div>更意外的是，这种方法对 GPU 要求不高。<p></p><p>研究人员表示实验过程中，该方法消耗的 GPU 内存从来没超过<strong>1.4GB</strong>。</p><p>要知道，当下基于注意力机制的同类方法，甚至都不能在普通消费级显卡上处理超过 1 分钟的视频。</p><p>这就是伊利诺伊大学厄巴纳 - 香槟分校学者最新提出的一种长视频目标分割方法<strong>XMem</strong>。</p><p>目前已被 ECCV 2022 接收，代码也已开源。</p><p>如此丝滑的效果，还在 Reddit 上吸引不少网友围观，热度达到 800+。</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb81_1024.jpg" data-height="739" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb81_1024.jpg" referrerpolicy="no-referrer"></div></div>网友都在打趣说：<p></p><p>为什么要把你的手涂成紫色？</p><p>谁知道灭霸是不是有计算机视觉方面的爱好呢？</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb82_1024.jpg" data-height="466" data-width="944" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb82_1024.jpg" referrerpolicy="no-referrer"></div></div><b>模仿人类记忆法</b><p></p><p>目前已有的视频对象分割方法非常多，但是它们要么处理速度比较慢，要么对 GPU 要求高，要么精度不够高。</p><p>而本文提出的方法，可以说是兼顾了以上三方面。</p><p>不仅能对长视频快速进行对象分割，画面帧数可达到 20FPS，同时在普通 GPU 上就能完成。</p><p>其特别之处在于，它受人类记忆模式所启发。</p><p>1968 年，心理学家阿特金森和希夫林提出<strong>多重存储模型</strong>（Atkinson-Shiffrin memory model）。</p><p>该模型认为，人类记忆可以分为 3 种模式：瞬时记忆、短期记忆和长期记忆。</p><p>参考如上模式，研究人员将 AI 框架也划分出 3 种内存方式。分别是：</p><p>及时更新的瞬时内存</p><p>高分辨率工作内存</p><p>密集长期记忆内存。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb83_1024.jpg" data-height="543" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202207/62d65e3a8e9f0912af4ceb83_1024.jpg" referrerpolicy="no-referrer"></div></div>其中，瞬时内存会每帧更新一次，来记录画面中的图像信息。<p></p><p>工作内存从瞬时内存中收集画面信息，更新频率为每 r 帧一次。</p><p>当工作内存饱和时，它会被压缩转移到长期内存里。</p><p>而长期内存也饱和时，会随着时间推移忘记过时的特征；一般来说这会在处理过数千帧后才会饱和。</p><p>这样一来，GPU 内存也就不会因为时间推移而不足了。</p><p>通常，对视频目标进行分割会给定第一帧的图像和目标对象掩码，然后模型会跟踪相关目标，为后续帧生成相应的掩码。</p><p>具体来看，XMem 处理单帧画面的过程如下：</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb84_1024.jpg" data-height="441" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb84_1024.jpg" referrerpolicy="no-referrer"></div></div>整个 AI 框架由 3 个端到端卷积网络组成。<p></p><p>一个<strong>查询编码器</strong>（Query encoder）用来追踪提取查询特定图像特征。</p><p>一个<strong>解码器</strong>（Decoder）负责获取内存读取步骤的输出，以生成对象掩码。</p><p>一个<strong>值编码器</strong>（Value encoder）可以将图像和目标的掩码相结合，从而来提取新的内存特征值。</p><p>最终值编码器提取到的特征值会添加到工作内存中。</p><p>从实验结果来看，该方法在短视频和长视频上，都实现了 SOTA。</p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb85_1024.jpg" data-height="325" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb85_1024.jpg" referrerpolicy="no-referrer"></div></div>在处理长视频时，随着帧数的增加，XMem 的性能也没有下降。<p></p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb86_1024.jpg" data-height="354" data-width="700" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202207/62d65e3a8e9f0912af4ceb86_1024.jpg" referrerpolicy="no-referrer"></div></div><b></b><p></p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            