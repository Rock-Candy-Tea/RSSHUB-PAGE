
---
title: 'CEO亲自写代码登上热榜，从零开始打造_裸金属_树莓派'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733dac_1024.jpg'
author: ZAKER
comments: false
date: Sun, 10 Oct 2021 00:07:04 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733dac_1024.jpg'
---

<div>   
<p>CEO 亲自写的代码是啥样？</p><p>来自 RealVNC 公司的 CEO 说，自己长年当管理者，代码生疏了，所以决定重拾一下程序员工作，写一点<strong>树莓派</strong>的代码。</p><p>结果，一不小心就上了技术论坛 Hacker News 热门。</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres2.myzaker.com/202110/61626c7e8e9f093093733dac_1024.jpg" data-height="662" data-width="1726" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733dac_1024.jpg" referrerpolicy="no-referrer"></div></div>这串代码究竟是什么？打开这位 CEO 的 Twitter 一看，是一段小游戏。<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_1" data-original="http://zkres1.myzaker.com/202110/61626c7e8e9f093093733dad_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61626c7e8e9f093093733dad_raw.gif" data-height="376" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61626c7e8e9f093093733dad_1024.jpg" referrerpolicy="no-referrer"></div></div>花了一年时间就写了个这？当然不是，这位 CEO 可是从零开始打造的这款游戏，连系统启动文件都是自己写的。<p></p><p>通常我们使用树莓派都会在 SD 卡上刷写好操作系统，其实树莓派还能从零开始打造成一款 " 裸金属 "（Bare Metal）计算机。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres1.myzaker.com/202110/61626c7e8e9f093093733dae_1024.jpg" data-height="480" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61626c7e8e9f093093733dae_1024.jpg" referrerpolicy="no-referrer"></div></div>所谓 " 裸金属 " 就是没有操作系统的计算机，直接在逻辑硬件上执行指令。这位 CEO 说，打造一个裸金属系统是他儿时的志向。<p></p><p>所以就有了这串，从零开始到成功运行 Hello World，再到运行小游戏的程序。</p><p>从启动硬件到 Hello World</p><p>目前，该项目已经完成了 12 章，仍在 GitHub 上继续更新中，截至今天已经收获了 1.6k 星。</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres2.myzaker.com/202110/61626c7e8e9f093093733daf_1024.jpg" data-height="350" data-width="948" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733daf_1024.jpg" referrerpolicy="no-referrer"></div></div>项目内容有：启动、构建基本代码、运行 HelloWorld、调用蓝牙声音硬件等。<p></p><p>在编写代码之前先要准备树莓派 4 的周边硬件：HDMI 线、micro-SD 卡以及<strong>USB 转 TTL 线</strong>。</p><p>由于编译过程是在电脑上进行，而程序是在树莓派上运行，因此还要在电脑上安装<strong>交叉编译器</strong>。</p><p>接下来开始引导树莓派启动：</p><p>树莓派 4 运行的第一个代码需要用汇编语言编写，之后由 C 语言来编写内核。</p><p>写好启动代码后，再制作 makefile 文件进行交叉编译。</p><p>CFILES = $ ( wildcard *.c ) OFILES = $ ( CFILES:.c=.o ) GCCFLAGS = -Wall -O2 -ffreestanding -nostdinc -nostdlib -nostartfilesGCCPATH = ../../gcc-arm-10.3-2021.07-x86_64-aarch64-none-elf/binall: clean kernel8.imgboot.o: boot.S$ ( GCCPATH ) /aarch64-none-elf-gcc $ ( GCCFLAGS ) -c boot.S -o boot.o%.o: %.c$ ( GCCPATH ) /aarch64-none-elf-gcc $ ( GCCFLAGS ) -c $< -o $@kernel8.img: boot.o $ ( OFILES ) $ ( GCCPATH ) /aarch64-none-elf-ld -nostdlib boot.o $ ( OFILES ) -T link.ld -o kernel8.elf$ ( GCCPATH ) /aarch64-none-elf-objcopy -O binary kernel8.elf kernel8.imgclean:/bin/rm kernel8.elf .o .img > /dev/null 2> /dev/null || true</p><p>运行 make 后构建内核映像 kernel8.img，将镜像文件复制到 SD 卡中，这样就可以启动树莓派了。</p><p>不过树莓派在这一通操作后只能运行启动画面，之后只剩下一个空的黑屏。</p><p>然后就是让树莓派程序员熟悉的 "Hello World" 程序，但是在一台黑屏的机器上如何运行呢？这就需要用到 UART 串行通信。</p><p>刚刚准备的 USB 转 TTL 线这时候就派上了用场。</p><p>将 TTL 的 RX 引线（白色）链接到 GPIO 的 TXD 引脚上，TX 引线（绿色）链接到 GPIO 的 RXD 引脚上，地线（黑线）连接到 Ground 引脚上。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202110/61626c7e8e9f093093733db0_1024.jpg" data-height="1102" data-width="1920" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61626c7e8e9f093093733db0_1024.jpg" referrerpolicy="no-referrer"></div></div>电脑上还要安装 PuTTY，将链接方式选择为 "Serial"，Speed 设置为 115200<p></p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres1.myzaker.com/202110/61626c7e8e9f093093733db1_1024.jpg" data-height="435" data-width="456" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61626c7e8e9f093093733db1_1024.jpg" referrerpolicy="no-referrer"></div></div>#include "io.h"voidmain ( ) &#123;uart_init ( ) ;uart_writeText ( "Hello world!n" ) ;while ( 1 ) ;&#125;<p></p><p>这里的头文件 io.h 也不存在，需要自己定义。</p><p>但是此时的树莓派还有没字体文件，也就是屏幕无法正常显示英文字母，也需要自定义。经过一系列操作后，这位 CEO 终于在屏幕上成功显示了 "Hello world！" 和几个几何图形。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db2_1024.jpg" data-height="1440" data-width="1920" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db2_1024.jpg" referrerpolicy="no-referrer"></div></div>编程并没有到此截止，这位 CEO 后面又实现了对蓝牙互传信息、播放音频文件等操作。他还表示，项目还在持续更新中。<p></p><p>关于作者</p><p>" 裸金属 " 树莓派的作者 Adam Greenwood-Byrne 毕业于牛津大学，2009 年加入 RealVNC 担任销售经理，2018 年成为这家公司 CEO。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db3_1024.jpg" data-height="781" data-width="1920" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db3_1024.jpg" referrerpolicy="no-referrer"></div></div>他的 GitHub 主页上目前只有一个项目，第一章内容是他在疫情隔离期间完成的，之后项目就处于休眠状态。<p></p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db4_1024.jpg" data-height="482" data-width="1866" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61626c7e8e9f093093733db4_1024.jpg" referrerpolicy="no-referrer"></div></div>不过从今年的活跃度来看，他从今年开始又重拾了该项目，开始认真写代码了。<p></p><p>参考链接：</p><p> [ 1 ] https://github.com/isometimes/rpi4-osdev</p><p> [ 2 ] https://www.rpi4os.com</p><p> [ 3 ] https://twitter.com/isometim_es/status/1446359865274871818</p><p> [ 4 ] https://news.ycombinator.com/item?id=28774022</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            