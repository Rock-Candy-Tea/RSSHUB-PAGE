
---
title: 'AI训练的空洞骑士能打败大黄蜂小姐姐吗？'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765abf_1024.jpg'
author: ZAKER
comments: false
date: Sat, 22 May 2021 09:18:06 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765abf_1024.jpg'
---

<div>   
<p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765abf_1024.jpg" data-height="320" data-width="512" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765abf_1024.jpg" referrerpolicy="no-referrer"></div></div>AI 的更新迭代和《空洞骑士》的叙事达成了奇妙的和谐：要不断尝试，不断犯错，直到战胜敌人。<p></p><p>开始直播第五天，Ailec 的直播间诞生了一场颇为精彩的战斗。</p><p>正在直播的游戏是《空洞骑士》，玩家挑战的 BOSS 是作品中的高人气角色大黄蜂。小骑士先是用冲锋的无敌帧躲过大黄蜂的冲刺，接着又在大黄蜂掷出飞针的同时下劈并靠近，攻击得手后一个小跳，轻易躲过收回的飞针……</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_1" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac0_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac0_raw.gif" data-height="328" data-width="636" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac0_1024.jpg" referrerpolicy="no-referrer"></div></div>迅速靠近敌人，大黄蜂起跳瞬间预判使用法术，在 BOSS 做出冲锋姿势时一刀打出硬直，几乎没有停顿地位移靠近继续输出。<p></p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_2" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac1_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac1_raw.gif" data-height="325" data-width="633" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac1_1024.jpg" referrerpolicy="no-referrer"></div></div>耗时 40 秒，小骑士用最后一刀劈中正处于冲锋状态的大黄蜂，利落地结束了这场战斗。弹幕一时飘过好几串代表着惊讶和振奋的 "ohhhhhh"，而小骑士只是沉默，继续开始与大黄蜂纠缠新的一局。<p></p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_3" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac2_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac2_raw.gif" data-height="326" data-width="633" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac2_1024.jpg" referrerpolicy="no-referrer"></div></div>不少观众感慨这位才刚开始玩游戏没几天的新手已经拥有了远超自己的水平，甚至认为其中某些精妙的操作已经超脱了正常人类的范畴——当然，其中完全没有质疑小骑士舞弊的意思。<p></p><p>毕竟，这位幕后的玩家本来就不是人类。</p><p><strong>1</strong></p><p>老实说，AI 打游戏并不算是什么稀罕事。</p><p>有以实力强著称的，像横扫围棋界的 AlphaGo 和《星际争霸 2》达到宗师段位的 AlphaStar，已经被不少人称作人工智能领域的里程碑。也有以实力差闻名的，日本一家 AI 公司的首席技术官曾经在推特上发布一个 " 史上最弱 " 的黑白棋 AI，即便是职业棋手上阵，想在它面前输掉比赛也不得不绞尽一番脑汁。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac3_1024.jpg" data-height="698" data-width="490" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac3_1024.jpg" referrerpolicy="no-referrer"></div></div>胜率逼近 0.5%<p></p><p>而且 AI 往往不按套路出牌。你让它玩索尼克，他跑去墙角卡 BUG 走捷径通关。</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_5" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac4_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac4_raw.gif" data-height="193" data-width="273" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ac4_1024.jpg" referrerpolicy="no-referrer"></div></div>你让它学俄罗斯方块，他迅速落下每一块方块并在游戏即将 Game Over 的时候按下暂停键。因为每落下一块方块都能使 AI 获得的更多奖励分，而在输掉游戏前按下暂停就不会得到失败的惩罚——你得承认，这对它来说确实是一种极具效率的得分方式。<p></p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac5_1024.jpg" data-height="659" data-width="750" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac5_1024.jpg" referrerpolicy="no-referrer"></div></div>正在美国留学，且面临着期末考核的 Ailec 在开始自己的作业前就已经做好了一定的心理预期，可即便是站在前人的肩膀上，直到真正开始调教 AI 打游戏，他才切身感受到这是一项多么充满坎坷的挑战。<p></p><p>之所以选择《空洞骑士》，除了 Ailec 自己刚在去年年底通关了这款游戏之外，更直接的原因是他恰巧点进了一位名叫 " 烽征战 " 的 up 主的直播间。</p><p>烽征战是一位国内的研究生，虽然平日学业繁忙，但偶尔也会在 B 站开直播，今年三月份的时候，他正在尝试的项目是训练 AI 击败《空洞骑士》中的大黄蜂。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac6_1024.jpg" data-height="93" data-width="512" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac6_1024.jpg" referrerpolicy="no-referrer"></div></div>为什么是《空洞骑士》，为什么是大黄蜂，其中实际上包含了诸多考量。首先，《空洞骑士》是一款 2D 平面游戏，且 BOSS 战需要投入关注的对象只有自己和 BOSS，这减轻了计算机的工作量，其次，大黄蜂的整体攻略难度不高，而且招式多变，相对来说是个难易程度适中的好老师。<p></p><p>Ailec 和烽征战一拍即合，与对方沟通交流一番后便开始了同样内容的直播。他觉得这是个再合适不过的期末作业——创造一个能够稳定战胜大黄蜂的 AI。</p><p><strong>2</strong></p><p>Ailec 最初版本的 AI 框架基本继承自一位名叫 " 蓝魔 digital" 的 up 主。这位在 2020 年写了一套 AI 学习打《只狼》的代码，借鉴其代码创作的 AI 击败苇名弦一郎的视频还上过 B 站首页。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac7_1024.jpg" data-height="732" data-width="1006" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac7_1024.jpg" referrerpolicy="no-referrer"></div></div>不出所料，在《只狼》中如鱼得水的 AI 立马对《空洞骑士》呈现出水土不服的症状。作为 " 只狼 "，AI 需要做出的判断是锁定弦一郎、挥刀、格挡、适时看破，而作为 " 小骑士 "，" 格挡 " 和 " 看破 " 这样的机制在游戏中并不存在，它得重新学习如何使用基本的挥砍和法术打败敌人。<p></p><p>于是 Ailec 开始马不停蹄地修改代码。白天对 AI 算法进行更新迭代，睡前打开直播，把 AI 扔进游戏训练学习——这时候国内正是上午。一觉醒来，审视一下学习成果，和观众们聊上两句，然后紧接着投入新的更新迭代。</p><p>Ailec 至今清楚记得第一次重大更新（事故）发生在容器 7 身上——容器，这是直播间的观众为 AI 取的名字。你知道，有关游戏的具体版本，开发者往往会用上 1.1、1.2 甚至是尼尔那样行为艺术的 "1.22474487139" 加以描述区分，但具体到《空洞骑士》中，AI 的版本更迭和游戏的叙事产生了奇妙的映射关系。根绝游戏的设定，玩家操纵的小骑士是万千容器中的一个，在他必然踏上的旅途中，无数容器曾经历过与其相似却又不同宿命，<strong>就像一代代挑战大黄蜂又倒在她针下的 AI。</strong></p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac8_1024.jpg" data-height="474" data-width="626" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac8_1024.jpg" referrerpolicy="no-referrer"></div></div>容器 7 之所以与众不同，主要在于这是 Ailec 第一次尝试手把手教 AI 如何战斗。简单来说，他将自己对阵大黄蜂的录像演示给 AI，希望它能从中学习到一些操作技巧，结果容器 7 受到教诲后，不仅没有成长为武林高手，反而立地成佛，具体表现为只追着 BOSS 跑，靠近后却一刀不砍——可惜大黄蜂不会因此手下留情。<p></p><p>事后反思时，Ailec 找到了症结所在。对人类来说，靠近 BOSS 是为了有效击中 BOSS，这点不言而喻。但 AI 不能理解人类的思路，它认为小骑士花了更多的操作和时间接近大黄蜂，最后却只挥出一刀。如果进攻一次的得分是 1，那么靠近 BOSS 可能占 0.9，挥刀则占 0.1。既然如此，一个劲往 BOSS 身上靠就是十分合乎逻辑的操作……</p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac9_1024.jpg" data-height="197" data-width="399" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765ac9_1024.jpg" referrerpolicy="no-referrer"></div></div>Ailec 挂在直播间的 FAQ<p></p><p><strong>3</strong></p><p>总结失败经验，不断优化算法，一个个容器因此诞生。进化到 11 号容器时，Ailec 终于做出了大刀阔斧的改动。</p><p>具体的尝试主要体现在两方面：一是优化奖励机制，降低移动在 " 得分 " 中的权重，杜绝只追着 BOSS 不砍这种现象的发生；二是将动作组合起来，命令 AI 一次性做出一组动作，比如在冲刺后衔接攻击，从而更好地抓住输出机会。</p><p>容器 11 的表现一度十分亮眼，文章开篇的那顿精彩操作就是它的闪光时刻之一。不过好景不长，威猛没多久，11 号就陷入了日墙状态。</p><p></p><div class="img_box" id="id_imagebox_11" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_11" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765aca_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765aca_raw.gif" data-height="323" data-width="631" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765aca_1024.jpg" referrerpolicy="no-referrer"></div></div>病因和容器 7 类似，在不断的练习过程中，容器 11 的进攻权重完全压倒了移动权重，换句话说，这回只知道砍不知道动了。<p></p><p>除此之外，动作组合的弊端同样显现出来。原本 Ailec 为容器们设定的操作只有 17 项（例如左移动、右移动、左攻击、右攻击……），但在强行添加派生动作后，AI 的学习难度陡然增加，根据 BOSS 行动作出的反馈延迟也剧增——小骑士一刀挥出最快只需要 0.25 秒，但 AI 的反应时间却长达 0.3、0.4 甚至 0.8 秒。</p><p>Ailec 最终找到的应对方法是放弃动作组合，将小骑士的移动和攻击分别交给两组模型管理，其中方向脑只负责移动，而行动脑则负责除移动之外的挥刀、法术、跳跃等等。</p><p>应用这套框架后，Ailec 又在容器 16 身上尝试削弱延迟奖励机制对 AI 影响。延迟奖励机制的主要作用是让 AI 认清长期利益，他用迷宫举例，看上去离出口更近的岔路口可能是死路，延迟奖励能够让 AI 意识到短时间内的绕路实际上会节省更多的时间。</p><p></p><div class="img_box" id="id_imagebox_12" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_12" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acb_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acb_raw.gif" data-height="414" data-width="414" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acb_1024.jpg" referrerpolicy="no-referrer"></div></div>但《空洞骑士》不是迷宫，大黄蜂的攻击方式是多变的，小骑士的一次操作也不会对后续战斗造成类似于迷宫选错岔路口那么严重的影响——降低延迟奖励机制对 AI 的影响之后，容器 16 的胜率终于稳定在了 30% 左右。<p></p><p>Ailec 几乎以天为单位对算法进行细致的优化，容器们的胜率也因此来回波动不定。当然，也有做无用功的时候，比如一位观众曾建议他尝试应用 RNN（循环神经网络），结果花了两天时间改的代码最终对小骑士毫无帮助。</p><p>但容器们总体上还是在一点点变得更强的。容器 23，Ailec 对奖励机制做出细化，使得只能控制移动的方向脑即便无法通过 " 攻击 " 行为得分，也能凭借靠近 BOSS 获得奖励。</p><p></p><div class="img_box" id="id_imagebox_13" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_13" data-original="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765acc_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202105/60a933448e9f097ce8765acc_raw.gif" data-height="334" data-width="626" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a933448e9f097ce8765acc_1024.jpg" referrerpolicy="no-referrer"></div></div>追着大黄蜂揍的 23<p></p><p>容器 24，Ailec 进一步完善行动脑的奖励机制，鼓励 AI 做出诸如 " 在距离 BOSS 过远时使用冲刺 " 之类的操作，同时完全去除了延迟奖励机制——此时 24 号已经基本能够以 90% 以上的胜率击败大黄蜂。</p><p>对整体神经网络结构进行最后一次大范围改动优化，并 " 灌顶 " 容器 24 的经验后，容器 26 达到了接近完美的状态。起初它的表现一般，但用 Ailec 的话来说，就像学会了挂挡、把方向盘、控制离合刹车，却没适应怎么打开车门——打开车门终究不是什么难事，很快容器 26 就能够以将近百分百的胜率战胜敌人，即使是难度更高的进升级大黄蜂，胜率也在最后达到了 90%。</p><p></p><div class="img_box" id="id_imagebox_14" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_14" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acd_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acd_raw.gif" data-height="334" data-width="626" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acd_1024.jpg" referrerpolicy="no-referrer"></div></div>一血险胜进升级大黄蜂<p></p><p>它已经是个足够强大的小骑士了。</p><p><strong>4</strong></p><p>交流过程中，Ailec 曾数次向我提起教授、朋友（烽征战）以及直播间观众对他的帮助，于是我问：" 你觉得为什么会有这么多人来看 AI 打大黄蜂？"</p><p>他想了想，觉得自己也不太能确定。可能是这部分观众本身对人工智能感兴趣，可能是 AI 的一点点强大带给观众 " 儿子长大了 " 的快感，甚至可能只是因为 AI 与 " 容器 " 之间产生一种奇妙的对应关系。</p><p></p><div class="img_box" id="id_imagebox_15" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_15" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ace_1024.jpg" data-height="362" data-width="660" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765ace_1024.jpg" referrerpolicy="no-referrer"></div></div>写到这里，我对这个问题也大致有了自己的想法。让 AI 训练小骑士打败大黄蜂即是对机器的挑战，也是对人的挑战，而《空洞骑士》，或者说 " 容器们 "，用一种和谐而直观的方式呈现出机器的成长，以及人的成长。<p></p><p>就像在泪水之城，大黄蜂告诉玩家操纵的小骑士：" 你的灵魂出自两个虚空，难怪你能到达这世界的中心。"</p><p></p><div class="img_box" id="id_imagebox_16" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_16" data-original="http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acf_1024.jpg" data-height="540" data-width="1002" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a933448e9f097ce8765acf_1024.jpg" referrerpolicy="no-referrer"></div></div><p></p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            