
---
title: '微软2022年开年就出大bug 大量程序员连夜加班：年都没跨好'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bac_1024.jpg'
author: ZAKER
comments: false
date: Sun, 02 Jan 2022 04:02:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bac_1024.jpg'
---

<div>   
<p>没想到，2022 年的到来，也给微软带来了一个新 bug。</p><p>随着日期从 2021 年 12 月 31 日跳转到 2022 年 1 月 1 日，不少使用微软 Exchange 的公司发现，自己写好的新年祝福等邮件，突然发不出去了。</p><p>Exchange Server 是微软推出的一套电子邮件服务组件，可用于构建企业、高校或机构的邮件系统。简单来说，用它不止能构建 " 邮箱工作群 "，还能协调内部工作流等。</p><p>这些公司的邮箱服务器内滞留了大量邮件，有些甚至达到数十万封，面临服务器存储不下的问题。</p><p>目前这个 bug 已经在 Reddit 热度上千，许多人表示 " 年都没跨好就在这修 bug"：</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bac_1024.jpg" data-height="149" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bac_1024.jpg" referrerpolicy="no-referrer"></div></div>新年（哔）快乐！<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres2.myzaker.com/202201/61d188288e9f0966d3294bad_1024.jpg" data-height="82" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61d188288e9f0966d3294bad_1024.jpg" referrerpolicy="no-referrer"></div></div>我本来还在度假呢，就给我拉回来处理这个玩意了……<p></p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bae_1024.jpg" data-height="83" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bae_1024.jpg" referrerpolicy="no-referrer"></div></div>所以到底是怎么回事？<p></p><p>微软 2022 版 " 千年虫 "</p><p>据一位 Exchange 管理员 Joseph Roosen 表示，这是一个由于 "2022 年 " 的到来而导致的 bug。</p><p>这个 bug 的根源，是微软 Exchange 上面的邮件过滤管理系统（FIP-FS），采用了一种名叫 "yymmddHHMM" 的有符号变量（Int32，也就是 long）来存储日期。</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202201/61d188288e9f0966d3294baf_1024.jpg" data-height="382" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294baf_1024.jpg" referrerpolicy="no-referrer"></div></div>其中，yymmddHHMM 分别指代用两位来存储年（years）、月（months）、日（days）、小时（Hours）、分钟（Minutes）。<p></p><p>这个数据类型存在一个问题：</p><p>有符号的 Int32 最多只能存储 -2147483647 到 +2147483647 的数据。</p><p>然而，从 2022 年 1 月 1 日 0 时开始，"yymmddHHMM" 的 yy 就已经变成了 "22"，超过了 Int32 所能存储的数据最大范围：</p><p>2147483647</p><p>22XXXXXXX</p><p>于是，在 2022 年 1 月 1 日这天，所有用 Exchange 服务器发邮件的公司，都收到了这样一条错误提醒：</p><p>The FIP-FS Scan Process failed initialization. Error: 0x8004005. Error Details: Unspecified Error" or "Error Code: 0x80004005. Error Description: Can ’ t convert "2201010001" to long.（FIP-FS 扫描处理初始化失败……无法将 "2201010001" 转变为 long 数据类型）</p><p>它最初被一位名叫 @miketheitguy 的推特用户发现：</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bb0_1024.jpg" data-height="259" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bb0_1024.jpg" referrerpolicy="no-referrer"></div></div>由于和 " 千年虫 " 一样都是日期给计算机带来的 bug，这次 bug 也被一些 Exchange 管理员命名为 Y2K22。<p></p><p>其中，Y2K 指的是著名的 " 千年虫 " 问题，由于部分计算机程序只采用两位十进制数表示年份，在跨世纪时就会出现错误的结果；22 指的则是 2022 年。</p><p>这个 bug 在不少 Exchange Server 版本中都出现了相同的问题，包括 2016 和 2019 等。</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bb1_1024.jpg" data-height="283" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61d188288e9f0966d3294bb1_1024.jpg" referrerpolicy="no-referrer"></div></div>目前，微软的 Exchange 团队正在紧急修复中。<p></p><p>他们表示，几天后会发布一个 Exchange Server 更新，里面将用一个更大的变量类型来保存日期。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202201/61d188288e9f0966d3294bb2_1024.jpg" data-height="150" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61d188288e9f0966d3294bb2_1024.jpg" referrerpolicy="no-referrer"></div></div>然而在这之前，使用 Exchange Server 的公司们必须想办法把邮件发出去。<p></p><p>一些权宜之计</p><p>微软团队表示，如果有非常紧急的邮件需要发送，需要先关掉 Exchange 中的 FIP-FS 功能。</p><p>这是个 Exchange 上的垃圾邮件过滤器，平时会用来扫描邮件中自带的恶意软件、或是垃圾邮件。</p><p>目前微软官方也提供了一些禁用或绕过恶意软件扫描的方法。</p><p>然而，这样操作的后果是公司邮箱 " 可能收到更多垃圾邮件 "。</p><p>对此有网友调侃，如果微软在修复中把有符号变量改成无符号变量，那么数据的表示范围就会变成 0~4294967295，Exchange 邮箱又可以用到 2043 年了。</p><p>除此之外，目前 Reddit 网友还给出了一些其他的解决方案。</p><p>例如，有网友发布了一个非官方的自定义脚本，可以将日期回滚到 2021 年，但他对此表示，一切风险需要使用者自己承担。</p><p>如果还没想好怎么解决你的 Exchange 邮箱系统问题，可以先用上面这些方法试一试。</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            