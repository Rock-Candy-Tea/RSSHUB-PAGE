
---
title: '安全专家发现ATM机NFC功能漏洞，仅用一台手机就可改变金额，甚至强制提现！'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad1_1024.jpg'
author: ZAKER
comments: false
date: Wed, 30 Jun 2021 03:15:46 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad1_1024.jpg'
---

<div>   
<p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad1_1024.jpg" data-height="840" data-width="1280" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad1_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>大数据文摘出品</strong><p></p><p><strong>作者：王烨</strong></p><p>你有多久没去 ATM 取过钱了？</p><p>由于移动支付的诞生，中国民众现在出门很少带现金了，为了跟上 " 移动化 " 的潮流，银行的 ATM 机经过不断升级已经有了 NFC、无卡取款甚至是刷脸取款。</p><p>从诞生之初，ATM 就一直被不法分子觊觎，毕竟 ATM 里面有大量现金，附近还无人值守，是一个天然吸引犯罪的地方。</p><p>一般来说，银行在考虑到 ATM 存在被抢风险的情况下，都会把 ATM 机建造的很坚固，但是依然有人选择 " 硬来 "；</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_1" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad2_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad2_raw.gif" data-height="202" data-width="360" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad2_1024.jpg" referrerpolicy="no-referrer"></div></div>当然，也有人选择智取。近期，一位安全公司的研究人员发现了现在 ATM 机中 NFC 功能的漏洞，利用这个漏洞，可以修改交易金额，甚至可以让 ATM 直接吐钱。<p></p><p><strong>安全顾问入侵 ATM 机多，修改金额只需一部手机</strong></p><p>安全公司 IOActive 的研究员和顾问何塞普 · 罗德里格斯（Josep Rodriguez）去年开始一直在挖掘和报告所谓的 NFC 芯片的漏洞，这些芯片被用于全球数百万台 ATM 机。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad3_1024.jpg" data-height="373" data-width="937" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad3_1024.jpg" referrerpolicy="no-referrer"></div></div>在 ATM 机上，NFC 功能可以让你在 ATM 机上挥动银行卡，而不是刷卡或插入银行卡，从而进行支付或从提款机中取钱。<p></p><p>为此，罗德里格斯开发了一个 Android 应用程序，可以让他的智能手机模仿银行卡的 NFC 通信功能，并利用 NFC 系统固件中的缺陷入侵 ATM 机或者销售点终端。</p><p>也就是说，仅仅利用一部智能手机，罗德里格斯就可以侵入 ATM 机或者销售点终端收集和传输银行卡数据，悄悄地改变交易数额，甚至锁定设备。</p><p>罗德里格斯说，他甚至可以强迫至少一个品牌的 ATM 机直接支付现金ーー由于与 ATM 供应商签订了保密协议，他拒绝详细说明或公开披露这些漏洞。</p><p>" 例如，你可以修改固件并将价格改为 1 美元，即使屏幕显示你要支付 50 美元。你可以使设备失效，或者安装一种勒索软件。这有很多可能性，" 罗德里格斯表示，" 如果你发动连锁攻击，并向 ATM 机的处理器发送一个特殊的有效载荷，你就可以在 ATM 机上找到突破口——比如提现。"</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad4_1024.jpg" data-height="450" data-width="800" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202106/60dbf640b15ec00db0773ad4_1024.jpg" referrerpolicy="no-referrer"></div></div>罗德里格斯担任顾问多年来一直在测试 ATM 机的安全性。他表示，一年前他开始探索 ATM 机的 NFC 是否可以成为黑客入侵的捷径。<p></p><p>NFC 读卡器通常由支付技术公司 ID tech 销售，罗德里格斯从 eBay 上购买 NFC 阅读器和销售点设备，很快发现其中许多都有同样的安全缺陷——他们没有验证通过 NFC 从银行卡发送到读卡器的数据包（APDU）大小。</p><p>因此，罗德里格斯创建了一个定制的应用程序，通过他的支持 NFC 的 Android 手机向 ATM 机或销售点设备发送一个精心制作的 APDU，这个程序比设备预期的要大几百倍，这样，罗德里格斯能够触发一个 " 缓冲区溢出 "（buffer overflows），这是一种有几十年历史的软件漏洞，黑客可以利用该漏洞破坏目标设备的内存，并运行自己的代码。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad5_1024.jpg" data-height="186" data-width="605" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad5_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>多家 ATM 机供应商受影响，打补丁需要很长时间</strong><p></p><p>罗德里格斯说，他在 7 个月至 1 年前通知了受影响的 ATM 机和销售点终端供应商，其中包括 ID Tech、Ingenico、Verifone、Crane Payment Innovations、BBPOS、Nexgo，以及未透露姓名的 ATM 供应商。</p><p>即便如此，他警告称，受影响的系统数量之多，以及许多销售点终端和 ATM 机不会定期接收软件更新，而且在许多情况下需要物理访问才能进行更新，这意味着这些设备中的许多可能仍然容易受到攻击。</p><p>罗德里格斯说：" 给成千上万的自动取款机打补丁，这需要很多时间。"</p><p>为了展示这些挥之不去的漏洞，罗德里格斯与《连线》杂志分享了一段视频，视频中，他在自己居住的马德里街头的一台 ATM 机的 NFC 感应区上挥舞一部智能手机，并让这台机器显示一条错误信息。</p><p>罗德里格斯要求《连线》杂志不要发布这段视频，因为担心承担法律责任。他也没有提供劫机攻击的视频演示，因为他说，他只能在 IOActive 向受影响的 ATM 供应商提供安全咨询的机器上进行合法测试，IOActive 已经与该供应商签署了保密协议。</p><p>安全公司 SRLabs 的创始人、著名的固件黑客卡斯滕 · 诺尔（Karsten Nohl）回顾了罗德里格斯的工作，他说，这些发现是 " 对嵌入式设备上运行的软件脆弱性的极好研究 "。但是诺尔也指出了这项发现的一些局限性，正是这些局限降低了它在现实世界中被不法分子利用的可能性。</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad6_1024.jpg" data-height="720" data-width="1280" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad6_1024.jpg" referrerpolicy="no-referrer"></div></div>诺尔指出，被入侵的 NFC 读卡器只能窃取信用卡的磁条数据，而不能窃取受害者的个人识别码或 EMV 芯片中的数据。事实上，ATM 提现还要求目标 ATM 的代码有一个额外的、明显的漏洞。<p></p><p>当《连线》联系受影响的公司时，ID Tech、BBPOS 和 Nexgo 没有回应置评请求，ATM 行业协会也拒绝置评。</p><p>Ingenico 公司在一份声明中回应说，由于它的安全缓解措施，罗德里格斯的缓冲区溢出技术只能使其设备崩溃，而不能执行攻击代码，但是，" 考虑到给我们的客户带来的不便和影响，"Ingenico 还是发布了一个补丁。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad7_1024.jpg" data-height="270" data-width="480" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad7_1024.jpg" referrerpolicy="no-referrer"></div></div>Verifone 公司则表示，早在罗德里格斯报告之前，他们就已经发现并修复了罗德里格斯在 2018 年指出的漏洞。但罗德里格斯说，他去年在一家餐馆的 Verifone 设备上测试了他的 NFC 攻击技术，发现它仍然很脆弱。<p></p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad8_1024.jpg" data-height="667" data-width="1000" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202106/60dbf640b15ec00db0773ad8_1024.jpg" referrerpolicy="no-referrer"></div></div>在保密了整整一年之后，罗德里格斯计划在未来几周的网络研讨会上分享漏洞的技术细节，部分原因是为了让受影响厂商的客户引起重视。他希望更广泛地呼吁人们关注嵌入式设备安全的糟糕状况，他发现，像缓冲溢出这样简单的漏洞存在于如此之多的常用设备中ーー这些设备正处理着人们敏感的财务信息。<p></p><p>" 这些漏洞已经存在多年，我们每天都在使用这些设备来处理我们的信用卡，我们的钱，" 他说。" 它们需要得到保护。"</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            