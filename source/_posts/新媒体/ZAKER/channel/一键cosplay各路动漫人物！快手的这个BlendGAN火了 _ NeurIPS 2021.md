
---
title: '一键cosplay各路动漫人物！快手的这个BlendGAN火了 _ NeurIPS 2021'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d2_1024.jpg'
author: ZAKER
comments: false
date: Sat, 20 Nov 2021 23:34:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d2_1024.jpg'
---

<div>   
<p>动漫、艺术作品里的人物，他们极具张力的形象往往给人们留下深刻的印象。</p><p>但如果说现在，你也可拥有他们的同款造型呢？</p><p>没错，依旧来自是 " 无所不能 " 的<strong>GAN</strong>。</p><p>只要把你 pick 好的形象 " 投喂 " 进去，接下来<strong>妆发</strong>的工作交给它就行了：</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_0" data-original="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d2_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d2_raw.gif" data-height="400" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d2_1024.jpg" referrerpolicy="no-referrer"></div></div>红的、黄的、蓝的、白的……发色随意改变，风格也随之变换。<p></p><p>这就是来自快手的<strong>BlendGAN</strong>，而且这项工作还被顶会 NeurIPS 2021 接收。</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d3_1024.jpg" data-height="370" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d3_1024.jpg" referrerpolicy="no-referrer"></div></div>而与以往 " 变妆 "GAN 不同的是，BlendGAN 号称能驾驭的风格是——<strong>任意</strong>！<p></p><p>是有种 " 百变大咖秀 " 的那味了。</p><p>于是乎，这个项目成功在网上引起了众多网友的围观。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d4_1024.jpg" data-height="178" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d4_1024.jpg" referrerpolicy="no-referrer"></div></div>如何丝滑变妆？<p></p><p><b></b></p><p>那么，怎样拥有动漫人物同款造型呢？</p><p>很简单，只需要准备 2 张照片：</p><p>一张生活照</p><p>一张动漫人物造型</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d5_1024.jpg" data-height="520" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d5_1024.jpg" referrerpolicy="no-referrer"></div></div>现在在 Hugging Face 里已经有了在线可玩的 demo。<p></p><p>最简单的办法就是把这两张照片上传进去，等待一会儿就可以出结果了。</p><p>当然，稍微 " 技术 " 点的方法就是自己跑一遍程序了。</p><p>就在这两天，BlendGAN 在 GitHub 上也已开源。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d6_1024.jpg" data-height="278" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d6_1024.jpg" referrerpolicy="no-referrer"></div></div>首先需要下载一些<strong>预训练模型</strong>，包括 BlendGAN 模型、PSP 编码器模型和 Style 编码器模型。<p></p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d7_1024.jpg" data-height="318" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202111/6199e8598e9f092bb17023d7_1024.jpg" referrerpolicy="no-referrer"></div></div>然后仅需几句 Python 代码，便可出效果。<p></p><p>例如用随机人脸代码生成图像对，就输入：</p><p>python generate_image_pairs.py --size 1024 --pics N_PICS --ckpt ./pretrained_models/blendgan.pt --style_img ./test_imgs/style_imgs/100036.png --outdir results/generated_pairs/reference_guided/</p><p>若是要给照片换风格，则输入：</p><p>python style_transfer_folder.py --size 1024 --ckpt ./pretrained_models/blendgan.pt --psp_encoder_ckpt ./pretrained_models/psp_encoder.pt --style_img_path ./test_imgs/style_imgs/ --input_img_path ./test_imgs/face_imgs/ --outdir results/style_transfer/</p><p>要生成插值视频，则：</p><p>python gen_video.py --size 1024 --ckpt ./pretrained_models/blendgan.pt --psp_encoder_ckpt ./pretrained_models/psp_encoder.pt --style_img_path ./test_imgs/style_imgs/ --input_img_path ./test_imgs/face_imgs/ --outdir results/inter_videos/</p><p><b>为什么可以 hold 住任意风格？</b></p><p>那么快手的这个 BlendGAN，为什么可以同时驾驭这么多的风格？</p><p>据研究介绍，团队首先是利用灵活的混合策略和通用的艺术数据集，来生成任意样式化的脸。</p><p>具体来说，就是在通用艺术数据集上，训练一个自监督 Style 编码器来提取任意样式的表示。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d8_1024.jpg" data-height="152" data-width="1058" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d8_1024.jpg" referrerpolicy="no-referrer"></div></div>在生成器部分，则提出了一种叫做<strong>加权混合模块</strong> ( WBM ) 的方法，来隐式混合人脸和样式表示，并控制任意的程式化效果。<p></p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d9_1024.jpg" data-height="411" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023d9_1024.jpg" referrerpolicy="no-referrer"></div></div>以往诸如 StyleGAN2 在这个步骤中，不同分辨率层（resolution layer）负责生成图像中的不同特征，而团队认为它们在不同层的混合权值不应当是一致的。<p></p><p>因此，研究人员将人脸和风格 latent 代码转换到它们的 W 空间，然后再由 WBM 进行一个组合的工作。</p><p>由此得到的结果显示，与以往方法比较，BlendGAN 能够得到更加逼真的效果。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023da_1024.jpg" data-height="920" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202111/6199e8598e9f092bb17023da_1024.jpg" referrerpolicy="no-referrer"></div></div>作者介绍<p></p><p><b></b></p><p>本文的通讯作者是 Li Qiang，现任快手 Y-tech 的算法工程师。</p><p>本科和硕士就读于华中科技大学；博士毕业于悉尼科技大学，师从陶大程教授。</p><p>其主要研究方向为深度学习、机器学习和概率图形模型，对卷积神经网络、深度生成模型、表示学习和结构化预测感兴趣。</p><p>最后，想试试变妆的小伙伴，可以戳下方链接体验一下 ~</p><p>在线试玩：</p><p>https://huggingface.co/spaces/akhaliq/BlendGAN</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            