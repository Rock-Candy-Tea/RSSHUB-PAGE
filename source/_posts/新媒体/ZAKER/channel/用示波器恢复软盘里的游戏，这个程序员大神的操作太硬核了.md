
---
title: '用示波器恢复软盘里的游戏，这个程序员大神的操作太硬核了'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591295_1024.jpg'
author: ZAKER
comments: false
date: Sat, 22 May 2021 23:02:58 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591295_1024.jpg'
---

<div>   
<p><b>用示波器恢复软盘里的游戏，这个程序员大神的操作太硬核了 </b></p><p>又到了考（bao）验（lu）阅（nian）历（ling）的时候了。</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591295_1024.jpg" data-height="525" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591295_1024.jpg" referrerpolicy="no-referrer"></div></div>盆友，你可识得此物？<p></p><p>在 80 年代 90 年代，可是有不少宝贵的代码数据，都是存储在这样的载体之中的，比如 DOS 版的仙剑 1。</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f08591297_1024.jpg" data-height="450" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f08591297_1024.jpg" referrerpolicy="no-referrer"></div></div>辣么，如果现在有一张存储古早代码的<strong>软盘</strong>到了你手里，你该如何解开其中的历史秘密？要知道，在今天，你可能连读取软盘的设备都很难找到……<p></p><p>要是再磕了碰了，那就更完蛋了。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591298_1024.jpg" data-height="228" data-width="221" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f08591298_1024.jpg" referrerpolicy="no-referrer"></div></div>最近，<strong>vsftpd</strong>作者、Google Project Zero 创始人 Chris Evans 大佬就遇到了这样的难题：<p></p><p>在和 Phil Pemberton 一起恢复存储在软盘中的几个古早游戏代码时，他们发现，部分软盘出现了不同程度的损坏，以致于直接用<strong>Greaseweazle</strong>这样的设备是无法读取的。</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f08591299_1024.jpg" data-height="198" data-width="320" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f08591299_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>△</strong>Greaseweazle F7 Plus<p></p><p>怎么办？大佬决心要搞出一个船新的方案，抢救宝贵历史代码。</p><p>设备也简单，就用万能的<strong>示波器</strong>。</p><p>没错，就是那种用来测试电路、显示波形的仪器。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129a_1024.jpg" data-height="588" data-width="888" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129a_1024.jpg" referrerpolicy="no-referrer"></div></div>恢复出来的游戏代码竟然还能玩，而且界面显示清晰：<p></p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129b_1024.jpg" data-height="353" data-width="400" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129b_1024.jpg" referrerpolicy="no-referrer"></div></div>这波操作，看得网友直呼：数据考古不要太酷。<p></p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f0859129c_1024.jpg" data-height="146" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f0859129c_1024.jpg" referrerpolicy="no-referrer"></div></div><b>手敲 0 和 1，100% 恢复古早代码</b><p></p><p>软盘通常以<strong>模拟信号</strong>的方式存储数据。</p><p>这里面存储的模拟信号，用的是最原始的<strong>FM 调制</strong>（频率调制）。</p><p>也就是说，它所存储的信号<strong>0</strong>和<strong>1</strong>，分别会以不同的波形频率表示。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129d_1024.jpg" data-height="171" data-width="320" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129d_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>△</strong>这代表的是 00101100<p></p><p>以下面这段波形为例，单位周期下，在信号为 0 时，输出的频率是比较<strong>慢</strong>的；而当信号变成 1 时，频率就会突然变<strong>快</strong>。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129e_1024.jpg" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129e_1024.jpg" referrerpolicy="no-referrer"></div></div>因此，只需要找到周期规律，就能判断一个周期里，信号代表的是 0 还是 1。<p></p><p>但也不能仅仅看峰值来判断信号是否为 1。例如，在这个周期里，就出现了一个 "<strong>假峰值</strong>"，然而人工解读的结果还是 0。</p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129f_1024.jpg" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f0859129f_1024.jpg" referrerpolicy="no-referrer"></div></div>因为这个峰值其实是一个噪音，信号的整体趋势仍然是下降的，波形的频率本质上并没有变化。（但信号为 1 时，波形会呈现一个完整的周期，起始点和终点的值是非常接近的）<p></p><p>有网友给出了简单的判断方法：一个周期过去，如果信号值变化很大，则代表 0；如果信号值几乎不变，则代表 1。</p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a0_1024.jpg" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a0_1024.jpg" referrerpolicy="no-referrer"></div></div>据 Chris Evans 介绍，代表 0 的正弦波信号，是<strong>8 μ s</strong>一个周期；而代表 1 的正弦波信号，则是<strong>4 μ s</strong>一个周期。<p></p><p>这种情况下，用 Greaseweazle 等 " 现代设备 " 直接读取数据，会出现一个问题。</p><p>如果软盘中的数据，由于各种<strong>外部原因</strong>（时间久远、使用次数过多）出现了损坏，那么仅凭机器，是无法从这些带有大量噪音的数据中完成解读的。</p><p></p><div class="img_box" id="id_imagebox_11" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_11" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a1_1024.jpg" data-height="351" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a1_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>△</strong>就像这样，有一个扇区出现了问题<p></p><p>但人却可以轻易看出这些数据中的 " 规律 "，从而判断信号的状态。</p><p>因此，用示波器将软盘中传输的模拟信号展示出来，再由人工进行解读，会是个更好的方法。</p><p>于是 Evans 和 Pemberton 将示波器直接连上了软盘驱动器的<strong>测试点</strong>，看看软盘到底都输出了些什么信号。</p><p>其中，输入信号会呈现一正一负两个波形，用来消除一部分噪声。</p><p></p><div class="img_box" id="id_imagebox_12" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_12" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a2_1024.jpg" data-height="640" data-width="480" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a2_1024.jpg" referrerpolicy="no-referrer"></div></div>从各种 " 年代久远 " 的软盘解读出的信号来看，难怪 Greaseweazle 这些设备读不出来……（连人也得仔细分辨一会儿）<p></p><p></p><div class="img_box" id="id_imagebox_13" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_13" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f085912a3_1024.jpg" data-height="559" data-width="448" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f085912a3_1024.jpg" referrerpolicy="no-referrer"></div></div>接下来，就是处理这些神奇的波形了。<p></p><p>为了更好地处理噪音、绘制信号图像，Evans 和 Pemberton 还用上了<strong>Audacity</strong>来处理模拟信号。</p><p>Audacity 是一个免费开源的音频分析和编辑工具，能够快速放大和检查波形，还具有多功能低通滤波器，以及直接绘图的功能。</p><p></p><div class="img_box" id="id_imagebox_14" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_14" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a4_1024.jpg" data-height="570" data-width="891" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a4_1024.jpg" referrerpolicy="no-referrer"></div></div>另外，Audacity 也支持 CSV 文件的导入。<p></p><p>Evans 和他的小伙伴还利用这样的音频工具搞出了新的衍生玩法……</p><p>比如将速度放慢 100 倍，听一听软盘记录的声音（软盘每转一次时间为 0.2 秒，该样本为 20 秒）：</p><p>恢复出来的数据，效果还不错。</p><p></p><div class="img_box" id="id_imagebox_15" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_15" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a5_1024.jpg" data-height="305" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a5_1024.jpg" referrerpolicy="no-referrer"></div></div>但上面这些，还只能用于数据比较正常的信号。<p></p><p>对于软盘本身有轻微损坏的信号，想要恢复就变得更困难了。</p><p><b>软盘坏了怎么办？</b></p><p>要是软盘上有划痕，这部分的信号就会变得非常难以辨认。</p><p></p><div class="img_box" id="id_imagebox_16" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_16" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a6_1024.jpg" data-height="400" data-width="300" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a6_1024.jpg" referrerpolicy="no-referrer"></div></div>这是 Evans 和 Pemberton 还原的其中一个<strong>凹痕</strong>的信号，显然中间那部分，信号振幅（图中信号的强度）丢失得非常厉害，还自带<strong>噪音</strong>。<p></p><p></p><div class="img_box" id="id_imagebox_17" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_17" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a7_1024.jpg" data-height="351" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a7_1024.jpg" referrerpolicy="no-referrer"></div></div>其中一种方法是，多用几种不同的软盘驱动器试试。<p></p><p>先用 MF504C 软盘驱动器过滤一下噪音：</p><p></p><div class="img_box" id="id_imagebox_18" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_18" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a8_1024.jpg" data-height="351" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a8_1024.jpg" referrerpolicy="no-referrer"></div></div>好像效果不大。<p></p><p>换上另一个 TEAC 软盘驱动器后，显示的信号更加给力了，但强度还是很小：</p><p></p><div class="img_box" id="id_imagebox_19" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_19" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a9_1024.jpg" data-height="351" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912a9_1024.jpg" referrerpolicy="no-referrer"></div></div>用肉眼分辨的话，难度还是太高了。<p></p><p>鉴于此，Evans 和 Pemberton 又换上了 TEC 软盘驱动器，效果好多了，峰值也变得清晰可辨。</p><p></p><div class="img_box" id="id_imagebox_20" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_20" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912aa_1024.jpg" data-height="351" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912aa_1024.jpg" referrerpolicy="no-referrer"></div></div>除此之外，应对这类信号振幅丢失的情况，还有另一种方法：手工绘制修复。<p></p><p>由于峰值缺失得实在太厉害，只能通过<strong>人为修复</strong>，绘制部分峰值信号，来解决强度过低的问题。</p><p></p><div class="img_box" id="id_imagebox_21" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_21" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ab_1024.jpg" data-height="360" data-width="640" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ab_1024.jpg" referrerpolicy="no-referrer"></div></div>但无论如何，这些信号都可以被修复。<p></p><p>据作者介绍，上面这些办法<strong>100%</strong>可以恢复软盘中的数据。</p><p>除非真的出现了不可抗力。</p><p>例如，软盘的一部分被损坏得很彻底：</p><p></p><div class="img_box" id="id_imagebox_22" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_22" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ac_1024.jpg" data-height="400" data-width="300" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ac_1024.jpg" referrerpolicy="no-referrer"></div></div>这种情况下，软盘数据就彻底没办法恢复了。<p></p><p>所以，家里有 " 上古宝物 " 的小伙伴，一定要保护好自己的软盘！</p><p><b>关于作者</b></p><p>这个项目的作者之一，是最受欢迎的 Linux 发行版 FTP 服务器程序<strong>vsftpd</strong>作者、著名黑客<strong>Chris Evans</strong>。</p><p>他毕业于牛津大学，毕业后进入甲骨文工作，其后又在谷歌工作了 9 年时间，是 Chrome 浏览器安全团队和谷歌黑客团队 Project Zero 的创建者。</p><p>据报道，Project Zero 团队由谷歌内部顶尖安全工程师组成，使命是找出全球范围内高价值的安全漏洞，并将其彻底消除。</p><p>2015 年，特斯拉把这位黑客大神揽入麾下，负责领导安全工作。2016 年，Evans 从特斯拉离职。</p><p></p><div class="img_box" id="id_imagebox_23" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_23" data-original="http://zkres2.myzaker.com/202105/60a9f23eb15ec07f085912ad_1024.jpg" data-height="540" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202105/60a9f23eb15ec07f085912ad_1024.jpg" referrerpolicy="no-referrer"></div></div>Evans 还是漏洞赏金平台 HackerOne 的成立顾问。<p></p><p>现在，据老哥自己说，他处在 " 半退休 " 状态。</p><p></p><div class="img_box" id="id_imagebox_24" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_24" data-original="http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ae_1024.jpg" data-height="450" data-width="948" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202105/60a9f23eb15ec07f085912ae_1024.jpg" referrerpolicy="no-referrer"></div></div>最后的最后，你是否也对 80 年代的游戏代码长啥样产生了好奇？<p></p><p>Evans 表示，这些恢复出来的源代码已经交给游戏原作者，是否开源就要看原作者的意思了，如果你感兴趣，不妨蹲个后续 ~</p><p>不过，此前量子位还介绍过另一个从 21 张软盘中被 " 抢救 " 出来的红白机游戏，代码已在 GitHub 上开源：</p><p>https://github.com/DickBlackshack/Days-of-Thunder-NES-Unpublished/</p><p>参考链接：</p><p> [ 1 ] https://scarybeastsecurity.blogspot.com/2021/05/recovering-lost-treasure-filled-floppy.html</p><p> [ 2 ] https://news.ycombinator.com/item?id=27187435</p><p>— <strong>完</strong> —</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            