
---
title: '妙哉！用文言文编程 竟从28万行唐诗中找出了对称矩阵'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0ca_1024.jpg'
author: ZAKER
comments: false
date: Sat, 27 Mar 2021 21:09:20 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0ca_1024.jpg'
---

<div>   
<p>你能看出来，这首诗妙在哪里吗？</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0ca_1024.jpg" data-height="278" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0ca_1024.jpg" referrerpolicy="no-referrer"></div></div>其实，横着读是一首诗，竖着读还是这首诗！<p></p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0cb_1024.jpg" data-height="360" data-width="368" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0cb_1024.jpg" referrerpolicy="no-referrer"></div></div>而且，这首诗可不是乱编的，其中的诗句都来自《全唐诗》，读起来也颇有意境。<p></p><p>创造这个奇妙组合的，不是文学研究大师，而是一位程序员小哥。</p><p>他用计算机，找出了所有符合规律的古诗，还在 Github 上开源了代码。</p><p>就连 README 文件，也颇具个性：</p><p>余所用之程序，當以 gcc 編譯之如是 gcc -O3 mgsq5.c -o mgsq5</p><p>等一下。这个风格好像很熟悉？</p><p>没错，这位程序员，正是之前开发了火遍全网的文言文编程语言的 Huang Lingdong。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0cc_1024.jpg" data-height="136" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0cc_1024.jpg" referrerpolicy="no-referrer"></div></div>△ 文言文编程的 "Hello，World"<p></p><p>他用数学中的 3 阶幻方（九宫格）作比，把符合这种规律的诗命名为 " 唐诗幻方 "。</p><p>然而，这首诗真正的玄妙之处，还不止在这里。</p><p><strong>玄妙之处</strong></p><p>这首诗，初看只是横竖都能读，但如果把其中汉字编码成数字再看的话，会发现：</p><p>原来，这是个对称矩阵！</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0cd_1024.jpg" data-height="273" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0cd_1024.jpg" referrerpolicy="no-referrer"></div></div>不过，他遍历了全唐诗里所有五言诗共二十八万七千句后，也只能得出两个这样的幻方。<p></p><p>除了 " 风月清江夜 " 以外，还只有一个，不过意境上差了许多，不能令他满意。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0ce_1024.jpg" data-height="360" data-width="366" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0ce_1024.jpg" referrerpolicy="no-referrer"></div></div>在 135600 行七言唐诗中，符合这个规律的七言 " 幻方 "，更是一个都没有。<p></p><p>他只能退而求其次，只寻找奇数项对称的，即每句第 1、3、5、7 个字对称，偶数行用空行代替。</p><p>放宽标准后倒是能找出不少，但再想从其中挑选符合音韵格律、意思上还通顺的，就不多了。</p><p>最后，他选择了其中一个还稍微过得去的做例子，把空行中的字也加上，也能写成对称矩阵：</p><p>这位小哥，是在研究传统文化时，从古代的洛书和璇玑图中获得的灵感。</p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0d0_1024.jpg" data-height="440" data-width="440" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0d0_1024.jpg" referrerpolicy="no-referrer"></div></div>△洛书<p></p><p>洛书写成数字就是三阶幻方，特点是每一行、每一列及对角线中的数字之和都相等。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0d1_1024.jpg" data-height="206" data-width="208" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0d1_1024.jpg" referrerpolicy="no-referrer"></div></div>文字没有求和这种操作，如果按照程序员思维，那就是字符串拼接起来相等。<p></p><p>就这样，得出了要寻找的目标：第 n 行和第 n 列的文字相同。</p><p>璇玑图中共 841 个字，按顺读、逆读、横读、斜读、蛇行读、交叉读、换行读、换列读、间句读都能成诗，总共包含了 7958 首诗。</p><p>其中的关键之处在于，按照不同顺序读，其文字都能组成有意义的诗句。他自认没有古人作诗的才华，就想到从唐诗中寻找符合条件的诗句。</p><p>而且是用现代人的方法——编程来解决。</p><p><strong>以 " 暴力 " 治之</strong></p><p>这位小哥，先是想到了用 " 八皇后问题 " 的计算机解法，来找出符合要求的唐诗。</p><p>八皇后问题，简单来说是这样的：</p><p>8 x 8 的国际象棋棋盘上，摆放 8 个不同的皇后，使其不能互相攻击，即处在同一行、同一列、同一斜线上，求解摆放方法。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0d3_1024.jpg" data-height="606" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0d3_1024.jpg" referrerpolicy="no-referrer"></div></div>这个问题，可以用到一种名为 " 回溯法 " 的算法来求解，原理如图：<p></p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0d4_1024.jpg" data-height="373" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0d4_1024.jpg" referrerpolicy="no-referrer"></div></div>如果用回溯法来找 " 幻方 "，计算机需要先随机 " 找出半句诗 "，再挨个儿往后面搜索合适的诗句。<p></p><p>例如，计算机先从 13 万行唐诗中，随机找出诗句 " 风月清江夜 "：</p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0d5_1024.jpg" data-height="103" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0d5_1024.jpg" referrerpolicy="no-referrer"></div></div>根据对称矩阵的原理，第二句诗的开头，就应该以 " 月 " 为首：<p></p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0d6_1024.jpg" data-height="163" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0d6_1024.jpg" referrerpolicy="no-referrer"></div></div>（以月开头的诗句，应该还是有不少的，像月上柳梢头）<p></p><p>以此类推，第三句诗的开头，就应该以 " 清夜 " 为首：</p><p></p><div class="img_box" id="id_imagebox_11" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_11" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0d7_1024.jpg" data-height="227" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0d7_1024.jpg" referrerpolicy="no-referrer"></div></div>（以清夜开头的诗句，就少了许多）<p></p><p>而第四句诗的开头，就应该以 " 江山归 " 打头：</p><p>（江山归开头的诗 …… 可选范围应该更少了）</p><p>最后一句诗的开头，就必须与前 4 句诗的结尾完全一致，" 夜深来客 "：</p><p></p><div class="img_box" id="id_imagebox_12" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_12" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0d9_1024.jpg" data-height="350" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0d9_1024.jpg" referrerpolicy="no-referrer"></div></div>难度逐渐变成地狱级 ……<p></p><p>在这几步操作中，要是有任何一步无法满足条件，就得全部推倒重来。</p><p>这样的话，最初的第一步，就显得尤为重要：从什么类型的诗句开始遍历，才能最快地找到答案？</p><p>他为此用上了启发式搜索，从已知问题信息入手，对这些空格进行评估，找到限制条件最多、即最容易 " 下笔 " 的那个位置，再从这个位置开始找诗。</p><p>具体写成代码求解的话，就是利用递归法的结构。</p><p>同时，用上剪枝法，缩小剩下位置的查找范围。</p><p>也就是说，要用到约束函数，在扩展节点处剪去不满足约束条件的子树；再用限界函数，剪去得不到最优解的子树。</p><p></p><div class="img_box" id="id_imagebox_13" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_13" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0da_1024.jpg" data-height="203" data-width="400" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0da_1024.jpg" referrerpolicy="no-referrer"></div></div>这样一来，就能降低问题复杂度。<p></p><p>然而在运行代码时，作者却发现，这样做效率并不高。</p><p>这种方法，虽然可以求解 "N" 皇后问题，却不太适合求汉字矩阵。</p><p>因为，要填进格子里的，可不止 8 个皇后，每一格可以填的汉字，就有 5000+ 种选择！</p><p></p><div class="img_box" id="id_imagebox_14" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_14" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0db_1024.jpg" data-height="365" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0db_1024.jpg" referrerpolicy="no-referrer"></div></div>采用递归法的话，计算机在填上前面的汉字时，实际上就缩小了剩下汉字可以搜查的范围。<p></p><p>如果没有找到最初那个合适的字，往往搜到一半后，能用的诗句就没了，又得重新再猜，效率不升反降。</p><p>越想越烦躁，这位小哥干脆一拍大腿：不如暴力搜索！</p><p></p><div class="img_box" id="id_imagebox_15" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_15" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0dc_1024.jpg" data-height="279" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0dc_1024.jpg" referrerpolicy="no-referrer"></div></div>当然，也不是普通的暴力搜索。<p></p><p>会有两个搜索条件：</p><p>其一，以五言诗为例，第五列的前 4 个字，和第五行的前 4 个字，内容是否完全一样？如果不一样，就扔掉。</p><p></p><div class="img_box" id="id_imagebox_16" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_16" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0dd_1024.jpg" data-height="398" data-width="395" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0dd_1024.jpg" referrerpolicy="no-referrer"></div></div>△ 第五行和第五列的前 4 个字<p></p><p>其二，这首诗是不是对称矩阵？不是的话，就扔掉。</p><p></p><div class="img_box" id="id_imagebox_17" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_17" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0de_1024.jpg" data-height="244" data-width="243" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0de_1024.jpg" referrerpolicy="no-referrer"></div></div>利用 C 语言写好后，不用 1 小时就能跑出所有的 " 对称诗 "。<p></p><p>作者表示，自己并非文学研究的专家，也不是算法专家，因此，这种方法可能并不是最好的办法。</p><p>诸君若有更好的求解思路，可以来找他玩耍 ~</p><p><strong>作者介绍</strong></p><p></p><div class="img_box" id="id_imagebox_18" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_18" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0df_1024.jpg" data-height="600" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0df_1024.jpg" referrerpolicy="no-referrer"></div></div>作者 Huang Lingdong，在发布文言文编程语言时还在卡耐基梅隆大学上本科。现在已毕业，在母校的 Studio for Creative Inquiry 做研究助理，为博物馆和学校等组织开发交互媒体项目。<p></p><p>这位小哥热爱编程和传统文化，还开发过写诗 IDE，能自动检查平仄等格律规则，内置韵书和康熙字典做参考。</p><p>还能通过机器学习分析用户作品，并与《全唐诗》中的诗句做比对，看你写的诗像哪位诗人的风格。</p><p></p><div class="img_box" id="id_imagebox_19" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_19" data-original="http://zkres2.myzaker.com/202103/606007908e9f09294252f0e0_1024.jpg" data-height="516" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202103/606007908e9f09294252f0e0_1024.jpg" referrerpolicy="no-referrer"></div></div>除了诗词古文，他对传统美术也颇有研究，开发过无限生成随机山水画的工具，和多款中文字体。<p></p><p></p><div class="img_box" id="id_imagebox_20" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_20" data-original="http://zkres1.myzaker.com/202103/606007908e9f09294252f0e1_1024.jpg" data-height="298" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202103/606007908e9f09294252f0e1_1024.jpg" referrerpolicy="no-referrer"></div></div>△就是不知道为什么山水画里有个电线杆<p></p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            