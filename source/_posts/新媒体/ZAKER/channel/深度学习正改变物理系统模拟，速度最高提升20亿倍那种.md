
---
title: '深度学习正改变物理系统模拟，速度最高提升20亿倍那种'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2df_1024.jpg'
author: ZAKER
comments: false
date: Mon, 11 Oct 2021 23:44:00 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2df_1024.jpg'
---

<div>   
<p>如果经常玩大型游戏的话应该会发现，游戏里的物理引擎效果越来越好了。</p><p>比如育碧公司的新游戏《极限国度》中自行车<strong>溅起的泥点</strong>、受到滑板冲击<strong>改变的雪道和飞溅的雪花</strong>、随着角色姿势不断变化的<strong>衣服褶皱</strong>等逼真细节，都让玩家更能感到身临其境。</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_0" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2df_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2df_raw.gif" data-height="407" data-width="900" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2df_1024.jpg" referrerpolicy="no-referrer"></div></div>但这里面有一个问题越来越突显：<p></p><p>玩家对游戏画面的要求永远在提高，物理解算器的发展却遇到了瓶颈，从算法上可以优化的余地已经不多了，以后还有什么办法能加速物理模拟？</p><p>育碧公司其实已经找到办法了，用 AI。</p><p>育碧的 AI 研发部门 La Forge 早在 2017 年就已成立，在 AI 技术应用于游戏开发中已经做出不少成果。</p><p>他们用强化学习优化游戏 NPC 的寻路行为，用 GAN 生成丰富的 NPC 脸型（知道《看门狗军团》号称有 900 万个可招募 NPC 怎么来的了吧）。</p><p>对了，La Forge 还开发了一个 AI 能快速寻找代码中的 Bug（但 Bug 还是很多啊）。</p><p>在物理模拟上，他们把要模拟的物体在前 3 帧的位置作为输入，喂给神经网络来预测下一帧，还用主成分分析法（PCA）简化计算，最终把不同类型物理模拟的速度提高了<strong>300-5000 倍</strong>。</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e0_1024.jpg" data-height="337" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e0_1024.jpg" referrerpolicy="no-referrer"></div></div>虽然还没听说有在哪款游戏里大规模实际应用上，但光凭这个数据就足以让人期待了。<p></p><p>尤其是那些经历过打开模拟头发运动的 " 海飞丝特效 " 游戏就变卡的玩家。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_2" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e1_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e1_raw.gif" data-height="390" data-width="700" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e1_1024.jpg" referrerpolicy="no-referrer"></div></div>毕竟小孩子才做选择，大人画质和帧数全都要。<p></p><p><b>预测代替计算</b></p><p>游戏与电影最大的不同就是有玩家的参与。</p><p>电影可以在制作时使用大规模机群消耗大量时间渲染好<strong>固定</strong>的画面。</p><p>但游戏要根据玩家的操作实时计算并反馈结果，还只能靠玩家自己的机器的计算能力。</p><p>育碧团队的神经网络用预测代替了密集的计算，训练好后只需要很少的资源就能快速给出结果。</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_3" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e2_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e2_raw.gif" data-height="506" data-width="900" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e2_1024.jpg" referrerpolicy="no-referrer"></div></div>在布料模拟中，只消耗了不到 10mb 的内存和显存，每秒可以给出 2000 多帧。<p></p><p>但是神经网络的训练不是需要很长时间吗？</p><p>没错，除了训练过程消耗时间，生成训练所需的大量数据要消耗更多时间。</p><p>不过这些都是一次性的工作，可以在游戏开发阶段由游戏公司的计算资源完成。</p><p>也就是把计算的重担从运行时 ( Runtime ) 玩家自己的机器转移到了训练服务器上。</p><p>对于游戏角色的动作，用物理解算器给出精准数据的速度只能达到每秒 3 帧，而神经网络的预测却可以做到每秒 2000 多帧。</p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_4" data-original="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e3_1024.jpg" data-gif-url="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e3_raw.gif" data-height="418" data-width="750" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e3_1024.jpg" referrerpolicy="no-referrer"></div></div>看这拳击动作，有点《刺客信条》那味了。<p></p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_5" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e4_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e4_raw.gif" data-height="329" data-width="450" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e4_1024.jpg" referrerpolicy="no-referrer"></div></div>除了游戏公司育碧，DeepMind 也对用神经网络做物理模拟感兴趣。<p></p><p>他们用的是图神经网络，而且预测的不是物体的位置而是加速度，再用欧拉积分计算出相应的速度和位置。</p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e5_1024.jpg" data-height="486" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e5_1024.jpg" referrerpolicy="no-referrer"></div></div>通过这个模型，DeepMind 成功模拟了水、沙子和黏稠物的运动。<p></p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div"><img class="lazy opacity_0 zaker_gif_cache" id="img_7" data-original="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e6_1024.jpg" data-gif-url="http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e6_raw.gif" data-height="335" data-width="600" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202110/61653c668e9f0977ca29d2e6_1024.jpg" referrerpolicy="no-referrer"></div></div>不过可惜的是这项研究更注重展示深度学习方法能做什么，在预测速度上和传统解算方法相比没有太大优势。<p></p><p><b>获诺奖的复杂系统也需要模拟</b></p><p>无论是计算还是预测的方法，既然都把物体的运动过程模拟出来了，除了做游戏和影视特效以外是不是还能有点别的用处？</p><p>没错，物理模拟算法同时也是科学研究的有力工具。</p><p>尤其是像今年的诺贝尔物理奖颁给了气候和材料学领域的复杂系统，以及高能物理、天体物理学这些领域。</p><p>它们研究的对象要么特别宏观要么特别微观，还有的需要等很长时间才能观察到一次，想拿实物去做实验会遇到很多困难。</p><p>为此，牛津大学开发了一套 Deep Emulator Network Search ( DENSE ) 系统，在 10 个科学研究场景中把物理模拟速度最高提高到 20 亿倍。</p><p>你没看错，是<strong>20 亿倍</strong>。</p><p>原来在此之前，科研模拟中主流的做法还是用随机森林和高斯过程等传统机器学习方法来构建模型。</p><p>这些方法首先需要的数据量就非常庞大，还要人工去提取特征。</p><p>在很多科学领域数据并不像图像识别或 NLP 里那么好获得，所以用机器学习来做科研模拟这事进展一直缓慢。</p><p>牛津大学为了在数据有限的情况下搞模拟，首先想到的就是用卷积来自动提取数据特征。</p><p>不过从微观粒子到气候变化再到天体运行，数据类型不同适合的网络结构也大不相同。</p><p>他们最终设计出了一套神经网络超架构，相当于一个模版，在训练时同时进行更新网络的权重和搜索出适合特定问题的结构。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e8_1024.jpg" data-height="272" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e8_1024.jpg" referrerpolicy="no-referrer"></div></div><strong>△</strong>CNN 超架构<p></p><p>在实验中选取了<strong>10 个科学模拟领域</strong>，其中就包括这次获得诺贝尔物理奖的气候模拟：</p><p>1、高能物理学中的弹性 X 射线汤姆逊散射（XRTS）</p><p>2、实验室天体物理学中的光学汤姆逊散射（OTS）</p><p>3、聚变能科学中的托卡马克边缘局域模诊断（ELMs）</p><p>4、等离子体中的 3 倍射线发射光谱（XES）</p><p>5、天体物理学中的星系晕中心分布建模</p><p>6、沙茨基上升海洋高原地震层析成像（SeisTomo）</p><p>7、气候科学中使用大气环流模型（GCM）的全球气溶胶气候建模</p><p>8、生物地球化学中的海洋中上层化学计量建模（MOPS）</p><p>9、中子成像（ICF JAG）</p><p>10、惯性约束聚变实验中的标量测量（ICF JAG Scalars）</p><p>最终的结果，比传统物理解算的方法速度提高了<strong>10 万 -20 亿倍</strong>不等。</p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e9_1024.jpg" data-height="368" data-width="754" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2e9_1024.jpg" referrerpolicy="no-referrer"></div></div>与手工设计的神经网络相比，搜索出来的网络结构收敛速度也都有所提高。<p></p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2ea_1024.jpg" data-height="340" data-width="708" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202110/61653c668e9f0977ca29d2ea_1024.jpg" referrerpolicy="no-referrer"></div></div>这么厉害的方法，也不是没有缺点。<p></p><p>牛津大学认为 DENSE 目前最大的两个局限是不适用于多维数据输入，以及在输出可变性高的区域学习效果不好，不过也算是为很多需要快速计算的研究领域提供了新的解决方案。</p><p>这次获诺贝尔物理奖的三位科学家的主要研究发表于上世纪 60 至 80 年代，那时候的计算机速度要比现在慢上太多，算法也都是直接解算为主。</p><p>即便如此他们也都在各自领域做出了突破性的成果。</p><p>现在有了 AI 物理模拟的帮助，希望更多的研究成果能不断涌现出来。</p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            