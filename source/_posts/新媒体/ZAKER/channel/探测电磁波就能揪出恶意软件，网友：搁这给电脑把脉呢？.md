
---
title: '探测电磁波就能揪出恶意软件，网友：搁这给电脑把脉呢？'
categories: 
 - 新媒体
 - ZAKER
 - channel
headimg: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ad_1024.jpg'
author: ZAKER
comments: false
date: Fri, 14 Jan 2022 02:07:48 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ad_1024.jpg'
---

<div>   
<p>不安装任何杀毒软件，" 悬丝诊脉 " 也能揪出计算机病毒？</p><p>而且准确率达 99.82%，杀毒软件看了都汗颜。</p><p>先请出我们的 " 患者 "，一个经过特殊处理后化身微型计算机的<strong>树莓派</strong>：</p><p></p><div class="img_box" id="id_imagebox_0" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_0" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ad_1024.jpg" data-height="605" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ad_1024.jpg" referrerpolicy="no-referrer"></div></div>病毒入侵、服务中断、后台进程活动等无数个正常和非正常的行为正在这台微型计算机中发生。<p></p><p>然后让 AI 与这个蓝白相间的示波器相连，伸出一根探针 " 悬丝 " 搭在 CPU 上：</p><p></p><div class="img_box" id="id_imagebox_1" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_1" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ae_1024.jpg" data-height="700" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634ae_1024.jpg" referrerpolicy="no-referrer"></div></div>很快啊，AI 就发现了这台计算机上的恶意软件！<p></p><p>明明是在树莓派体内的病毒，怎么探针隔空一放（没直接接触）就被发现了？</p><p>答案是：靠<strong>电磁波</strong>。</p><p>一群来自法国 IRISA 的学者认为，病毒、间谍软件、蠕虫等恶意软件在活动时，会不自觉泄露出与设备正常活动不同的 " 异常 " 电磁波。</p><p>通过<strong>外部</strong><strong>设备</strong>探查、再靠<strong>AI</strong><strong>识别</strong>不同的电磁波，就能隔空发现 " 中毒设备 " 上的病毒踪迹。</p><p></p><div class="img_box" id="id_imagebox_2" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_2" data-original="http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634af_1024.jpg" data-height="418" data-width="484" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634af_1024.jpg" referrerpolicy="no-referrer"></div></div>他们表示，探测设备不和 " 中毒设备 " 相连，因此不会被病毒这类恶意软件发现。<p></p><p>由于不和恶意软件在一个屋子（中毒设备）里打游击，探测设备也就不会引发病毒的回击、反扑或更进一步的伪装。</p><p></p><div class="img_box" id="id_imagebox_3" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_3" data-original="http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b0_1024.jpg" data-height="604" data-width="760" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b0_1024.jpg" referrerpolicy="no-referrer"></div></div>反过来说，伪装再流氓、功能再牛逼的病毒软件，也无法隐藏 " 中毒设备 " 的电磁辐射和散热。<p></p><p></p><div class="img_box" id="id_imagebox_4" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_4" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b1_1024.jpg" data-height="254" data-width="392" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b1_1024.jpg" referrerpolicy="no-referrer"></div></div>该研究目前已经被 ACM 旗下的 ACSAC 2021 收录。据作者表示，对于最常见的几类恶意软件，这种 " 悬丝诊脉 " 法的识别率非常高：<p></p><p></p><div class="img_box" id="id_imagebox_5" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_5" data-original="http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b2_1024.jpg" data-height="148" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b2_1024.jpg" referrerpolicy="no-referrer"></div></div>技术圈大牛 @phunter_lau 更是调侃 " 玄学给予致命一击 "：<p></p><p></p><div class="img_box" id="id_imagebox_6" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_6" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b3_1024.jpg" data-height="292" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b3_1024.jpg" referrerpolicy="no-referrer"></div></div>所以这究竟是一项怎样的研究？<p></p><p><b>贴合现实的 " 病毒数据库 "</b></p><p>要让 AI 学会 " 悬丝 " 诊断，既要让它学会识别疾病，也得避免它发生误诊。</p><p>所以这里面就需要两类电磁波数据集。</p><p><strong>一方面，首先得让它认识够多的 " 疾病 "，也就是恶意软件出现时的电磁波信号。</strong></p><p>像我们常说的电脑病毒，其实只是广大恶意软件（Malware）中的一类。</p><p>恶意软件包括电脑蠕虫、特洛伊木马、勒索软件、间谍软件、甚至是一些广告软件等，能够利用 IoT 设备的漏洞对其造成损伤。</p><p>研究人员从知名恶意软件合集社区 Virusign 中获取样本，共收集了 4790 个 32 位 ELF ARM 恶意软件样本。</p><p></p><div class="img_box" id="id_imagebox_7" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_7" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b4_1024.jpg" data-height="752" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b4_1024.jpg" referrerpolicy="no-referrer"></div></div>他们发现，以下三类恶意软件是最为常见的三个类型：<p></p><p>第一种，<strong>DDoS 攻击</strong>，通过恶意流量淹没网站或网络资源，从而导致资源耗尽，网络服务暂时中断或停止，导致其正常用户无法访问。典型的 DDoS 恶意软件包括 Mirai，Bashlite 等。</p><p>第二种，<strong>勒索软件</strong>（Ransomware），又称阻断访问式攻击（Denial-of-access attack），通过锁死设备、或系统性加密特定硬盘文件，要求受害者缴纳赎金以取回控制权。典型代表如 GoNNaCry。</p><p>第三种，<strong>内核态 Rootkits</strong>。其中 Rootkits 是一组工具的集合，可以替换或更改可执行程序，而内核态 Rootkits 不仅可以访问 OS 文件，还能通过增删代码来更改功能。例如，Keysniffer 就能够记录键盘事件并写入 DebugFS。</p><p>光是掌握这些基本 " 疾病 " 还不够，AI 还得学会识破恶意软件的进一步 " 伪装 "。</p><p>例如，<strong>混淆技术</strong>（Obfuscation）就是比较常见的恶意软件伪装方法。</p><p></p><div class="img_box" id="id_imagebox_8" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_8" data-original="http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b5_1024.jpg" data-height="369" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d48e9f09762b1634b5_1024.jpg" referrerpolicy="no-referrer"></div></div>这种方法有意让代码模糊不清，从而使逆向工程变得困难，原本是一种用于保护含有 IP 价值的程序。但后来却被黑客反向用来削弱杀毒软件，以逃脱其追捕。<p></p><p>据此，研究人员利用混淆技术对恶意软件进行了进一步 " 升级 "，再加入数据集中。</p><p>其中，就包括采用静态代码重写（不透明谓词、假控制流、指令替换、控制流扁平化）和动态代码重写（打包器、代码虚拟化）等方式，对数据进行处理。</p><p><strong>另一方面，除了恶意软件数据以外，AI 还得知道正常情况下的信号数据。</strong></p><p>所以除了恶意的 " 病毒数据库 "，开发者还准备了一个<strong>良性数据集</strong>，以模拟真实场景中 " 随机突发 " 的病毒入侵事件。</p><p>哪些算是良性数据呢？</p><p>比如计算、设备睡眠、照片捕捉、网络工作连接，以及像是媒体播放这种长时间的可执行程序运行。</p><p></p><div class="img_box" id="id_imagebox_9" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_9" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b6_1024.jpg" data-height="726" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b6_1024.jpg" referrerpolicy="no-referrer"></div></div>由于树莓派部署了一个 Linux 4.19.57-v7 ARM v7l 的 Raspbian Buster 操作系统，开发者就从新安装的 Linux 系统中收集 ARM 可执行文件，以此生成良性数据集。<p></p><p>在整个过程中，研究人员一共收集了 100000 份电磁波数据，用于训练 AI。</p><p>但这些数据在交给 AI 用于训练之前，还需要经过一些处理，从收集数据到完成训练一共<strong>分成三步</strong>。</p><p><b>采用时频域分析降低噪声影响</b></p><p>首先，部署数据收集装置，收集信号数据。</p><p></p><div class="img_box" id="id_imagebox_10" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_10" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b7_1024.jpg" data-height="497" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b7_1024.jpg" referrerpolicy="no-referrer"></div></div>这个数据收集装置分为被攻击设备和示波器两部分，其中树莓派是被攻击设备，高速数字转换器 PicoScope 6407（示波器）用于采集和传输数据。<p></p><p>部署好的数据收集装置如下，其中 PicoScope 6407 的探针（EM probe）会被放在树莓派上，用于收集信号：</p><p></p><div class="img_box" id="id_imagebox_11" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_11" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b8_1024.jpg" data-height="707" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b8_1024.jpg" referrerpolicy="no-referrer"></div></div>然后，对数据进行预处理。<p></p><p></p><div class="img_box" id="id_imagebox_12" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_12" data-original="http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b9_1024.jpg" data-height="276" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d48e9f09762b1634b9_1024.jpg" referrerpolicy="no-referrer"></div></div>由于收集到的电磁波信号伴随大量噪音，因此需要将收集到的信号数据进行时域和频域分析，进行特征采集：<p></p><p>最后，用这些数据训练 AI。</p><p>为了选出最适合这项实验的 AI，研究人员分别训练了 SVM、NB、MLP 和 CNN 四种类型的网络：</p><p></p><div class="img_box" id="id_imagebox_13" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_13" data-original="http://zkres1.myzaker.com/202201/61e126d58e9f09762b1634bb_1024.jpg" data-height="474" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d58e9f09762b1634bb_1024.jpg" referrerpolicy="no-referrer"></div></div>最后他们发现 MLP 和 CNN 是最棒的：<p></p><p></p><div class="img_box" id="id_imagebox_14" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_14" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634bc_1024.jpg" data-height="241" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634bc_1024.jpg" referrerpolicy="no-referrer"></div></div>其中 CNN 还要更好一点，具体模型的架构如下：<p></p><p></p><div class="img_box" id="id_imagebox_15" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_15" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634bd_1024.jpg" data-height="514" data-width="574" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634bd_1024.jpg" referrerpolicy="no-referrer"></div></div>训练结果如下，其中 1963 份良性数据（benign）中，只有 1 个被误测为 DDoS；Rootkit 类型的恶意软件数据全部被正确识别；DDoS 和 Ransomware 的识别效果也不错：<p></p><p></p><div class="img_box" id="id_imagebox_16" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_16" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634be_1024.jpg" data-height="508" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634be_1024.jpg" referrerpolicy="no-referrer"></div></div>当然，除了单独的恶意软件类型以外，采用混淆技术后模型分类的效果也依旧不错。<p></p><p>整套流程的逻辑如下：</p><p></p><div class="img_box" id="id_imagebox_17" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_17" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634bf_1024.jg" data-height="765" data-width="1080" src="https://cors.zfour.workers.dev/?http://www.myzaker.com/article/undefined" referrerpolicy="no-referrer"></div></div>其中，树莓派代表的是 " 被攻击设备 "，示波器用探针在外部收集电磁信号后，传给 AI 进行预测，AI 再将预测结果反馈给防火墙，决定是否要拦截恶意软件。<p></p><p>这项研究来自研究机构 IRISA，目前是法国最大的计算机科学和新技术领域研究实验室之一。</p><p><b>设备价格接近 9 万</b></p><p>研究登上的 ACSAC 2021，是一个 " 纯应用型 " 的安全会议。</p><p>然而包括 Gizmodo 在内的外媒表示，想要真正<strong>应用</strong>它来检测恶意软件，还有很多待解决的地方。</p><p>一方面，这篇论文采用的良性数据集，没有将所有使用场景考虑在内，涉及的主要是图片及音视频、以及一些设备良性运转的 " 常规活动 "。</p><p>作者也在论文中提到，论文的最初目的并非<strong>检测</strong>恶意软件，而只是让 AI 学会给几种恶意软件<strong>做分类</strong>。至于实际检测效果还不错，只是他们的 " 意外发现 "。</p><p></p><div class="img_box" id="id_imagebox_18" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_18" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c0_1024.jpg" data-height="368" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c0_1024.jpg" referrerpolicy="no-referrer"></div></div>另一方面，这项研究所采用的设备价格不菲。<p></p><p>光是 Picoscope 6407 这台数字转换器，在国内某宝的价格就接近<strong>90000 元</strong>，至少不太亲民：</p><p></p><div class="img_box" id="id_imagebox_19" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_19" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c1_1024.jpg" data-height="536" data-width="468" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c1_1024.jpg" referrerpolicy="no-referrer"></div></div>要想凑齐这一整套设备，从资金上来看还是有点难度的（狗头）。<p></p><p>不知道研究人员后续会不会考虑从实际落地的角度出发，将这个设备成本搞得更便宜一点。</p><p>对于研究本身，有网友调侃，这是 " 真把脉来了 "：</p><p></p><div class="img_box" id="id_imagebox_20" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_20" data-original="http://zkres1.myzaker.com/202201/61e126d58e9f09762b1634c2_1024.jpg" data-height="197" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres1.myzaker.com/202201/61e126d58e9f09762b1634c2_1024.jpg" referrerpolicy="no-referrer"></div></div>有人感觉这是个绝妙的想法：<p></p><p>但也有网友认为，这篇论文就是在扯淡，看上去应用范围（物联网）过于狭窄，只是标题上蹭了热度比较高的领域。</p><p></p><div class="img_box" id="id_imagebox_21" onclick><div class="content_img_div perview_img_div"><img class="lazy opacity_0 " id="img_21" data-original="http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c4_1024.jpg" data-height="186" data-width="1080" src="https://cors.zfour.workers.dev/?http://zkres2.myzaker.com/202201/61e126d58e9f09762b1634c4_1024.jpg" referrerpolicy="no-referrer"></div></div>对于用电磁波信号来检测恶意软件，你觉得这事靠谱吗？<p></p><div id="recommend_bottom"></div><div id="article_bottom"></div>  
</div>
            