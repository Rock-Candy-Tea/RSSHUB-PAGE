
---
title: '自制自行车码表从B站火到 GitHub：硬件和软件均已开源'
categories: 
 - 新媒体
 - IT 之家
 - 热榜
headimg: 'https://img.ithome.com/newsuploadfiles/2021/7/e36ed589-ea10-4a59-8541-9b59fc7f0fbb.gif'
author: IT 之家
comments: false
date: Fri, 23 Jul 2021 05:00:59 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/7/e36ed589-ea10-4a59-8541-9b59fc7f0fbb.gif'
---

<div>   
<p>7 月 23 日消息，民间又有高手“出没”，一位“技术宅”自制的自行车码表在B站火了，短短几天引来 20 多万人围观。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/e36ed589-ea10-4a59-8541-9b59fc7f0fbb.gif" w="600" h="353" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="600" height="353" referrerpolicy="no-referrer"></p><p><span class="accentTextColor">常规的速度、距离、时间、卡路里、航向显示的记录功能自不用多提，该设备还可显示经纬度和海拔</span>。</p><p>它还配有离线地图，<span class="accentTextColor">可显示你的实时位置与骑行轨迹</span>。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/21aab103-0c88-4be9-9811-091c75a166f3.gif" w="300" h="300" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="300" height="300" referrerpolicy="no-referrer"></p><p>该设备在汽车、高铁上也能测速。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/06f329bc-87d9-4059-83ef-af6c20da3479.gif" w="532" h="620" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="532" height="620" referrerpolicy="no-referrer"></p><p>它还可以切换界面查看电量、骑行记录、GPS 定位、传感器等系统数据，相当丝滑。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/5054a934-566d-4bc1-b278-9579d4b9bf55.gif" w="600" h="661" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="600" height="661" referrerpolicy="no-referrer"></p><p>再看细节上，UI 设计可是比市面上不少码表都要高级。</p><p>这要是告诉我它是某个大牌而非自制的（除了壳很明显以外），我可能都信了。</p><p>网友们也是纷纷 respect，称赞它打爆那些溢价离谱的码表：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/5ef550fa-f6c3-46c3-b04b-d5c1c7f1ef8e.png" w="1080" h="160" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="121" referrerpolicy="no-referrer"></p><p>“完成度离谱”，是不是很想要链接？</p><p>好家伙，连稚晖君都被吸引过来了（后来佳明也现身评论区“自黑”，见后文）：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/685e79fe-baa1-433e-8ff8-3f0483ac9515.png" w="1080" h="191" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="145" referrerpolicy="no-referrer"></p><p>稚晖君的真・自行车和这个码表是不是可以搭配使用？</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/7c0a72c1-3221-4d2d-bee5-174980da7802.png" w="768" h="327" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="768" height="327" referrerpolicy="no-referrer"></p><p>除了在B站上很火，<span class="accentTextColor">这个码表项目也登上了今日 GitHub 热榜</span>：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/aa38dc26-188e-49a7-8aaa-fc5eca7d8285.png" w="1080" h="133" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="101" referrerpolicy="no-referrer"></p><p><span class="accentTextColor">而据网友粗略估算这个码表的硬件成本大概不到 300 元</span>，如此优秀的它，是如何 DIY 出来的呢？</p><h2>如何 DIY 一个自行车码表</h2><p>X-TRACK 软件架构示意图如下：由 HAL、Framework 和 App 三层组成，Framework 为核心。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/e6b6a81d-bc35-4036-a1c7-eaa88b58538e.png" w="426" h="381" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="426" height="381" referrerpolicy="no-referrer"></p><p>HAL 层负责底层芯片驱动和传感器原始数据获取；</p><p>Framework 又包括三个模块，分别负责图形渲染、页面生命周期管理和消息分发处理。</p><p>其中消息框架模块提供数据的分发和处理。</p><p><span class="accentTextColor">使用订阅发布机制</span>，将 HAL 层的接收到的传感器数据发布，转发给对应的订阅者进行数据处理。</p><blockquote><p>以 GPS 为例，GPS 数据处理节点每秒读取一次卫星数据，然后发起 publish，由消息框架将 GPS 数据推送给订阅者。</p><p>在运动数据处理节点中订阅 GPS 数据。在收到 GPS 数据之后，运动数据处理节点根据 GPS 数据计算总里程，平均速度等信息。在表盘页面中，拉取运动数据节点信息，将其显示在表盘页面中。</p></blockquote><p><em>ps. 地图软件为 GPXSee。</em></p><p><strong>实现主要有 7 步：</strong></p><p>1、首先是硬件设计。</p><p>用 AD（Altium Designer）进行 PCB 板线路设计：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/c869d9cb-b372-4353-8a1a-182abd36d4bf.jpg@s_2,w_820,h_435" w="1080" h="573" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" srcset="https://img.ithome.com/newsuploadfiles/2021/7/c869d9cb-b372-4353-8a1a-182abd36d4bf.jpg 2x" width="1080" height="435" referrerpolicy="no-referrer"></p><p>电路图和 PCB 文件也可以在 GitHub 详细查看。</p><p>2、然后就是被大家纷纷夸赞的 UI 设计：</p><p>设计软件是 Adobe AI。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/eefb3700-84c7-4720-bdd1-7089ccba7c2c.png" w="1080" h="521" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="396" referrerpolicy="no-referrer"></p><p>3、接着在 3ds MAX 上进行外壳设计：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/68762215-e56f-4487-a484-285bb76fa848.png" w="1080" h="545" alt="图片" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="414" referrerpolicy="no-referrer"></p><p>4、再然后就是软件设计了：</p><p>编程语言为 C++：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/d40f232d-08af-4518-bbf3-05e00764bed1.png" w="1080" h="593" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="450" referrerpolicy="no-referrer"></p><p>5、再使用模拟器直接在 PC 上模拟效果。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/b5df74e3-179c-4f67-b624-1a272158e9cd.gif" w="600" h="321" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="600" height="321" referrerpolicy="no-referrer"></p><p>码表的图形界面采用了免费开源的 GUI 图形库 LVGL。</p><p>成品使用了许多 LVGL 提供的基础控件，例如在地图页面的轨迹显示中使用了 line 控件，地图显示使用了 image 控件，在表盘页面的页面切换选择，使用了 button 控件。</p><p>6、调试调试，没问题就可进行编译下载。</p><p>这里用的是 Keil。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/0680e4c9-1d9d-4d79-a370-65f39bf84e2e.png" w="1080" h="602" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="457" referrerpolicy="no-referrer"></p><p>7、最后，将最终程序烧录到单片机 (AT32F403ACGU7) 上运行，再连上 ST-Link 进行调试。</p><p>成功！</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/04856849-ba76-476e-9879-9af700d4c6e6.gif" w="600" h="354" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="600" height="354" referrerpolicy="no-referrer"></p><p>另外可能很多人不知道，<span class="accentTextColor">UP 主用的这个 AT32 系列 MCU 是国产设计（重庆雅特力）</span>，可替代意法半导体 STM32F103 系列，主频更高、RAM 更大。</p><p>全部硬件配置如下：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/e0bf39a0-470f-4305-b391-63dde23069b9.png" w="1080" h="565" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="429" referrerpolicy="no-referrer"></p><p><span class="accentTextColor">该设备的内存有 32GB，存下一个 1GB 多的北京地图不是事儿</span>。</p><p>另外，除了开头提到的功能以外，它还支持地图缩放、计步功能、导出标准 GPX 格式的轨迹、RTC 自动根据 GPS 校准、掉电自动保存数据 (JSON 格式文件)、不过续航为 4 小时 (持续工作，始终亮屏)。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/12d773c2-9017-4582-9a42-2a4bf264be14.png" w="960" h="540" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="960" height="461" referrerpolicy="no-referrer"></p><p><span class="accentTextColor">整个设计的硬件和软件部分都已开源</span>。</p><h2>连“竞品”佳明都来点赞</h2><p>怎么样？学会（废）了吗？</p><p>不少围观群众觉得这样一个 UI 颜值爆表、功能丰富的自行车码表如果真的能有厂商合作生产的话，那还有佳明这些产品什么事儿。</p><p>有人在评论区 @Garmin 佳明，没想到还真把它引过来了：这下好了，连“竞品”都给 X-TRACK 点赞。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/ffa3e06a-dc4c-4e4f-a330-09f70bb3a538.png" w="1080" h="219" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="166" referrerpolicy="no-referrer"></p><p>有人还算了一笔账，在某宝按教程买这些配件一共需要不到 300 元，比佳明上千的价格是便宜不少（虽然续航能力低一点）。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/dbea0f0a-6e12-4410-8cef-8076723d91b7.png" w="1080" h="334" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="254" referrerpolicy="no-referrer"></p><p>催量产的网友真的非常非常多，不过真要商业化的话，除了续航能力，有自行车骑行爱好者认为还需支持 ant+、踏频、心率、功率设备的连接、防尘防水等功能，以及考虑现在的屏幕在阳光下的能见度等问题。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/88fd5a4a-3872-42bc-a0d8-d6f4b87cab18.png" w="1080" h="197" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="150" referrerpolicy="no-referrer"></p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/b5a3a321-dd2c-424c-b047-a02040da2e43.png" w="1080" h="160" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="121" referrerpolicy="no-referrer"></p><p>不知道未来，X-TRACK 还会不会被继续增加或改进呢？</p><p>毕竟毕业于电子信息专业的 UP 主说自己也算半个自行车爱好者。</p><p>最后，除了这个梦幻般的自行车码表，<span class="accentTextColor">他还用 STM32 自制过智能手表、航模遥控器</span>（被网友称赞可以直接拿来卖的程度）。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/7/9a2e2091-cde5-4cfb-8a8a-04633ac94cb7.png" w="1080" h="486" title="自制自行车码表从B站火到 GitHub：硬件和软件均已开源" width="1080" height="369" referrerpolicy="no-referrer"></p>
          
</div>
            