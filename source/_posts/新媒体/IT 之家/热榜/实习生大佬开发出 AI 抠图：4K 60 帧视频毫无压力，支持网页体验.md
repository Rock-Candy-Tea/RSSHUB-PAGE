
---
title: '实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验'
categories: 
 - 新媒体
 - IT 之家
 - 热榜
headimg: 'https://img.ithome.com/newsuploadfiles/2021/8/501d44c9-b519-4364-b29e-314df1ae2081.gif'
author: IT 之家
comments: false
date: Mon, 30 Aug 2021 06:59:04 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/8/501d44c9-b519-4364-b29e-314df1ae2081.gif'
---

<div>   
<p>（原标题：完美抠图王冰冰！字节实习生开发的 AI，实现 4K60 帧视频实时抠图，连头发丝都根根分明）</p><p>看这一头蓬松的秀发，加上帅气的动作，你以为是在绿幕前拍大片？</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/501d44c9-b519-4364-b29e-314df1ae2081.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>No、No、No</p><p>这其实是 AI 拿来视频实时抠图后的效果。</p><p>没想到吧，实时视频抠图，现在能精细到每一根发丝。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/350706e0-400c-4174-bca0-857c37a45902.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>换到 alpha 通道再看一眼，不用多说，德芙打钱吧（手动狗头）。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/18504313-d008-4b29-b570-a1101d8a96b9.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>这就是来自字节跳动实习生小哥的最新研究：实时高分辨率视频抠图大法。</p><p>无需任何辅助输入，把视频丢给这个名为 RVM 的 AI，它分分钟就能帮你把人像高精度抠出，将背景替换成可以任意二次加工的绿幕。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/8348bb73-0cb5-49af-8380-a3f9fe2c5c73.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>不信有这么丝滑？我们用线上 Demo 亲自尝试了一波。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/0cafe1c7-455a-4946-9e47-530aa65fb324.gif" w="1079" h="402" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1079" height="306" referrerpolicy="no-referrer"></p><p>相比之下，现在在线会议软件里的抠图，一旦头发遮住脸，人就会消失……</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/cf22fdb6-6cbb-4625-a1fb-d0fecc7678af.gif" w="640" h="338" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="338" referrerpolicy="no-referrer"></p><p>头发丝更是明显糊了。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/bdde8c96-73c6-403e-98cc-4b3ebe0f70cc.jpg@s_2,w_820,h_304" w="1058" h="392" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" srcset="https://img.ithome.com/newsuploadfiles/2021/8/bdde8c96-73c6-403e-98cc-4b3ebe0f70cc.jpg 2x" width="1058" height="304" referrerpolicy="no-referrer"></p><p>难怪看得网友直言：</p><p>不敢想象你们把这只 AI 塞进手机里的样子。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/ba992db9-b415-4e0e-a649-cd3fca3db7a1.png" w="976" h="162" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="976" height="136" referrerpolicy="no-referrer"></p><p>目前，这篇论文已经入选 WACV 2022。</p><p>你也可以上手一试目前，RVM 已经在 GitHub 上开源，并给出了两种试玩途径：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/3fe51c11-fbee-41f2-9a91-47ae8a1b4f5e.png" w="1080" h="235" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="178" referrerpolicy="no-referrer"></p><p>于是我们也赶紧上手试了试。</p><p>先来看看效果：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/cd0e4dee-5314-4518-aded-d8205518125f.gif" w="640" h="358" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="358" referrerpolicy="no-referrer"></p><p>首先来点难度低的。对于这种人物在画面中基本不移动的情况，RVM 可以说是表现的非常好，和人工抠图几乎无差别。</p><p>现在，王冰冰进入动森都毫不违和了。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/9ca61a12-8681-43f8-bff7-4a56b1f14cf9.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>于是开脑洞，也变得简单了许多……</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/1c935606-4a1e-4099-9c46-78110c61debc.gif" w="570" h="324" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="570" height="324" referrerpolicy="no-referrer"></p><p>咳咳，言归正传。人物动作幅度加大会怎样呢？</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/05310928-e9ef-4900-8c51-925e3080bce7.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>对于多人舞蹈视频而言，RVM 的表现也很 nice。即便动来动去、头发乱甩，也没有影响它的抠图效果。只有在人物出现遮挡的情况下，才会出现瑕疵。对比前辈方法 MODNet，确实有不小的进步。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/ebe13b1f-4dc4-490f-889b-5fc99e152e42.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>不过我们也发现，如果视频的背景较暗，就会影响 RVM 的发挥。</p><p>比如在这种背景光线昏暗的情况下，抠图的效果就非常不尽人意了。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/fce64865-30a6-497a-a354-ac56ef7a0f7a.png" w="1080" h="489" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="371" referrerpolicy="no-referrer"></p><p>可以看到，博主老哥的头发完全糊了。</p><p>而且身体的边界线也不够清晰。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/473fd7b3-20ba-45ce-aaa8-cb19f8ccc8c1.gif" w="640" h="314" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="314" referrerpolicy="no-referrer"></p><p>所以，如果你想自己拍视频试玩，就一定要选择光线充足的场景。</p><p>利用时间信息</p><p>那么这样的“魔法”，具体又是如何实现的？</p><p>照例，我们先来扒一扒论文~</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/c0d78e8b-830d-4509-b78c-aeec4d759712.png" w="1080" h="305" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="232" referrerpolicy="no-referrer"></p><p>实际上，有关视频抠图的算法如今已不鲜见，其中大多数采用的是将视频中的每一帧作为独立图像来实现抠图的方法。</p><p>不同与此，在这篇论文中，研究人员构建了一个循环架构，利用上了视频的时间信息，在时间一致性和抠图质量上取得了明显改进。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/f53fef6a-9a26-4e5e-9fab-6555712d2316.png" w="1080" h="401" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="304" referrerpolicy="no-referrer"></p><p>从上图中可以看出，RVM 的网络架构包括 3 个部分：</p><p>特征提取编码器，用来提取单帧特征；</p><p>循环解码器，用于汇总时间信息；</p><p>深度引导滤波（DGF）模块，用于高分辨率上采样。</p><p>其中，循环机制的引入使得 AI 能够在连续的视频流中自我学习，从而了解到哪些信息需要保留，哪些信息可以遗忘掉。</p><p>具体而言，循环解码器采用了多尺度 ConvGRU 来聚合时间信息。其定义如下：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/f9303fe1-5a2f-4441-9316-ff1fdf1cc682.png" w="654" h="184" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="654" height="184" referrerpolicy="no-referrer"></p><p>在这个编码器-解码器网络中，AI 会完成对高分辨率视频的下采样，然后再使用 DGF 对结果进行上采样。</p><p>除此之外，研究人员还提出了一种新的训练策略：同时使用抠图和语义分割目标数据集来训练网络。</p><p>这样做到好处在于：</p><p>首先，人像抠图与人像分割任务密切相关，AI 必须学会从语义上理解场景，才能在定位人物主体方面具备鲁棒性。</p><p>其次，现有的大部分抠图数据集只提供真实的 alpha 通道和前景信息，所以必须对背景图像进行合成。但前景和背景的光照往往不同，这就影响了合成的效果。语义分割数据集的引入可以有效防止过拟合。</p><p>最后，语义分割数据集拥有更为丰富的训练数据。</p><p>经过这一番调教之后，RVM 和前辈们比起来，有怎样的改进？</p><p>从效果对比中就可以明显感受到了：</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/176efebd-2b62-488f-a7db-10e75b5b0be5.gif" w="640" h="360" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="640" height="360" referrerpolicy="no-referrer"></p><p>另外，与 MODNet 相比，RVM 更轻更快。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/42bb9123-4a7e-479d-9b5d-a96dcaf1323c.png" w="688" h="274" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="688" height="274" referrerpolicy="no-referrer"></p><p>从下面这张表格中可以看出，在 1080p 视频上 RVM 的处理速度是最快的，在 512×288 上比 BGMv2 略慢，在 4K 视频上则比带 FGF 的 MODNet 慢一点。研究人员分析，这是因为 RVM 除了 alpha 通道外还预判了前景。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/e40beee5-b902-469d-bec1-99a096ee75cb.png" w="698" h="456" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="698" height="456" referrerpolicy="no-referrer"></p><p>更直观的数据是，在英伟达 GTX 1080Ti 上，RVM 能以 76FPS 的速度处理 4K 视频，以 104FPS 的速度处理 HD 视频。</p><p>一作字节跳动实习生</p><p>这篇论文是一作林山川在字节跳动实习期间完成的。他本科、硕士均毕业于华盛顿大学，曾先后在 Adobe、Facebook 等大厂实习。2021 年 3 月-6 月，林山川在字节跳动实习。8 月刚刚入职微软。</p><p>事实上，林山川此前就曾凭借 AI 抠图大法拿下 CVPR 2021 最佳学生论文荣誉奖。</p><p>他以一作身份发表论文《Real-Time High-Resolution Background Matting》，提出了 Background Matting V2 方法。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/0eba0a10-643b-40f1-89ce-9893c0daa3ab.png" w="1080" h="620" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="471" referrerpolicy="no-referrer"></p><p>这一方法能够以 30FPS 的速度处理 4K 视频，以 60FPS 的速度处理 HD 视频。</p><p>值得一提的是，Background Matting 这一系列方法不止一次中了 CVPR。此前，第一代 Background Matting 就被 CVPR 2020 收录。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/552ac51c-08ac-46c0-bc42-73269841b39c.png" w="1080" h="402" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="1080" height="305" referrerpolicy="no-referrer"></p><p>两次论文的通讯作者都是华盛顿大学副教授 Ira Kemelmacher-Shlizerman，她的研究方向为计算机视觉、计算机图形、AR/VR 等。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/8/c61fe757-511f-4e90-a942-6be85915c32c.jpg" w="160" h="200" title="实习生大佬开发出 AI 抠图：4K 60 帧视频毫无压力，支持网页体验" width="160" height="200" referrerpolicy="no-referrer"></p><p>此外，本次论文的二作为 Linjie Yang，他是字节跳动的研究科学家。本科毕业于清华大学，在香港中文大学获得博士学位。</p><p>对了，除了能在 Colab 上试用之外，你也可以在网页版上实时感受一下这只 AI 的效果，地址拿好：</p><p>https://peterl1n.github.io/RobustVideoMatting/#/demo</p><p>GitHub 地址：</p><p>https://github.com/PeterL1n/RobustVideoMatting</p><p>论文地址：</p><p>https://arxiv.org/abs/2108.11515</p><p>参考链接：</p><p>https://www.reddit.com/r/MachineLearning/comments/pdbpmg/r_robust_highresolution_video_matting_with/</p>
          
</div>
            