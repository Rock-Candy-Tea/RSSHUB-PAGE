
---
title: 'WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强'
categories: 
 - 新媒体
 - IT 之家
 - 热榜
headimg: 'https://img.ithome.com/newsuploadfiles/2021/11/e613647f-1f4a-49b9-b9f4-040435c8c1d8.jpg'
author: IT 之家
comments: false
date: Mon, 15 Nov 2021 15:16:36 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/11/e613647f-1f4a-49b9-b9f4-040435c8c1d8.jpg'
---

<div>   
<p data-vmark="33a1">WPS 官微发布公告，说是自即日起 WPS 开始正式支持 XLOOKUP 函数。很多人就奇怪了，作为一款办公软件，增加个函数不是太正常了？这有啥可激动的？其实能让 WPS“激动”自然是有些道理，理由就是这个 XLOOKUP 实在太强了！</p><h2 data-vmark="6565">示例 1.  反向查找</h2><p data-vmark="49e2">目的：通过“姓名”反查“工号”</p><p data-vmark="ed85">公式：=XLOOKUP (G6,B:B,A:A)</p><p data-vmark="dea3"><img src="https://img.ithome.com/newsuploadfiles/2021/11/e613647f-1f4a-49b9-b9f4-040435c8c1d8.jpg" w="700" h="241" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="241" referrerpolicy="no-referrer"></p><p data-vmark="6e8e">日常工作中我们经常会遇到用姓名查工号的情况，由于原始数据中，“工号”字段通常是位于“姓名”之前，因此直接使用 VLOOKUP 肯定无法得到结果。通常的办法，是借助 IF 函数建立一个虚拟数组“IF (&#123;1,0&#125;,B:B,A:A)”，将“工号”与“姓名”临时对调一下，以满足 VLOOKUP 的操作需求。不过它的问题就是，对于新手童鞋来说，这个数组太难理解了。</p><p data-vmark="c06f">如果换作 XLOOKUP 呢？很简单，直接输入“=XLOOKUP (G6,B:B,A:A)”就行。整个语法基本参照了 VLOOKUP 的习惯，先确定好要查找的内容（G6），然后告诉表格去哪里查找（B:B），最后返回对应列的结果就可以了（A:A）。相比之下，XLOOKUP 的逻辑是不是就清晰多了！</p><h2 data-vmark="23b7">示例 2.  出错处理</h2><p data-vmark="5b5a">目的：当查询无结果时，显示“查无此人”</p><p data-vmark="cf46">公式：=XLOOKUP (G6,B:B,A:A,"查无此人")</p><p data-vmark="04bb"><img src="https://img.ithome.com/newsuploadfiles/2021/11/0b33b3c1-2a6c-4f4d-9776-072f05483aed.jpg" w="700" h="231" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="231" referrerpolicy="no-referrer"></p><p data-vmark="7612">为了防止 LOOKUP、VLOOKUP 等函数意外出错，我们通常会在函数外围包裹一层 IFERROR，用于手工控制出错信息的显示。不过这种做法一来会让公式变长，二来也不怎么高效。而 XLOOKUP 的处理方法绝对是简单粗暴，直接将出错信息标在了函数里。高效的同时，也让公式更加简练，就像下面这样：“=XLOOKUP (G6,B:B,A:A,"查无此人")”。</p><h2 data-vmark="1d0d">示例 3.  批量化查询</h2><p data-vmark="440d">目的：通过“工号“查询该员工所有信息</p><p data-vmark="c28e">公式：=XLOOKUP (G8,A:A,B:E)</p><p data-vmark="3383"><img src="https://img.ithome.com/newsuploadfiles/2021/11/f8d70c53-72b5-4691-8f5e-3d601f25544c.jpg" w="700" h="227" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="227" referrerpolicy="no-referrer"></p><p data-vmark="4e85">编写搜索器时，会在原始数据中批量查询所需的内容。通常有两种解决方法，一是借助 VLOOKUP 手工确定要查询的列，二是通过 COLUMN 函数配合 VLOOKUP 做一个半自动查询器。</p><p data-vmark="b4cd">那么 XLOOKUP 有没有更简单的办法呢？答案是有的，方法就是直接填写“=XLOOKUP (G8,A:A,B:E)”。语法上依旧沿用了 VLOOKUP 的逻辑，先是确定好要查找的内容（G8），然后告诉表格去哪里查找（A:A），接下来返回 B:E 列里的对应信息即可。由于函数的“溢出效应”，相邻几个单元格（性别、职务、部门）也会自动填好结果，连拖拽这一步都省去了。</p><h2 data-vmark="ebe1">示例 4.  多条件查询</h2><p data-vmark="d6fb">目的：通过“姓名”和“性别”两组条件查询员工信息</p><p data-vmark="e08f">公式：=XLOOKUP (G7&H7,B:B&C:C,D:D)</p><p data-vmark="4e6f"><img src="https://img.ithome.com/newsuploadfiles/2021/11/5ab145db-153c-4642-a4c1-07b815e79f06.jpg" w="700" h="197" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="197" referrerpolicy="no-referrer"></p><p data-vmark="0948">现实中重名的情况并不少见，当一个条件无法确定一个人时，就要加载第二组条件。比如本例中，小编就使用了“姓名”+“性别”的双重条件验证。对于此类需求，传统的 VLOOKUP 需要借助 IF 函数生成一个虚拟数组。而在 XLOOKUP 之下，上述公式可以直接简化为“=XLOOKUP (G7&H7,B:B&C:C,D:D)”。</p><h2 data-vmark="359c">示例 5.  模糊查询</h2><p data-vmark="9cde">目的：根据分值为每个人标注等级。</p><p data-vmark="3363">公式：=XLOOKUP (D2,$H$2:$H$5,$I$2:$I$5,,-1)</p><p data-vmark="96b3"><img src="https://img.ithome.com/newsuploadfiles/2021/11/01e82e53-979b-4d18-970a-60ae35987c8a.jpg" w="700" h="246" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="246" referrerpolicy="no-referrer"></p><p data-vmark="4ca2">熟悉 VLOOKUP 的小伙伴，大多知道这个函数最后有一个“精确匹配 FALSE”和“近似匹配 TRUE”的小参数。其中的“近似匹配”，就是我们常说的模糊查找。通常来讲，模糊查找主要用作区域数值的界定，比如 90-100 分为“优秀”、70-89 分为“良好”，类似这样的分数段筛选，就很适合使用模糊查找。不过它有一个前提，那就是数值源必须提前使用升序排列，否则无法得到准确结果。</p><p data-vmark="9ac4"><img src="https://img.ithome.com/newsuploadfiles/2021/11/0a4afb59-50c4-42ff-b47a-15f9ee1f6604.jpg" w="638" h="261" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="638" height="261" referrerpolicy="no-referrer"></p><p data-vmark="398b">而使用 XLOOKUP 就不用这么麻烦了，它的第五个参数（输入公式时会有提示）直接提供了“0”、“-1”、“1”、“2”四种不同匹配条件。以本例使用的“-1”为例，它的含义就是当搜索结果达不到目标值 499 时，会自动向下查找（小于 499）。正是借助这样一个选项，我们就轻松配置出了一个业绩等级设定表。</p><h2 data-vmark="e059">示例 6.  横向查找</h2><p data-vmark="df93">目的：输入产品名称查询该产品的销量、销售额、利润、利润率</p><p data-vmark="122a">公式：=XLOOKUP (B7,B1:E1,B2:E2)</p><p data-vmark="59bb"><img src="https://img.ithome.com/newsuploadfiles/2021/11/c605691b-d753-4b90-ac21-e38fe67d4b1b.jpg" w="671" h="397" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="671" height="397" referrerpolicy="no-referrer"></p><p data-vmark="1301">在 Excel 中，除了纵向搜索的 VLOOKUP 外，还有一个支持横向搜索的 HLOOKUP。这两组函数虽然作用不一，但语法却基本相同。区别是一个在列中查找，一个在行中查找。而我们的 XLOOKUP 其实也集合了纵向和横向两种查询机制，除了上面讲到的纵向查询外，你还可以通过变换查找区域来实现横向搜索。具体效果，如上图所示。</p><h2 data-vmark="7fb0">示例 7.  搜索最后记录</h2><p data-vmark="91b2">目的：快速查询某商品的最新入库价格</p><p data-vmark="3f40">公式：=XLOOKUP (F4,B:B,C:C,,,-1)</p><p data-vmark="7413"><img src="https://img.ithome.com/newsuploadfiles/2021/11/108141d1-c01a-4554-b249-a3de63849550.jpg" w="700" h="304" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="304" referrerpolicy="no-referrer"></p><p data-vmark="9ee6">很多出入库表格，都需要查找最后一次出入记录。这个看似简单的要求，实现起来却不容易。通常我们都是使用 LOOKUP 建立一个虚拟数组，然后再对其进行查找。但正如前面所言，这一类东东一来不适合新手理解，二来过多的数组函数对于系统性能也是拖累。特别在一些大型表格中，频繁地使用数组函数，会让表格变得异常缓慢。</p><p data-vmark="753e"><img src="https://img.ithome.com/newsuploadfiles/2021/11/56a07053-726a-4f29-85af-15623086fb72.jpg" w="700" h="272" title="WPS 新增支持重磅功能，告诉你 XLOOKUP 有多强" width="700" height="272" referrerpolicy="no-referrer"></p><p data-vmark="28f8">而 XLOOKUP 的加入，让这个问题变得简单多了。它的解决方法很简单，直接用一个参数来搞定。依旧以上文为例，如果想查询某商品的最近一次入库价格，只要在它的第 6 参数位中，输入参数值“-1”。而返回的结果，正是该商品的最后一次入库价。</p><h2 data-vmark="1cdc">写在最后</h2><p data-vmark="bb89">怎么样？看完上面这些案例，是不是有种豁然开朗的感觉？其实在日常使用中，XLOOKUP 还有逻辑清晰、语句简练等优势。</p><p data-vmark="e0b6">举个最简单例子，以往在使用 VLOOKUP 时，查找范围后面的列数常常要我们手工去数，而 XLOOKUP 由于直接使用了列标作为返回列，因此也就省掉了这个步骤。</p><p data-vmark="4a14">同时由于 XLOOKUP 还是一个全能型选手，特别对于新手来说更加友好，再不用劳神记忆各种复杂的函数和数组，一个 XLOOKUP 统统就搞定了！</p>
          
</div>
            