
---
title: '数据缩至 1_5000，模型准确率却翻倍，谷歌新_蒸馏法_火了'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2021/12/975b2243-5c52-4b37-9b74-5e010b93ddd6.png'
author: IT 之家
comments: false
date: Fri, 17 Dec 2021 07:06:46 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/12/975b2243-5c52-4b37-9b74-5e010b93ddd6.png'
---

<div>   
<p data-vmark="a18a">在炼丹过程中，为了减少训练所需资源，MLer 有时会将大型复杂的大模型“蒸馏”为较小的模型，同时还要保证与压缩前相当的结果。这就是知识蒸馏，一种模型压缩 / 训练方法。</p><p data-vmark="16ed">不过随着技术发展，大家也逐渐将蒸馏的对象扩展到了数据集上。这不，谷歌最近就提出了两种新的数据集蒸馏方法，在推特上引起了不小反响，热度超过 600：</p><p data-vmark="5004"><img src="https://img.ithome.com/newsuploadfiles/2021/12/975b2243-5c52-4b37-9b74-5e010b93ddd6.png" w="1040" h="846" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1040" height="667" referrerpolicy="no-referrer"></p><p data-vmark="a5a3">像这样，将 50000 张标注图像的 CIFAR-10 数据集“蒸馏”缩小至 1/5000 大小，只基于 10 张合成数据点进行训练，模型的准确率仍可近似 51%：</p><p data-vmark="d599"><img src="https://img.ithome.com/newsuploadfiles/2021/12/1d5398f5-98cb-4fd9-af34-9c9210214037.png" w="1080" h="254" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1080" height="193" referrerpolicy="no-referrer"></p><p data-vmark="3048">△上：原始数据集 下：蒸馏后</p><p data-vmark="1818">而如果“蒸馏数据集”由 500 张图像组成（占原数据集 1% 大小），其准确率可以达到 80%。两种数据集蒸馏方法分别来自于 ICLR 2021 和 NeurIPS 2021 上的两篇论文。</p><p data-vmark="8de7"><img src="https://img.ithome.com/newsuploadfiles/2021/12/39a63b07-a507-4c2c-938a-ef462d02fb19.png" w="1080" h="198" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1080" height="150" referrerpolicy="no-referrer"></p><p data-vmark="9780"><img src="https://img.ithome.com/newsuploadfiles/2021/12/e832ff53-1a8a-4a64-9616-5059e4ebce70.png" w="1080" h="160" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1080" height="121" referrerpolicy="no-referrer"></p><h2 data-vmark="54fd">通过两阶段循环进行优化</h2><p data-vmark="c1f8">那么要如何才能“蒸馏”一个数据集呢？其实，这相当于一个两阶段的优化过程：</p><ul class=" list-paddingleft-2"><li><p data-vmark="cf19">“内部循环”，用于在学习数据上训练模型</p></li><li><p data-vmark="b907">“外部循环”，用于优化学习数据在自然数据上的性能</p></li></ul><p data-vmark="5eca">通过内部循环可以得到一个核脊回归（KRR）函数，然后再外部循环中计算原始图像标注与核脊回归函数预测标注之间的均方误差（MSE）。</p><p data-vmark="f8cf">这时，谷歌提出的两种方法就分别有了不同的处理路线：</p><p data-vmark="6b15"><strong>一、标注解释 （LS）</strong></p><p data-vmark="5d94">这种方法直接解释最小化 KRR 损失函数的支持标注集（support labels），并为每个支持图像生成一个独特的密集标注向量。</p><p data-vmark="08f5"><img src="https://img.ithome.com/newsuploadfiles/2021/12/acd7a573-54db-430c-ab7e-e2e11544b121.png" w="848" h="1220" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="848" height="1180" referrerpolicy="no-referrer"></p><p data-vmark="2cc8">△蓝：原始独热标注 橙：LS 生成的密集标注</p><p data-vmark="fdb5"><strong>二、核归纳点 （KIP）</strong></p><p data-vmark="e281">这种方法通过基于梯度的方法将 KRR 损失函数最小化，以此来优化图像和可能生成的数据。以 MNIST 为例，下图中的上、中、下三张图分别为原始的 MNIST 数据集、固定标注的 KIP 蒸馏图像、优化标注的 KIP 蒸馏图像。可以看出，在于对数据集进行蒸馏时，优化标注的效果最好：</p><p data-vmark="d85f"><img src="https://img.ithome.com/newsuploadfiles/2021/12/d6fab77f-8295-4e37-b313-21a5e3b3aa35.png" w="1080" h="659" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1080" height="500" referrerpolicy="no-referrer"></p><p data-vmark="ef7f">对比已有的 DC（Dataset Condensation）方法和 DSP（Dataset Condensation with Differentiable Siamese Augmentation）方法可以看到：</p><p data-vmark="6351">如果使用每类别只有一张图像，也就是最后只有 10 张图像的蒸馏数据集，KIP 方法的测试集准确率整体高于 DC 和 DSP 方法。在 CIFAR-10 分类任务中，LS 也优于先前的方法，KIP 甚至可以达到翻倍的效果。</p><p data-vmark="7e01"><img src="https://img.ithome.com/newsuploadfiles/2021/12/3930fa05-ba17-4915-a554-cc6745b1b86a.jpg@s_2,w_820,h_457" w="1080" h="602" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" srcset="https://img.ithome.com/newsuploadfiles/2021/12/3930fa05-ba17-4915-a554-cc6745b1b86a.jpg 2x" width="1080" height="457" referrerpolicy="no-referrer"></p><p data-vmark="19fc">对此，谷歌表示：</p><blockquote><p data-vmark="5547">这证明了在某些情况下，我们的缩小 100 倍的“蒸馏数据集”要比原始数据集更好。</p></blockquote><h2 data-vmark="e778">两位华人作者</h2><p data-vmark="dd2e">整个项目由萧乐超（Lechao Xiao）、Zhourong Chen、Roman Novak 三人合作完成。</p><p data-vmark="6583">其中萧乐超为 LS 方法的论文作者之一，本科毕业于浙江大学的应用数学系，在美国伊利诺大学厄巴纳-香槟分校（UIUC）取得博士学位，现在是谷歌大脑团队的一名科学家。他的主要研究方向是数学、机器学习和深度学习。</p><p data-vmark="86fd"><img src="https://img.ithome.com/newsuploadfiles/2021/12/78f8e3aa-35b5-4f6c-aa38-24297073402d.png" w="1080" h="960" alt title="数据缩至 1/5000，模型准确率却翻倍，谷歌新“蒸馏法”火了" width="1080" height="729" referrerpolicy="no-referrer"></p><p data-vmark="b76c">另一位华人科学家 Zhourong Chen 则是 KIP 方法的论文作者之一，本科毕业于中山大学，并在中国香港科技大学取得了计算机科学与工程系的博士学位，现是 Google Research 的一名软件工程师。</p><p data-vmark="0c37">论文：</p><p data-vmark="66e6">[1]<span class="link-text-start-with-http">https://openreview.net/forum?id=l-PrrQrK0QR</span></p><p data-vmark="2009">[2]<span class="link-text-start-with-http">https://openreview.net/forum?id=hXWPpJedrVP</span></p><p data-vmark="1417">开源地址：</p><p data-vmark="eca6"><span class="link-text-start-with-http">https://github.com/google-research/google-research/tree/master/kip</span></p><p data-vmark="09b7">参考链接：</p><p data-vmark="f13c"><span class="link-text-start-with-http">https://ai.googleblog.com/2021/12/training-machine-learning-models-more.html</span></p>
          
</div>
            