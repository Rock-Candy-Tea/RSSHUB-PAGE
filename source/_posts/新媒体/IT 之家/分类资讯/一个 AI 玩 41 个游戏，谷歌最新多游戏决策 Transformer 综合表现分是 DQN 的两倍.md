
---
title: '一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2022/7/d0898e0d-a4ef-418e-aac2-b08d80feb4c8.png'
author: IT 之家
comments: false
date: Sat, 23 Jul 2022 07:13:59 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2022/7/d0898e0d-a4ef-418e-aac2-b08d80feb4c8.png'
---

<div>   
<p data-vmark="4369">谷歌 AI 宣布，在多任务学习上取得了巨大进展：<span class="accentTextColor">他们搞出一个会玩 41 款雅达利游戏的 AI，而且采用的新训练方法比起其他算法，训练效率大大提升！</span></p><p style="text-align: center;" data-vmark="23dc"><img src="https://img.ithome.com/newsuploadfiles/2022/7/d0898e0d-a4ef-418e-aac2-b08d80feb4c8.png" w="982" h="934" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="982" height="780" referrerpolicy="no-referrer"></p><p data-vmark="d4a3">此前会玩星际争霸的 CherryPi 和火出圈的 AlphaGo 都属于单游戏智能体（Agent），也就是说，一个 AI 只会玩一种游戏。多游戏智能体这边，现有的训练算法屈指可数：主要包括时间差分学习算法（Temporal Difference Learning，TD）和行为克隆（Behavioral Cloning，BC）等。</p><p data-vmark="c7dc">不过为了让一个智能体同时学会玩多款游戏，之前的这些方法的训练过程都很漫长。</p><p data-vmark="9901">现在，谷歌采用了一个新决策 Transformer 架构来训练智能体，能够在少量的新游戏数据上迅速进行微调，使训练速度变得更快，而且训练效果也是杠杠的 —— 该多游戏智能体玩 41 款游戏的表现综合得分，是 DQN 等其他多游戏智能体的 2 倍左右，甚至可以和只在单个游戏上训练的智能体媲美。</p><p style="text-align: center;" data-vmark="9ccf"><img src="https://img.ithome.com/newsuploadfiles/2022/7/1b22c7f7-5cd9-4412-808f-ecb07f632a58.png" w="1080" h="316" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="1080" height="240" referrerpolicy="no-referrer"></p><p data-vmark="0f29">△ 100% 表示每款游戏的人类平均水平，灰色条代表单游戏智能体，蓝色条代表多游戏智能体</p><p data-vmark="94f4">下面就来看看这个性能优秀的多游戏智能体。</p><h3 data-vmark="83df">新决策 Transformer 三大亮点</h3><p data-vmark="10a9">这个处理多款游戏学习的 Transformer，采用了一个将强化学习（Reinforcement Learning，RL）问题视为条件序列建模的架构，它根据智能体和环境之间过去的互动以及预期收益，来指导智能体的下一步活动。</p><p data-vmark="75e5">说到强化学习，其讨论的主要问题是：在训练过程中，一个面对复杂环境的智能体，如何通过在每个 Time Step 里感知当前状态和 Reward 来指导下一步动作，以最终最大化累计收益（Return）。</p><p style="text-align: center;" data-vmark="572b"><img src="https://img.ithome.com/newsuploadfiles/2022/7/7ee3ce3a-0652-4ad5-a07b-515ce0e26881.png" w="934" h="420" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="934" height="369" referrerpolicy="no-referrer"></p><p data-vmark="9dc9">传统的深度 RL 智能体（如 DQN、SimPLe、Dreamer 等）会学习一个策略梯度（Policy Gradient），让高 Reward 的轨迹出现概率变大，低 Reward 的轨迹出现概率变小。</p><p data-vmark="c34f">这就导致它出现一些问题：即需要手动定义一个信息量很大的标量值范围，包含针对于每个特定游戏的适当信息。这是个相当浩大的工程，而且拓展性较差。</p><p data-vmark="d600">为了解决这个问题，谷歌团队提出了一个新方法。</p><h3 data-vmark="6a37">训练纳入数据更多样化</h3><p data-vmark="dde5">谷歌的这个新决策 Transformer，把从入门玩家到高级玩家的经验数据都映射到相应的收益量级（Return Magnitude）中。开发者们认为，这样可以让 AI 模型更全面地“了解”游戏，从而让其更稳定并提高其玩游戏的水平。</p><p data-vmark="df4e">他们根据智能体在训练期间与环境的互动，建立了一个收益的大小分布模型。在这个智能体玩游戏时，只需添加一个优化偏差来提升高 Reward 出现的概率。</p><p data-vmark="5698">此外，为了在训练期间更全面地捕捉智能体与环境互动的时空模式，开发者还将输入的全局图像改成了像素块，这样模型就可以关注局部动态，以掌握游戏相关的更多细节信息。</p><p style="text-align: center;" data-vmark="705d"><img src="https://img.ithome.com/newsuploadfiles/2022/7/6595704b-7cbb-4fc7-bef9-d25df95db220.png" w="1080" h="503" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="1080" height="382" referrerpolicy="no-referrer"></p><p data-vmark="91ab">△ 决策 Transformer 基本架构示意图</p><h3 data-vmark="0dd6">可视化智能体训练过程</h3><p data-vmark="5a51">此外，开发者们还别出心裁地将智能体的行为可视化。然后他们发现，这个多游戏决策智能体一直都在关注着包含关键环境特征等重要信息的区域，而且它还可以“一心多用”：即同时关注多个重点。</p><p style="text-align: center;" data-vmark="4cfd"><img src="https://img.ithome.com/newsuploadfiles/2022/7/0a17e8e1-9b5a-4f33-bb16-be44d3031bcd.gif" w="516" h="258" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="516" height="258" referrerpolicy="no-referrer"></p><p data-vmark="5ed1">△ 红色越亮表示智能体对那块像素的关注度越高</p><p data-vmark="f606">这种多样化注意力分配也提高了模型的性能。</p><h3 data-vmark="027e">拓展性更好</h3><p data-vmark="4f47">如今规模已成为许多机器学习相关突破的重要驱动力之一，而规模拓展一般是通过增加 Transformer 模型中的参数数量来实现的。研究者发现，这个多游戏决策 Transformer 也是类似的：随着规模扩大，和其他模型相比，其性能提升显著。</p><p style="text-align: center;" data-vmark="7e3b"><img src="https://img.ithome.com/newsuploadfiles/2022/7/ff710592-ba58-44e2-9e7c-ac72625624de.png" w="1080" h="647" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="1080" height="491" referrerpolicy="no-referrer"></p><h3 data-vmark="d23c">Facebook 也在研究决策 Transformer</h3><p data-vmark="7817">谷歌 AI 使用决策 Transformer 不仅提高了 AI 玩多个游戏的水平，还提升了多游戏智能体的扩展性。</p><p data-vmark="0164">除此之外，据谷歌大脑、加州大学伯克利分校和 Facebook AI Research 合作的一篇论文介绍，决策 Transformer 架构在强化学习研究平台 OpenAI Gym 和 Key-to-Door 任务上也表现出色。</p><p style="text-align: center;" data-vmark="9acf"><img src="https://img.ithome.com/newsuploadfiles/2022/7/66dcaf79-4e60-489d-81e8-9ba9238942e0.png" w="1080" h="942" title="一个 AI 玩 41 个游戏，谷歌最新多游戏决策 Transformer 综合表现分是 DQN 的两倍" width="1080" height="715" referrerpolicy="no-referrer"></p><p data-vmark="44fe">或许决策 Transformer 正是通用人工智能（AGI）发展的关键因素之一。</p><p data-vmark="ccc7">对了，谷歌 AI 表示，相关代码和 Checkpoint 会在 GitHub 上陆续开源，感兴趣的小伙伴们可以去看看~</p><p data-vmark="15d5">传送门：</p><p data-vmark="d7ce"><span class="link-text-start-with-http">https://github.com/google-research/google-research/tree/master/multi_game_dt</span></p><p data-vmark="a036">参考链接：</p><p data-vmark="4f27">[1]<span class="link-text-start-with-http">https://twitter.com/GoogleAI/status/1550260410686644224</span></p><p data-vmark="29e4">[2]<span class="link-text-start-with-http">https://ai.googleblog.com/2022/07/training-generalist-agents-with-multi.html</span></p><p data-vmark="7d43">[3]<span class="link-text-start-with-http">https://arxiv.org/abs/2106.01345</span></p><p data-vmark="5e53">[4]<span class="link-text-start-with-http">https://zhuanlan.zhihu.com/p/354618420</span></p>
          
</div>
            