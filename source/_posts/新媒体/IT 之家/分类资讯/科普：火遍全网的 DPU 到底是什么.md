
---
title: '科普：火遍全网的 DPU 到底是什么'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2022/8/808a59e6-6270-4181-880c-70917560ddf8.png'
author: IT 之家
comments: false
date: Thu, 18 Aug 2022 06:09:11 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2022/8/808a59e6-6270-4181-880c-70917560ddf8.png'
---

<div>   
<p data-vmark="7a26">不管你是否身处 ICT 行业，这两年有一个词你肯定听说过，那就是 DPU 。</p><p data-vmark="e002">作为一个全新兴起的科技概念，DPU 正在以惊人的速度崛起，成为整个行业甚至整个社会的关注重点。尤其是投资领域，对 DPU 简直是竞相追逐，将其视为未来颠覆行业的潜力技术。</p><p data-vmark="560d">究竟什么是 DPU ？它和我们熟悉的 CPU 、 GPU 有什么区别？</p><p data-vmark="7ffe">今天，小枣君就带大家彻底搞明白 DPU 的来龙去脉。</p><h3 data-vmark="1f7f">█ 什么是 DPU</h3><p data-vmark="947d">DPU 的英文全称叫做 Data Processing Unit ，也就是数据处理器。</p><p data-vmark="4b9d" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/808a59e6-6270-4181-880c-70917560ddf8.png" w="624" h="349" title="科普：火遍全网的 DPU 到底是什么" width="624" height="349" referrerpolicy="no-referrer"></p><p data-vmark="ce6d">英伟达首席执行官黄仁勋曾在演讲中表示：“ DPU 将成为未来计算的三大支柱之一，未来的数据中心标配是‘ CPU + DPU + GPU ’。CPU 用于通用计算，GPU 用于加速计算，DPU 则进行数据处理。”</p><p data-vmark="b51d">听着有点晕，DPU 到底进行什么样的数据处理？有了 CPU 和 GPU ，为啥还要 DPU ？</p><p data-vmark="cf7b">众所周知，自从计算机诞生以来，就是采用的著名的冯诺依曼架构。</p><p data-vmark="9cbd" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/fb2d4c1e-c9f1-4dbc-ab57-da55ce87abb9.png" w="1080" h="561" title="科普：火遍全网的 DPU 到底是什么" width="1080" height="426" referrerpolicy="no-referrer"></p><p data-vmark="a39d" style="text-align: center;">冯诺依曼架构</p><p data-vmark="4737">这是一个以计算和存储为核心的架构，CPU 作为处理器单元，负责完成各种算术和逻辑计算。而内存（运存）和硬盘（外部存储），负责存储数据，与 CPU 交互。</p><p data-vmark="d6e7">除了 CPU 、内存和硬盘之外，就是键盘、显示器这样的输入和输出设备。随着时间的推移，后来，我们有了鼠标，又有了显卡、网卡。最终，形成了现在大家看到的电脑的基本构造。</p><p data-vmark="df88">有了显卡，就有了 GPU（Graphics Processing Unit），图形处理器。大家都玩过游戏，很明白，正是游戏、 3D 设计等多媒体图形软件的高速发展，要处理的工作量越来越大，也越来越复杂，CPU 实在忙不过来，所以就有了专门进行图像和图形相关运算工作的 GPU ，分担 CPU 的压力。</p><p data-vmark="acfa">DPU 的出现，道理也是一样的。同样是因为 CPU 难以负担一些复杂的计算，所以需要进行任务分工。</p><h3 data-vmark="e883">█ DPU 到底算些什么</h3><p data-vmark="127f">好了，终于到了关键点了。说了半天，DPU 到底分担了 CPU 的哪些工作呢？</p><p data-vmark="3ee9">说实话，想要从技术上解释 DPU 分担的工作内容，稍微有点困难，不容易看懂。但是，我们可以从工作场景上进行解释。</p><p data-vmark="9716">大致来看，DPU 分担的工作可以归纳为四个关键词，分别是虚拟化、网络、存储以及安全。</p><p data-vmark="7918" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/3bf14152-a834-415c-b0a2-0d0bdbfdb5f5.png" w="1066" h="773" title="科普：火遍全网的 DPU 到底是什么" width="1066" height="595" referrerpolicy="no-referrer"></p><p data-vmark="b589">特别需要提醒大家，<span class="accentTextColor">DPU 是一个紧密围绕数据中心的概念。也就是说，它主要用于数据中心这种大规模算力场景，而非我们每个人的台式机、笔记本电脑或手机（至少目前不是）</span>。</p><p data-vmark="a788">DPU 服务于云计算，主要作用是提升数据中心等算力基础设施的效率，减少能耗浪费，进而降低成本。</p><p data-vmark="fda6">前面提到的虚拟化、网络、存储以及安全，是数据中心非常重要的工作，也是大量消耗算力资源的工作。</p><p data-vmark="9fd8" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/9e9ecfda-c0e6-4b88-a4c0-cf84bc924cd2.jpg" w="469" h="436" title="科普：火遍全网的 DPU 到底是什么" width="469" height="436" referrerpolicy="no-referrer"></p><p data-vmark="5552">以网络为例。</p><p data-vmark="6e9f">在数据中心里，时时刻刻都有大量的数据在进行传输。主机在收发数据时，需要进行海量的⽹络协议处理。根据传统的计算架构，这些协议处理都是由 CPU 完成的。</p><p data-vmark="b9cd">有人统计过，想要线速处理 10G 的⽹络，需要的⼤约 4 个 Xeon CPU 的核。也就是说，仅仅是进行⽹络数据包的处理，就要占用⼀个 8 核⾼端 CPU ⼀半的算⼒。现在数据中心网络不断升级，从 10G 到 40G 、 100G ，甚至 400G ⾼速⽹络，这些性能开销如何承受？</p><p data-vmark="a659">这些开销如此之大，以至于被称为“ Datacenter Tax（数据中心税）”。</p><p data-vmark="32f7">业务程序尚未运行，仅是接入网络数据，就消耗了这么多算力资源，这是无法忍受的。所以，就有公司提出了 SmartNIC （智能网卡）的概念，将网络协议处理的工作从 CPU “卸载”到网卡上，以此分担 CPU 的负载。</p><p data-vmark="1f11">2015 年，云计算厂商 AWS 率先开始探索这种 SmartNIC 模式。他们收购了芯片厂商 Annapurna Labs ，并于 2017 年正式推出 Nitro 系统。同年，阿里云也官宣了有类似功能的神龙（ X-Dragon ）架构。</p><p data-vmark="e390">2019 年 3 月，英伟达花费 69 亿美元收购了以色列芯片公司 Mellanox 。英伟达将 Mellanox 的 ConnectX 系列高速网卡技术与自己的已有技术相结合，于 2020 年正式推出了两款 DPU 产品：BlueField-2 DPU 和 BlueField-2X DPU 。</p><p data-vmark="a3bd" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/29a3c964-7c10-4d3f-b959-f8d8459fd12d.jpg@s_2,w_820,h_462" w="1080" h="608" title="科普：火遍全网的 DPU 到底是什么" srcset="https://img.ithome.com/newsuploadfiles/2022/8/29a3c964-7c10-4d3f-b959-f8d8459fd12d.jpg 2x" width="1080" height="462" referrerpolicy="no-referrer"></p><p data-vmark="b58d">从此，DPU 这个概念正式进入了公众视野。2020 年，也被称为 DPU 元年。</p><p data-vmark="9949">正因为 DPU 和 SmartNIC 有这样的渊源，所以，人们普遍将 DPU 视为 SmartNIC 的扩展升级版。</p><p data-vmark="f399">DPU 在 SmartNIC 的基础上，将存储、安全和虚拟化等工作负载也从 CPU 卸载到自己身上。</p><p data-vmark="f086">上世纪 90 年代末，以 VMWare 为代表的虚拟化技术刚刚出现的时候，完全是由软件进行模拟线的，缺乏硬件的支持，所以，性能很差，几乎难以使用。</p><p data-vmark="fff2">后来，2005 年，随着技术的演进，CPU 和内存的硬件虚拟化问题逐渐解决，才让虚拟化系统的性能有了大幅的提升，也激活了这项技术的发展前景和价值。众所周知，我们现在的整个云计算架构，都是基于虚拟化技术发展起来的。</p><p data-vmark="b043">虚拟化技术发展的过程，是硬件能力不断取代软件能力的过程。前面我们提到 AWS 发布 Nitro 系统。这个系统除了 SmartNIC 之外，也完成了 I / O 的硬件虚拟化。它还将虚拟化管理程序 Hypervisior 从 CPU 卸载到专用硬件上。这样做带来的结果就是，虚拟化技术的性能损耗趋近于零，CPU 的负担进一步下降。</p><p data-vmark="ae46">存储也是如此。</p><p data-vmark="094f">现在数据中心对存储读取和写入的速率要求很高。SSD 价格逐渐下降后，将 SSD 通过本地 PCIe 或高速网络与系统相连接，成为了一种主流的技术路线。针对分布式系统，在以往 InfiniBand 、 FC（Fiber Channel，光纤通道）、 Ethernet 的基础上，RDMA（Remote Direct Memory Access，远程直接数据存取）技术开始流行。</p><p data-vmark="e98e" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/95807c94-2557-4961-bc9b-69b623aa7a0a.png" w="1080" h="630" title="科普：火遍全网的 DPU 到底是什么" width="1080" height="478" referrerpolicy="no-referrer"></p><p data-vmark="65a2">在 RDMA 模式中，应用程序的数据，不再经过 CPU 和复杂的操作系统，直接和网卡通信。这就意味着，DPU 可以承担存储相关的高速接口标准协议处理，进一步为 CPU 分担压力。</p><p data-vmark="7cff">最后再看看安全。</p><p data-vmark="a0c7">在目前越来越严峻的安全形势下，为了确保网络和系统的安全可靠，引入了大量的加密算法。以往，这些算法都是由 CPU 负责完成加密和解密的。</p><p data-vmark="e821">但事实上，网络接口才是最理想的隐私边界。在网络接口上进行加密和解密，才是最合理的。所以，像国密标准的非对称加密算法 SM2 、哈希算法 SM3 和对称分组密码算法 SM4 等，其实都可以交给 DPU 进行计算。未来，区块链技术成熟应用后，相关算法也是可以从 CPU 卸载到 DPU 进行的。</p><p data-vmark="b5d4">综上所述，大家应该也看明白了，DPU 的作用本质，就是卸载、加速和隔离 —— 把 CPU 的部分工作卸载到自己身上；利用自己的算力特长，对这些工作进行加速运算；整个过程，实现了计算的隔离。</p><h3 data-vmark="9590">█  DPU 的未来前景</h3><p data-vmark="d32d">DPU 是一个新型可编程多核处理器，是一块 SoC（System On Chip）芯片。它符合行业标准，具有很高的算力，还具备高性能的网络接口，能高速解析、处理数据，并高效地将数据传输到 CPU 和 GPU 。</p><p data-vmark="681b">DPU 和 CPU 的最大不同，是 CPU 擅长通用性计算任务（什么任务都能接，比较“杂”），而 DPU 更擅长基础层应用任务（做特定的任务，比较“专注”），例如网络协议处理，交换路由计算，加密解密，数据压缩等“脏活累活”。</p><p data-vmark="b3f9">所以说，DPU 是 CPU 的一个好帮手，将与 CPU 、 GPU 形成“铁三角”，彻底颠覆数据中心的运算模式。</p><p data-vmark="31a6" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/17c65c4f-de83-4904-9f24-0ce8c1dc6ec0.png" w="686" h="568" title="科普：火遍全网的 DPU 到底是什么" width="686" height="568" referrerpolicy="no-referrer"></p><p data-vmark="88af">这就是为什么 DPU 如今备受关注的原因。</p><p data-vmark="626f">正如本文开头所说，DPU 目前的火爆程度，已经不能用词语来形容。资本对于 DPU 的热情，更是令人印象深刻。不管是巨头还是初创公司，都纷纷入局 DPU 赛道。DPU 的市场仍在升温，发展前景可期。</p><p data-vmark="1ff7">还是以英伟达为例。继 BlueField-2 DPU 和 BlueField-2X 之后，2021 年 4 月，NVIDIA 又发布了新一代数据处理器 —— BlueField-3 DPU 。</p><p data-vmark="b1db" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/c6ceb336-8f77-4463-9194-79cd1740c655.jpg" w="640" h="338" title="科普：火遍全网的 DPU 到底是什么" width="640" height="338" referrerpolicy="no-referrer"></p><p data-vmark="b664" style="text-align: center;">BlueField-3 DPU</p><p data-vmark="a540">这是首款为 AI 和加速计算而设计的 DPU ，针对多租户、云原生环境进行了优化，提供数据中心级的软件定义和硬件加速的网络、存储、安全和管理等服务。</p><p data-vmark="8c52">据称，一个 BlueField-3 DPU 所提供的数据中心服务，可相当于多达 300 个 x86 核才能实现的服务。这就释放了大量的 CPU 资源，用于运行关键业务应用。</p><p data-vmark="71ae">要想发挥 DPU 在现代数据中心的核心价值，离不开软件的加持。换句话说，没有软件的芯片，只是昂贵的沙子。</p><p data-vmark="38e0">为了构建更为强大的 DPU 生态，英伟达专门推出了给 BlueField DPU 量身打造的软件开发平台 —— NVIDIA DOCA 。</p><p data-vmark="b650">DOCA 的全称叫 Data Center Infrastructure On A Chip Architecture ，即“线上数据中心基础设施体系结构”。借助于 DOCA ，开发人员能够利用行业标准的 API ，在 NVIDIA BlueField DPU 上快速创建网络，存储，安全和管理服务，以及 AI / HPC 的一系列应用程序和服务。</p><p data-vmark="2fdd">在 2022 年 5 月，NVIDIA 发布了 DOCA 1.3 。该版本不仅新增了 121 个 API 开发接口，还添加了优化数据流插入的 DOCA Flow 库、通信通道库（ Communication Channel ）、正则表达式库（ Regular Expression ）和基于 OVN 的数据路径加密等功能，更添加了 HBN （基于主机的网络）等服务，深受开发者的欢迎。</p><p data-vmark="07bf" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/8/b853b2a1-e3dc-4fbb-934f-f85d4fad877e.png" w="886" h="814" title="科普：火遍全网的 DPU 到底是什么" width="886" height="753" referrerpolicy="no-referrer"></p><p data-vmark="d3b0" style="text-align: center;">DOCA 1.3 的架构</p><p data-vmark="53d3">近日，NVIDIA 又发布了 DOCA 1.4 ，在不重启主机的情况下支持 DPU 固件升级，在 BlueField-2 DPU 25G & 100G w / BMC 产品上支持 32GB DDR 内存，新增对 AArch64 服务器主机支持，以及基于最长前缀匹配（ LPM ）管道的路由功能。</p><p data-vmark="6b11">借助 DOCA 1.4 版本，开发者可以更灵活、更简单、更快捷地在 BlueField DPU 上进行开发环境的搭载，从而迅速推出新产品。</p><h3 data-vmark="c68f">█ 结语</h3><p data-vmark="8084">根据预测，到 2025 年，DPU 全球市场容量预计将达到 120 亿美金。</p><p data-vmark="ce41">随着摩尔定律逐渐进入瓶颈，为了更高效地利用算力资源，我们需要大力发展 DPU ，让 CPU 、 GPU 、 DPU 进行合理分工，各自更加专注于自己擅长的工作。这样，我们才能将数据中心的能效发挥到最大，为整个社会的数字化转型提供强劲且绿色的动力。</p>
          
</div>
            