
---
title: '一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2021/11/3b43177d-3d40-4584-8f82-be8a9105c3b8.gif'
author: IT 之家
comments: false
date: Sun, 21 Nov 2021 05:38:28 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/11/3b43177d-3d40-4584-8f82-be8a9105c3b8.gif'
---

<div>   
<p data-vmark="5181">动漫、艺术作品里的人物，他们极具张力的形象往往给人们留下深刻的印象。</p><p data-vmark="5ce3">但如果说现在，你也可拥有他们的同款造型呢？</p><p data-vmark="9e05">没错，依旧来自是“无所不能”的对抗生成网络（Generative Adversarial Network，以下简称为 GAN）。</p><p data-vmark="a2da">只要把你 pick 好的形象“投喂”进去，接下来妆发的工作交给它就行了：</p><p data-vmark="ba1a"><img src="https://img.ithome.com/newsuploadfiles/2021/11/3b43177d-3d40-4584-8f82-be8a9105c3b8.gif" w="600" h="400" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="600" height="400" referrerpolicy="no-referrer"></p><p data-vmark="433f">红的、黄的、蓝的、白的…… 发色随意改变，风格也随之变换。</p><p data-vmark="5388">这就是来自快手的 <span class="accentTextColor">BlendGAN</span>，而且这项工作还被顶会 NeurIPS 2021 接收。</p><p data-vmark="4799"><img src="https://img.ithome.com/newsuploadfiles/2021/11/e93e3b6f-f0ac-4a1f-bb9f-edd3184bdc89.png" w="1080" h="370" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="281" referrerpolicy="no-referrer"></p><p data-vmark="da2e">而与以往“变妆”GAN 不同的是，<span class="accentTextColor">BlendGAN 号称能驾驭的风格是 —— 任意</span>！</p><p data-vmark="267a">是有种“百变大咖秀”的那味了。</p><p data-vmark="76f1">于是乎，这个项目成功在网上引起了众多网友的围观。</p><p data-vmark="27f1"><img src="https://img.ithome.com/newsuploadfiles/2021/11/6bbbf31f-3fe9-47a9-93c8-5df6ff1bbea6.png" w="1080" h="178" alt="图片" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="135" referrerpolicy="no-referrer"></p><h2 data-vmark="4639">如何丝滑变妆？</h2><p data-vmark="8a6a">那么，怎样拥有动漫人物同款造型呢？</p><p data-vmark="341b">很简单，只需要准备 2 张照片：</p><ul class=" list-paddingleft-2"><li><p data-vmark="c6a0">一张生活照</p></li><li><p data-vmark="fa64">一张动漫人物造型</p></li></ul><p data-vmark="dcbb"><img src="https://img.ithome.com/newsuploadfiles/2021/11/36cd54ab-f9f9-4022-84be-96fc2629b90a.png" w="1080" h="520" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="395" referrerpolicy="no-referrer"></p><p data-vmark="90de">现在在 Hugging Face 里已经有了在线可玩的 demo。</p><p data-vmark="9947">最简单的办法就是把这两张照片上传进去，等待一会儿就可以出结果了。</p><p data-vmark="acb0">当然，稍微“技术”点的方法就是自己跑一遍程序了。</p><p data-vmark="806e">就在这两天，BlendGAN 在 GitHub 上也已开源。</p><p data-vmark="5a36"><img src="https://img.ithome.com/newsuploadfiles/2021/11/4a33da67-41db-4354-aa2b-0e976a06a266.png" w="1080" h="278" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="211" referrerpolicy="no-referrer"></p><p data-vmark="269e">首先需要下载一些预训练模型，包括 BlendGAN 模型、PSP 编码器模型和 Style 编码器模型。</p><p data-vmark="e87f"><img src="https://img.ithome.com/newsuploadfiles/2021/11/ca109d0f-58b7-4966-a342-8d9c21010f1c.png" w="1080" h="318" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="241" referrerpolicy="no-referrer"></p><p data-vmark="46fb">然后仅需几句 Python 代码，便可出效果。</p><p data-vmark="db3c">例如用随机人脸代码生成图像对，就输入：</p><pre class="brush:javascript;toolbar:false ai-word-checked">python generate_image_pairs.py --size 1024 --pics N_PICS --ckpt ./pretrained_models/blendgan.pt --style_img ./test_imgs/style_imgs/100036.png --outdir results/generated_pairs/reference_guided/</pre><p data-vmark="5601">若是要给照片换风格，则输入：</p><pre class="brush:javascript;toolbar:false">python style_transfer_folder.py --size 1024 --ckpt ./pretrained_models/blendgan.pt --psp_encoder_ckpt ./pretrained_models/psp_encoder.pt --style_img_path ./test_imgs/style_imgs/ --input_img_path ./test_imgs/face_imgs/ --outdir results/style_transfer/</pre><p data-vmark="8f7a">要生成插值视频，则：</p><pre class="brush:javascript;toolbar:false ai-word-checked">python gen_video.py --size 1024 --ckpt ./pretrained_models/blendgan.pt --psp_encoder_ckpt ./pretrained_models/psp_encoder.pt --style_img_path ./test_imgs/style_imgs/ --input_img_path ./test_imgs/face_imgs/ --outdir results/inter_videos/</pre><h2 data-vmark="d2d9">为什么可以 hold 住任意风格？</h2><p data-vmark="5e45">那么快手的这个 BlendGAN，为什么可以同时驾驭这么多的风格？</p><p data-vmark="e5de">据研究介绍，团队首先是利用灵活的混合策略和通用的艺术数据集，来生成任意样式化的脸。</p><p data-vmark="0681">具体来说，就是在通用艺术数据集上，训练一个自监督 Style 编码器来提取任意样式的表示。</p><p data-vmark="fa18"><img src="https://img.ithome.com/newsuploadfiles/2021/11/dbb1095a-912e-4271-8673-cf8ecd6edca8.png" w="1058" h="152" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1058" height="118" referrerpolicy="no-referrer"></p><p data-vmark="29e3">在生成器部分，则提出了一种叫做<span class="accentTextColor">加权混合模块 (WBM) </span>的方法，来隐式混合人脸和样式表示，并控制任意的程式化效果。</p><p data-vmark="965b"><img src="https://img.ithome.com/newsuploadfiles/2021/11/e814f325-cbc5-49ef-88db-9048b3041bcd.png" w="1080" h="411" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="312" referrerpolicy="no-referrer"></p><p data-vmark="da5e">以往诸如 StyleGAN2 在这个步骤中，不同分辨率层（resolution layer）负责生成图像中的不同特征，而团队认为它们在不同层的混合权值不应当是一致的。</p><p data-vmark="4be1">因此，研究人员将人脸和风格 latent 代码转换到它们的 W 空间，然后再由 WBM 进行一个组合的工作。</p><p data-vmark="b896">由此得到的结果显示，与以往方法比较，BlendGAN 能够得到更加逼真的效果。</p><p data-vmark="ca5d"><img src="https://img.ithome.com/newsuploadfiles/2021/11/623847db-6106-4504-857d-30458eabe70d.png" w="1080" h="920" title="一键 Cosplay 各路动漫人物，快手算法工程师开发的这个 BlendGAN 火了" width="1080" height="699" referrerpolicy="no-referrer"></p><h2 data-vmark="9508">作者介绍</h2><p data-vmark="4e17">本文的通讯作者是 Li Qiang，现任快手 Y-tech 的算法工程师。</p><p data-vmark="1ab9">本科和硕士就读于华中科技大学；博士毕业于悉尼科技大学，师从陶大程教授。</p><p data-vmark="31eb">其主要研究方向为深度学习、机器学习和概率图形模型，对卷积神经网络、深度生成模型、表示学习和结构化预测感兴趣。</p><p data-vmark="9db5">最后，想试试变妆的小伙伴，可以戳下方链接体验一下。</p><p data-vmark="ec80">在线试玩：<a href="https://huggingface.co/spaces/akhaliq/BlendGAN" target="_blank">点此直达</a></p>
          
</div>
            