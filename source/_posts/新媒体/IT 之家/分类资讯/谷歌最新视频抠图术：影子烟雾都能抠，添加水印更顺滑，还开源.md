
---
title: '谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2021/9/f8e9eb23-c09c-4d75-99f0-2a30d461c5f2.gif'
author: IT 之家
comments: false
date: Thu, 02 Sep 2021 06:24:06 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/9/f8e9eb23-c09c-4d75-99f0-2a30d461c5f2.gif'
---

<div>   
<p>如何更顺滑的添加水印？</p><p>谷歌的这项新技术，让文本简直就像贴在地面上，哪怕是在沙尘横飞的场景里。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/f8e9eb23-c09c-4d75-99f0-2a30d461c5f2.gif" w="640" h="196" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="640" height="196" referrerpolicy="no-referrer"></p><p>方法也很简单。</p><p>只需输入一段视频，和指定对象的粗略蒙版。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/c6a2c67f-0b7d-476a-8a62-ca2e14e40ad4.gif" w="640" h="148" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="640" height="148" referrerpolicy="no-referrer"></p><p>那这个对象的所有相关场景元素，都能解锁！</p><p>比如人和狗的影子。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/b4ae4609-c389-4fc1-8e9b-f5f954f5f3ee.gif" w="640" h="148" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="640" height="148" referrerpolicy="no-referrer"></p><p>还有黑天鹅缓缓拂过的涟漪~</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/5f3d4a2b-9e99-404b-b7db-e7759ca6b37b.gif" w="638" h="146" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="638" height="146" referrerpolicy="no-referrer"></p><p>以及上述那个赛车疾驰过后激起的沙尘。</p><p>不管是任意对象和主体，不论怎么移动，所有元素都能抠出来。</p><p>这就是谷歌最新的视频分层技术 ——<span class="accentTextColor">omnimatte</span>，入选 CVPR 2021 Oral。</p><p>目前这项技术已开源。</p><h2>如何实现</h2><p>计算机视觉在分割图像或视频中的对象方面越来越有效，然而与对象相关的场景效果。</p><p>比如阴影、反射、产生的烟雾等场景效果常常被忽略。</p><p>而识别这些场景效果，对提高 AI 的视觉理解很重要，那谷歌这项新技术又是如何实现的呢？</p><p>简单来说，<span class="accentTextColor">用分层神经网络渲染方法自监督训练 CNN</span>，来将主体与背景图像分割开来。</p><p>由于 CNN 的特有结构，会有倾向性地学习图像效果之间的相关性，且相关性却强，CNN 越容易学习。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/02efdc72-92c1-4ca4-8309-2780bcec2d1a.png" w="1080" h="501" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="1080" height="380" referrerpolicy="no-referrer"></p><p>输入一段有移动物体的视频，以及一个或者多个标记主体的粗略分割蒙版。</p><p>首先，使用现成的分割网络比如 Mask RCNN，来讲这些主体分成多个遮罩层和背景噪声图层，并按照某种规则进行排序。</p><p>比如，在一个骑手、一辆自行车以及几个路人的场景中，就会把骑手和自行车归入一个层，把人群归入第二层。</p><p>omnimatte 模型是一个二维 UNet，逐帧处理视频。每一帧都用现成的技术来计算物体掩码，来标记运动中的主体，并寻找和关联蒙版中未捕捉到的效果，比如阴影、反射或者烟雾，重建输入帧。</p><p>为了保证其他静止的背景元素不被捕获，研究人员引入了稀疏损失。</p><p>此外，还计算了视频中每一帧和连续帧之间的密集光流场，为网络提供与该层对象相关的流信息。</p><p>最终生成 Alpha 图像（不透明度图）和 RGBA 彩色图像，尤其 RGBA 图像，简直可以说是视频/图像剪辑法宝！</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/d2a98f19-b660-4ae4-9a7c-7677309a3613.png" w="1080" h="689" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="1080" height="523" referrerpolicy="no-referrer"></p><p>目前这一技术已经开源，配置环境如下：</p><ul class=" list-paddingleft-2"><li><p>Linux</p></li><li><p>Python 3.6+</p></li><li><p>英伟达 GPU + CUDA CuDNN</p></li></ul><h2>有什么用途</h2><p>技术效果如此，那有什么样的用途呢？</p><p>首先就可以复制或者删除图像。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/90beb6ea-887b-49ff-aa6f-6259d5f94f55.gif" w="720" h="138" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="720" height="138" referrerpolicy="no-referrer"></p><p>还有顺滑地切换背景。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/9de73969-e108-4cee-9100-8af9de3c33d1.gif" w="518" h="146" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="518" height="146" referrerpolicy="no-referrer"></p><p>还可以实现这一经典操作，让原本依次掉水的小孩一起入水~</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/f823a70b-d53a-4330-8421-5c2b7a58921b.gif" w="720" h="192" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="720" height="192" referrerpolicy="no-referrer"></p><h2>背后的团队</h2><p>最后再来说一下背后的团队。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/82c5b423-8338-46fd-8619-017cf394ee5a.png" w="1080" h="591" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" width="1080" height="449" referrerpolicy="no-referrer"></p><p>这项研究由谷歌研究院、牛津大学以及魏茨曼科学研究所共同完成。</p><p>其中，论文一作是牛津大学四年级博士生 Erika Lu，曾是谷歌实习生，在麻省理工学院获得了计算机科学与工程学士学位。</p><p><img src="https://img.ithome.com/newsuploadfiles/2021/9/c8b7c4d3-9b06-4801-ac49-49258761d210.jpg@s_2,w_820,h_820" w="1080" h="1080" title="谷歌最新视频抠图术：影子烟雾都能抠，添加水印更顺滑，还开源" srcset="https://img.ithome.com/newsuploadfiles/2021/9/c8b7c4d3-9b06-4801-ac49-49258761d210.jpg 2x" width="1080" height="820" referrerpolicy="no-referrer"></p><p><strong>论文链接：</strong></p><p><a href="https://arxiv.org/pdf/2105.06993.pdf" target="_blank">https://arxiv.org/pdf/2105.06993.pdf</a></p>
          
</div>
            