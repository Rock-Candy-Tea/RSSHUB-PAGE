
---
title: '训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2022/3/157418b7-dc94-4d35-8695-11de328555f6.png'
author: IT 之家
comments: false
date: Fri, 25 Mar 2022 10:41:39 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2022/3/157418b7-dc94-4d35-8695-11de328555f6.png'
---

<div>   
<p data-vmark="4635">Prompt tuning，作为 NLP 领域中的一个“新宠”，甚至曾被学者誉为 NLP 预训练新范式。那么，它能否借鉴到 CV 领域并产生同样的成绩呢？</p><p data-vmark="1c02">现在，来自康奈尔大学和 Meta AI 等机构，通过 Prompt 来调整基于 Transformer 的视觉模型，结果发现：完全可以！</p><p data-vmark="2a13">比起全面微调，Prompt 性能提升显著。无论模型的规模和训练数据怎么变，24 种情况中有 20 种都完全胜出。</p><p data-vmark="c8dc" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/157418b7-dc94-4d35-8695-11de328555f6.png" w="594" h="498" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="594" height="498" referrerpolicy="no-referrer"></p><p data-vmark="c6f1">与此同时，它还能大幅降低每项任务所需的存储成本。</p><p data-vmark="ddcf" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/ceeefa01-9b0b-4932-852c-1aaeaed6dc73.png" w="440" h="440" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="440" height="440" referrerpolicy="no-referrer"></p><h3 data-vmark="2e21">只使用不到 1% 的模型参数</h3><p data-vmark="d283">大家一贯使用的全面微调（full fine-tuning），需要为每个下游任务存储和部署单独的主干参数副本，成本太高，尤其是现在基于 Transformer 的模型越来越大，已经超过 CNN 架构。</p><p data-vmark="fe39">所谓 Prompt，最初指的是在输入文本中预编语言指令，以便预培训的语言模型后续可以直接理解各种下游任务。它曾让 GPT-3 即使在少样本或零样本的情况下表现出很强的泛化能力。</p><p data-vmark="9f61">最近一些成果则表明，Prompt 与完全微调的性能相当，参数存储量还减少了 1000 倍。NLP 中的高超性能让不少人开始在 CV 领域中探索 Prompt 的魔力，不过都只局限于跨模态任务中文本编码器的输入。</p><p data-vmark="f40b">在本文中，作者将他们所提出的 Visual Prompt Tuning 方法，简称为 VPT。这是首次有人将 Prompt 应用到视觉模型主干（backbone），并做出成果。具体来说，比起全面微调，VPT 受最新大型 NLP 模型调整方法的启发，只在输入空间中引入少量可特定某任务训练的参数（不到模型参数的 1%），同时在训练下游任务期间冻结（freeze）预训练模型的主干。</p><p data-vmark="c151" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/96659863-def1-4f7d-ad48-c13dee347c9e.jpg" w="337" h="429" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="337" height="429" referrerpolicy="no-referrer"></p><p data-vmark="0f4d">在实操中，这些附加参数只用预先加入到每个 Transformer 层的输入序列中，并在微调期间与线性 head 一起学习。</p><p data-vmark="06df">他们一共探索出两种变体：</p><p data-vmark="a1f6">VPT-Deep 变体为 Transformer 编码器每层的输入预先设置一组可学习的参数；</p><p data-vmark="4848">VPT-Shallow 变体则仅将提示参数插入第一层的输入。</p><p data-vmark="9135">两者在下游任务的训练过程中，只有特定于任务的提示和线性头的参数会更新，而整个 Transformer 编码器被冻结。</p><p data-vmark="6d24" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/580d25df-3606-49fd-8182-fe2c9fccece2.png" w="1080" h="322" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="1080" height="244" referrerpolicy="no-referrer"></p><p data-vmark="3811">接下来，是骡子是马？拉出来溜溜～</p><h3 data-vmark="d295">20/24 的优胜率</h3><p data-vmark="35f7">实验涉及两种在 ImageNet-21k 上预训练好的主干，一个来自 Vision Transformer，一个来自 Swin Transformer。</p><p data-vmark="3b34">进行对比的微调方法有三大种，7 小种，包括：</p><p data-vmark="f830">（1）完全微调：更新所有主干和分类头（classification head）参数</p><p data-vmark="5933">（2）以分类头为重点的微调，包括 Linear、Partial-k 和 Mlp-k 三种；</p><p data-vmark="4a0d">（3）以及在微调过程中更新一个主干子集参数或向主干添加新的可训练参数的方法，分为 Sidetune、Bias 和 Adapter 三种。</p><p data-vmark="3c67" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/37e61750-9d2c-4e94-a496-78b2c5525c94.png" w="922" h="1228" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="922" height="1092" referrerpolicy="no-referrer"></p><p data-vmark="fb74">实验的数据集有两组，一共涉及 24 个跨不同领域的下游识别任务，包括：</p><p data-vmark="a346">（1）由 5 个基准细粒度视觉分类任务组成的 FGVC；</p><p data-vmark="8819">（2）由 19 个不同视觉分类集合组成的 VTAB-1k，细分为使用标准相机拍摄的自然图像任务（Natural）、用专用设备（如卫星图像）捕获的图像任务（Specialized）以及需要几何理解的任务（Structured），比如物体计数。</p><p data-vmark="ad29">测得每项任务上的平均准确度后，得出的主要结果如下：</p><p data-vmark="b8ac">VPT-Deep 在 24 个任务中有 20 个的表现都优于全面微调，同时使用的总模型参数显著减少（1.18× vs. 24.02×）；</p><p data-vmark="198d">要知道，在 NLP 领域中 Prompt 再厉害，性能也不会超过全面微调。这说明 Prompt 很适用于视觉 Transformer 模型。和其他微调方法相比（b、c 组），VPT-Deep 的性能则全部胜出。</p><p data-vmark="5f55" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/2382b9cc-d19c-46c6-acb3-48286ddbf63f.png" w="1080" h="378" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="1080" height="287" referrerpolicy="no-referrer"></p><p data-vmark="1ee2">此外，选择不同主干参数规模和模型规模的 ViT（ViT-B、ViT-L 和 ViT-H）进行测试还发现，VPT 方法不会受影响，依然基本保持性能领先。</p><p data-vmark="b7a6" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/2f8d1afa-509c-48f3-b482-a929d7925787.png" w="1080" h="298" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="1080" height="226" referrerpolicy="no-referrer"></p><p data-vmark="5755">而在 Swin Transformer 中，全面微调法的平均准确度虽然更高，但也付出了巨大的参数代价。其他微调方法则全部不敌 VPT。</p><p data-vmark="de00" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/a2853ed6-2b0a-4822-9c9a-4cd2461ec967.png" w="932" h="432" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="932" height="380" referrerpolicy="no-referrer"></p><h3 data-vmark="3d10">作者介绍</h3><p data-vmark="b944">一作贾梦霖，康奈尔大学信息科学（Information Science）博士生，主要研究方向为视觉和文本信息的细粒度识别，截至目前共发表过 4 篇顶会。</p><p data-vmark="a78a" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/e15d38b4-bd3c-47c5-867d-65e04cc9c2e1.png" w="752" h="752" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="752" height="752" referrerpolicy="no-referrer"></p><p data-vmark="3a3b">共同一作为唐路明，也是康奈尔大学的一位计算机博士在读学生，本科毕业于清华大学数学与物理专业。</p><p data-vmark="727a">他的主要研究方向为机器学习和计算机视觉的交叉领域。</p><p data-vmark="07de" style="text-align: center;"><img src="https://img.ithome.com/newsuploadfiles/2022/3/fb41be79-84cd-4a14-b8e0-e0106be45cd1.png" w="510" h="510" title="训练 CV 模型新思路来了：用 NLP 大火的 Prompt 替代微调，性能全面提升" width="510" height="510" referrerpolicy="no-referrer"></p><p data-vmark="1bcd">论文地址：</p><p data-vmark="8c04"><span class="link-text-start-with-http">https://arxiv.org/abs/2203.12119</span></p>
          
</div>
            