
---
title: '会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2022/3/7e53f50d-0d6f-4f2a-bdb8-4481e5c0a0fb.gif'
author: IT 之家
comments: false
date: Wed, 09 Mar 2022 04:33:02 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2022/3/7e53f50d-0d6f-4f2a-bdb8-4481e5c0a0fb.gif'
---

<div>   
<p data-vmark="160f">比 Codex 还会写 C 语言的 AI 代码生成模型，现在开源了！</p><p data-vmark="e4e4">这段时间，用 AI 写代码可以说是大火，其中最著名的要属 OpenAI 的 Codex 和 DeepMind 的 AlphaCode。</p><p style="text-align: center;" data-vmark="91b9"><img src="https://img.ithome.com/newsuploadfiles/2022/3/7e53f50d-0d6f-4f2a-bdb8-4481e5c0a0fb.gif" w="480" h="334" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="480" height="334" referrerpolicy="no-referrer"></p><p data-vmark="628a">△基于 Codex 的 Copilot</p><p data-vmark="0ecb">然而，这两个 AI 模型，全都没有开源：<span class="accentTextColor">其中 AlphaCode 只给出了一些测试样例，而 Codex 只开放了 API。</span></p><p data-vmark="b43a">为此，来自 CMU 的几个研究人员，用 GPT-2 搞出了一个名叫 PolyCoder 的 AI 代码生成模型，而且还是开源的。</p><p data-vmark="350e">据研究人员表示，虽然 PolyCoder 最大只有 27 亿参数（相比 Codex 有 120 亿参数），<span class="accentTextColor">但它用 C 语言写出来的代码，比 Codex 的效果还要好。</span></p><p data-vmark="56cf">这里面究竟有什么秘诀？</p><h2 data-vmark="d193">用 12 种编程语言代码集训练</h2><p data-vmark="5d83">首先来看训练用的数据集，这也是 PolyCoder 的最大特点之一。此前，包括 Codex、CodeParrot 等 AI 代码生成模型，主要都是基于 Python 语言的代码来训练。</p><p data-vmark="182d">例如 Codex 的评估数据集之一 HumanEval，评估的也是生成 Python 代码的效果。</p><p data-vmark="6e62">相比之下，PolyCoder 采用了多种编程语言代码集来训练，一共有 12 种：C、C#、C++、Go、Java、JavaScript、PHP、Python、Ruby、Rust、Scala 和 TypeScript。</p><p style="text-align: center;" data-vmark="794e"><img src="https://img.ithome.com/newsuploadfiles/2022/3/27b6dfb9-6d8e-44c6-84b2-a8fcd8ceab6b.png" w="1080" h="506" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="384" referrerpolicy="no-referrer"></p><p data-vmark="0e23">其中，C 语言的代码量是最多的，达到了 221GB；而 Python 代码的数据量比 Codex 和 CodeParrot 用得都要少。</p><p data-vmark="dc3d">这里 PolyCoder 用的是 GitHub 上的公开代码，主要选取的是各种编程语言中比较受欢迎的库，每个库至少有 50 Stars。</p><p data-vmark="0a08">据研究人员表示，每种编程语言库的 Stars 总数加起来不超过 25k，以避免模型生成的代码效果太过于倾斜最流行的编程语言（通常编程语言越流行，库的 Stars 就越多）。</p><p data-vmark="141d">通过提取库中的文件、经过简单处理（包括消除重复代码）后，一共筛选出大约 254GB 的数据用于训练。</p><p data-vmark="e15b">然后是预训练的方法。</p><p data-vmark="a2b9">语言模型的预训练方法通常有三种。第一种是自左向右的语言模型，根据上文预测下文，比较适用于代码生成等；第二种是掩蔽语言模型，基于上下文预测屏蔽片段，比较适合代码分类等；第三种是编解码器模型，比较适用于代码注释等任务。</p><p style="text-align: center;" data-vmark="d22d"><img src="https://img.ithome.com/newsuploadfiles/2022/3/4f468c36-5244-409c-90a5-c99b1772f90e.png" w="1080" h="219" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="166" referrerpolicy="no-referrer"></p><p data-vmark="23ef">这里 PolyCoder 主要采用的是第一种预训练方法。</p><p data-vmark="1e4a">相比于同样采用 GPT-2 训练的 CodeParrot 和 Codex，PolyCoder 在超参数设置上也稍微有一些差异：</p><p style="text-align: center;" data-vmark="bbc6"><img src="https://img.ithome.com/newsuploadfiles/2022/3/df57f817-484d-43c5-9616-e5514290c721.png" w="1080" h="457" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="347" referrerpolicy="no-referrer"></p><p data-vmark="cf8f">PolyCoder 一共提供了三种不同的模型，分别有 27 亿参数、4 亿参数和 1.6 亿参数，研究人员可以根据自身需求和不同的训练能力来选取合适的模型。</p><p style="text-align: center;" data-vmark="3a88"><img src="https://img.ithome.com/newsuploadfiles/2022/3/ebda83fc-c175-42b4-af40-bc0e4a211518.png" w="1080" h="475" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="361" referrerpolicy="no-referrer"></p><p data-vmark="ddc3">那么，最终训练出来的 AI 模型，代码生成效果如何？</p><h2 data-vmark="88ad">C 语言写得尤其好，但 Python 不行</h2><p data-vmark="f194">研究人员将 PolyCoder 与已有的 AI 代码生成模型进行了对比。由于 AlphaCode 不好比较（接口没开放），所以研究人员主要分析了下面这些模型，包括 GPT-Neo、CodeParrot 和 Codex 等。</p><p data-vmark="c91d">其中蓝色的是开源的，橙色的是没开源的：</p><p style="text-align: center;" data-vmark="7ead"><img src="https://img.ithome.com/newsuploadfiles/2022/3/1537a254-bb2a-4317-89fb-79b57538a504.png" w="1080" h="397" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="301" referrerpolicy="no-referrer"></p><p data-vmark="24cf">从参数量来看，PolyCoder 并不是最顶尖的，最大的 27 亿参数模型也只有 Codex 的四分之一不到。</p><p data-vmark="0e9e">研究人员先是用语言模型评估常用的困惑度对一系列模型进行了比较。</p><p data-vmark="eadd">困惑度（Perplexity），用于衡量语言模型（LM）的好坏。困惑度越低，语言模型面对代码感到困惑的程度就越低，模型生成效果越好。</p><p data-vmark="804b">从图中来看，PolyCoder 在 C 语言中意外取得了最好的效果（困惑度最低）。</p><p data-vmark="689f">用大量 C 语言训练 PolyCoder 的结果说明，即使模型整体原理不变（基于 GPT-2），单纯改变训练用的代码集，也能训练出擅长不同语言风格的 AI 代码生成模型。</p><p data-vmark="c9b2">可惜的是，从其他语言来看，生成的效果就完全没办法和 Codex 相比了：</p><p style="text-align: center;" data-vmark="07f6"><img src="https://img.ithome.com/newsuploadfiles/2022/3/9adb94e5-9da8-463f-a224-39b551e4df40.png" w="1080" h="365" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="277" referrerpolicy="no-referrer"></p><p data-vmark="15fa">例如，在主要用于评估 Python 代码的 HumanEval 上，PolyCoder 的能力远不如 Codex 好：</p><p style="text-align: center;" data-vmark="9379"><img src="https://img.ithome.com/newsuploadfiles/2022/3/809c69d1-71f1-46ed-9773-73637a94cacd.png" w="1080" h="374" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="1080" height="284" referrerpolicy="no-referrer"></p><p data-vmark="eea2">据论文分析，这可能是 Python 代码数据量、模型参数量不足等原因导致的。</p><p data-vmark="7d8e">此外，作者们也提到，做出 PolyCoder 的目的主要还是为了开源一个 AI 代码生成模型，让更多人参与研究和使用。</p><p data-vmark="e868">目前代码已经开源，无论是直接拿来用，还是试着在它的基础上开发新模型都可以。</p><p data-vmark="8f8e">感兴趣的小伙伴可以上手一试了~</p><h2 data-vmark="a6d8">作者介绍</h2><p style="text-align: center;" data-vmark="9247"><img src="https://img.ithome.com/newsuploadfiles/2022/3/bc312306-e79b-47a2-9194-db9153df1b07.png" w="330" h="328" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="330" height="328" referrerpolicy="no-referrer"></p><p data-vmark="ebd2">一作许方正（Frank Xu），目前在 CMU 读博，研究方向是 NLP、信息抽取等，发表过多篇顶会论文，包括 ICLR、ACL 和 EMNLP 等。本硕毕业于上海交通大学，师从朱其立教授。</p><p style="text-align: center;" data-vmark="a73f"><img src="https://img.ithome.com/newsuploadfiles/2022/3/bc1f0c0b-efda-4f34-bd43-3ff2d857dbce.png" w="316" h="480" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="316" height="480" referrerpolicy="no-referrer"></p><p data-vmark="babb">Uri Alon，在 CMU 进行博士后工作，研究方向是编程语言处理（PLP）、NLP 和深度学习。</p><p style="text-align: center;" data-vmark="9a47"><img src="https://img.ithome.com/newsuploadfiles/2022/3/59e77d08-c2c7-403a-9d2e-3b62f4c6edb9.png" w="308" h="380" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="308" height="380" referrerpolicy="no-referrer"></p><p data-vmark="04d4">Graham Neubig，CMU 助理教授，研究方向是 NLP、机器翻译和基于机器学习的自然语言理解。</p><p style="text-align: center;" data-vmark="8f29"><img src="https://img.ithome.com/newsuploadfiles/2022/3/72d0d10b-1bb5-4556-ac7b-5dd13e886131.png" w="346" h="342" title="会写代码的 AI 开源了：C 语言写得比 Codex 还要好，掌握 12 种编程语言" width="346" height="342" referrerpolicy="no-referrer"></p><p data-vmark="1a64">Vincent J. Hellendoorn，CMU 计算机助理教授，主要研究方向是软件工程和机器学习，致力于利用智能方法帮助软件开发人员减少代码调试、程序优化等繁琐工作的时间。</p><p data-vmark="d883">不知道作者们是否已经在用这个 AI 撸代码了（手动狗头）</p><p data-vmark="1977">项目地址：</p><p data-vmark="595f"><span class="link-text-start-with-http">https://github.com/VHellendoorn/Code-LMs</span></p><p data-vmark="04f9">论文地址：</p><p data-vmark="51d6"><span class="link-text-start-with-http">https://arxiv.org/abs/2202.13169</span></p>
          
</div>
            