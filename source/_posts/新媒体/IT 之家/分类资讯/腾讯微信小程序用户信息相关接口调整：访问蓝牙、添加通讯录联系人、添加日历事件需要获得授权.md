
---
title: '腾讯微信小程序用户信息相关接口调整：访问蓝牙、添加通讯录联系人、添加日历事件需要获得授权'
categories: 
 - 新媒体
 - IT 之家
 - 分类资讯
headimg: 'https://img.ithome.com/newsuploadfiles/2021/12/9a541a07-9fde-4e38-a405-1c81f3aed6af.png'
author: IT 之家
comments: false
date: Thu, 30 Dec 2021 03:49:08 GMT
thumbnail: 'https://img.ithome.com/newsuploadfiles/2021/12/9a541a07-9fde-4e38-a405-1c81f3aed6af.png'
---

<div>   
<div class="tougao-user">感谢IT之家网友 <a href="https://m.ithome.com/html/app/open.html?url=ithome%3A%2F%2Fuserpage%3Fid%3D862549" rel="nofollow">貂惹迷之别</a> 的线索投递！</div>
            <p data-vmark="257a"><a class="s_tag" href="https://www.ithome.com/" target="_blank">IT之家</a> 12 月 30 日消息，腾讯微信团队近期表示，为进一步规范开发者调用用户信息相关接口或功能，提升用户体验，平台将对部分用户信息相关功能及接口进行调整。</p><p data-vmark="f8eb"><img src="https://img.ithome.com/newsuploadfiles/2021/12/9a541a07-9fde-4e38-a405-1c81f3aed6af.png" w="596" h="480" alt="微信" title="腾讯微信小程序用户信息相关接口调整：访问蓝牙、添加通讯录联系人、添加日历事件需要获得授权" width="596" height="480" referrerpolicy="no-referrer"></p><p data-vmark="60e9">具体如下：</p><h3 data-vmark="d363">访问蓝牙、添加通讯录联系人、添加日历事件需要用户授权</h3><p data-vmark="e0e3">小程序处理用户的个人信息，需要获取用户明示同意，平台计划从 2022 年 2 月 21 日 24 时起对以下接口增加用户授权：</p><ul class=" list-paddingleft-2"><li><p data-vmark="073a">访问蓝牙：调用 wx.openBluetoothAdapter、wx.createBLEPeripheralServer，需要授权 scope.bluetooth</p></li><li><p data-vmark="93ea">添加通讯录联系人：调用 wx.addPhoneContact，需要授权 scope.addPhoneContact</p></li><li><p data-vmark="3db3">添加日历事件：调用 wx.addPhoneRepeatCalendar、wx.addPhoneCalendar，需要授权 scope.addPhoneCalendar</p></li></ul><p data-vmark="0cb8">IT之家获悉，开发者可在平台调整前提前增加使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/setting/wx.getSetting.html" target="_blank">wx.getSetting</a> 获取用户当前的授权状态的逻辑，若授权状态为 false 可以调用 wx.openSetting 打开设置界面，引导用户开启授权。</p><p data-vmark="3e2d">授权功能详细说明可参考：<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html" target="_blank">官方文档</a></p><h3 data-vmark="f334"><open-data> 组件功能调整</h3><p data-vmark="f664">开发者在未获取用户明示同意的情况下通过 <a href="https://developers.weixin.qq.com/miniprogram/dev/component/open-data.html" target="_blank"><open-data></a> 组件 在小程序中展示用户个人信息，用户容易误以为自己的个人信息在未授权的情况下，被小程序获取。平台计划从 2022 年 2 月 21 日 24 时起回收通过 <open-data> 展示个人信息的能力，若小程序需收集用户昵称头像等信息，可以通过 头像昵称填写功能 功能进行收集。具体回收方式为：</p><ul class="ai-word-checked list-paddingleft-2"><li><p data-vmark="5ad1">头像展示 灰色头像</p></li><li><p data-vmark="4533">用户昵称展示“微信用户”</p></li><li><p data-vmark="3b8c">用户性别、地区、语言展示为为空（“”）</p></li></ul><p data-vmark="32dd">小程序通过 <open-data> 展示群名称能力保留，平台会针对小程序生命周期内首次调用该组件展示群名称向用户提示：“群名称仅你可见，小程序无法获取。”</p><h3 data-vmark="dcdc">获取手机号能力安全升级</h3><p data-vmark="a576">此前小程序获取用户手机号是通过基础库接口直接获取 encryptedData 后进行解密。从基础库 2.21.2 版本起，回调参数中增加 code 参数，开发者获取 code 参数后，通过服务端 auth.getPhoneNumber 接口，使用 code 换取 encryptedData，用于解密手机号。</p><p data-vmark="3ae7">为不影响开发者现有逻辑，原有基础库接口中的 encryptedData 参数依旧保留，建议开发者尽快使用新的方式获取用户手机号。</p><p data-vmark="68e7">详细功能描述可参考： <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html" target="_blank">官方文档</a></p>
          
</div>
            