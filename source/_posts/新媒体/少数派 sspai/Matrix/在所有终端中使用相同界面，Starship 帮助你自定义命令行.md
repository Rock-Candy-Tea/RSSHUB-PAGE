
---
title: '在所有终端中使用相同界面，Starship 帮助你自定义命令行'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2022/04/25/65b42c190154b0721c0dc77ebc250244.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Fri, 29 Apr 2022 15:30:13 GMT
thumbnail: 'https://cdn.sspai.com/2022/04/25/65b42c190154b0721c0dc77ebc250244.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-6dd0eb6a><div class="update-wrap" data-v-6dd0eb6a></div><div class="content wangEditor-txt minHeight" data-v-6dd0eb6a><p><strong>Matrix 首页推荐</strong> </p><p><a href="https://sspai.com/matrix">Matrix</a> 是少数派的写作社区，我们主张分享真实的产品体验，有实用价值的经验与思考。我们会不定期挑选 Matrix 最优质的文章，展示来自用户的最真实的体验和观点。 <br>文章代表作者个人观点，少数派仅对标题和排版略作修改。</p><hr><p>众所周知，各个终端默认的配置都十分简陋。无论是 Windows 的 Powershell，还是 Linux 大部分发行版默认的 Bash，亦或是 macOS 预置的 zsh，本身都只提供了路径名和提示符，别无其他。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/25/65b42c190154b0721c0dc77ebc250244.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/25/65b42c190154b0721c0dc77ebc250244.png" referrerpolicy="no-referrer"><figcaption>默认的 Powershell 界面</figcaption></figure><p>这对需要频繁使用的机器来说，无论从生产力方面，还是美观度、舒适度方面，都是不大够用的。</p><p>我曾经尝试过好多种终端自定义方案，例如我使用 zsh 时，使用 <a href="https://ohmyz.sh/" target="_blank">oh-my-zsh</a> 这一集成方案，本身内置了大量主题，但是想对具体主题进行些许适合自己的微调，则并不容易。</p><p>我在使用 Bash 时，通过编辑 <code>.bashrc</code> 文件，虽然实现了比较自由的界面设置，但是复杂的代码和难用的 Shell 脚本，想要调整依然不简单。</p><pre class="language-shell"><code>local EXIT="$?"

local RCol='\[\e[0m\]'
local BRed='\[\e[1;31m\]'
local BGre='\[\e[1;32m\]'
local BBlu='\[\e[1;34m\]'

PS1="$&#123;debian_chroot:+($debian_chroot)&#125;\n"
if [ $EXIT != 0 ]; then
    PS1+="[$&#123;BRed&#125;$EXIT$&#123;RCol&#125;] "
fi
if test -n "$VIRTUAL_ENV"; then
    PS1+="($(basename $VIRTUAL_ENV)) "
fi
PS1+="$&#123;BGre&#125;\u@\h$&#123;RCol&#125;:$&#123;BBlu&#125;\w$&#123;RCol&#125;"
PS1+="\n"
PS1+="\\$ $&#123;RCol&#125;"</code></pre><p>直到我发现了 <a href="https://starship.rs/zh-CN/" target="_blank">Starship</a>。</p><h2>它有什么优势呢？</h2><p>开箱即用，这是 Starship 最让我惊喜的地方。</p><p>安装完 Starship 后，无需进行任何具体自定义的配置，默认就已经提供了非常完整和舒适的终端效果，因此我甚至不需要做什么调整，就可以拿来直接开始用。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/25/63aaaf9440982f86937ef86d26650a2d.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/25/63aaaf9440982f86937ef86d26650a2d.png" referrerpolicy="no-referrer"><figcaption>Starship 预设主题</figcaption></figure><p>Starship 的配置全部放在一个名为 <code>starship.toml</code> 的文件中，类似于：</p><pre class="language-null"><code>[git_state]
format = '[\($state( $progress_current of $progress_total)\)]($style) '
cherry_pick = "[🍒 PICKING](bold red)"</code></pre><p>官方提供了非常详细的 <a href="https://starship.rs/zh-CN/guide/" target="_blank">文档</a>，手把手指导如何配置每一个模块。可配置的模块有好几十个。</p><p>还有一点就是，Starship 使用 Rust 编写，对性能的影响很小，在我的低配置 VPS 中也能够快速运行，而不是像其他一些工具，启用之后，每次点击回车出现命令提示符时，都能感受到明显的卡顿。</p><p>此外，Starship 非常易于同步。各自安装之后，同一份配置文件可以在不同的操作系统（Windows、Linux、macOS、Android 等）、不同的 Shell（Bash、Zsh、Fish、Powershell 等）中使用，而且展示效果完全一致。非常适合同时使用多个环境、又期望在不同环境中拥有相似体验的人们。</p><h2>如何安装</h2><h3>主程序</h3><p>Starship 官方支持了各平台几乎所有常用的包管理器。</p><p>如果你使用 Windows，你可以使用 Chocolatey 或者 Scoop：</p><pre class="language-shell"><code>choco install starship</code></pre><p>如果你使用 Linux 或者 macOS，你可以选择 Homebrew 来安装：</p><pre class="language-shell"><code>brew install starship</code></pre><h3>启用</h3><p>要使 Starship 在终端中产生效果，需要在各个终端的配置文件中启用。例如对于 Bash，需要执行：</p><pre class="language-shell"><code>echo 'eval "$(starship init bash)"' >> ~/.profile</code></pre><p>对于 Powershell，可以使用 VS Code 直接编辑：</p><pre class="language-shell"><code>code $PROFILE</code></pre><p>并在打开的文件最后，加入一行：</p><pre class="language-shell"><code>Invoke-Expression (&starship init powershell)</code></pre><p>其他操作系统的安装方法、其他 Shell 的配置方法，可以在官网的 <a href="https://starship.rs/zh-CN/guide/#%F0%9F%9A%80-%E5%AE%89%E8%A3%85" target="_blank">安装指导</a> 中进行查询。</p><h3>字体</h3><p>为了显示效果完美呈现，可以在使用终端的系统中安装一个  Nerd Font 字体，用来显示一些图标字符。例如在 Windows 中可以执行：</p><pre class="language-null"><code>choco install firacodenf</code></pre><p>并在 Windows Terminal 中启用该字体：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/25/83ffcb46a47d4b650f69f0b819a0bca1.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/25/83ffcb46a47d4b650f69f0b819a0bca1.png" referrerpolicy="no-referrer"><figcaption>在 Windows Terminal 中设置字体</figcaption></figure><p>这并不是必须的，取决于在美化方案中是否用到图标字符。</p><h3>配置文件</h3><p>创建一个配置文件 <code>~/.config/starship.toml</code>，就可以在这个文件中自由设置了。</p><p>在默认风格的基础上，我们可以随意调整任何细节。例如，我们可以装饰一下提示符（官网示例）：</p><pre class="language-null"><code>format = """
[┌───────────────────>](bold green)
[│](bold green)$directory$rust$package
[└─>](bold green) """</code></pre><p>就会得到这样的效果：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/26/d02dc277ef64d4507adae65e4f8b7c76.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/26/d02dc277ef64d4507adae65e4f8b7c76.png" referrerpolicy="no-referrer"><figcaption>装饰过的提示符</figcaption></figure><p>所见即所得。</p><h2>配置适合自己的风格</h2><p>Starship 的配置文件以模块化的方式搭建。</p><h3>显示完整路径名</h3><p>需要修改当前路径的显示方式时，可以使用 Directory 这个组件：</p><pre class="language-null"><code>[directory]
truncate_to_repo=false
truncation_length=0</code></pre><p>由于 Starship 默认只展示 3 级目录，且只会显示到 git 根路径。为了显示完整路径名，我加入了上面的两项参数，关闭了这两个默认的功能。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/26/87968b3a755426fcecaf0a1cc53d8904.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/26/87968b3a755426fcecaf0a1cc53d8904.png" referrerpolicy="no-referrer"><figcaption>目录调整前后</figcaption></figure><h3>修改模块标识</h3><p>如果不想使用前文提到的图标字符，那么可以在配置中修改提示符。例如我这里去掉了 git 分支前面的符号：</p><pre class="language-null"><code>[git_branch]
symbol = "branch:"</code></pre><p>这样，分支符号就显示成了我在配置文件中设置的 <code>branch:</code> 字符串了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/26/ff63d5a1ef3bdb556fb36b1297a2ae37.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/26/ff63d5a1ef3bdb556fb36b1297a2ae37.png" referrerpolicy="no-referrer"><figcaption>移除图标字符</figcaption></figure><h3>增加 IP 地址</h3><p>通过 Local IP 模块，可以在命令行中显示 IP 地址，这对通过 SSH 连接时非常有用。</p><pre class="language-null"><code>[localip]
ssh_only = false
format = "[IP:$localipv4](bold red) "
disabled = false</code></pre><p>显示效果：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/04/26/96e13da347e8059fa0780786cf6ff562.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/04/26/96e13da347e8059fa0780786cf6ff562.png" referrerpolicy="no-referrer"></figure><h3>配置的一般规则</h3><p>在进行了前面几次尝试之后，对于规则的编写，大概可以有一些经验了。</p><p>首先确认需要调整的模块名称。仍以前面显示 IP 地址的模块为例，在文档中可以看到四个配置项：</p><ul><li>format</li><li>style</li><li>ssh_only</li><li>disabled</li></ul><p>其中 <code>disabled</code> 是几乎所有模块都有的一个配置，把它配为 <code>true</code> 则会显示，配为 <code>false</code> 则为隐藏。Starship 的默认配置中，指定了一些模块为 <code>true</code> 而另一些为 <code>false</code>，这可以通过查阅文档的默认值来确定。</p><p><code>format</code> 也是几乎所有模块都有的一个配置，它用来定义这个模块在命令行中如何显示。例如，前面我们给 IP 模块的 <code>format</code> 取值是 <code>"[IP:$localipv4](bold red)"</code>，这里 <code>$localipv4</code> 表示变量，会自动替换成相应的内容。所有可以使用的变量，在每个模块的 Variables 中有具体说明。</p><p>方括号用来确定一个具体的字符串，和小括号相结合，可以用来指定样式。在前面的例子中，方括号内的 <code>IP:$localipv4</code> 是具体显示的内容（当然这里 <code>$localipv4</code> 会实际显示成真实的 IP 地址，例如 <code>172.16.10.190</code>），而 <code>(bold red)</code> 并不会显示出来，而是用来把前面的 <code>IP:172.16.10.190</code> 部分的样式调整为粗体红色。</p><p><code>style</code> 也是大部分模块都会有的一个配置，可以调整默认的样式。</p><p>余下的就是模块自己独有的一些设置了，例如这里的 <code>ssh_only</code> 可以选择是否只是在 ssh 连接时显示 IP 地址。</p><h2>社区分享的配置</h2><p>除了基于 Starship 默认的配置进行调整，官方还收录了一些<a href="https://starship.rs/presets/#nerd-font-symbols" target="_blank">社区分享的配置</a>。</p><p>这些预设的配置文件中，包括了：</p><ul><li>使用图标文字的样式</li><li>使用方括号的样式</li><li>使用纯文本的样式</li></ul><p>以及其他一些预设配置。我们也可以在这些配置的基础上，进行自定义的设置。</p><h2>配置的同步</h2><p>设计完自己所需的配置之后，我们只需要把配置文件 <code>~/.config/starship.toml</code> 复制到另一个设备上，就可以立刻获得几乎完全相同的终端风格了。</p><h3>关联阅读</h3><ul><li><a href="https://sspai.com/post/59666" target="_blank">给你的终端加点料 —— 7 个让终端更好用的小工具</a></li><li><a href="https://sspai.com/post/59297" target="_blank">一日一技 | 如何让你的终端欢迎语好看又有趣</a></li><li><a href="https://sspai.com/post/59380" target="_blank">新生代 Windows 终端：Windows Terminal 的全面自定义</a></li></ul><p>> 下载 <a href="https://sspai.com/page/client">少数派 2.0 客户端</a>、关注 <a href="https://sspai.com/s/J71e">少数派公众号</a>，解锁全新阅读体验 📰 </p><p>> 实用、好用的 <a href="https://sspai.com/mall">正版软件</a>，少数派为你呈现 🚀</p></div><div class="update-details-wrap" data-v-6dd0eb6a></div><!----></div><div style="border:1px solid transparent;" data-v-6dd0eb6a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-6dd0eb6a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>23</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>11</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-8520" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E5%9C%A8%E6%89%80%E6%9C%89%E7%BB%88%E7%AB%AF%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9B%B8%E5%90%8C%E7%95%8C%E9%9D%A2%EF%BC%8CStarship%20%E5%B8%AE%E5%8A%A9%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E8%A1%8C%E3%80%91%E5%AE%89%E8%A3%85%E5%AE%8C%20Starship%20%E5%90%8E%EF%BC%8C%E6%97%A0%E9%9C%80%E8%BF%9B%E8%A1%8C%E4%BB%BB%E4%BD%95%E5%85%B7%E4%BD%93%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%BB%98%E8%AE%A4%E5%B0%B1%E5%B7%B2%E7%BB%8F%E6%8F%90%E4%BE%9B%E4%BA%86%E9%9D%9E%E5%B8%B8%E5%AE%8C%E6%95%B4%E5%92%8C%E8%88%92%E9%80%82%E7%9A%84%E7%BB%88%E7%AB%AF%E6%95%88%E6%9E%9C%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E7%94%9A%E8%87%B3%E4%B8%8D%E9%9C%80%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88%E8%B0%83%E6%95%B4%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%8B%BF%E6%9D%A5%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2022%2F04%2F26%2F8be67df9e46ac19b4d282a8ec3c0ba6e.png%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="iconfont iconfont-weibo-simple right-16"></i></a><span><div role="tooltip" id="el-popover-318" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><span class="el-popover__reference-wrapper"><i class="iconfont iconfont-wechat-simple right-16"></i></span></span><a href="https://twitter.com/share?text=%E3%80%90%E5%9C%A8%E6%89%80%E6%9C%89%E7%BB%88%E7%AB%AF%E4%B8%AD%E4%BD%BF%E7%94%A8%E7%9B%B8%E5%90%8C%E7%95%8C%E9%9D%A2%EF%BC%8CStarship%20%E5%B8%AE%E5%8A%A9%E4%BD%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E5%91%BD%E4%BB%A4%E8%A1%8C%E3%80%91%E5%AE%89%E8%A3%85%E5%AE%8C%20Starship%20%E5%90%8E%EF%BC%8C%E6%97%A0%E9%9C%80%E8%BF%9B%E8%A1%8C%E4%BB%BB%E4%BD%95%E5%85%B7%E4%BD%93%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%8C%E9%BB%98%E8%AE%A4%E5%B0%B1%E5%B7%B2%E7%BB%8F%E6%8F%90%E4%BE%9B%E4%BA%86%E9%9D%9E%E5%B8%B8%E5%AE%8C%E6%95%B4%E5%92%8C%E8%88%92%E9%80%82%E7%9A%84%E7%BB%88%E7%AB%AF%E6%95%88%E6%9E%9C%EF%BC%8C%E5%9B%A0%E6%AD%A4%E6%88%91%E7%94%9A%E8%87%B3%E4%B8%8D%E9%9C%80%E8%A6%81%E5%81%9A%E4%BB%80%E4%B9%88%E8%B0%83%E6%95%B4%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E6%8B%BF%E6%9D%A5%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="iconfont iconfont-twitter-simple right-16"></i></a></div></div><span class="el-popover__reference-wrapper"><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            