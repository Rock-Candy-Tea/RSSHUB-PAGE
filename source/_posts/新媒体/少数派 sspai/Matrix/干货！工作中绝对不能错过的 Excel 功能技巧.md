
---
title: '干货！工作中绝对不能错过的 Excel 功能技巧'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/05/11/article/ce1f732795f96c87ad1481743fd3a9f8?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Tue, 11 May 2021 01:07:27 GMT
thumbnail: 'https://cdn.sspai.com/2021/05/11/article/ce1f732795f96c87ad1481743fd3a9f8?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><p>提名【vlookup函数】和【数据透视表】！如果你不会用这俩，请速速码住它们的花样使用方法，实现工作效率的翻倍提升！</p><hr><p>----------先来【vlookup函数】9大用法指南-----------------</p><h2>1.常规用法</h2><p>常规方法相信大家都非常的熟悉，在这里我们想要查找西瓜的销售额，只需要将公式设置为：=VLOOKUP(E2,A2:C8,3,0)即可，这样的话就能查找想要的结果。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/ce1f732795f96c87ad1481743fd3a9f8?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/ce1f732795f96c87ad1481743fd3a9f8" referrerpolicy="no-referrer"></figure><h2>2.核对两列顺序错乱数据</h2><p>如下图，我们想要核对顺序错乱的数据，只需要将公式设置为：=E4-VLOOKUP(D4,$A$3:$B$9,2,0)，在这里如果结果不是0，就是差异的数据。它其实利用的也是vlookup的常规用法，将表1的考核得分引用到表2中，然后再用表2的考核得分减一下即可。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/e1404a53683eec37317f42830c74a1e5?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/e1404a53683eec37317f42830c74a1e5" referrerpolicy="no-referrer"></figure><h2>3.多条件查询</h2><p>使用vlookup查找数据的时候，如果遇到重复的查找值，函数仅仅会返回第一个查找的结果，比如在这里我们要查找销售部王明的考核得分，仅仅用王明来查找数据就会返回75分这个结果。</p><p>因为它在第一个位置，这个时候就需要增加一个条件来查找数据才能找到精确的结果，只需要将公式设置为：=VLOOKUP(E3&F3,IF(&#123;1,0&#125;,A1:A10&B1:B10,C1:C10),2,0)然后按ctrl+shift+回车三键填充公式即可。</p><p>在这里利用连接符号将姓名与部门连接在一起，随后再利用if函数构建一个二维数组就能找到正确的结果。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/93006242dd064aabc91bab54911fe54d?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/93006242dd064aabc91bab54911fe54d" referrerpolicy="no-referrer"></figure><h2>4.反向查找</h2><p>当我们使用vlookup来查找数据的时候，它仅仅只能查找数据区域右边的数据，而不能查找左边的数据，比如在这里我们想要通过工号来查找姓名，因为姓名在工号的左边所以查找不到，这个时候我们就需要将函数设置为：=VLOOKUP(G2,IF(&#123;1,0&#125;,B2:B10,A2:A10),2,0)然后按ctrl+shift+回车三键填充公式即可。</p><p>这个与多条件查询十分的相似，我们都是利用if函数构建了一个二维数组来达到数据查询的效果。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/65c240a4c5a79028e354a3af1dddc46c?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/65c240a4c5a79028e354a3af1dddc46c" referrerpolicy="no-referrer"></figure><h2>5.关键字查询</h2><p>在这里我们需要用到一个通配符，就是一个星号它代表任意多个字符，我们需要利用连接符号将星号分别连接在关键字的前后作为查找值，这样的话就能达到根据关键字查找数据的效果公式为：=VLOOKUP("*"&E2&"*",A1:A10,1,0)。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/7c0b41fc67ce0524e30131de88a7e4a9?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/7c0b41fc67ce0524e30131de88a7e4a9" referrerpolicy="no-referrer"></figure><p>6.一对多查询</p><p>首先我们需要先在数据的最左侧构建一个辅助列，A2单元格输入公式为：=(B2=$G$2)+A1，然后点击回车向下填充，这的话每遇到一个2班就会增加1，此时我们的查找值就变为了从1开始的序列，只需要将公式设置为：=VLOOKUP(ROW(A1),$A$1:$D$10,3,0)向下填充即可。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/e408aa73d9313c42e2a5d5cff5b7db08?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/e408aa73d9313c42e2a5d5cff5b7db08" referrerpolicy="no-referrer"></figure><h2>7.区间查询</h2><p>计算销售提成其实就是区间查询，所谓的区间查询就是某一个区间对应一个固定的数值，如下图我们想要计算销售提成的系数，首先需要先构建一个数据区域，将每个区间的最小值提取出来对应该区间的系数，然后进行升序排序，随后我们直接使用vlookup函数的近似匹配来引用结果即可，公式为：=VLOOKUP(B2,$E$11:$F$16,2,1)。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/e1180fb76c8802b1dea092c1b264e784?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/e1180fb76c8802b1dea092c1b264e784" referrerpolicy="no-referrer"></figure><h2>8.提取固定长度的数字</h2><p>如下图，我们想要将工号提取出来，也可以使用vlookup来解决，只需要将公式设置为：=VLOOKUP(0,&#123;0,1&#125;*MID(A2,ROW($1:$20),5),2,0)，然后按ctrl+shift+回车向下填即可。</p><p>如果工号的长度为5位，在这里我们利用MID(A2,ROW($1:$20),5)来提取5个字符长度的数据，然后将这个结果乘以0与1，来构建一个二维数组。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/e504fd3bf2046e2dcc916a589350fa10?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/e504fd3bf2046e2dcc916a589350fa10" referrerpolicy="no-referrer"></figure><h2>9.合并同类项</h2><p>Vlookup也可以用于合并同类项，只不过过程比较复杂，我们需要使用两次公式，首先我们将公式设置为：=B2&IFERROR("、"&VLOOKUP(A2,A3:$C$10,3,0),"")，然后拖动公式至倒数第二个单元格中，随后我们在旁边的单元格中再次使用vlookup函数将结果引用过来，公式为：=VLOOKUP(E3,A:C,3,0)至此合并完毕。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/4499002986b6d97438618fcdbdfae8fc?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/4499002986b6d97438618fcdbdfae8fc" referrerpolicy="no-referrer"></figure><hr><p><strong>----------------下方为【数据透视表】使用指南-----------------</strong></p><p>Excel数据透视表到底多好用，用过的人都知道！下次做数据汇总和拆分的时候就不用去套用各种函数了，毕竟数据透视表几秒钟就给你解决了～</p><p><strong>结合函数理解数据透视表：</strong></p><p>举个例子：</p><p>A公司销售的KPI要求为“每天30秒以上电话数/人为25个”，现需统计12月2日各部门KPI完成情况。如下：左图为A公司12月2日销售外呼数据，右图为需要获取的A公司销售部各部门KPI完成情况（部门完成率=部门实际值总和/部门目标值总和）。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/1158fb29f61f5e905861d6ba01b5ad0b?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/1158fb29f61f5e905861d6ba01b5ad0b" referrerpolicy="no-referrer"></figure><p>我们可以用SUMIF函数计算的方法，虽然也能较快的计算出我们需要的结果，但效率不高。在此，介绍一种<strong>利用【数据透视表】快速按需求获取汇总数据</strong>的方法。</p><p>第一步：选中目标数据：选中目标区域任意单元格，Ctrl+A。</p><p>第二步：插入数据透视表：【插入】选项卡-【数据透视表】，【创建数据透视表】弹窗：“选择要分析的数据”（默认即可）和“选择要放置数据透视表的位置（现有工作表）”。弹窗选项说明如下：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/ddb09d7a178884606f7f2dc883efc822?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/ddb09d7a178884606f7f2dc883efc822" referrerpolicy="no-referrer"></figure><p>第三步：选择字段，生成透视表：从【字段名称】列表里，点击字段拖拽至“筛选器、列、行、值”当中，如下图所示：给到的案例比较简单，只需要【行】和【值】两部分即可获取需要的结果。透视表结构如下图，详细说明如下：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/a0aa15f8e41b5e59bfd54589df996c7b?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/a0aa15f8e41b5e59bfd54589df996c7b" referrerpolicy="no-referrer"></figure><p>至此结束。</p><p>除此外，<strong>透视表还可以和【切片器】【透视图】【图表应用】【统计汇总】等结合使用</strong>，产生更多意想不到的效果，简单的演示可以看这篇分享：<a href="http://www.officezhushou.com/excel/jiqiao/5043.html" target="_blank">Excel数据透视表10大常用技巧</a></p><p>更进一步的数据可视化，还可以将excel表格导入到简道云中，制作可实时更新的动态数据看板：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/11/article/f200f0bb3e11adb79b51bc93db5ee857?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/11/article/f200f0bb3e11adb79b51bc93db5ee857" referrerpolicy="no-referrer"></figure><p><strong>看板制作教程：</strong><a href="https://hc.jiandaoyun.com/doc/10967" target="_blank"><strong>仪表盘设计教程</strong></a></p><p><strong>简道云地址：</strong><a href="https://www.jiandaoyun.com/?hmsr=zh&hmpl=lj&hmcu=&hmkw=&hmci=" target="_blank"><strong>简道云</strong></a></p><p>本文vlookup函数参考资料：<a href="https://mp.weixin.qq.com/s?__biz=MzU2ODc0MjI2OA==&mid=2247487469&idx=1&sn=1a0649416f52946f236605a4716c4c89&chksm=fc8817fecbff9ee8628507872dc99d5efa3ea0bd17e767fdd8e53a43d74dc332b3ccb21950e9&mpshare=1&scene=23&srcid=0510fkcTg4CLulWkTesjHEFu&sharer_sharetime=1620614002204&sharer_shareid=da96e63ef43dea34f067bf5dbaa4102d%23rd" target="_blank">vlookup函数用法大全，解决所有数据查询问题，收藏备用吧</a></p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>2</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>0</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-7858" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E5%B9%B2%E8%B4%A7%EF%BC%81%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%83%BD%E9%94%99%E8%BF%87%E7%9A%84%20Excel%20%E5%8A%9F%E8%83%BD%E6%8A%80%E5%B7%A7%E3%80%91%E4%BD%9C%E8%80%85%EF%BC%9A%E7%AE%80%E9%81%93%E4%BA%91%E9%93%BE%E6%8E%A5%EF%BC%9Ahttps%3A%2F%2Fwww.zhihu.com%2Fquestion%2F330309436%2Fanswer%2F1878455835%E6%9D%A5%E6%BA%90%EF%BC%9A%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F05%2F11%2F152265314080b7ff8dfafb70bf361022.jpg%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-4210" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><i class="icon icon-article_weixin right-16"></i></span><a href="https://twitter.com/share?text=%E3%80%90%E5%B9%B2%E8%B4%A7%EF%BC%81%E5%B7%A5%E4%BD%9C%E4%B8%AD%E7%BB%9D%E5%AF%B9%E4%B8%8D%E8%83%BD%E9%94%99%E8%BF%87%E7%9A%84%20Excel%20%E5%8A%9F%E8%83%BD%E6%8A%80%E5%B7%A7%E3%80%91%E4%BD%9C%E8%80%85%EF%BC%9A%E7%AE%80%E9%81%93%E4%BA%91%E9%93%BE%E6%8E%A5%EF%BC%9Ahttps%3A%2F%2Fwww.zhihu.com%2Fquestion%2F330309436%2Fanswer%2F1878455835%E6%9D%A5%E6%BA%90%EF%BC%9A%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            