
---
title: '让支持 HomeKit 的除湿机有更多选择——将德业除湿机接入 Homebridge'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2022/03/06/4b4e106308445b5f4c154681496291ef.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Sun, 06 Mar 2022 09:56:30 GMT
thumbnail: 'https://cdn.sspai.com/2022/03/06/4b4e106308445b5f4c154681496291ef.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-0b37afcb><div class="update-wrap" data-v-0b37afcb></div><div class="content wangEditor-txt minHeight" data-v-0b37afcb><h2>前言</h2><p>自己家里的除湿机已经买了快两年了，虽然它可以连接 Wi-Fi，但却一直没有什么实际作用。于是最近突发奇想：是否可以将德业除湿机接入 HomeKit，实现多设备联动？</p><p>答案是可以。</p><p>作为一个销售了数十万台除湿机的厂商，几乎绝大部分民用设备都有 Wi-Fi 功能（哪怕是最低端的 E12A3），这点还是值得表扬的。</p><h2>原理</h2><p>德业除湿机使用的是 MQTT 进行连接，所以我们只要知道 MQTT 账号密码与设备信息即可进行连接。当然，如果你愿意折腾的话，也完全可以让它连接到自己的 MQTT 服务器。</p><p><a href="https://deyedev.tat.moe/" target="_blank">这里</a> 是一个工具，可以用来获取 MQTT 与设备的信息。</p><p>有了这些信息还不够，还需要解析设备控制与状态的代码，以下是设备控制与状态代码的解析。这是我根据现有信息和自己的测试整合出来的。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/4b4e106308445b5f4c154681496291ef.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/4b4e106308445b5f4c154681496291ef.png" referrerpolicy="no-referrer"></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/cd7f6de8540f6106c3d302114e0107c8.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/cd7f6de8540f6106c3d302114e0107c8.png" referrerpolicy="no-referrer"></figure><p>说了半天，市面上并没有相关的插件，于是就有了它：homebridge-deye。</p><h2>安装插件</h2><p>安装和配置 Homebridge 的教程已有很多，这里将不在赘述。</p><p>在 Homebridge Config UI X 中搜索 homebridge-deye，然后选择安装。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/ecc2a404b13a9ae93c813321aab9a2f9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/ecc2a404b13a9ae93c813321aab9a2f9.png" referrerpolicy="no-referrer"></figure><p>手动安装：</p><p><code>npm install -g homebridge-deye</code></p><h2>配置插件</h2><p>首先，确保你的除湿机已经连接到 Wi-Fi 并绑定到账号。</p><p>打开 <a href="https://deyedev.tat.moe/" target="_blank">德业设备信息获取器</a>，输入德业账号的手机号和密码，点击 Login。</p><figure class="image ss-img-wrapper image_resized" style="width:503px;"><img src="https://cdn.sspai.com/2022/03/06/624dda0f54515789ceed190a8f18b9b1.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/624dda0f54515789ceed190a8f18b9b1.png" referrerpolicy="no-referrer"></figure><p> </p><p>这时此网页应该显示服务器连接信息和设备信息，你可以点击设备标题来展开详细信息。</p><figure class="image ss-img-wrapper image_resized" style="width:664px;"><img src="https://cdn.sspai.com/2022/03/06/34f258b4367f990a7c184988ac7c7cd0.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/34f258b4367f990a7c184988ac7c7cd0.png" referrerpolicy="no-referrer"></figure><p><strong>请注意：由于德业账号仅支持单端登录</strong><s><strong>（还没见过除了QQ微信只能单端登录的）</strong></s><strong>，所以你的 App 可能会收到“你的账号已在别处登录”的通知，这是正常的。</strong></p><p>此网页不会保留你的任何用户信息和密码，请放心使用。<a href="https://github.com/yamisenyuki/Deye-Device-Information-Getter" target="_blank">仓库地址</a></p><p>将对应名称的信息依次填入相应的栏目。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/03b0d28a30d272a2c69cf47aae0a1173.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/03b0d28a30d272a2c69cf47aae0a1173.png" referrerpolicy="no-referrer"><figcaption>Homebridge 编辑界面 - MQTT 信息</figcaption></figure><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/6ed11201021f5f5821d99c3fba6ec348.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/6ed11201021f5f5821d99c3fba6ec348.png" referrerpolicy="no-referrer"><figcaption>Homebridge 编辑界面 - 设备信息</figcaption></figure><p>你也可以点击 ADD DEVICE SETTINGS 来添加更多设备。</p><h3>一些配置信息：</h3><p><strong>Fan Speed Control:</strong> 是否启用风速控制功能。仅部分机型支持。</p><p><strong>Enable Temperature Sensor:</strong> 是否启用温度传感器。可能仅部分机型支持。</p><p><strong>Enable Dry Clothes Mode:</strong> 是否启用干衣模式开关。可能仅部分机型支持。</p><p><strong>Enable Sleep Mode:</strong> 是否启用睡眠模式开关。可能仅部分机型支持。</p><p><strong>请注意：</strong>当启用温度传感器后，由于苹果 HomeKit 政策原因，它将会将配件进行合并，你可能无法直接看到加湿器的控制界面。</p><p>如果发生此情况，请点击家庭 App 中配件中的“配件”选项，你将可以看到除湿机的信息。</p><p>或者，你也可以选择启用 干衣模式 或 睡眠模式，然后在点击家庭 App 中配件的“作为单独板块分开显示”。</p><p> </p><p><strong>输入完成后点击保存并重启Homebridge。</strong></p><p>现在你应该可以在HomeKit中看到除湿机。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2022/03/06/6180136b2720836ef6e1882dcf1385b3.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2022/03/06/6180136b2720836ef6e1882dcf1385b3.png" referrerpolicy="no-referrer"></figure><p>更多配置详情可以打开 <a href="https://github.com/IcesandSora/homebridge-deye">GitHub 仓库</a> 查看。</p><p>如果走到这一步，恭喜你，你已经添加了除湿机，现在可以使用啦！</p><h2>什么是 <a href="https://deyedev.tat.moe/" target="_blank">德业设备信息获取器</a>？</h2><p>这是一个静态网页，用于登陆获取德业账号中的信息，免去使用 Postman 等工具的麻烦。你的信息不会已任何形式保存在该网站。</p><p>请注意：由于德业账号仅支持单端登录<s>（还没见过除了QQ微信只能单端登录的）</s>，所以你的App可能会收到“你的账号已在别处登录”的通知，这是正常的。</p><h2>尾巴</h2><p>其实去年就已经有这个想法，看到有人将德业除湿机接入了 HomeAssistant，但是并不能满足我的需求。于是打算自己开发，但是碍于时间问题，并没有实现它。直到前几天又想做这个，发现网络上还是没有相关的插件，便开发了它。</p><p>希望这个插件可以在下个回南天帮助到你。</p><h2>特别感谢：</h2><p><a href="https://github.com/yamisenyuki" target="_blank">@yamisenyuki</a></p><h2>链接：</h2><p>homebridge-deye: <a href="https://github.com/IcesandSora/homebridge-deye" target="_blank">https://github.com/IcesandSora/homebridge-deye</a></p><p>德业设备信息获取器: <a href="https://github.com/yamisenyuki/Deye-Device-Information-Getter" target="_blank">https://github.com/yamisenyuki/Deye-Device-Information-Getter</a></p><p>homebridge: <a href="https://github.com/homebridge/homebridge" target="_blank">https://github.com/homebridge/homebridge</a></p><p>德业除湿机接入HomeAssistant: <a href="https://xiking.win/2020/11/12/3-deye-dehumidifer-add-to-homeassistant/" target="_blank">https://xiking.win/2020/11/12/3-deye-dehumidifer-add-to-homeassistant/</a></p><p>[经验分享] 德业除湿机接入以后获取全部状态: <a href="https://bbs.hassbian.com/thread-13426-1-1.html" target="_blank">https://bbs.hassbian.com/thread-13426-1-1.html</a></p></div><div class="update-details-wrap" data-v-0b37afcb></div><!----></div><div style="border:1px solid transparent;" data-v-0b37afcb></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-0b37afcb><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>6</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>2</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-3952" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E8%AE%A9%E6%94%AF%E6%8C%81%20HomeKit%20%E7%9A%84%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%9C%89%E6%9B%B4%E5%A4%9A%E9%80%89%E6%8B%A9%E2%80%94%E2%80%94%E5%B0%86%E5%BE%B7%E4%B8%9A%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%8E%A5%E5%85%A5%20Homebridge%E3%80%91%E5%89%8D%E8%A8%80%E8%87%AA%E5%B7%B1%E5%AE%B6%E9%87%8C%E7%9A%84%E9%99%A4%E6%B9%BF%E6%9C%BA%E5%B7%B2%E7%BB%8F%E4%B9%B0%E4%BA%86%E5%BF%AB%E4%B8%A4%E5%B9%B4%E4%BA%86%EF%BC%8C%E8%99%BD%E7%84%B6%E5%AE%83%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5Wi-Fi%EF%BC%8C%E4%BD%86%E5%8D%B4%E4%B8%80%E7%9B%B4%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E5%AE%9E%E9%99%85%E4%BD%9C%E7%94%A8%E3%80%82%E4%BA%8E%E6%98%AF%E6%9C%80%E8%BF%91%E7%AA%81%E5%8F%91%E5%A5%87%E6%83%B3%EF%BC%9A%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E5%B0%86%E5%BE%B7%E4%B8%9A%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%8E%A5%E5%85%A5Home%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2022%2F03%2F06%2Fd5c5ece8a2ae63c5cda0e527eafd82bb.png%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="iconfont iconfont-weibo-simple right-16"></i></a><span><div role="tooltip" id="el-popover-4654" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><span class="el-popover__reference-wrapper"><i class="iconfont iconfont-wechat-simple right-16"></i></span></span><a href="https://twitter.com/share?text=%E3%80%90%E8%AE%A9%E6%94%AF%E6%8C%81%20HomeKit%20%E7%9A%84%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%9C%89%E6%9B%B4%E5%A4%9A%E9%80%89%E6%8B%A9%E2%80%94%E2%80%94%E5%B0%86%E5%BE%B7%E4%B8%9A%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%8E%A5%E5%85%A5%20Homebridge%E3%80%91%E5%89%8D%E8%A8%80%E8%87%AA%E5%B7%B1%E5%AE%B6%E9%87%8C%E7%9A%84%E9%99%A4%E6%B9%BF%E6%9C%BA%E5%B7%B2%E7%BB%8F%E4%B9%B0%E4%BA%86%E5%BF%AB%E4%B8%A4%E5%B9%B4%E4%BA%86%EF%BC%8C%E8%99%BD%E7%84%B6%E5%AE%83%E5%8F%AF%E4%BB%A5%E8%BF%9E%E6%8E%A5Wi-Fi%EF%BC%8C%E4%BD%86%E5%8D%B4%E4%B8%80%E7%9B%B4%E6%B2%A1%E6%9C%89%E4%BB%80%E4%B9%88%E5%AE%9E%E9%99%85%E4%BD%9C%E7%94%A8%E3%80%82%E4%BA%8E%E6%98%AF%E6%9C%80%E8%BF%91%E7%AA%81%E5%8F%91%E5%A5%87%E6%83%B3%EF%BC%9A%E6%98%AF%E5%90%A6%E5%8F%AF%E4%BB%A5%E5%B0%86%E5%BE%B7%E4%B8%9A%E9%99%A4%E6%B9%BF%E6%9C%BA%E6%8E%A5%E5%85%A5Home%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="iconfont iconfont-twitter-simple right-16"></i></a></div></div><span class="el-popover__reference-wrapper"><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            