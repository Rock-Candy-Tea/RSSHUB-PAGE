
---
title: '长假睡好觉，一文了解睡眠监测技术内幕'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/10/04/b9397e932d6f7c83394daa0b1409c436.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Mon, 04 Oct 2021 08:42:33 GMT
thumbnail: 'https://cdn.sspai.com/2021/10/04/b9397e932d6f7c83394daa0b1409c436.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-6a669db8><div class="content wangEditor-txt minHeight" data-v-6a669db8><p style="margin-left:0px;">假期的你睡好觉了吗，我们如何知道这个「觉」睡得好不好？</p><p style="margin-left:0px;">在大家越发重视健康和睡眠质量的当下，各种睡眠追踪应用软件开始进入大家的视野。这些睡眠追踪方式是如何工作的？</p><p style="margin-left:0px;">本文就将带大家从原理到应用，进一步了解睡眠监测的技术内幕。</p><h2 style="margin-left:0px;">睡眠监测的医疗背景</h2><p style="margin-left:0px;text-align:justify;">睡觉是每一个人与生俱来的技能，或许没有谁比谁更懂睡眠。那么，睡眠监测为何物呢？顾名思义简单地讲，便是通过采集人类在睡眠期间的生理数据来监测分析其睡眠质量的过程。</p><p style="margin-left:0px;text-align:justify;">当然，这是我非常朴素的理解，在医学上，睡眠监测其实还是一个不小的研究领域，且普通人并不是研究对象，而是有相关障碍的患者。从为数不多的百科资料中我们可以了解到最常见的诊断方法：</p><blockquote><p style="margin-left:0px;">多导睡眠图监测（Polysomnography，PSG）又称睡眠多项生理检查，是睡眠医学、睡眠障碍、打鼾、癫痫、睡眠呼吸中止症等相关睡眠疾病当中，最常被安排进行的标准生理诊断方法。多项生理检查顾名思义，需要透过多种仪器的配合，方能进行检查的综合诊断方法。</p></blockquote><p style="margin-left:0px;text-align:justify;">PSG的检查内容一般包括睡眠情况（脑波图、眼动图、肌电图）、呼吸情况（血氧、胸腹动作、口鼻气流）、心脏情况等，受检者身上会安装多种仪器的侦测电极。目前很多医院也有专门的睡眠中心提供相关检查项目。</p><blockquote><p style="margin-left:0px;">需要留宿于医院一个晚上，做为期6-8小时的睡眠记录，而且需要全程配有专业睡眠检查的人员或医生。因此如果对于自己的睡眠有所疑问，可以洽询耳鼻喉科、胸腔内科、精神病学的医生以及睡眠技师（呼吸治疗师）等。</p></blockquote><h3 style="text-align:justify;">何为</h3><p style="margin-left:0px;text-align:justify;">睡眠监测有何用处呢？虽然本文的主题还是围绕移动端应用软件来展开，但医学上的专业监测方法却给移动设备上的简化版监测提供了理论基础，后者又在一定程度上普及了睡眠监测，降低了的使用者的成本。即便我们不是相关病症的患者，也有些许途径了解自己睡眠的简单情况，以便预防，即时就医。</p><p style="margin-left:0px;text-align:justify;">市面上也有很多商家专门贩卖睡眠监测仪之类的消费级设备（某些有点智商税的感觉），相比医院的医疗级设备肯定是差了不少，所以我个人还是觉得玩玩手机上的软件就差不多了。</p><h2 style="margin-left:0px;text-align:justify;">手机上的睡眠监测</h2><h3 style="text-align:justify;">手机厂商</h3><p style="margin-left:0px;text-align:justify;">目前很多手机厂商利用自己软硬结合的研发优势，开始进军健康应用的领域。比如苹果、华为、小米等国内外厂商都内置了独立的健康App。睡眠监测都还只是这些App的主要功能之一，除此之外还有运动、体重、心率、生理周期等相关功能，结合各家自己的穿戴设备，产品形态可以说是比较丰富了。</p><h4 style="text-align:justify;">Apple</h4><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/10/04/b9397e932d6f7c83394daa0b1409c436.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/b9397e932d6f7c83394daa0b1409c436.png" referrerpolicy="no-referrer"></figure><p style="margin-left:0px;text-align:justify;">苹果在健康App的开发上面应该是起步最早的，产品功能都已经非常成熟了。在早期的iOS 13及以前版本，健康和时钟App就有联动的功能，在时钟上使用“就寝”，可以追踪用户的睡眠状况。</p><blockquote><p style="margin-left:0px;">只需设置希望的每夜睡眠时长，“时钟”应用便可提醒您就寝，并通过播放闹钟来唤醒您。</p></blockquote><p style="margin-left:0px;text-align:justify;">在iOS 14以后，苹果将睡眠相关的功能深度整合到了健康App中，比如设置睡眠目标、编辑睡眠定时等。结合Watch，还可以追踪各项睡眠指标，如血氧、心率、呼吸频率等。不仅是睡眠监测，在苹果的睡觉“一条龙”服务当中，睡眠目标、睡前助眠、叫醒起床也是同样重要，给了用户一套比较完整的体验。</p><p style="margin-left:0px;text-align:justify;">苹果在睡眠这个功能集合上，相比其他产品，没有特别复杂的数据分析报告，不给用户太大的压力，更多的是关注用户睡没睡着，睡了多久，产品策略上似乎睡眠目标更为重要。在数据采集上也比较谨慎，早期的Watch其实就已经内置了检测血氧的光学传感器，但并没有开放，因为之前很多消费级的穿戴设备所推出的血氧检测功能并未获得相关的医疗认证，准确性和可靠性都存疑。</p><p style="margin-left:0px;text-align:justify;">总而言之，数据过于丰富并非是一件好事，只有得到充分研究论证后，那些确实跟睡眠状况有相关性的数据才有价值展示给用户。</p><figure class="image ss-img-wrapper image_resized" style="width:492px;"><img src="https://cdn.sspai.com/2021/10/04/eae4678fde3ada14d7c471b8a6bee174.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/eae4678fde3ada14d7c471b8a6bee174.png" referrerpolicy="no-referrer"></figure><h4 style="text-align:justify;">小米</h4><p style="margin-left:0px;text-align:justify;">小米在MIUI 12推出的时候，也着重介绍了其内置的健康App，现在MIUI 12.5的官网依然有健康的介绍入口。从初版的体验来看，功能也算是比较齐全了，看得出来内部团队在这个产品孵化上花的时间不少。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/10/04/8363868ed843e2e4b119c0ea7bd17cf6.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/8363868ed843e2e4b119c0ea7bd17cf6.png" referrerpolicy="no-referrer"></figure><p style="margin-left:0px;text-align:justify;">从最新官方海报来看，睡眠并没有作为重点功能介绍。但睡眠依然是小米健康App的主要功能模块之一，其中深浅睡和鼾声梦话记录还是做得比较成熟的，作为系统应用，体验上还是要优于大多数同类竞品的。</p><p style="margin-left:0px;text-align:justify;">国内很多厂商都在学习苹果的产研路线，小米健康同样支持穿戴设备的数据互通，甚至在很早之前就提供了<a href="https://dev.mi.com/docs/micloud/health/">小米健康云开放平台用户文档</a>，期望统一管理用户的健康数据，避免生态链企业各搞各的。</p><figure class="image ss-img-wrapper image_resized" style="width:483px;"><img src="https://cdn.sspai.com/2021/10/04/f077e30aa95a9b827785e196b4a94b5c.jpg?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/f077e30aa95a9b827785e196b4a94b5c.jpg" referrerpolicy="no-referrer"></figure><h4 style="text-align:justify;">华为</h4><p style="margin-left:0px;text-align:justify;">其实华为在健康App的研发上比小米等国内厂商要先行一步，该有的功能都有。除了睡眠监测分析等基本功能外，锦上添花的配套服务也比较丰富，例如白噪音、冥想等，属实是抢了不少三方应用的用户。</p><figure class="image ss-img-wrapper image_resized" style="width:445px;"><img src="https://cdn.sspai.com/2021/10/04/371c9ee3ff52fd2ddf0884ca6558d679.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/371c9ee3ff52fd2ddf0884ca6558d679.png" referrerpolicy="no-referrer"></figure><p style="margin-left:0px;text-align:justify;">仍然需要重点说明的是，手机厂商有一个很大的优势便是硬件，尤其是在传感器数据采集、穿戴设备的生态建设等方面，定制化地的集成研发都比三方应用只在数据层玩得开。</p><ul><li style="text-align:justify;"><a href="https://www.apple.com.cn/ios/health/">iOS - 健康</a></li><li style="text-align:justify;"><a href="https://home.miui.com/part">小米健康</a></li><li style="text-align:justify;"><a href="https://consumer.huawei.com/cn/mobileservices/health/">华为运动健康</a></li></ul><h3 style="text-align:justify;">三方应用</h3><p style="margin-left:0px;text-align:justify;">虽然手机厂商在硬件层面有更好的专属集成和功耗控制，但睡眠监测从理论上需要的大部分数据在上层应用也能获取到，所以三方开发者也并不是毫无机会施展拳脚。当然，在耗电方面，大家睡觉的时候基本都是让手机保持充电状态，倒是不用考虑功耗问题，但户外运动相关的健康功能，三方应用相比系统应用就没有什么优势了。</p><p style="margin-left:0px;text-align:justify;">此外，随着厂商平台生态的开放，以及健康数据相关API的系统级别沉淀与下放，三方应用的相对劣势会逐渐减少。尤其是近几年人工智能热潮再度掀起，机器学习在移动端的发展也逐渐成熟，Google和Apple都在相关领域有所铺垫。</p><p style="margin-left:0px;text-align:justify;">市面上有很多成熟的睡眠类App，聊聊我最近发现的Sleep as Android这款应用，从应用配置清单（manifest）来看，就很可能利用了Google最新开放的<strong>Sleep API</strong>，再结合自己的机器学习模型来实现睡眠监测。其功能丰富程度可以说是睡眠类应用的标准模板了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/10/04/317334d83d6fccf05f6f3f43ae186770.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/317334d83d6fccf05f6f3f43ae186770.png" referrerpolicy="no-referrer"></figure><p style="margin-left:0px;text-align:justify;">在我体验几天下来，感觉监测还是比较准的，主要是在睡眠时间这一块，个人主观感受比以前用的初版小米健康要稍微准一点（主要是在入眠时间的判断上面）。就是UI风格实在是太Material Design了，交互上反倒是稍微有点不适应。</p><p style="margin-left:0px;text-align:justify;">深浅睡和快速眼动（REM）这些基本数据都会有。入睡前有催眠曲，叫醒时会使用闹钟提醒起床，并且必须通过某些小测验才能解锁并停止闹钟，以证明你真的清醒了。当然，这对那些梦里都能操作的人来说，或许……没什么用。</p><figure class="image ss-img-wrapper image_resized" style="width:320px;"><img src="https://cdn.sspai.com/2021/10/04/064f95618ab0e7544dd0edaf7ecfcf34.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/064f95618ab0e7544dd0edaf7ecfcf34.png" referrerpolicy="no-referrer"><figcaption>Sleep as Android</figcaption></figure><ul><li style="text-align:justify;"><a href="https://docs.sleep.urbandroid.org/">Sleep as Android 用户手册</a></li></ul><h2 style="text-align:justify;">如何监测</h2><p style="margin-left:0px;text-align:justify;">下面就是重点了，我们从软件到硬件层面聊一下睡眠监测的技术实现方式和原理。</p><h3 style="text-align:justify;">软件</h3><h4 style="text-align:justify;">原始数据</h4><p style="margin-left:0px;text-align:justify;">不管是系统应用还是三方应用，其实应用软件本身在原始数据采集这一步能做的事情并不是很多，重点还是在数据的二次加工及使用上。比如苹果和国内Android厂商的系统级健康App，其数据采集方式都是差不多的。在手机设备上，它们无非是通过<strong>加速度传感器</strong>、<strong>光学传感器</strong>、<strong>扬声器/麦克风</strong>等元器件记录设备整晚的位移变化、光强度变化、声音变化信息，这些数据<strong>有分散也有连贯的</strong>。一些较为特殊的指标比如心率、血氧等，就依赖手表等穿戴设备来获取。</p><p style="margin-left:0px;text-align:justify;">简单地讲，加速度传感器的数据源是最为重要的，它往往作为睡眠类App的主要训练分析对象，其他数据源作为辅助优化训练结果。我之前在使用小米健康的时候，它就会请求身体运动信息等类似权限，并告诉你尽量放在枕边，保证你自己和手机睡在同一张床上，以此来监测你入眠后翻身、扭头等动作带来的振动，作为深浅睡的识别依据。</p><p style="margin-left:0px;text-align:justify;">例如，对Android应用开发者来说，监听部分传感器的数据实现起来也非常简单，系统底层框架已经屏蔽了不同手机设备的硬件差异。</p><ul><li style="text-align:justify;"><a href="https://developer.android.com/guide/topics/sensors/sensors_motion?hl=zh-cn#sensors-motion-accel">运动传感器 - Android Developers</a></li></ul><pre class="language-null"><code>private SensorManager sensorManager;
private Sensor sensor;
// 直接使用Android SDK提供的系统服务即可
sensorManager = (SensorManager) getSystemService(Context.SENSOR_SERVICE);
sensor = sensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
// 数据将以周期性事件的形式回调给开发者，加速度传感器是很多其他传感器的基础
public void onSensorChanged(SensorEvent event)&#123;
    // In this example, alpha is calculated as t / (t + dT),
    // where t is the low-pass filter's time-constant and
    // dT is the event delivery rate.

    final float alpha = 0.8;

    // Isolate the force of gravity with the low-pass filter.
    gravity[0] = alpha * gravity[0] + (1 - alpha) * event.values[0];
    gravity[1] = alpha * gravity[1] + (1 - alpha) * event.values[1];
    gravity[2] = alpha * gravity[2] + (1 - alpha) * event.values[2];

    // Remove the gravity contribution with the high-pass filter.
    linear_acceleration[0] = event.values[0] - gravity[0];
    linear_acceleration[1] = event.values[1] - gravity[1];
    linear_acceleration[2] = event.values[2] - gravity[2];
&#125;</code></pre><p style="margin-left:0px;text-align:justify;">当你把手机放在床头柜而不是床上时，发现最终识别效果并不是很理想，就说明此应用没有使用其他传感器的数据来辅助分析。</p><figure class="image ss-img-wrapper image_resized" style="width:321px;"><img src="https://cdn.sspai.com/2021/10/04/4235c2dfa29aca25c7326ec3190c27e6.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/4235c2dfa29aca25c7326ec3190c27e6.png" referrerpolicy="no-referrer"><figcaption>Sleep as Android</figcaption></figure><p style="margin-left:0px;text-align:justify;">在鼾声、梦话和呼吸频率的监测中，麦克风等声学元器件就起到了至关重要的作用。深夜的卧室里，环境一般都很安静，背景噪音是非常少的，所以声音数据的采集就比较有用处了。但考虑到功耗和存储限制，App一般不会整晚录音，那样生成的文件太大，也不便于分析，而是对分贝进行测量，<strong>大于设定阈值才会写入文件</strong>。</p><p style="margin-left:0px;text-align:justify;">Sleep as Android的简介中提到了用声纳原理来监测呼吸，这样就可以避免使用加速度传感器了。在我曾参与过的睡眠功能的开发中，并没有使用这个方法，当时主要是考虑到不同用户的睡眠环境、个体差异太大，且对设备的摆放位置要求较高，最终会导致训练难度加大。</p><h4 style="text-align:justify;">睡眠API</h4><p style="margin-left:0px;text-align:justify;">上面讲到的方案是开发者自己采集传感器的原始数据来进行睡眠分析，但随着这一需求的增多和相关训练模型的成熟，Google开始把睡眠监测整合成API加入到<strong>GMS</strong>的服务框架中。这些API相当于对各种传感器原始数据采集的方法做了二次封装，并且还内置了监测识别的模型，开发者<strong>无需再关心</strong>睡眠监测应该如何去采集数据、如何去训练了。Google现在帮你做好了，你只需要调用API，简单地处理结果事件即可。</p><ul><li style="text-align:justify;"><a href="https://developers.google.com/location-context/sleep">Sleep API - Google Developers</a></li><li style="text-align:justify;"><a href="https://github.com/android/location-samples/tree/main/SleepSampleKotlin">SleepSample - GitHub</a></li></ul><p style="margin-left:0px;text-align:justify;">从Sleep API官方文档来看，使用方式非常简单：</p><blockquote><p style="margin-left:0px;">To get started, do the following:</p><ul><li>Target Android 10 (API level 29) or higher.</li><li>Request the <code>ACTIVITY_RECOGNITION</code> permission.</li><li>Register for updates to the user's sleep behavior, including sleep segments and sleep event classification results, by calling <code>requestSleepSegmentUpdates()</code>.</li></ul></blockquote><p style="margin-left:0px;text-align:justify;">只要设备基于Android 10及以上，声明并请求行为识别专属权限，再调用相应的方法即可获取睡眠事件，这些事件都是GMS在框架中已经识别分析之后的结果，开发者只需要关心自己的产品业务逻辑即可。</p><p style="margin-left:0px;text-align:justify;">其中最重要且仅有的两个睡眠事件有必要介绍一下：<a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepSegmentEvent">SleepSegmentEvent</a> 和 <a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepClassifyEvent">SleepClassifyEvent</a> 。</p><p style="margin-left:0px;text-align:justify;">SleepSegmentEvent顾名思义就是<strong>睡眠片段</strong>事件，其中包含了用户每一段睡眠的关键信息：</p><figure class="table"><table><thead><tr><th style="border-bottom:0px;border-top:0px;padding:8px;vertical-align:bottom;"><strong>关键方法</strong></th><th style="border-bottom:0px;border-top:0px;padding:8px;vertical-align:bottom;"><strong>说明</strong></th></tr></thead><tbody><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepSegmentEvent#getEndTimeMillis()">getEndTimeMillis</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">系统检测到用户停止睡眠并苏醒的时间</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepSegmentEvent#getSegmentDurationMillis()">getSegmentDurationMillis</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">用户这段睡眠的持续时间（原文档特别提示到based on the device sensor data）</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepSegmentEvent#getStartTimeMillis()">getStartTimeMillis</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">用户开始入睡的时间</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepSegmentEvent#getStatus()">getStatus</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">事件状态，有数据缺失、无法检测和成功三种，第一种一般是数据采集不足导致的，第二种是识别结果置信度不够导致</td></tr></tbody></table></figure><p style="margin-left:0px;text-align:justify;">而SleepClassifyEvent，便是<strong>睡眠识别分类</strong>事件，包含了睡眠识别的置信度和传感器数据等信息，且此事件回调周期是固定间隔10分钟：</p><figure class="table"><table><thead><tr><th style="border-bottom:0px;border-top:0px;padding:8px;vertical-align:bottom;"><strong>关键方法</strong></th><th style="border-bottom:0px;border-top:0px;padding:8px;vertical-align:bottom;"><strong>说明</strong></th></tr></thead><tbody><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepClassifyEvent#getConfidence()">getConfidence</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">0到100，值越大置信度越高，说明用户当前越可能处于睡眠状态</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepClassifyEvent#getLight()">getLight</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">顺便返回环境亮度值</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepClassifyEvent#getMotion()">getMotion</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">顺便返回设备位移值，即加速度传感器的包装数据</td></tr><tr><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;"><a href="https://developers.google.com/android/reference/com/google/android/gms/location/SleepClassifyEvent#getTimestampMillis()">getTimestampMillis</a>()</td><td style="border-top:1px solid rgb(221, 221, 221);padding:8px;vertical-align:top;">事件发生时的时间戳，是一个时刻，非连时间段</td></tr></tbody></table></figure><p style="margin-left:0px;text-align:justify;">有了这些方法，睡眠类App开发的门槛大幅降低，大概是一件好事吧。当然，这就相当于完全信任Google的模型，且依赖GMS（谷歌移动服务）框架，国内恐怕不好普及。不过之前在做竞品调研的时候，Pixel的效果确实比其他手机好，国产某些旗舰机（自带GMS框架）也可以。</p><p style="margin-left:0px;text-align:justify;">由于GMS的<strong>闭源</strong>特性，成熟的商业App肯定不会只使用Google的Sleep API，更多是以此来辅助自己的算法，用户体验到的会是优化后的融合效果。</p><h3 style="text-align:justify;">硬件</h3><p style="margin-left:0px;text-align:justify;">相比三方应用开发者，手机厂商的巨大优势就是硬件，这里说的硬件不仅仅是区别于手机的穿戴设备那么简单，而是指手机、手表等设备内部的芯片、传感器。上层软件开发者在睡眠监测这个功能上有两个主要劣势：</p><p style="margin-left:0px;text-align:justify;">只能调用封装好的传感器数据API或者集成好模型的二次API，无法得知底层实现，做不了数据源的定制化开发，最终必须在数据处理上玩出花才行。</p><p style="margin-left:0px;text-align:justify;">不管监听哪种传感器，以及声音采集，都是非常<strong>耗电</strong>的行为，即便睡眠场景不用太担心电量，但对各类健康App来说，不只有睡眠功能，其他诸如运动、测量等功耗自然是越低越好，所以功耗问题三方应用没有办法太好地解决，软件优化是有瓶颈的。</p><p style="margin-left:0px;text-align:justify;">针对上述2个缺点，对应聊一聊厂商的系统应用是如何解决的。</p><h4 style="text-align:justify;">融合传感器</h4><p style="margin-left:0px;text-align:justify;">任何某个单一传感器都是无法满足监测识别任务的，厂商可以开发专属的传感器，来采集其他基本传感器的数据，融合成新的传感器事件（event）。这个专属传感器可以是真实元件，成本较高；也可是模拟的，一般在系统的硬件抽象层（HAL）做模拟。最后对于上层的系统应用（System Apps）来说，就是多了一个可以监听的Sensor类型而已。</p><p style="margin-left:0px;text-align:justify;">融合传感器可以避免上层应用同时监听多个传感器，大大降低功耗。很多人可能会有疑问：融合的数据不也是在底层同时采集了多个其他传感器吗？确实是，但是它减少了从底层到上层一系列的框架调用，底层硬件的耗电其实远小于软件层面的CPU消耗电量。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/10/04/58ac4d34c10539d1c763a223596a5b8f.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/10/04/58ac4d34c10539d1c763a223596a5b8f.png" referrerpolicy="no-referrer"><figcaption>Android系统架构</figcaption></figure><h4 style="text-align:justify;">算法下沉</h4><p style="margin-left:0px;text-align:justify;">有了融合传感器之后，我们可以进一步把一些较为固定的业务逻辑和算法模型下沉到系统底层，让专用的处理单元（比如DSP、TPU等）去做计算工作，最后直接把识别的结果传递给上层应用即可，传递数据之前的整个过程中都不需要唤醒上层的应用进程，应用层只需要在接收结果后稍作修饰，再做纯业务展示即可。</p><p style="margin-left:0px;text-align:justify;">这一系列做法可以极大地降低设备功耗。这就是为什么某些厂商可以自信地宣称系统内置运动健康类App的各种活动识别全天耗电在1%以内。</p><h2 style="margin-left:0px;text-align:justify;">小结</h2><p style="margin-left:0px;text-align:justify;">睡眠监测越来越得到各家健康App的重视，虽然三方和厂商在基础能力上有先天差距，但随着技术的成熟，厂商为了建立自己的生态，也愿意开放能力出来给大家使用。降低行业总体成本的同时，未来角逐的更多还是产品体验。</p></div><!----></div><div style="border:1px solid transparent;" data-v-6a669db8></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-6a669db8><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>5</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>1</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-8782" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E9%95%BF%E5%81%87%E7%9D%A1%E5%A5%BD%E8%A7%89%EF%BC%8C%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3%E7%9D%A1%E7%9C%A0%E7%9B%91%E6%B5%8B%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%91%E5%9B%BD%E5%BA%86%E9%95%BF%E5%81%87%EF%BC%8C%E4%B8%8D%E6%83%B3%E5%87%BA%E9%97%A8%E7%9A%84%E4%BD%A0%EF%BC%8C%E7%9D%A1%E4%B8%AA%E5%A5%BD%E8%A7%89%E4%BA%86%E5%90%97%EF%BC%9F%E6%88%91%E4%BB%AC%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E8%BF%99%E4%B8%AA%E2%80%9C%E8%A7%89%E2%80%9D%E7%9D%A1%E5%BE%97%E5%A5%BD%E4%B8%8D%E5%A5%BD%E5%91%A2%EF%BC%9F%E5%9C%A8%E6%B3%A8%E9%87%8D%E5%81%A5%E5%BA%B7%E7%9A%84%E5%BD%93%E4%B8%8B%EF%BC%8C%E7%9D%A1%E7%9C%A0%E7%9B%91%E6%B5%8B%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%A7%8B%E8%BF%9B%E5%85%A5%E5%A4%A7%E5%AE%B6%E7%9A%84%E8%A7%86%E9%87%8E%E3%80%82%E6%9C%AC%E6%96%87%E5%B0%86%E5%B8%A6%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F10%2F04%2F86761ffee635effd4e3defd80c60517c.png%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="iconfont iconfont-weibo-simple right-16"></i></a><span><div role="tooltip" id="el-popover-9390" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><span class="el-popover__reference-wrapper"><i class="iconfont iconfont-wechat-simple right-16"></i></span></span><a href="https://twitter.com/share?text=%E3%80%90%E9%95%BF%E5%81%87%E7%9D%A1%E5%A5%BD%E8%A7%89%EF%BC%8C%E4%B8%80%E6%96%87%E4%BA%86%E8%A7%A3%E7%9D%A1%E7%9C%A0%E7%9B%91%E6%B5%8B%E6%8A%80%E6%9C%AF%E5%86%85%E5%B9%95%E3%80%91%E5%9B%BD%E5%BA%86%E9%95%BF%E5%81%87%EF%BC%8C%E4%B8%8D%E6%83%B3%E5%87%BA%E9%97%A8%E7%9A%84%E4%BD%A0%EF%BC%8C%E7%9D%A1%E4%B8%AA%E5%A5%BD%E8%A7%89%E4%BA%86%E5%90%97%EF%BC%9F%E6%88%91%E4%BB%AC%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E8%BF%99%E4%B8%AA%E2%80%9C%E8%A7%89%E2%80%9D%E7%9D%A1%E5%BE%97%E5%A5%BD%E4%B8%8D%E5%A5%BD%E5%91%A2%EF%BC%9F%E5%9C%A8%E6%B3%A8%E9%87%8D%E5%81%A5%E5%BA%B7%E7%9A%84%E5%BD%93%E4%B8%8B%EF%BC%8C%E7%9D%A1%E7%9C%A0%E7%9B%91%E6%B5%8B%E7%B1%BB%E7%9A%84%E5%BA%94%E7%94%A8%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%A7%8B%E8%BF%9B%E5%85%A5%E5%A4%A7%E5%AE%B6%E7%9A%84%E8%A7%86%E9%87%8E%E3%80%82%E6%9C%AC%E6%96%87%E5%B0%86%E5%B8%A6%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="iconfont iconfont-twitter-simple right-16"></i></a></div></div><span class="el-popover__reference-wrapper"><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            