
---
title: '作为一个普通的航司 IT，谈谈你所不知道的机票业务'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/06/14/article/61ec165e1d6a43e8c8bf6dc8a0122b6d?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Mon, 14 Jun 2021 11:15:54 GMT
thumbnail: 'https://cdn.sspai.com/2021/06/14/article/61ec165e1d6a43e8c8bf6dc8a0122b6d?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><h3><strong>机票</strong></h3><p>如果你需要登机，你就需要一张机票，这毋庸置疑。</p><p>如果你是一个空中飞人，你就会发现不同机场的纸质机票虽然有着不同的布局，不同的logo，不同的背部广告，但正面展示的信息基本相同，我们暂且认为这是旅客在机场完成值机、行李托运、安检、登机等一系列手续所需的基本信息，以不同的布局，不同的格式展现在这种不大不小的长方形卡纸上。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/14/article/61ec165e1d6a43e8c8bf6dc8a0122b6d?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/14/article/61ec165e1d6a43e8c8bf6dc8a0122b6d" referrerpolicy="no-referrer"><figcaption>纸质登机牌</figcaption></figure><p>那么这些信息是否都是必要的呢？</p><p>随着民航无纸化业务的普及，人们渐渐发现，很多业务的办理只需要票号/身份证就可以办理，比如值机或者行李托运，那么纸质登机牌上这些信息到底是为了什么呢？</p><p>实际上，负责任的说，纸质登机牌上的明文信息更多是方便乘客去核对个人信息，找到对的登机口，找到对的座位号，除此之外，所有业务需要的信息，实际上都藏在登机牌角落里那不起眼的条形码或二维码里。</p><p>要了解这个，我们就要谈谈机票业务的数据流转。</p><h3><strong>你买票的时候，到底发生了什么？</strong></h3><p>要了解买票的流程，你首先得明白一个航司内部的基础概念，叫做GDS，全称Global Distribution System全球分销系统，从名字你就能明白，这是一个大规模的销售网络系统，而在中国，这个系统叫做中航信（TravelSky）。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/14/article/99844c32d4c72c62f82476fe88b767ee?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/14/article/99844c32d4c72c62f82476fe88b767ee" referrerpolicy="no-referrer"><figcaption>GDS</figcaption></figure><p>目前来说，GDS系统的运行方式，主要分为三部分，而大部分旅客购票时发生的信息流转，都跟这三个部分密切相关：</p><p>1、代理人机票销售系统CRS，全称Computer Reservation System. CRS的作用在于由代理人（如携程、去哪儿等大型OTA及各个城市的小型代理人等）提供航班情况查询、航段销售、产品销售、订座记录查询、客票预定等功能，你在携程、去哪儿的购票行为，均跟CRS相关，由它们向相关航司统一提供旅客数据，完成预定过程。</p><p>2、航司订座系统ICS，全称Inventory Control System，ICS向代理人和自营渠道提供作为控制、航班排期、运价/收益、航空联盟、销售控制等参数。</p><p>3、离港控制系统DCS，全称Departure Control System，主要控制旅客值机、航班配载、航班数据控制、登机联程等信息服务。</p><p>你从CRS购票，CRS会向ICS请求航班信息，并随后传输你的订座信息给ICS，而在航班初始化之后，你的数据会从ICS流转到DCS，并由DCS完成最后的值机、登机等流程。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/14/article/f5d79a90aa9e7e25be40e11e20ba5144?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/14/article/f5d79a90aa9e7e25be40e11e20ba5144" referrerpolicy="no-referrer"><figcaption>GDS</figcaption></figure><h3><strong>How?</strong></h3><p>人们说实践出真知，让我带你们走一遍从购票到值机，最后登机的全流程，你们就会发现实际上从订票到起飞，一切都没看起来这么简单。</p><p>让我们从CRS端开始，当你在航空公司官网也好，App也好，携程去哪儿也罢，输入你想要查询的航班，比如上海到北京，2021年6月15号的机票，点击搜索。</p><p>这时候CRS会向ICS发送一个查询指令，这个指令一般是AV，Availability的缩写，格式为AV SHAPKX/15JUN/0000/D，其中SHA是上海虹桥机场的三字码，PKX是北京大兴机场的三字码，这套三字码系统是国际通用的IATA三字码标准，用来区分具体机场的不同（比如上海还有一个浦东机场为PVG，而北京首都机场是PEK），在前端页面为了用户方便，一般会让用户输入上海这个城市，同时查出SHA和PVG分别到PEK和PKX信息，组合返回，并在航班列表页面标识出来。</p><p>这时候ICS会返回航班列表以及对应的舱位等级和剩余数量，这里有个很有意思的点，如果剩余舱位数量小于10，则会给出具体的数字，比如1、2、3，但如果舱位充足，则会用A代替，这就是为什么你有时候查询只会看到【座位充足】四个字，那说明这个舱位的剩余数量超过了9，至于多少，CRS也不知道。</p><p>在你输入了个人信息，并确认购票时，ICS会获得你的姓名、证件号、联系方式等，并将航班信息和你的个人信息写入档案，返回给你一个档案编码，这个编码就是民航人员常说的PNR，Passenger Name Record，并通过PAT指令生成运价信息，确认购票后，你就得到了我们常说的13位票号，购票成功了，而上述就是购票过程中发生的一切。</p><p>通常13位票号是不会重复的，因此在隐私保护协议中，一般票号会作为重要隐私保护，理论上来讲获得了票号，就能获得你的行程信息、个人信息，是十分危险的事情；PNR则比较有趣，由于PNR只有六位，在目前全国旅客这么多的情况下，就算是26个字母+10个数字组成，也是不够用的，更遑论还要剔除0和o等相似字样，所以PNR是有一个回收机制的，这个PNR服务完你的行程之后，会进入候选池，被下一个旅客随机抽取使用。</p><p>有经验的朋友此时可能会发现，机票票号是有规律的，没错，这边顺带提一嘴，机票票号通常为13位，其中前三位是航空公司的数字代码，后十位则是流水号，因此一般有经验的旅客看到前三位就能判断是哪家航司的票。</p><p>言归正传，完成购票流程之后，我们就要等航班初始化之后，准备网上值机或者现场值机，然后起飞了对吧~航班初始化一样是一个业内用语，一般是代表航班及旅客信息从订座系统流转到离港系统后，由机场现场的小姐姐小哥哥点击航班初始化按钮确定初始化状态，这时候你才能在网络上完成值机动作。</p><p>这个航班初始化的时间一般是由场站拟定的，所以你会发现有的场站起飞的航班，可以提前两天进行网上值机，而有的则只能提前一天甚至12小时进行值机。</p><p>来，现在让我们来进行值机。</p><p>现在一般航司自己搭建的值机系统，是通过PE系统和航信底层进行交互，首先需要你的证件号，查出你的订座信息，但现在为了隐私保护，避免黑产通过穷举票号获得大量旅客的行程信息出售，一般会进行一次个人信息的校验，这就是为什么现在你们值机除了票号，还需要证件号、姓名、手机号、验证码等步骤，都是因为他们。</p><p>获得旅客订座信息之后，会有一张航班的座位图传输给航司，航司需要根据座位图上开放座位的数据，提示旅客哪些座位能网上值机，哪些座位则只能现场办理。</p><p>这里又有一个有趣的知识点，一般为了航班配载考虑，头部和尾部的座位在网上值机的时候会被锁定，这是为了飞机在天空中飞行的平衡考虑；同样安全出口由于需要当面告知旅客相关注意事项，所以同样也是被锁定的，只能现场办理，所以有的旅客会发现网值能选的位置相对少得可怜，这就是出于安全需要了，如果想要这些特殊座位，还请麻烦移步现场值机。</p><p>完成值机之后，有无纸化登机流程的航司会给旅客一张电子登机牌和二维码，这个二维码包含的信息可就丰富了，有你的行程信息、个人信息、登机序号等等等，可谓是大而全，所以不建议在微博或者朋友圈发截图的时候不打码，这隐私泄露得可比你登机牌上明文可见的信息多多了。</p><p>之后你拿着这个二维码过安检，安检会拿到你的个人数据，并给你登机牌盖上【安检验讫章】，你才算完成了前置步骤，可以移步至登机口进行登机。</p><h3><strong>结尾</strong></h3><p>怎么样，看完上述的步骤之后，是不是有一些常年积累的疑问得到了解答呢？比如为什么网值可选的座位图这么少？为什么购票的时候看不到剩余的具体舱位数量？哈哈这也不是航司或者OTA（<i>Online</i> <i>Travel</i> Agent，不是大家熟知的那个OTA哈）特意刁难你们，属实是【系统设定】，如果有想了解的更多关于航司的信息，可以在评论留言，我会挑选一部分再写文章进行解答~</p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>11</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>2</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-3860" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E4%BD%9C%E4%B8%BA%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%9A%84%E8%88%AA%E5%8F%B8%20IT%EF%BC%8C%E8%B0%88%E8%B0%88%E4%BD%A0%E6%89%80%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E6%9C%BA%E7%A5%A8%E4%B8%9A%E5%8A%A1%E3%80%91%E6%9C%BA%E7%A5%A8%E5%A6%82%E6%9E%9C%E4%BD%A0%E9%9C%80%E8%A6%81%E7%99%BB%E6%9C%BA%EF%BC%8C%E4%BD%A0%E5%B0%B1%E9%9C%80%E8%A6%81%E4%B8%80%E5%BC%A0%E6%9C%BA%E7%A5%A8%EF%BC%8C%E8%BF%99%E6%AF%8B%E5%BA%B8%E7%BD%AE%E7%96%91%E3%80%82%E5%A6%82%E6%9E%9C%E4%BD%A0%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A9%BA%E4%B8%AD%E9%A3%9E%E4%BA%BA%EF%BC%8C%E4%BD%A0%E5%B0%B1%E4%BC%9A%E5%8F%91%E7%8E%B0%E4%B8%8D%E5%90%8C%E6%9C%BA%E5%9C%BA%E7%9A%84%E7%BA%B8%E8%B4%A8%E6%9C%BA%E7%A5%A8%E8%99%BD%E7%84%B6%E6%9C%89%E7%9D%80%E4%B8%8D%E5%90%8C%E7%9A%84%E5%B8%83%E5%B1%80%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84logo%EF%BC%8C%E4%B8%8D%E5%90%8C%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F06%2F14%2F1c3c82e480bed91b884322909ab04a98.png%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-6085" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><i class="icon icon-article_weixin right-16"></i></span><a href="https://twitter.com/share?text=%E3%80%90%E4%BD%9C%E4%B8%BA%E4%B8%80%E4%B8%AA%E6%99%AE%E9%80%9A%E7%9A%84%E8%88%AA%E5%8F%B8%20IT%EF%BC%8C%E8%B0%88%E8%B0%88%E4%BD%A0%E6%89%80%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E6%9C%BA%E7%A5%A8%E4%B8%9A%E5%8A%A1%E3%80%91%E6%9C%BA%E7%A5%A8%E5%A6%82%E6%9E%9C%E4%BD%A0%E9%9C%80%E8%A6%81%E7%99%BB%E6%9C%BA%EF%BC%8C%E4%BD%A0%E5%B0%B1%E9%9C%80%E8%A6%81%E4%B8%80%E5%BC%A0%E6%9C%BA%E7%A5%A8%EF%BC%8C%E8%BF%99%E6%AF%8B%E5%BA%B8%E7%BD%AE%E7%96%91%E3%80%82%E5%A6%82%E6%9E%9C%E4%BD%A0%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A9%BA%E4%B8%AD%E9%A3%9E%E4%BA%BA%EF%BC%8C%E4%BD%A0%E5%B0%B1%E4%BC%9A%E5%8F%91%E7%8E%B0%E4%B8%8D%E5%90%8C%E6%9C%BA%E5%9C%BA%E7%9A%84%E7%BA%B8%E8%B4%A8%E6%9C%BA%E7%A5%A8%E8%99%BD%E7%84%B6%E6%9C%89%E7%9D%80%E4%B8%8D%E5%90%8C%E7%9A%84%E5%B8%83%E5%B1%80%EF%BC%8C%E4%B8%8D%E5%90%8C%E7%9A%84logo%EF%BC%8C%E4%B8%8D%E5%90%8C%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            