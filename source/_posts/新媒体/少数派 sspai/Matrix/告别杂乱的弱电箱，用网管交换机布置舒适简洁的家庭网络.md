
---
title: '告别杂乱的弱电箱，用网管交换机布置舒适简洁的家庭网络'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/05/23/f86380fd6a133663896d2a42baf3cbab.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Sun, 23 May 2021 04:55:39 GMT
thumbnail: 'https://cdn.sspai.com/2021/05/23/f86380fd6a133663896d2a42baf3cbab.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><h3>  前言</h3><p>  弱电箱，一直是家庭网络配置的最大敌人之一。现在房子中的弱电箱不仅空间小，里面更是塞了光猫插线板，网络交换机，电话交换机，甚至电视线交换机。很多朋友都不满足于运营商送的光猫路由一体机的羸弱性能，但是又无奈不能往狭小的弱电箱中塞入强劲的Wi-Fi6路由器，加之弱电箱一般为可以屏蔽信号的金属外壳，位置一般在不方便随时打开调试的高台或者柜子后面。因此即使装修商已经提前帮你布好了接入各个房间的网线，弱电箱也限制了我们的发挥。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/23/f86380fd6a133663896d2a42baf3cbab.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/23/f86380fd6a133663896d2a42baf3cbab.png" referrerpolicy="no-referrer"><figcaption>笔者家以前的弱电箱</figcaption></figure><p>  网上很多朋友都尝试直接拆掉弱电箱门，甚至专门为弱电箱定制弱电箱柜子。在本文中我们可以换一个思路，用一种名为VLAN（虚拟局域网）的技术，彻底解决弱电箱带给我们的苦恼。</p><hr><p>首先我们要介绍一下VLAN这个很常见但是可能大家并不熟悉的技术。</p><blockquote><p><strong>虚拟局域网</strong>（<strong>Virtual Local Area Network</strong>或简写<strong>VLAN</strong>, <strong>V-LAN</strong>）是一种建构于局域网交换技术（LAN Switch）的<a href="https://zh.wikipedia.org/wiki/%E7%B6%B2%E7%B5%A1%E7%AE%A1%E7%90%86">网络管理</a>的技术，网管人员可以借此透过控制<a href="https://zh.wikipedia.org/wiki/%E4%BA%A4%E6%8F%9B%E5%99%A8">交换机</a>有效分派出入局域网的分组到正确的出入端口，达到对不同实体局域网中的设备进行逻辑分群（Grouping）管理，并降低局域网内大量资料流通时，因无用分组过多导致壅塞的问题，以及提升局域网的信息安全保障。</p></blockquote><p>  上面的文字可能比较难以简单理解，这边我们可以换一个简单的说法：VLAN就是一个可以决定网络数据流向的工具，我们可以借助VLAN隔离我们不想让他们混杂在一起的网络信号，通过VLAN我们可以建立虚拟层面的交换机。</p><p>  如果上面的解释还是不够清晰，不要担心，跟着笔者的思路解决弱电箱难题之后，相信你会对这个技术有更深的理解。</p><hr><h3>解决问题</h3><p>现在我们要开始解决弱电箱难题，在解决之前我们首先要确认一下家里的网络是否符合以下条件：</p><ul><li>光猫改成桥接模式。</li><li>弱电箱中的网线可以通到各个房间。</li><li>弱电箱中的空间可以足够放下一个网管交换机（具体看网线数量和选择品牌），老的交换机可以拆掉。</li></ul><p>  如果以上条件全部符合，我们可以开始选购合适的网管型交换机了！选购网管交换机之前，还要确认一点：<strong>如果你的路由器的网口可以设置VLAN（比如各种openwrt的软路由），那么我们只需要购买放在弱电箱中的交换机即可。如果你的路由器没有这么高级的功能，那么则需要多购买一个网管型交换机（一般最小的5口就够用）。</strong></p><p><strong>  </strong>而市面上的网管型交换机价格区间很大，但是家用网络我们只需要选择便宜的千兆网管交换机即可。</p><span class="ss-linkCard" link-card-href="https://item.jd.com/100001913315.html"> </span><span class="ss-linkCard" link-card-href="https://item.jd.com/100001913313.html#crumb-wrap"> </span><span class="ss-linkCard" link-card-href="https://item.jd.com/100002382702.html"> </span><span class="ss-linkCard" link-card-href="https://item.jd.com/7660978.html"> </span><p>  当然在弱电箱中放置一个网管型交换机和一个非网管型交换机也是可以的，只要插座或者DC电源线分配合适，这也是一种节约成本的办法。</p><p>那么购买好合适的网管型交换机之后，我们就可以开始着手消灭弱电箱难题了。我们先从传统的家庭网络拓扑图开始看：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/23/75bfc7116bb59e1a6b9479b7f623f95c.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/23/75bfc7116bb59e1a6b9479b7f623f95c.png" referrerpolicy="no-referrer"><figcaption>传统网络拓扑结构</figcaption></figure><p>  从图上可以看到，传统的方式路由器的WAN口连接着广域网（光猫），路由器作为三层设备，下面连接着局域网（交换机）。但是这种方式路由器光猫和交换机的物理位置必然要非常接近。而为了解决这个问题，我们来看看使用VLAN隔离后的网络拓扑结构：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/23/a6927f8ca0e94321e6701f9331c7f444.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/23/a6927f8ca0e94321e6701f9331c7f444.png" referrerpolicy="no-referrer"><figcaption>使用VLAN隔离之后的结构</figcaption></figure><p>  虽然连通着广域网的网线和局域网的网线都连接在一个交换机上，但是我们使用VLAN技术把它们从虚拟层面隔离开，使得虚拟层面上的网络拓扑图依旧如同传统网络拓扑一样整齐简洁。而这个时候，我们的主路由可以再家中任何有网口的房间摆放，而弱电箱的门可以再也不用打开。</p><p>  理清楚思路之后，我们就可以开始着手设置我们的网管型交换机了。在这里我们补充一下接下来将要用到的一些知识。</p><h4>PVID</h4><p>PVID可以简单理解成网络信号中被交换机打上的标记。就好比给不同的网络信号穿上了不同颜色的衣服。而经过网口的时候网口则会判断这件衣服是否符合自己的规定，符合颜色的衣服的网络信号就可以顺利通过这个网口，而不符合的则会被隔离开来。</p><h4>Tagged口和Untagged口</h4><p>简单的说Tagged口可以允许多条VLAN共用一条网线，而Untagged端口允许一条VLAN使用。</p><p>由于各家界面不尽相同，所以笔者这里仅用思维导图和文字带大家一起设置。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/05/23/40d8e63e4970c6ec4ab45cd493d8959a.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/05/23/40d8e63e4970c6ec4ab45cd493d8959a.png" referrerpolicy="no-referrer"></figure><ol><li>把网管交换机替换掉弱电箱中原本的交换机，把光猫的千兆口接入网管交换机的网络接口。记住光猫接入的网口序号（A），需要放置主路由房间的网口序号（B）。</li><li>查看交换机说明书，书中会给出对应的管理IP地址，在连接到交换机局域网的任意一个设备上，更改IP地址到同一网段（比如管理地址是192.168.<strong>A</strong>.*，设备就改为192.168.<strong>A</strong>.**，子网掩码255.255.255.0，不需要填入网关和DNS）。</li><li>进入交换机管理页面，找到VLAN→802.1Q<sup class="ss-footnote" href="https://en.wikipedia.org/wiki/IEEE_802.1Q" title="IEEE 802.1Q定义一个关于VLAN连接介质访问控制层和IEEE 802.1D生成树协议的具体概念模型。这个模型允许各个独立的VLAN以交换机的数据链路层或路由器互相连接。" footnote-id="1">1</sup>→启用。</li><li>给WAN设置一个任意（1-4094）整数<i><strong>A'，</strong></i>把A网口改为在VLAN：A'下的Untagged口，把B网口改为Tagged口。</li><li>给LAN设置一个任意（1-4094）整数<i><strong>B'</strong></i>，把除了A、B网口的剩下所有网口改为在VLAN：B'下的Untagged口，把B网口改为Tagged口。</li><li>点进802.1QPVID设置，把A网口的值改为A'，除了AB以外剩下的网口改为B'。B口默认不用即可。</li><li>更改交换机的IP地址到家庭局域网段下。</li><li>保存设置。</li></ol><p>接下来我们来设置第二台VLAN交换机，整体过程大同小异我们直接从第4步开始：</p><ol><li>把直接连接主交换机的网口设置成和主交换机的B网口一致。</li><li>把连接路由器WAN口的网口设置成和主交换机A网口一致（PVID也一致）。</li><li>把剩下的口设置为和主交换机除了AB网口以外网口一致（PVID也一致）。</li><li>把路由器的LAN口插入剩下任意网口。</li><li>设置路由器上网设置。</li></ol><p>如此一来我们就已经解决了弱电箱难题！当然如果你觉得两台交换机过于复杂，你也可以去研究单臂路由的设置方法，这样走线会更加整洁，但在本文就不再更深的研究。</p><p>同样的，如果你家里也有IPTV，也可以参照上面的方法把IPTV的网络单独隔离出来，如此一来也不用单独拉线到电视盒子上。</p><hr><h3>总结</h3><p>  经过一番不算复杂的的折腾之后，我们终于可以不用再去管弱电箱了，其实VLAN还有很多更好玩的用法有待大家探索，也希望大家都能远离弱电箱，拥有一个更加舒适的家庭网络环境。</p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>8</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>7</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-4965" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E5%91%8A%E5%88%AB%E6%9D%82%E4%B9%B1%E7%9A%84%E5%BC%B1%E7%94%B5%E7%AE%B1%EF%BC%8C%E7%94%A8%E7%BD%91%E7%AE%A1%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B8%83%E7%BD%AE%E8%88%92%E9%80%82%E7%AE%80%E6%B4%81%E7%9A%84%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E3%80%91%E5%89%8D%E8%A8%80%E5%BC%B1%E7%94%B5%E7%AE%B1%EF%BC%8C%E4%B8%80%E7%9B%B4%E6%98%AF%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9C%80%E5%A4%A7%E6%95%8C%E4%BA%BA%E4%B9%8B%E4%B8%80%E3%80%82%E7%8E%B0%E5%9C%A8%E6%88%BF%E5%AD%90%E4%B8%AD%E7%9A%84%E5%BC%B1%E7%94%B5%E7%AE%B1%E4%B8%8D%E4%BB%85%E7%A9%BA%E9%97%B4%E5%B0%8F%EF%BC%8C%E9%87%8C%E9%9D%A2%E6%9B%B4%E6%98%AF%E5%A1%9E%E4%BA%86%E5%85%89%E7%8C%AB%E6%8F%92%E7%BA%BF%E6%9D%BF%EF%BC%8C%E7%BD%91%E7%BB%9C%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%8C%E7%94%B5%E8%AF%9D%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%8C%E7%94%9A%E8%87%B3%E7%94%B5%E8%A7%86%E7%BA%BF%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F05%2F23%2F2a57c48406525178586d0e4a58a0e653.jpg%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-535" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><i class="icon icon-article_weixin right-16"></i></span><a href="https://twitter.com/share?text=%E3%80%90%E5%91%8A%E5%88%AB%E6%9D%82%E4%B9%B1%E7%9A%84%E5%BC%B1%E7%94%B5%E7%AE%B1%EF%BC%8C%E7%94%A8%E7%BD%91%E7%AE%A1%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%B8%83%E7%BD%AE%E8%88%92%E9%80%82%E7%AE%80%E6%B4%81%E7%9A%84%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E3%80%91%E5%89%8D%E8%A8%80%E5%BC%B1%E7%94%B5%E7%AE%B1%EF%BC%8C%E4%B8%80%E7%9B%B4%E6%98%AF%E5%AE%B6%E5%BA%AD%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE%E7%9A%84%E6%9C%80%E5%A4%A7%E6%95%8C%E4%BA%BA%E4%B9%8B%E4%B8%80%E3%80%82%E7%8E%B0%E5%9C%A8%E6%88%BF%E5%AD%90%E4%B8%AD%E7%9A%84%E5%BC%B1%E7%94%B5%E7%AE%B1%E4%B8%8D%E4%BB%85%E7%A9%BA%E9%97%B4%E5%B0%8F%EF%BC%8C%E9%87%8C%E9%9D%A2%E6%9B%B4%E6%98%AF%E5%A1%9E%E4%BA%86%E5%85%89%E7%8C%AB%E6%8F%92%E7%BA%BF%E6%9D%BF%EF%BC%8C%E7%BD%91%E7%BB%9C%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%8C%E7%94%B5%E8%AF%9D%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%8C%E7%94%9A%E8%87%B3%E7%94%B5%E8%A7%86%E7%BA%BF%E4%BA%A4%E6%8D%A2%E6%9C%BA%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            