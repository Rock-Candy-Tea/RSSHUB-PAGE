
---
title: '利用 NAS 对实验室数据进行存储的一次尝试'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/06/30/41190721bcee22b5f89b9c5683aa7457.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Sat, 03 Jul 2021 03:30:13 GMT
thumbnail: 'https://cdn.sspai.com/2021/06/30/41190721bcee22b5f89b9c5683aa7457.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><h2>背景介绍：      </h2><p>       在学术上，遇到质疑时最有力的回击方式之一就是提供原始实验数据。遗憾的是，并不是所有原始实验数据都能被很好地保存。一方面，古老文章的实验数据往往记载在纸上，时间一长比较容易受损或者丢失。另一方面，在管理不善的情况下，实验数据或许会被实验同学有意无意的修改，没有办法给出最原始的那份数据。</p><p>      受到质疑的一方无法提供原始数据，这多多少少会显得没有底气。毕竟，对于任何一个致力于优秀科研成果的实验室来说，良好的实验室数据管理是理所当然的。在遭到质疑而拿不出原始数据时，哪怕是学界大牛也可能面临撤稿的结果（<a href="https://www.zhihu.com/question/458152727/answer/1893955699">比如电催化领域顶级大牛崔屹也因此被Nature Catalysis撤稿</a>）。可见，管理保存原始实验数据是实验室良好发展不可或缺的一个环节。</p><p>      我现在的实验室也有数据备份的需求。实验室建立还不久，大约半年前实验平台搭建完成，师兄师姐们陆续有了一些实验数据。但是大家平时都使用的自己的电脑做的实验，实验数据的管理上稍显混乱。导师担心前人走后，新人没有办法很好地接受前人的工作（比如说需要摸索一段时间在自己电脑上配置软件，或者可能没有师兄的前期实验数据很难开展后续的工作等等）。因此，导师买了两台电脑专门用于实验，并且拿了自己以前使用的 NAS 计划搭建实验室自己的云盘。因为在少数派看到 NAS 相关的介绍，我就把这项工作拿了过来，准备搭建一个简单的模型。</p><p>       为了方便后面的人快速上手管理 NAS，导师要求我把整个流程做的简单一些。我在这里提供了一个简单的备份和同步模型，并在最后指出一些目前的漏洞和可以进行的升级措施。</p><h2>实验材料：</h2><p>       使用的 NAS 是群晖的 DS215J，属于比较老的型号了，可以插两个盘。它有一根网线连接网络，另外需要一直供电。理论上讲它具有断电保护的措施，不过还是要小心实验室的意外断电（发出来的这天早上还恰巧发生了一次没有预兆的实验楼断电）。功能实现完全依赖于群晖自己 Drive service，不一定适应其他的 NAS。</p><p>       搭建过程中的所有操作都来自少数派的 NAS 入门教程<a href="https://sspai.com/series/182">《家用 NAS 入门指南》</a>。这份教程比较详细地讲述了 NAS 的基本操作。拥有它的指导，我很快地像是搭积木一样把模型搭了起来。整体的思路和操作都不难理解，但是有一些实验室环境下独有的细节，可能需要你关注一下。</p><h2>具体操作：</h2><p>       整个模型可以分成三个部分：实验电脑，NAS 和个人电脑。实验电脑专门用于实验并记录实验数据，NAS 用于备份实验数据并同步到个人电脑，个人电脑用于数据处理和作图。</p><h3>    基本配置：</h3><p>       基本上就是 NAS 的配置。硬件上就是电源和网线。电源自然不必多说。网线我是直接连在了实验室的路由器上的，两台实验电脑也处于同一网络下。使用的网络是校园网，因此每次路由器重启后ip会变动。当然，我们也可以向学校申请固定 ip，这样就可以增加一个内网穿透，支持从外部网络访问的功能了。不过我们的设想是学生做完实验后直接在本地网络下直接同步，就没有暂时搁置了这项工作。</p><p>       连上网络之后就是软件配置了。按照《家用 NAS 入门指南》的指导，我先是在<a href="http://find.synology.com/">http://find.synology.com/</a>下搜索局域网内的 NAS，无果后按照界面要求下载了 Synology Assistant。这一次顺利地找到了 NAS，直接点击就可以进行连接。</p><p>       全新的机器到这一步应该有创建激活账户的步骤，因为我手头的是导师的就机子，直接登陆导师的账号就进去了。进去之后按照教程，我在 DS215J 上下载了 Drive service (下载步骤可以参考官方指导）。这个软件可以像云盘一样帮助文件在不同电脑上备份和同步。</p><p>        同时我开了一个专门用于实验室成员登录的账号，操作上基本上就和 Windows 开一个账号一样，账号权限可以按照需求勾选。后面实验室电脑和个人电脑登录都是使用的实验室共同账号。</p><p>        这样，所有在 NAS 上的准备工作就完成了。</p><h3>    从实验室电脑到NAS的备份：</h3><p>       按照计划，所有的实验数据都会在实验室电脑上测得。把这一部分的实验数据一丝不差地备份下来，是整个模型中最重要的一部分。我认为最常见的场景是图1展示的三种：正常备份，数据删除和数据覆盖的情况。第一种不用多说，而后面两种都是实际可能出现的误操作。对此，群晖的 Drive 都能比较好地保护好数据。备份功能不需要其他设置就可以保证实验电脑上的数据删除不会影响 NAS 上的数据。</p><p>       如果实验数据存档命名时因为重名覆盖了另一个文件，也不用担心。Drive 支持文件的历史版本查询。我测试过不停覆盖文件六到七次，都可以顺利地在历史版本里找回。而官方文档上给出的最多支持记录的历史版本数目是32个（来自《Synology Drive 白皮书》），应该是绰绰有余的。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/30/41190721bcee22b5f89b9c5683aa7457.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/30/41190721bcee22b5f89b9c5683aa7457.png" referrerpolicy="no-referrer"><figcaption>图1.从实验室电脑到NAS的三个主要场景</figcaption></figure><p>       实际操作时要注意修改“备份规则”。我在实验电脑上安装 Synology Drive Client,登录后选择备份。在图2上方的窗口里勾选你要同步的文件夹（具体到这个例子就是保存实验数据的文件夹），然后打开下面的“备份规则”，勾选最下面的三个方框。这样勾选下，所有该文件下的附属文件和文件夹都会备份到 NAS 里，并且在本地文件被删除的情况下也会在 NAS 里保存好副本。</p><figure class="image ss-img-wrapper image_resized" style="width:345px;"><img src="https://cdn.sspai.com/2021/07/01/488299977e84737460c47f45bdd32c8c.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/07/01/488299977e84737460c47f45bdd32c8c.png" referrerpolicy="no-referrer"><figcaption>图2. 在备份窗口里选择备份来源和并修改备份规则</figcaption></figure><p>       另一个要注意的点就是知道如何找到文件的历史版本。你可以在NAS的操作界面里点开“File Station”- 找到对应文件  - 右键 - “Synology 管理控制台” - “浏览以前的版本” 的方式找到历史版本，在历史版本里找回最原始的实验数据。这样就不怕实验电脑上的数据被修改或者覆盖了。</p><figure class="image ss-img-wrapper image_resized" style="width:426px;"><img src="https://cdn.sspai.com/2021/07/01/3d23fbc9abf1ebe2bf04a934772e5315.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/07/01/3d23fbc9abf1ebe2bf04a934772e5315.png" referrerpolicy="no-referrer"><figcaption>图3. 寻找文件历史版本</figcaption></figure><h3>    从 NAS 到个人电脑的单向同步：</h3><p>      从 NAS 到个人电脑的同步就更加简单了，只需要利用的 Drive 的“同步”功能就可以了。我在我的个人电脑上安装了 Synology Drive Client，然后选择同步。在同步的窗口选择 NAS 里面我的实验文件夹，并在同步模式里勾选“单向同步”，就可以保证在自己电脑上对数据进行处理也不会影响到 NAS 里的文件。</p><figure class="image ss-img-wrapper image_resized" style="width:335px;"><img src="https://cdn.sspai.com/2021/07/01/293b33218bbde4d337803e3ce640c56d.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/07/01/293b33218bbde4d337803e3ce640c56d.png" referrerpolicy="no-referrer"><figcaption>图4. 在同步窗口里选择文件夹并设置单向同步</figcaption></figure><h2>总结：</h2><p>       以上就是整个模型的思路，应对场景和实际操作步骤了。它确实可以在最粗略的程度上满足备份数据要求。针对某些有意或者无意的破坏，比如说：</p><ol><li>在实验室电脑上误删或者覆盖了保存有原始数据的文件。</li><li>在个人电脑上修改原始数据文件。</li><li>直接进入 NAS 的操作界面修改数据。</li></ol><p>       这种比较低水平的破坏，它是能保护好原始数据的。并且，它能记录下“有人曾经修改过相关数据”的信息。</p><p>       但是，整个系统还是比较粗糙的。显而易见有好几种没有办法防范的作假手段，比如说：</p><ol><li>直接把一整份伪造的数据导入到实验电脑里，以“没有被修改过”的面貌进入 NAS里。</li><li>在修改数据同步到 NAS 里之后，进入 NAS 操作系统中手动删除旧版本，以达到没有修改过的假象。</li></ol><p>       针对性的升级措施也十分有限，我能想到的大致就是给实验室的每个同学分配一个账号，并给予每个账号非常有限的权限。但是这样后续维护十分费心费力，也会给下一个管理者平白地增加负担。我更愿意把这个系统设置成粗心大意下原始数据丢失的一种保护手段，而不是把防范做到极致的监视器。</p><p>       感谢你把这篇文章看完，希望这篇文章可以给你思路上的启发和帮助。</p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>7</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>3</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-5242" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E5%88%A9%E7%94%A8%20NAS%20%E5%AF%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%AD%98%E5%82%A8%E7%9A%84%E4%B8%80%E6%AC%A1%E5%B0%9D%E8%AF%95%E3%80%91%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%EF%BC%9A%E5%9C%A8%E5%AD%A6%E6%9C%AF%E4%B8%8A%EF%BC%8C%E9%81%87%E5%88%B0%E8%B4%A8%E7%96%91%E6%97%B6%E6%9C%80%E6%9C%89%E5%8A%9B%E7%9A%84%E5%9B%9E%E5%87%BB%E6%96%B9%E5%BC%8F%E4%B9%8B%E4%B8%80%E5%B0%B1%E6%98%AF%E6%8F%90%E4%BE%9B%E5%8E%9F%E5%A7%8B%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E3%80%82%E9%81%97%E6%86%BE%E7%9A%84%E6%98%AF%EF%BC%8C%E5%B9%B6%E4%B8%8D%E6%98%AF%E6%89%80%E6%9C%89%E5%8E%9F%E5%A7%8B%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E9%83%BD%E8%83%BD%E8%A2%AB%E5%BE%88%E5%A5%BD%E5%9C%B0%E4%BF%9D%E5%AD%98%E3%80%82%E4%B8%80%E6%96%B9%E9%9D%A2%EF%BC%8C%E5%8F%A4%E8%80%81%E6%96%87%E7%AB%A0%E7%9A%84%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-2806" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><span class="el-popover__reference-wrapper"><i class="icon icon-article_weixin right-16"></i></span></span><a href="https://twitter.com/share?text=%E3%80%90%E5%88%A9%E7%94%A8%20NAS%20%E5%AF%B9%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%95%B0%E6%8D%AE%E8%BF%9B%E8%A1%8C%E5%AD%98%E5%82%A8%E7%9A%84%E4%B8%80%E6%AC%A1%E5%B0%9D%E8%AF%95%E3%80%91%E8%83%8C%E6%99%AF%E4%BB%8B%E7%BB%8D%EF%BC%9A%E5%9C%A8%E5%AD%A6%E6%9C%AF%E4%B8%8A%EF%BC%8C%E9%81%87%E5%88%B0%E8%B4%A8%E7%96%91%E6%97%B6%E6%9C%80%E6%9C%89%E5%8A%9B%E7%9A%84%E5%9B%9E%E5%87%BB%E6%96%B9%E5%BC%8F%E4%B9%8B%E4%B8%80%E5%B0%B1%E6%98%AF%E6%8F%90%E4%BE%9B%E5%8E%9F%E5%A7%8B%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E3%80%82%E9%81%97%E6%86%BE%E7%9A%84%E6%98%AF%EF%BC%8C%E5%B9%B6%E4%B8%8D%E6%98%AF%E6%89%80%E6%9C%89%E5%8E%9F%E5%A7%8B%E5%AE%9E%E9%AA%8C%E6%95%B0%E6%8D%AE%E9%83%BD%E8%83%BD%E8%A2%AB%E5%BE%88%E5%A5%BD%E5%9C%B0%E4%BF%9D%E5%AD%98%E3%80%82%E4%B8%80%E6%96%B9%E9%9D%A2%EF%BC%8C%E5%8F%A4%E8%80%81%E6%96%87%E7%AB%A0%E7%9A%84%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><span class="el-popover__reference-wrapper"><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            