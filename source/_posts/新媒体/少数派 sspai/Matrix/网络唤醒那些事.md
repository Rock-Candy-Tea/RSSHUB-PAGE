
---
title: '网络唤醒那些事'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/06/07/d9e2c54e1f17876de68c0e0981f36ac9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Wed, 09 Jun 2021 04:57:37 GMT
thumbnail: 'https://cdn.sspai.com/2021/06/07/d9e2c54e1f17876de68c0e0981f36ac9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><p><a href="https://www.wikiwand.com/en/Wake-on-LAN">Wake-on-LAN</a> 也叫 WoL，指允许通过网络消息打开或唤醒计算机。</p><p>网络唤醒功能在打造远程办公环境下显得十分必要，比如位于家中或公司的计算机，出于经济和环保的目的，不使用时一般也会进入低功耗状态，比如睡眠/休眠甚至是关机。而一旦进入低功耗状态，就意味着需要适当的外部刺激才能让其重新恢复至工作模式。</p><p>这时借助 WoL 通过特定网络信号进行 「唤醒」便是一个不错的选择。</p><p>一般情况下，WoL 需要由另一台「同局域网」设备发送网络信号，任意有能力发送 WoL 信号 的设备都可以充当此角色；在远程办公场景中，最好由「带有线网卡的低功耗设备」来执行，包括但不限于以下选项</p><ul><li>带网络唤醒 WoL 功能的路由器产品</li><li>OpenWrt Linux 设备「TP-Link 703n」</li><li>树莓派「推荐 2 代」</li></ul><h2>配置网络唤醒</h2><h3>系统设置</h3><p>在 Windows 10 中，<code>运行 > ncpa.cpl</code> 打开「网络连接」，然后找到当前在使用的有线网卡。</p><p>右键点击「属性」：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/07/d9e2c54e1f17876de68c0e0981f36ac9.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/07/d9e2c54e1f17876de68c0e0981f36ac9.png" referrerpolicy="no-referrer"></figure><p>然后选择「配置」：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/07/5287d7cad5d79f2000b160c2f792fb0e.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/07/5287d7cad5d79f2000b160c2f792fb0e.png" referrerpolicy="no-referrer"></figure><p>找到「电源管理」，这里我们就能勾选「允许此设备唤醒计算机」以及「只允许幻数据包唤醒计算机」了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/07/36fdfc0d7ac28c28be8879c87325fb0c.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/07/36fdfc0d7ac28c28be8879c87325fb0c.png" referrerpolicy="no-referrer"></figure><h3>BIOS</h3><p>除此之外，我们可能还必须启用适当的 BIOS 设置才能使用 WoL 功能。具体方法视厂商而定，注意 BIOS 选项附加的说明，可以参考的关键词包括：</p><ul><li>Automatic Power On</li><li>Wake on LAN/WLAN</li><li>Power Management</li><li>Power On by Onboard LAN</li><li>Power On by PCI-E Devices</li></ul><p>等等。</p><h2>使用 Fing 进行测试</h2><p>启用完成后，我们可以通过 Fing 这款图形化软件来测试唤醒已经配置好 WoL 的主机。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/1c53e12c50e343c461734001a2b54c5c.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/1c53e12c50e343c461734001a2b54c5c.png" referrerpolicy="no-referrer"></figure><p>安装应用后启动，打开并扫描当前网络，然后在设备列表中找到需要唤醒的机器：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/d133e87cfec168f0e47d9f50ce54ff43.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/d133e87cfec168f0e47d9f50ce54ff43.png" referrerpolicy="no-referrer"></figure><p>在目标设备关机或休眠时，通过 Fing 的设备详细信息面板点击「LAN 唤醒」，此时 Fing 已自动填充需要的信息。此处主要起作用的参数是「MAC 地址」：</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/d46ca2dcc3dd13d0967e1e76d1a1e46c.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/d46ca2dcc3dd13d0967e1e76d1a1e46c.png" referrerpolicy="no-referrer"></figure><p>如果目标主机被成功唤醒则一切顺利，如果遇到问题，则需要重新检查系统设置和 BIOS 设置。</p><p>接下来我们就可以在内网布设网络设备，结合「定时任务」每天上班前自动唤醒位于家里或公司的电脑，即到即用。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/4cfaa7c9f65e39337d9a279dae681cf4.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/4cfaa7c9f65e39337d9a279dae681cf4.png" referrerpolicy="no-referrer"></figure><h2>常见问题</h2><h3>准确获取物理网卡地址</h3><h4>查看网络参数</h4><p>网络连接「ncpa.cpl」</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/11/5b09f21db31db9e65c5b8ab2513c8907.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/11/5b09f21db31db9e65c5b8ab2513c8907.png" referrerpolicy="no-referrer"></figure><h4>网络扫描工具</h4><ul><li>Windows - <a href="https://www.softperfect.com/products/networkscanner/" target="_blank">Softperfect Network Scanner</a></li><li>Linux - <a href="https://linux.die.net/man/1/arp-scan" target="_blank">arp-scan</a></li><li>Android / iOS - <a href="https://www.fing.com/" target="_blank">Fing</a> / <a href="https://play.google.com/store/apps/details?id=ua.com.streamsoft.pingtools" target="_blank">PingTools</a></li></ul><h3>只允许幻数据包唤醒计算机</h3><p>此处稍作区分，如果未勾选「只允许幻数据包唤醒计算机」，情况要简单得多，只要有任意网络信号请求与该物理网卡通信，都会触发唤醒操作。适用于网络中机器不多，服务简单的场景。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/07/bae8cf93daa33308276ab57d381fce47.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/07/bae8cf93daa33308276ab57d381fce47.png" referrerpolicy="no-referrer"></figure><p>但如果仅允许幻数据包（Magic Packet）才能唤醒，则需要借助唤醒工具；这样做的好处是可以防止误触发。</p><p>可以使用的幻数据包唤醒工具有：</p><figure class="table"><table><tbody><tr><td>平台</td><td>工具</td><td>特点</td></tr><tr><td>Windows</td><td><a href="https://www.gammadyne.com/cmdline.htm#wol">wol.exe</a></td><td>免安装，命令行，跨网段</td></tr><tr><td>Linux</td><td><a href="https://linux.die.net/man/8/ether-wake">etherwake</a></td><td>命令行，同网段</td></tr><tr><td>Android / iOS</td><td><a href="https://www.fing.com/" target="_blank">Fing</a> / <a href="https://play.google.com/store/apps/details?id=ua.com.streamsoft.pingtools" target="_blank">PingTools</a></td><td>可扫描</td></tr></tbody></table></figure><p>请注意，WoL 属于无状态协议，仅发送、不确认。</p><h3>网络开机</h3><p>除了唤醒，我们也可以使用网络信号来将已经关机的设备唤醒，方法和工具与网络唤醒原理一样，但需要主板和 BIOS 支持，一般多见于台式机。</p><p>因网络开机需要主板上的网卡始终保持供电状态，开启此功能将产生「更多电费」，因此大多数笔记本出于续航考虑也不支持「通过网络开机」。</p><h3>无线网卡「WLAN」唤醒</h3><p>目前已知在 <a href="https://www.cnblogs.com/waw/p/13977062.html">Dell XPS某些型号</a> 可以，是否支持还是通过 BIOS 进行验证，另出于稳定性考虑，这恐怕不是主流唤醒方式「插网线」。</p><h3>跨网段</h3><p>WoL 协议本身不支持跨网段；在网络可达的前提下，可以通过端口转发、代理等方式间接使用；另出于安全和稳定服务的考虑，不推荐此场景下使用。</p><p>也欢迎读者就此部分写下自己的想法或疑惑，如果条件合适，我们可以在另外的篇幅进行讨论。</p><h4>附</h4><p><a href="https://docs.microsoft.com/zh-cn/windows/win32/power/system-power-states?redirectedfrom=MSDN#wake-on-lan_behavior">ACPI系统电源状态</a> S0-S5</p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>8</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>1</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-4122" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E9%82%A3%E4%BA%9B%E4%BA%8B%E3%80%91Wake-on-LAN%E3%80%8CWoL%E3%80%8D%E5%85%81%E8%AE%B8%E9%80%9A%E8%BF%87%E7%BD%91%E7%BB%9C%E6%B6%88%E6%81%AF%E6%89%93%E5%BC%80%2F%E5%94%A4%E9%86%92%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E4%BB%8E%E6%9D%A5%E4%B8%8D%E6%98%AF%E4%B8%80%E4%B8%AA%E6%96%B0%E4%BA%8B%E7%89%A9%EF%BC%8C%E5%8F%AA%E6%98%AF%E6%88%91%E4%BB%AC%E4%B8%8D%E7%9F%A5%E9%81%93%E6%88%96%E8%80%85%E6%9C%AA%E6%9B%BE%E5%AF%B9%E5%85%B6%E6%9C%89%E8%B6%B3%E5%A4%9F%E7%9A%84%E6%B3%A8%E6%84%8F%E3%80%82%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F06%2F08%2F93d9cf5205cfddaa17d39495f20dec76.png%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-7496" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><i class="icon icon-article_weixin right-16"></i></span><a href="https://twitter.com/share?text=%E3%80%90%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E9%82%A3%E4%BA%9B%E4%BA%8B%E3%80%91Wake-on-LAN%E3%80%8CWoL%E3%80%8D%E5%85%81%E8%AE%B8%E9%80%9A%E8%BF%87%E7%BD%91%E7%BB%9C%E6%B6%88%E6%81%AF%E6%89%93%E5%BC%80%2F%E5%94%A4%E9%86%92%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%E4%BB%8E%E6%9D%A5%E4%B8%8D%E6%98%AF%E4%B8%80%E4%B8%AA%E6%96%B0%E4%BA%8B%E7%89%A9%EF%BC%8C%E5%8F%AA%E6%98%AF%E6%88%91%E4%BB%AC%E4%B8%8D%E7%9F%A5%E9%81%93%E6%88%96%E8%80%85%E6%9C%AA%E6%9B%BE%E5%AF%B9%E5%85%B6%E6%9C%89%E8%B6%B3%E5%A4%9F%E7%9A%84%E6%B3%A8%E6%84%8F%E3%80%82%E7%BD%91%E7%BB%9C%E5%94%A4%E9%86%92%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            