
---
title: '「说人话」的复式记账语言：Beancount'
categories: 
 - 新媒体
 - 少数派 sspai
 - Matrix
headimg: 'https://cdn.sspai.com/2021/06/12/20fbedb35f45702f99be97833fd422e2.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
author: 少数派 sspai
comments: false
date: Sat, 12 Jun 2021 10:54:24 GMT
thumbnail: 'https://cdn.sspai.com/2021/06/12/20fbedb35f45702f99be97833fd422e2.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1'
---

<div>   
<div class="articleWidth-content" data-v-e1f0100a><div class="content wangEditor-txt minHeight" data-v-e1f0100a><p style="margin-left:0px;text-align:justify;">「记账」始终是个人记录当中一个热门的话题。由于自己从事金融行业的缘故，对于这个话题也是格外关注。从最初用 Excel 记录，到后来使用各种主流的记账软件，我也经历了几轮流程的迭代和数据的「乾坤大挪移」。特别是去年开始，国内开发者的各种记账 app 层出不穷，基本上每周都能看到新的程序出现。对于我这种喜欢尝试新玩意儿的人来说，颇有些选择困难。但记账毕竟和其他的一般需求不同，它有着它的特殊性。可能是我个人比较挑剔，在使用了多个记账软件之后，我始终没有找到百分百合我心意的。其中几个常见的痛点包括：</p><ul><li style="text-align:justify;"><strong>记账逻辑</strong>：软件难以在便利性和多功能之间维持一个微妙的平衡，况且每个软件的逻辑都有细微的不同。例如，通过点击还是滑动触发记账，记账界面是否包括许多不需要的栏位，报销是否计入支出，修改余额是否会记录一笔分录等。</li><li style="text-align:justify;"><strong>迁移成本和稳定性</strong>：这一点对于个人开发者尤为如此。目前各个程序之间的账务数据暂时还做不到完整迁移，一旦开发者暂停软件的支持，或者后台服务器停止运营，软件变成了离线模式，想转投其他软件也要大费周章</li></ul><p style="margin-left:0px;text-align:justify;">在零散地更换了几个记账软件之后，我决定静下心来，想想自己的需求，以及如何更好地、长期地实现。细想了一下自己在各个软件里的日常操作和背后的个人思维，我发现用的是哪款软件，我脑内其实是用了<strong>「复式记账」</strong>的会计思维。对于不同的软件，我利用的是他们的账户特性、交易分类等功能来实现自己的脑内分录。那与其用多步转化，为何不直接用「复式记账」来进行？于是我在网上遇到了 Beancount。</p><p style="margin-left:0px;text-align:justify;">说实话，第一次见到 Beancount 我内心是拒绝的。纯文本环境，还要用 python 命令，修改参数等等。即使我学过些编程的皮毛，但骨子里的文科生本质还是对这么硬核的记账方式有些抵触的：这如何下手？在犹豫了一周之后，我鼓起勇气用一晚上时间完成了学习和初始化，两天后就决定全面搬迁到 Beancount。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/20fbedb35f45702f99be97833fd422e2.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/20fbedb35f45702f99be97833fd422e2.png" referrerpolicy="no-referrer"></figure><p style="margin-left:0px;text-align:justify;"><strong>它并没有看上去的那么硬核</strong>。许多高级功能需要较为复杂的语法和命令，但掌握几条（甚至一条命令）在日常就能完成比软件更趁手的记账。您可以把这篇文章看作 Beancount 的入门懒人包，下文将展示 Beancount 与会计复式记账的异同、如何在半小时内入门，以及他为我解决了以前在 App 上没能解决的哪些日常功能。</p><h2 style="text-align:justify;"><strong>什么是 Beancount 的复式记账？</strong></h2><p style="margin-left:0px;text-align:justify;">正如我在<a href="https://sspai.com/post/59868" target="_blank">这篇文章</a>中介绍的那样，复式记账的要义在于，每一笔交易可以表示为两个或以上账户、借贷方向相反、数额相同的两笔记录。用两句话总结也就是：</p><blockquote><p style="margin-left:0px;"><strong>资产</strong>（所有我有的）= <strong>负债</strong>（问别人借的）+<strong>所有者权益</strong>（真的是我的）+（<strong>收入</strong>-<strong>支出</strong></p><p style="margin-left:0px;">有借必有贷，借贷必相等。</p></blockquote><p style="margin-left:0px;text-align:justify;">例如，中午吃饭 40 元就可以表示成：</p><pre class="language-null"><code>借：饮食-午餐  40
    贷：信用卡 40</code></pre><p style="margin-left:0px;text-align:justify;">Beancount 采用的基本也是这个思路，但是略有不同。可能是为了淡化会计当中最复杂的借贷关系和账户属性，Beancount 的记录将每笔交易表示为两个或以上账户，<strong>正负相反</strong>，<strong>和为零</strong>的记录。而且也不用表明借贷，不限顺序，比如：</p><pre class="language-null"><code>Expenses:Lunch  40.00 CNY
Liabilities:Card -40.00 CNY</code></pre><p style="margin-left:0px;text-align:justify;">只需用淳朴的感情记住各个种类的符号即可。</p><p style="margin-left:0px;text-align:justify;">对于学过会计的同学而言，由于这个记账方法基于会计恒等式，但是又用正负号取代了借贷方向，因此就会出现一个在初期困扰了我很久的问题：<strong>收入是负的</strong>。也就是说，分录表示中收入必须要用负数表示，在报表中如果看到一段时间内的收入是负的，并不代表着入不敷出，而是恰恰相反。</p><p style="margin-left:0px;text-align:justify;">通过下面的场景其实不难理解这个设置。如果我收入了 100 块钱，在 Beancount 中记录就会变成：</p><pre class="language-null"><code>Assets:Deposit 100.00 CNY</code></pre><p style="margin-left:0px;text-align:justify;">在第二行 Income 的栏位，由于要<strong>整体和为零</strong>，我们只能表示为：</p><pre class="language-null"><code>Income -100.00 CNY</code></pre><p style="margin-left:0px;text-align:justify;">在了解了基本知识之后，我们就可以迈出 Beancount 的第一步了。</p><h2 style="text-align:justify;"><strong>开始并呈现我的第一笔 Beancount 记账</strong></h2><p style="margin-left:0px;text-align:justify;">如果有像我一样的编程苦手，使用 Beancount 也并不麻烦。以 Mac 为例，调出 Terminal，输入以下代码安装 Beancount 主程序，以及后台可视化程序 Fava：（用以前老师的话说：不理解没关系，记住就好）</p><pre class="language-python"><code>sudo pip3 install beancount
sudo pip3 install fava</code></pre><p style="margin-left:0px;text-align:justify;">完成后我们就可以开始初始化了。由于这是文本记账，理论上来说任何文本编辑器都可以编写账本。然而，我强烈推荐安装微软的 VSCode，并且安装 Lencerf 编写的 Beancount 插件，可以让自己的生活方便许多。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/637217c55e08b104d784e0f47a4d7486.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/637217c55e08b104d784e0f47a4d7486.png" referrerpolicy="no-referrer"><figcaption>插件的自动完成功能省时省力</figcaption></figure><p style="margin-left:0px;text-align:justify;">之前我曾担心账户名称拼写错误导致代码报错，用了这个插件之后我发现我的担心都是多余的。该插件可以自动提示语法错误，对齐小数点，实时显示各个账户的余额。最重要的是，可以根据之前的账本提示账户名称和收款人名称。工具到位了之后就可以开始建立账本了。以 VSCode 为例，新建一个文件，并存储为 main.bean，内容如下：</p><pre class="language-null"><code>option "title" "MyBook" 
option "operating_currency" "CNY"</code></pre><p style="margin-left:0px;text-align:justify;">第一行用于设置账本的名字，而第二行用于设置账户的本位币。下一步就是要设立账户。在其他记账软件中，普遍都会根据开发者的默认设置给用户提供一套「常用账户」，但很多科目对我来说其实并不常用，反而需要繁琐地一个个修改名称、图标。对于 Beancount 而言，一切就是一张白纸，只需要通过一行代码开启账户即可。账户支持分组和多层分类，以冒号分割。例如：</p><pre class="language-null"><code>1990-01-01 open Assets:Cash:ICBC CNY
1990-01-01 open Liabilities:Card:BOCOM CNY, USD
1990-01-01 open Equity:OpenBalance CNY, HKD, USD
1990-01-01 open Income:Salary CNY
1990-01-01 open Expenses:Meal:Lunch CNY</code></pre><p style="margin-left:0px;text-align:justify;">这当中，除了最开始的账户分类（Assets, Liabilities, Equity, Income, Expenses）不可修改外，其他的均可按照个人实际需求进行设置。完成后，在终端通过 cd 命令进入到记账文件的文件夹，输入：</p><pre class="language-null"><code>fava main.bean</code></pre><p style="margin-left:0px;text-align:justify;">顺利的话，终端就会提示：Running Fava on http://localhost:5000</p><p style="margin-left:0px;text-align:justify;">此时打开浏览器登录这一网址，就能够看到一排账户已经虚位以待了。随后，继续回到 VSCode，就可以在插件的配合下开始第一笔记账——余额初始化。由于这笔分录的格式和日常记账并无区别，新手可以通过这一过程熟悉语法结构。常见的一笔分录至少分为三行，比如：</p><pre class="language-null"><code>2021-06-01 * "" ""
Assets:Cash:ICBC 378.32 CNY
Equity:OpenBalance</code></pre><ul><li style="text-align:justify;">第一行表示记账的日期，后面两个引号内分别表示商户/收款人名称，以及备注。如果没有的话建议还是留出这个位置。</li><li style="text-align:justify;">后面的两行或多行就是涉及的账户及金额。在初始化的过程中，我们一般借用 Equity 账户进行「空手套白狼」。</li></ul><p style="margin-left:0px;text-align:justify;">您可能也注意到了，最后一行并没有写数字。这正是 Beancount 语法中偷懒的方法之一：如果只空缺了一个金额，系统会自动计算差额，实现正负平衡。这不仅减少了我的工作量，更避免了账不平的情况。</p><p style="margin-left:0px;text-align:justify;">在对所有账户进行完初始化操作后，保存并刷新网页，界面上已经可以显示出当下的个人资金状况了。从今天起，Beancount 就可以正式用于记账了。</p><figure class="image ss-img-wrapper"><img src="https://cdn.sspai.com/2021/06/12/3e8962554372c04b776fc31c27b15759.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/3e8962554372c04b776fc31c27b15759.png" referrerpolicy="no-referrer"></figure><h2 style="text-align:justify;"><strong>用 Beancount 优化日常记账场景</strong></h2><p style="margin-left:0px;text-align:justify;">光从输入的层面上来说，Beancount 一定不是最简洁的。从界面上来说，它也一定不是最美观的。但它「硬核而原始」的记账方式，却轻松解决了我在其他软件上遇到的一些痛点。</p><h3 style="text-align:justify;"><strong>与同事午饭 AA</strong></h3><p style="margin-left:0px;text-align:justify;">工作日中午经常和同事一起吃饭。吃完饭之后的一项「重要金融工程」，便是结账以及转账——通常一个人负责结账，剩下的同事们 AA 制用支付宝或者微信进行转账。现实中简单的操作在记账过程中却犯了难——多笔交易、多个账户，还需要对金额进行加减乘除的运算。和身边记账的同事讨论之后，我发现了几个常用做法（以 4 个人午餐，我用信用卡支付了 200，每人给了我 50 为例）：</p><p style="margin-left:0px;text-align:justify;"><strong>第一种：</strong>记录支出 200，再记录收入 150。这样子的好处在于仅涉及到支出和收入两个交易类型，即使是最简单的记账软件也可以实现。但问题就是：这样的记录会导致支出和收入脱离实际。或许 200 元还体现不出，但如果这是个部门聚餐，10 个人一共花了 2000 元呢？其实我自己在饮食上只花费了 200，而收入的 1800 也只是我收回了我的应收账款。在分析的时候容易造成误差。</p><p style="margin-left:0px;text-align:justify;"><strong>第二种：</strong>记录支出 50，再记录一笔（或多笔）从信用卡到微信/支付宝等收款账户的转账。这样的做法消除了上一种记录方式中对分类收支的影响。但从流程上而言过于麻烦，如果涉及到多个收款账户，那就更为复杂了。我尝试了多款记账 app，均不能完美解决这一刚需。基本都需要在几个功能之间来回跳转，各个 app 的逻辑也各有不同。</p><p style="margin-left:0px;text-align:justify;">而在 Beancount 里边，此类复杂记账就变得很简单了。从结构上来说，与自己一个人吃饭并没有什么不同：</p><pre class="language-null"><code>2021-06-01 * "XYZ" ""
Liabilities:Card -200.00 CNY
Assets:Alipay 50.00 CNY
Assets:Wechat 100.00 CNY
Expenses:Meal:Lunch</code></pre><p style="margin-left:0px;text-align:justify;">在一笔记录中就可以一气呵成。如果无法理解语句的意义，不如将它一行行转化为故事：「6 月 1 日我在XYZ花了一笔钱：我用信用卡支付了 200 元；同事用支付宝给了我 50；用微信又给了我 100；剩下的就是我自己吃的，算作我的午饭开销。」是不是直观又简单？</p><h3 style="text-align:justify;"><strong>快捷记录这个月基金的收益</strong></h3><p style="text-align:justify;">记账的过程中另一个曾经困扰我的点在于我究竟需要统计多少细节：数据太少会影响到报告的质量，而数据太多则会占据我大量的时间和精力用以输入与更新。就拿基金举例，不少软件（例如 MoneyWiz）的投资账户功能非常强大，但是逻辑复杂，需要登记每个基金的成本，以及每天的净值。但对于我而言，这些已经超出了我的需求范围，更多的记账语句徒增烦恼尔。因为我主要做被动的长期投资，我并没有需要了解每个基金每天的走势情况，只需要在每个月月底做一个盘点，了解本月盈利或是亏损了多少，并反映在个人整体财务状况中即可。</p><figure class="image ss-img-wrapper image_resized" style="width:424px;"><img src="https://cdn.sspai.com/2021/06/12/8102055faccb7de66868831cf5986a99.png?imageView2/2/w/1120/q/40/interlace/1/ignore-error/1" data-original="https://cdn.sspai.com/2021/06/12/8102055faccb7de66868831cf5986a99.png" referrerpolicy="no-referrer"><figcaption>MoneyWiz 虽然强大，但性能过剩</figcaption></figure><p style="text-align:justify;">不少软件把基金收益和亏损分别放在“支出”和“收入”下的两个账户，也不支持负数输入，导致两个科目下都有数值，无法准确地显示基金总体的盈亏状况。在 Beancount 中，由于一切都是高度定制化的，我只需在收入项下建立一个基金收益的科目，其余额为负数即为收益，正数即为亏损。</p><p style="text-align:justify;">此外，之前使用过的不少软件中，更新月底的数据并不是一件容易的事情。如果我使用修改余额功能更新账户数据，这部分差额并不会计入损益表，而只是作为一个系统调整。</p><p style="text-align:justify;">使用 Beancount 后，运用 pad 和 balance 命令，我只需告诉系统月底的实际余额为多少，系统就会将差额计入规定的账户，并体现在损益表上。例如：</p><pre class="language-null"><code>2021-05-31 pad Assets:Investment Income:InvestmentGain
2021-06-01 balance Assets:Investment 33597.19 CNY</code></pre><p style="text-align:justify;">转化成自然语言也非常好理解：「5 月 31 日，投资账户的差额计入投资收益里面；6 月 1 日，投资账户实际有 33597.19 元，系统你操作一下吧。」短短两条命令，免除了我拿着手机在各个 app 之间切换的困扰，我也不再需要按着计算器计算差额。</p><h2 style="text-align:justify;">结语</h2><p style="text-align:justify;">其实 Beancount 的功能远远不止这些。多币种记账，通过脚本自动导入账单、更新基金净值等功能自然不在话下。甚至还有高手将它变成了事件记录簿和家里的库存管理软件。然而对于我来说，以上的功能足以满足我对于日常记账，以及记账软件的需求了。每天晚上回到家里，打开VSCode，我就可以像写日记一样，用几分钟时间完成当天的记账。</p><p style="text-align:justify;">正如文章一开始所说的，适合一个人的记账软件与方法可能对另一个人并不有效。只有适合自己的，才是最好的。</p></div><!----></div><div style="border:1px solid transparent;" data-v-e1f0100a></div><div class="article-side sideTop" style="display:none;left:0;" data-v-7be936cf data-v-e1f0100a><div class="download-guide-container" data-v-14f9065e data-v-7be936cf><div class="btn-wrapper" data-v-14f9065e><!----><button class="btn btn-view" data-v-14f9065e><i class="iconfont iconfont-phone" data-v-14f9065e></i></button></div><a href="https://sspai.com/s/JYjP" target="_blank" data-v-14f9065e><!----></a></div><div class="item-wrapper" data-v-7be936cf><button class="btn btn-charge" data-v-7be936cf><i class="iconfont" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>2</span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-comment" data-v-7be936cf><i class="iconfont iconfont-comment" data-v-7be936cf></i></button><span class="count" data-v-7be936cf>8</span></div><div class="item-wrapper" data-v-7be936cf><span data-v-7be936cf><div role="tooltip" id="el-popover-2809" aria-hidden="true" class="el-popover el-popper popper-share right ss-popper-dark-border" style="width:undefinedpx;display:none;"><!----><div class="article-side-share-btn"><a href="https://service.weibo.com/share/share.php?url=null?ref=weibo&title=%E3%80%90%E3%80%8C%E8%AF%B4%E4%BA%BA%E8%AF%9D%E3%80%8D%E7%9A%84%E5%A4%8D%E5%BC%8F%E8%AE%B0%E8%B4%A6%E8%AF%AD%E8%A8%80%EF%BC%9ABeancount%E3%80%91%E3%80%8C%E8%AE%B0%E8%B4%A6%E3%80%8D%E5%A7%8B%E7%BB%88%E6%98%AF%E4%B8%AA%E4%BA%BA%E8%AE%B0%E5%BD%95%E5%BD%93%E4%B8%AD%E4%B8%80%E4%B8%AA%E7%83%AD%E9%97%A8%E7%9A%84%E8%AF%9D%E9%A2%98%E3%80%82%E7%94%B1%E4%BA%8E%E8%87%AA%E5%B7%B1%E4%BB%8E%E4%BA%8B%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A%E7%9A%84%E7%BC%98%E6%95%85%EF%BC%8C%E5%AF%B9%E4%BA%8E%E8%BF%99%E4%B8%AA%E8%AF%9D%E9%A2%98%E4%B9%9F%E6%98%AF%E6%A0%BC%E5%A4%96%E5%85%B3%E6%B3%A8%E3%80%82%E4%BB%8E%E6%9C%80%E5%88%9D%E7%94%A8Excel%E8%AE%B0%E5%BD%95%EF%BC%8C%E5%88%B0%E5%90%8E%E6%9D%A5%E4%BD%BF%E7%94%A8%E5%90%84%E7%A7%8D%E4%B8%BB%E6%B5%81%E7%9A%84%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&pic=https%3A%2F%2Fcdn.sspai.com%2F2021%2F06%2F12%2F3c71646d55c0bd6147ff0e5d6d875eaa.jpeg%3FimageMogr2%2Fauto-orient%2Fquality%2F95%2Fthumbnail%2F!1420x708r%2Fgravity%2FCenter%2Fcrop%2F1420x708%2Finterlace%2F1&appkey=3196502474#" target="_blank"><i class="icon icon-article_weibo right-16"></i></a><span><div role="tooltip" id="el-popover-6584" aria-hidden="true" class="el-popover el-popper" style="width:undefinedpx;display:none;"><!----><div style="text-align:center;"><div id="qr-code"></div><small class="qr-small">扫码分享</small></div></div><i class="icon icon-article_weixin right-16"></i></span><a href="https://twitter.com/share?text=%E3%80%90%E3%80%8C%E8%AF%B4%E4%BA%BA%E8%AF%9D%E3%80%8D%E7%9A%84%E5%A4%8D%E5%BC%8F%E8%AE%B0%E8%B4%A6%E8%AF%AD%E8%A8%80%EF%BC%9ABeancount%E3%80%91%E3%80%8C%E8%AE%B0%E8%B4%A6%E3%80%8D%E5%A7%8B%E7%BB%88%E6%98%AF%E4%B8%AA%E4%BA%BA%E8%AE%B0%E5%BD%95%E5%BD%93%E4%B8%AD%E4%B8%80%E4%B8%AA%E7%83%AD%E9%97%A8%E7%9A%84%E8%AF%9D%E9%A2%98%E3%80%82%E7%94%B1%E4%BA%8E%E8%87%AA%E5%B7%B1%E4%BB%8E%E4%BA%8B%E9%87%91%E8%9E%8D%E8%A1%8C%E4%B8%9A%E7%9A%84%E7%BC%98%E6%95%85%EF%BC%8C%E5%AF%B9%E4%BA%8E%E8%BF%99%E4%B8%AA%E8%AF%9D%E9%A2%98%E4%B9%9F%E6%98%AF%E6%A0%BC%E5%A4%96%E5%85%B3%E6%B3%A8%E3%80%82%E4%BB%8E%E6%9C%80%E5%88%9D%E7%94%A8Excel%E8%AE%B0%E5%BD%95%EF%BC%8C%E5%88%B0%E5%90%8E%E6%9D%A5%E4%BD%BF%E7%94%A8%E5%90%84%E7%A7%8D%E4%B8%BB%E6%B5%81%E7%9A%84%EF%BC%88%E6%9D%A5%E8%87%AA%20%40%E5%B0%91%E6%95%B0%E6%B4%BEsspai%EF%BC%89%E5%85%A8%E6%96%87%EF%BC%9A&url=null" target="_blank" class="twitter"><i class="icon icon-article_twitter right-16"></i></a></div></div><button class="btn-mini btn-share" data-v-7be936cf><i class="iconfont iconfont-share" data-v-7be936cf></i></button></span></div><div class="item-wrapper" data-v-7be936cf><button class="btn-mini btn-collect" data-v-7be936cf><i class="iconfont iconfont-collect" data-v-7be936cf></i></button></div><!----></div><!---->  
</div>
            