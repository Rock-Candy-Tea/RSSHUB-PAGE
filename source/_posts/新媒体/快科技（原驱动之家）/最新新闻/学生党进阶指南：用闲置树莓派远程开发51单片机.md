
---
title: '学生党进阶指南：用闲置树莓派远程开发51单片机'
categories: 
 - 新媒体
 - 快科技（原驱动之家）
 - 最新新闻
headimg: 'https://img1.mydrivers.com/img/20211021/Sba17d7a8-6de2-44c2-8be9-e17dd83136f9.jpg'
author: 快科技（原驱动之家）
comments: false
date: Thu, 21 Oct 2021 16:11:41 GMT
thumbnail: 'https://img1.mydrivers.com/img/20211021/Sba17d7a8-6de2-44c2-8be9-e17dd83136f9.jpg'
---

<div>   
<p>51单片机因为指令系统、内部结构相对简单，被国内许多高校用来进行单片机的入门教学。在今年年初的疫情防控期间，就有一名应届毕业生<strong>使用闲置的树莓派进行远程开发51单片机</strong>，以此锻炼自己的敲代码能力。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20211021/ba17d7a8-6de2-44c2-8be9-e17dd83136f9.jpg" target="_blank"><img alt="学生党进阶指南：用闲置树莓派远程开发51单片机" h="277" src="https://img1.mydrivers.com/img/20211021/Sba17d7a8-6de2-44c2-8be9-e17dd83136f9.jpg" style="border:black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>远程连接上，因为<strong>没有公网IP</strong>，该同学<strong>使用花生壳内网穿透实现了远程开发</strong>。值得一提的是，花生壳目前向学生群体<strong>免费开放了旗下“青春版”服务</strong>，学生可以用来更好地进行远程学习、开发调试等。</p>
<p>下面是该同学使用树莓派搭配花生壳，实现远程开发51单片机的具体步骤分享：</p>
<p><strong>项目原件清单</strong></p>
<p>1.用来远程连接的树莓派3B（已经吃灰很久了….）</p>
<p>2.执行程序的51开发板；</p>
<p>3.显示图像的摄像头（翻出了一个10年前的老USB摄像头…）</p>
<p>4.内网穿透工具花生壳；</p>
<p>5.一些继电器（是不是猜不到这个是干嘛的，先保密）</p>
<p><strong>项目流程</strong></p>
<p>虽然树莓派可以通过vnc进行远程桌面，但喜欢折腾的我怎么能甘心必须安装客户端呢？这绝对不行！！！所以我选择了带有html5解析vnc协议的novnc，远程部分ok。</p>
<p>51单片机的编译软件我选择的是sdcc进行编译，编译后会出现hex文件，但对于很多朋友来说这还不够，hex格式的文件还是很大，我们要用bin！！！大家可以使用Hex2bin来进行转换，okok现在就剩下串口下载了，我们来解决远程下载，这里我选择的是开源的stcgal进行烧写。</p>
<p>最后我们再来看看远程摄像头，远程摄像头的方案就有很多了，这里我选择的是motion。分析完了就让我们撸起袖子加油干吧！</p>
<p><strong>1. 烧录完成系统后，老规矩来给树莓派更换国内源；</strong></p>
<p>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</p>
<p>sudo cp /etc/apt/sources.list.d/raspi.list /etc/apt/sources.list.d/raspi.list.bak</p>
<p>修改软件更新源，执行如下命令：</p>
<p>sudo vi /etc/apt/sources.list</p>
<p>按i进入编辑模式，改成清华的软件源地址，按ESC退出，然后 :x 回车保存退出。</p>
<p>deb http://mirror.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi</p>
<p>deb-src http://mirror.tuna.tsinghua.edu.cn/raspbian/raspbian/ buster main contrib non-free rpi</p>
<p>修改系统更新源，执行如下命令：</p>
<p>sudo vi /etc/apt/sources.list.d/raspi.list</p>
<p>将原镜像用#号注释掉，然后插入清华的系统源地址，保存退出：</p>
<p>deb http://mirror.tuna.tsinghua.edu.cn/raspberrypi/ buster main ui</p>
<p>同步更新源及更新软件包，执行如下命令：</p>
<p>sudo apt-get update</p>
<p>sudo apt-get upgrade</p>
<p><strong>2. 更换完成源以后，开启树莓派自带的开启VNC</strong></p>
<p>在终端输入以下命令进入配置界面。</p>
<p>sudo raspi-config</p>
<p>依次操作：Interfacing Options -> VNC -> Yes。之后系统会提示你是否要安装 VNC 服务，输入 y 之后回车，等待系统自动下载安装完成，如果祖师爷还是爱我们的话应该已经开启成功了。</p>
<p>稳妥起见我们还是来查看本地是否安装了vncserver（其实就是看看上面祖师爷有没有显灵）</p>
<p>whereis vncserver</p>
<p>如果没有请手动安装</p>
<p>yum install -y tigervnc-server</p>
<p>如果按照成功了就看这里哦</p>
<p>使用下面的命令来运行vnc</p>
<p>vncserver</p>
<p>此时会要求输入密码。这里需要注意：</p>
<p>The VNC server will run in the background. The port that it runs on is the display number + 5900 (i.e. 5901 in the case above).</p>
<p>意思就是当你执行vncserver :1设置为1时，下面要运行VNC是的端口号应该是5900+1，那就是5901，VNC的默认端口是5900。</p>
<p><strong>3. 安装noVNC</strong></p>
<p>#安装git</p>
<p>sudo apt-get install git</p>
<p>#获取novnc的源码</p>
<p>git clone https://github.com/kanaka/noVNC</p>
<p>进入novnc的目录</p>
<p>cd noVNC</p>
<p>运行novnc（第一次运行的时候会下载一个端口转发的程序可能需要一些时间）</p>
<p>./utils/launch.sh --vnc localhost:5901</p>
<p><strong>4. 安装51开发环境</strong></p>
<p>这里的开发环境依赖python3，需要确保已安装python3， pip3.</p>
<p>如果没有下载pip3请下载安装</p>
<p>安装sdcc</p>
<p>sudo apt-get install sdcc</p>
<p>编译程序例子：</p>
<p>sdcc 1.c</p>
<p>安装hex2bin（如果是不是专业开发者感觉可以不安装）</p>
<p>百度网盘分享地址：https://pan.baidu.com/s/1iky8HsB-nVn1p5J3EzB8NQ</p>
<p>提取码：tg3v</p>
<p>安装pyserial</p>
<p>sudo pip3 install pyserial</p>
<p>安装stcgal</p>
<p>pip3 install stcgal</p>
<p>测试</p>
<p>stcgal -h</p>
<p>#下载程序样例（建议完成安装ch340后在进行下载测试）</p>
<p>stcgal 1.ihx</p>
<p><strong>5. 树莓派安装CH340驱动</strong></p>
<p>驱动下载官方网址（linux版本）</p>
<p>http://www.wch.cn/download/CH341SER_LINUX_ZIP.html</p>
<p>cd 进入文件夹</p>
<p>安装依赖环境</p>
<p>sudo apt-get install linux-headers</p>
<p>修改make文件</p>
<p>打开ch34x.c源码，添加#include <linux/sched/signal.h>，并注释掉waitqueuet wait</p>
<p>编译并加载驱动</p>
<p>make</p>
<p>make load</p>
<p><strong>6. 安装usb摄像头监控界面</strong></p>
<p>sudo apt-get install motion</p>
<p>然后打开 motion daemon 守护进程，让他可以一直在后台运行：</p>
<p>sudo nano /etc/default/motion</p>
<p>＃no修改成yes:</p>
<p>start_motion_daemon=yes</p>
<p>修改motion的配置文件：</p>
<p>sudo vim /etc/motion/motion.conf</p>
<p>#deamon off 改成 on</p>
<p>deamon on</p>
<p>#设置分辨率</p>
<p>width 800</p>
<p>height 600</p>
<p>#关闭 localhost 的限制</p>
<p>webcam_localhost off</p>
<p>然后运行 motion：</p>
<p>sudo motion</p>
<p>现在我们的摄像头已经变成了一台网络摄像头。在chrome浏览器下访问 http://[your.domain]:8081 即可看到摄像头当前拍摄的画面。</p>
<p><strong>7. 简单修改noVNC界面</strong></p>
<p>在noVNC源码的app目录下面添加camera文件夹</p>
<p>这里是jq的一个小插件实现了一个可以拖动的小框框</p>
<p>链接：https://pan.baidu.com/s/1VZSh14pUXK36NcxrYTM1-A</p>
<p>提取码：swk9</p>
<p>最后修改vnc.html文件让我们把摄像头和远程界面合二为一</p>
<p><!DOCTYPE html></p>
<p><html lang="en" class="noVNC_loading"></p>
<p><head></p>
<p><!--</p>
<p>noVNC example: simple example using default UI</p>
<p>Copyright (C) 2019 The noVNC Authors</p>
<p>noVNC is licensed under the MPL 2.0 (see LICENSE.txt)</p>
<p>This file is licensed under the 2-Clause BSD license (see LICENSE.txt).</p>
<p>Connect parameters are provided in query string:</p>
<p>http://example.com/?host=HOST&port=PORT&encrypt=1</p>
<p>or the fragment:</p>
<p>http://example.com/#host=HOST&port=PORT&encrypt=1</p>
<p>--></p>
<p><title>noVNC</title></p>
<p><meta charset="utf-8"></p>
<p><!-- Icons (see app/images/icons/Makefile for what the sizes are for) --></p>
<p><link rel="icon" sizes="16x16" type="image/png" href="app/images/icons/novnc-16x16.png"></p>
<p><link rel="icon" sizes="24x24" type="image/png" href="app/images/icons/novnc-24x24.png"></p>
<p><link rel="icon" sizes="32x32" type="image/png" href="app/images/icons/novnc-32x32.png"></p>
<p><link rel="icon" sizes="48x48" type="image/png" href="app/images/icons/novnc-48x48.png"></p>
<p><link rel="icon" sizes="60x60" type="image/png" href="app/images/icons/novnc-60x60.png"></p>
<p><link rel="icon" sizes="64x64" type="image/png" href="app/images/icons/novnc-64x64.png"></p>
<p><link rel="icon" sizes="72x72" type="image/png" href="app/images/icons/novnc-72x72.png"></p>
<p><link rel="icon" sizes="76x76" type="image/png" href="app/images/icons/novnc-76x76.png"></p>
<p><link rel="icon" sizes="96x96" type="image/png" href="app/images/icons/novnc-96x96.png"></p>
<p><link rel="icon" sizes="120x120" type="image/png" href="app/images/icons/novnc-120x120.png"></p>
<p><link rel="icon" sizes="144x144" type="image/png" href="app/images/icons/novnc-144x144.png"></p>
<p><link rel="icon" sizes="152x152" type="image/png" href="app/images/icons/novnc-152x152.png"></p>
<p><link rel="icon" sizes="192x192" type="image/png" href="app/images/icons/novnc-192x192.png"></p>
<p><!-- Firefox currently mishandles SVG, see #1419039</p>
<p><link rel="icon" sizes="any" type="image/svg+xml" href="app/images/icons/novnc-icon.svg"></p>
<p>--></p>
<p><!-- Repeated last so that legacy handling will pick this --></p>
<p><link rel="icon" sizes="16x16" type="image/png" href="app/images/icons/novnc-16x16.png"></p>
<p><!-- Apple iOS Safari settings --></p>
<p><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"></p>
<p><meta name="apple-mobile-web-app-capable" content="yes"></p>
<p><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"></p>
<p><!-- Home Screen Icons (favourites and bookmarks use the normal icons) --></p>
<p><link rel="apple-touch-icon" sizes="60x60" type="image/png" href="app/images/icons/novnc-60x60.png"></p>
<p><link rel="apple-touch-icon" sizes="76x76" type="image/png" href="app/images/icons/novnc-76x76.png"></p>
<p><link rel="apple-touch-icon" sizes="120x120" type="image/png" href="app/images/icons/novnc-120x120.png"></p>
<p><link rel="apple-touch-icon" sizes="152x152" type="image/png" href="app/images/icons/novnc-152x152.png"></p>
<p><!-- Stylesheets --></p>
<p><link rel="stylesheet" href="app/styles/base.css"></p>
<p><script src="app/error-handler.js"></script></p>
<p><script type="module" crossorigin="anonymous" src="app/ui.js"></script></p>
<p><link rel="stylesheet" type="text/css" href="app/camera/css/normalize.css" /></p>
<p><link href="app/camera/src/css/interactive.css" rel="stylesheet" /></p>
<p><style></p>
<p>html, body &#123;</p>
<p>width: 100%;</p>
<p>height: 100%;</p>
<p>background-color: gainsboro;</p>
<p>&#125;</p>
<p>.content &#123;</p>
<p>margin: 10px;</p>
<p>&#125;</p>
<p>#element &#123;</p>
<p>height: 280px;</p>
<p>width: 340px;</p>
<p>top: 240px;</p>
<p>left: 240px;</p>
<p>background-color: #82ABC0;</p>
<p>&#125;</p>
<p></style></p>
<p></head></p>
<p><body></p>
<p><!-- 摄像头显示框--></p>
<p><div id="element" name="Close false"></p>
<p><div class="content"></p>
<p><img style="-webkit-user-select: none;margin: auto;" src="http://192.168.3.208:8081/"></p>
<p></div></p>
<p></div></p>
<p><div id="noVNC_fallback_error" class="noVNC_center"></p>
<p><div></p>
<p><div>noVNC encountered an error:</div></p>
<p><br></p>
<p><div id="noVNC_fallback_errormsg"></div></p>
<p></div></p>
<p></div></p>
<p><!-- noVNC Control Bar --></p>
<p><div id="noVNC_control_bar_anchor" class="noVNC_vcenter"></p>
<p><div id="noVNC_control_bar"></p>
<p><div id="noVNC_control_bar_handle" title="Hide/Show the control bar"><div></div></div></p>
<p><div class="noVNC_scroll"></p>
<p><h1 class="noVNC_logo" translate="no"><span>no</span><br>VNC</h1></p>
<p><!-- Drag/Pan the viewport --></p>
<p><input type="image" alt="Drag" src="app/images/drag.svg"</p>
<p>id="noVNC_view_drag_button" class="noVNC_button noVNC_hidden"</p>
<p>title="Move/Drag Viewport"></p>
<p><!--noVNC Touch Device only buttons--></p>
<p><div id="noVNC_mobile_buttons"></p>
<p><input type="image" alt="Keyboard" src="app/images/keyboard.svg"</p>
<p>id="noVNC_keyboard_button" class="noVNC_button" title="Show Keyboard"></p>
<p></div></p>
<p><!-- Extra manual keys --></p>
<p><input type="image" alt="Extra keys" src="app/images/toggleextrakeys.svg"</p>
<p>id="noVNC_toggle_extra_keys_button" class="noVNC_button"</p>
<p>title="Show Extra Keys"></p>
<p><div class="noVNC_vcenter"></p>
<p><div id="noVNC_modifiers" class="noVNC_panel"></p>
<p><input type="image" alt="Ctrl" src="app/images/ctrl.svg"</p>
<p>id="noVNC_toggle_ctrl_button" class="noVNC_button"</p>
<p>title="Toggle Ctrl"></p>
<p><input type="image" alt="Alt" src="app/images/alt.svg"</p>
<p>id="noVNC_toggle_alt_button" class="noVNC_button"</p>
<p>title="Toggle Alt"></p>
<p><input type="image" alt="Windows" src="app/images/windows.svg"</p>
<p>id="noVNC_toggle_windows_button" class="noVNC_button"</p>
<p>title="Toggle Windows"></p>
<p><input type="image" alt="Tab" src="app/images/tab.svg"</p>
<p>id="noVNC_send_tab_button" class="noVNC_button"</p>
<p>title="Send Tab"></p>
<p><input type="image" alt="Esc" src="app/images/esc.svg"</p>
<p>id="noVNC_send_esc_button" class="noVNC_button"</p>
<p>title="Send Escape"></p>
<p><input type="image" alt="Ctrl+Alt+Del" src="app/images/ctrlaltdel.svg"</p>
<p>id="noVNC_send_ctrl_alt_del_button" class="noVNC_button"</p>
<p>title="Send Ctrl-Alt-Del"></p>
<p></div></p>
<p></div></p>
<p><!-- Shutdown/Reboot --></p>
<p><input type="image" alt="Shutdown/Reboot" src="app/images/power.svg"</p>
<p>id="noVNC_power_button" class="noVNC_button"</p>
<p>title="Shutdown/Reboot..."></p>
<p><div class="noVNC_vcenter"></p>
<p><div id="noVNC_power" class="noVNC_panel"></p>
<p><div class="noVNC_heading"></p>
<p><img alt="" src="app/images/power.svg"> Power</p>
<p></div></p>
<p><input type="button" id="noVNC_shutdown_button" value="Shutdown"></p>
<p><input type="button" id="noVNC_reboot_button" value="Reboot"></p>
<p><input type="button" id="noVNC_reset_button" value="Reset"></p>
<p></div></p>
<p></div></p>
<p><!-- Clipboard --></p>
<p><input type="image" alt="Clipboard" src="app/images/clipboard.svg"</p>
<p>id="noVNC_clipboard_button" class="noVNC_button"</p>
<p>title="Clipboard"></p>
<p><div class="noVNC_vcenter"></p>
<p><div id="noVNC_clipboard" class="noVNC_panel"></p>
<p><div class="noVNC_heading"></p>
<p><img alt="" src="app/images/clipboard.svg"> Clipboard</p>
<p></div></p>
<p><textarea id="noVNC_clipboard_text" rows=5></textarea></p>
<p><br></p>
<p><input id="noVNC_clipboard_clear_button" type="button"</p>
<p>value="Clear" class="noVNC_submit"></p>
<p></div></p>
<p></div></p>
<p><!-- Toggle fullscreen --></p>
<p><input type="image" alt="Fullscreen" src="app/images/fullscreen.svg"</p>
<p>id="noVNC_fullscreen_button" class="noVNC_button noVNC_hidden"</p>
<p>title="Fullscreen"></p>
<p><!-- Settings --></p>
<p><input type="image" alt="Settings" src="app/images/settings.svg"</p>
<p>id="noVNC_settings_button" class="noVNC_button"</p>
<p>title="Settings"></p>
<p><div class="noVNC_vcenter"></p>
<p><div id="noVNC_settings" class="noVNC_panel"></p>
<p><ul></p>
<p><li class="noVNC_heading"></p>
<p><img alt="" src="app/images/settings.svg"> Settings</p>
<p></li></p>
<p><li></p>
<p><label><input id="noVNC_setting_shared" type="checkbox"> Shared Mode</label></p>
<p></li></p>
<p><li></p>
<p><label><input id="noVNC_setting_view_only" type="checkbox"> View Only</label></p>
<p></li></p>
<p><li><hr></li></p>
<p><li></p>
<p><label><input id="noVNC_setting_view_clip" type="checkbox"> Clip to Window</label></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_resize">Scaling Mode:</label></p>
<p><select id="noVNC_setting_resize" name="vncResize"></p>
<p><option value="off">None</option></p>
<p><option value="scale">Local Scaling</option></p>
<p><option value="remote">Remote Resizing</option></p>
<p></select></p>
<p></li></p>
<p><li><hr></li></p>
<p><li></p>
<p><div class="noVNC_expander">Advanced</div></p>
<p><div><ul></p>
<p><li></p>
<p><label for="noVNC_setting_quality">Quality:</label></p>
<p><input id="noVNC_setting_quality" type="range" min="0" max="9" value="6"></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_compression">Compression level:</label></p>
<p><input id="noVNC_setting_compression" type="range" min="0" max="9" value="2"></p>
<p></li></p>
<p><li><hr></li></p>
<p><li></p>
<p><label for="noVNC_setting_repeaterID">Repeater ID:</label></p>
<p><input id="noVNC_setting_repeaterID" type="text" value=""></p>
<p></li></p>
<p><li></p>
<p><div class="noVNC_expander">WebSocket</div></p>
<p><div><ul></p>
<p><li></p>
<p><label><input id="noVNC_setting_encrypt" type="checkbox"> Encrypt</label></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_host">Host:</label></p>
<p><input id="noVNC_setting_host"></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_port">Port:</label></p>
<p><input id="noVNC_setting_port" type="number"></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_path">Path:</label></p>
<p><input id="noVNC_setting_path" type="text" value="websockify"></p>
<p></li></p>
<p></ul></div></p>
<p></li></p>
<p><li><hr></li></p>
<p><li></p>
<p><label><input id="noVNC_setting_reconnect" type="checkbox"> Automatic Reconnect</label></p>
<p></li></p>
<p><li></p>
<p><label for="noVNC_setting_reconnect_delay">Reconnect Delay (ms):</label></p>
<p><input id="noVNC_setting_reconnect_delay" type="number"></p>
<p></li></p>
<p><li><hr></li></p>
<p><li></p>
<p><label><input id="noVNC_setting_show_dot" type="checkbox"> Show Dot when No Cursor</label></p>
<p></li></p>
<p><li><hr></li></p>
<p><!-- Logging selection dropdown --></p>
<p><li></p>
<p><label>Logging:</p>
<p><select id="noVNC_setting_logging" name="vncLogging"></p>
<p></select></p>
<p></label></p>
<p></li></p>
<p></ul></div></p>
<p></li></p>
<p><li class="noVNC_version_separator"><hr></li></p>
<p><li class="noVNC_version_wrapper"></p>
<p><span>Version:</span></p>
<p><span class="noVNC_version"></span></p>
<p></li></p>
<p></ul></p>
<p></div></p>
<p></div></p>
<p><!-- Connection Controls --></p>
<p><input type="image" alt="Disconnect" src="app/images/disconnect.svg"</p>
<p>id="noVNC_disconnect_button" class="noVNC_button"</p>
<p>title="Disconnect"></p>
<p></div></p>
<p></div></p>
<p><div id="noVNC_control_bar_hint"></div></p>
<p></div> <!-- End of noVNC_control_bar --></p>
<p><!-- Status Dialog --></p>
<p><div id="noVNC_status"></div></p>
<p><!-- Connect button --></p>
<p><div class="noVNC_center"></p>
<p><div id="noVNC_connect_dlg"></p>
<p><div class="noVNC_logo" translate="no"><span>no</span>VNC</div></p>
<p><div id="noVNC_connect_button"><div></p>
<p><img alt="" src="app/images/connect.svg"> Connect</p>
<p></div></div></p>
<p></div></p>
<p></div></p>
<p><!-- Password Dialog --></p>
<p><div class="noVNC_center noVNC_connect_layer"></p>
<p><div id="noVNC_credentials_dlg" class="noVNC_panel"><form></p>
<p><ul></p>
<p><li id="noVNC_username_block"></p>
<p><label>Username:</label></p>
<p><input id="noVNC_username_input"></p>
<p></li></p>
<p><li id="noVNC_password_block"></p>
<p><label>Password:</label></p>
<p><input id="noVNC_password_input" type="password"></p>
<p></li></p>
<p><li></p>
<p><input id="noVNC_credentials_button" type="submit" value="Send Credentials" class="noVNC_submit"></p>
<p></li></p>
<p></ul></p>
<p></form></div></p>
<p></div></p>
<p><!-- Transition Screens --></p>
<p><div id="noVNC_transition"></p>
<p><div id="noVNC_transition_text"></div></p>
<p><div></p>
<p><input type="button" id="noVNC_cancel_reconnect_button" value="Cancel" class="noVNC_submit"></p>
<p></div></p>
<p><div class="noVNC_spinner"></div></p>
<p></div></p>
<p><!-- This is where the RFB elements will attach --></p>
<p><div id="noVNC_container"></p>
<p><!-- Note that Google Chrome on Android doesn't respect any of these,</p>
<p>html attributes which attempt to disable text suggestions on the</p>
<p>on-screen keyboard. Let's hope Chrome implements the ime-mode</p>
<p>style for example --></p>
<p><textarea id="noVNC_keyboardinput" autocapitalize="off"</p>
<p>autocomplete="off" spellcheck="false" tabindex="-1"></textarea></p>
<p></div></p>
<p><audio id="noVNC_bell"></p>
<p><source src="app/sounds/bell.oga" type="audio/ogg"></p>
<p><source src="app/sounds/bell.mp3" type="audio/mpeg"></p>
<p></audio></p>
<p><script src="app/camera/src/interactive.js"></script></p>
<p><script></p>
<p>let options = &#123;close: false &#125;;</p>
<p>interactive('element', options);</p>
<p></script></p>
<p></body></p>
<p></html></p>
<p><strong>8. 编写继电器控制脚本控制单片机上电</strong></p>
<p>首先我们选用树莓派上的一个引脚来控制继电器，而继电器来控制单片机的通电与断电。脚本代码如下，大家可以选择不同的引脚进行控制，不再做过多的赘述。</p>
<p># -*- coding: utf-8 -*-</p>
<p>import RPi.GPIO as GPIO</p>
<p>import time</p>
<p># BOARD编号方式，基于插座引脚编号</p>
<p>GPIO.setmode(GPIO.BOARD)</p>
<p># 输出模式</p>
<p>GPIO.setup(0, GPIO.OUT)</p>
<p>GPIO.output(0, GPIO.HIGH)</p>
<p>time.sleep(1)</p>
<p>GPIO.output(0, GPIO.LOW)</p>
<p>time.sleep(1)</p>
<p>这里运行这个代码以后我们会看到一个警告如下</p>
<p>RuntimeWarning: This channel is already in use, continuing anyway. Use GPIO.setwarnings(False) to disable warnings.</p>
<p>这个警告我们直接忽略就好~</p>
<p><strong>9. 花生壳内网穿透配置</strong></p>
<p>我们可以先到下面的URL中下载花生壳软件，我们这里使用的是树莓派当然要使用树莓派版本的软件了。</p>
<p>https://hsk.oray.com/download/</p>
<p>在下载软件的界面中我们有可以看到帮助选项，这里有很多我们可以参考的设置例子</p>
<p>安装第一步</p>
<p>sudo -s //切换到管理员权限</p>
<p>dpkg -i <安装包名称> //回车，等待安装完成。</p>
<p>我们可以使用下面的命令启动花生壳服务，更多命令可以到帮助网页中查看</p>
<p>phddns start //启动花生壳</p>
<p>phddns enable //设置花生壳开机自启</p>
<p>然后我们可以用过下面的网址远程设置花生壳</p>
<p>http://b.oray.com</p>
<p>首次登录，需先激活。提供扫码激活和密码激活两种方式</p>
<p>激活成功后，进入花生壳管理平台。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20211021/57685bdd-c407-468d-b879-d826dd1e1b06.png" target="_blank"><img alt="学生党进阶指南：用闲置树莓派远程开发51单片机" h="235" src="https://img1.mydrivers.com/img/20211021/S57685bdd-c407-468d-b879-d826dd1e1b06.png" style="border:black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>添加内网穿透映射时，点击页面上的“增加映射”按钮，根据页面提示填写映射所需的信息：</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20211021/6b698257-ccc3-4aab-bbc1-541efbd345ca.png" target="_blank"><img alt="学生党进阶指南：用闲置树莓派远程开发51单片机" h="262" src="https://img1.mydrivers.com/img/20211021/S6b698257-ccc3-4aab-bbc1-541efbd345ca.png" style="border:black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>1：自定义；2：选择HTTP（因为我们要映射的部分都是网页）；3：选择用作外网访问的域名，直接选择注册帐号时花生壳免费赠送的壳域名即可；4：选择动态端口；5：树莓派设备的内网IP地址；6：映射的服务类型对应端口；7：确认映射内容无误后，点击“确定”。</p>
<p>下面对摄像头和noVNC进行映射，映射添加完成将生成格式为<strong>域名+5位数端口号</strong>的外网访问地址：</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20211021/7328e50d-d35c-409f-a177-4d97eed201cc.jpg" target="_blank"><img alt="学生党进阶指南：用闲置树莓派远程开发51单片机" h="217" src="https://img1.mydrivers.com/img/20211021/S7328e50d-d35c-409f-a177-4d97eed201cc.jpg" style="border:black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>然后，在远程外网环境下，直接访问花生壳生成的域名地址就可以实现远程开发51单片机了。好了，本次分享到这里！感谢大家的耐心阅读。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20211021/842749e5-c987-481d-9fea-df7ee9f97507.png" target="_blank"><img alt="学生党进阶指南：用闲置树莓派远程开发51单片机" h="362" src="https://img1.mydrivers.com/img/20211021/S842749e5-c987-481d-9fea-df7ee9f97507.png" style="border:black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>值得强调的是，花生壳可以<strong>将自己的电脑迅速变成一台云服务器</strong>，运行基于http的<strong>web服务</strong>、基于socket的<strong>通讯项目</strong>等，如远程访问<strong>NAS</strong>、Web网站、数据库、Windows RDP远程桌面、<strong>游戏联机</strong>等，通过内网穿透实现没有公网IP时各种局域网服务的跨网段远程访问。有需要的童鞋，可以直接到花生壳官网“未来之星”页面“白嫖”花生壳“青春版”服务。</p>

           
           
<p class="end"> - THE END -</p> 
          <p class="zhuanzai">转载请注明出处：快科技</p>  
 <p class="bqian"><a href="https://news.mydrivers.com/tag/huashengke.htm"><i>#</i>花生壳</a></p>
<p class="url">
     
<span>责任编辑：文路</span>
</p>
        
</div>
            