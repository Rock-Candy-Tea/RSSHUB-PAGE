
---
title: '恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出'
categories: 
 - 新媒体
 - 快科技（原驱动之家）
 - 最新新闻
headimg: 'https://img1.mydrivers.com/img/20220117/83eb8cd5-9270-4c15-b6f5-a60bb0fa6ff9.png'
author: 快科技（原驱动之家）
comments: false
date: Mon, 17 Jan 2022 20:52:15 GMT
thumbnail: 'https://img1.mydrivers.com/img/20220117/83eb8cd5-9270-4c15-b6f5-a60bb0fa6ff9.png'
---

<div>   
<p>能同时攻击Windows、Mac、Linux三大操作系统的恶意软件出现了。</p>
<p>虽然“全平台通杀”病毒并不常见，但是安全公司Intezer的研究人员发现，有家教育公司在上个月中了招。</p>
<p>更可怕的是，他们通过分析域名和病毒库发现，这个恶意软件已经存在半年之久，只是直到最近才被检测到。</p>
<p>他们把这个恶意软件命名为SysJoker。</p>
<p>SysJoker核心部分是后缀名为“.ts”的TypeScript文件，一旦感染就能被远程控制，方便黑客进一步后续攻击，比如植入勒索病毒。</p>
<p>SysJoker用C++编写，每个变体都是为目标操作系统量身定制，之前在57个不同反病毒检测引擎上都未被检测到。</p>
<p style="text-align: center"><img alt="恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出" h="256" src="https://img1.mydrivers.com/img/20220117/83eb8cd5-9270-4c15-b6f5-a60bb0fa6ff9.png" style="border: black 1px solid" w="497" referrerpolicy="no-referrer"></p>
<p>那么SysJoker到底是如何通杀三大系统的？</p>
<p><strong>SysJoker的感染步骤</strong></p>
<p>SysJoker在三种操作系统中的行为类似，下面将以Windows为例展示SysJoker的行为。</p>
<p>首先，SysJoker会伪装成系统更新。</p>
<p>一旦用户将其误认为更新文件开始运行，它就会随机睡眠90到120秒，然后在C:\ProgramData\SystemData\目录下复制自己，并改名为igfxCUIService.exe，伪装成英特尔图形通用用户界面服务。</p>
<p>接下来，它使用Live off the Land（LOtL）命令收集有关机器的信息，包括MAC地址、用户名、物理媒体序列号和IP地址等。</p>
<p>SysJoker使用不同的临时文本文件来记录命令的结果。这些文本文件会立即删除，存储在JSON对象中，然后编码并写入名为microsoft_windows.dll的文件。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20220117/92dc7a31-c2c5-4fa6-aba6-563dbb0f5a9c.png" target="_blank"><img alt="恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出" h="107" src="https://img1.mydrivers.com/img/20220117/S92dc7a31-c2c5-4fa6-aba6-563dbb0f5a9c.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>此外，SysJoker收集之后软件向注册表添加键值HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run保证其持久存在。</p>
<p>在上述每个步骤之间，恶意软件都会随机睡眠，防止被检测到。</p>
<p>接下来，SysJoker将开始建立远程控制（C2）通信。</p>
<p>方式是通过下载从Google Drive托管的文本文件，来生成远程控制。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20220117/f7d4821e-242a-4eff-aca8-7a02c2f17cae.png" target="_blank"><img alt="恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出" h="500" src="https://img1.mydrivers.com/img/20220117/Sf7d4821e-242a-4eff-aca8-7a02c2f17cae.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>Google Drive链接指向一个名为“domain.txt”的文本文件，这是以编码形式保存的远程控制文件。</p>
<p>在Windows系统上，一旦感染完成，SysJoker就可以远程运行包括“exe”、“cmd”、“remove_reg”在内的可执行文件。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20220117/2ff3c2a1-acf5-4e34-919a-6f01d2f5c87e.png" target="_blank"><img alt="恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出" h="417" src="https://img1.mydrivers.com/img/20220117/S2ff3c2a1-acf5-4e34-919a-6f01d2f5c87e.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>而且研究人员在分析期间发现，以上服务器地址更改了三次，表明攻击者处于活动状态，并监控了受感染的机器。</p>
<p><strong>如何查杀SysJoker</strong></p>
<p>尽管SysJoker现在被杀毒软件检测出的概率很低，但发现它的Intezer公司还是提供了一些检测方法。</p>
<p>用户可以使用内存扫描工具检测内存中的SysJoker有效负载，或者使用检测内容在EDR或SIEM中搜索。具体操作方法可以参见Intezer网站。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20220117/a351c908-1b9c-404e-8fe8-f9df80474b63.png" target="_blank"><img alt="恶意软件攻陷三大操作系统：狡猾伪装 隐藏半年最近才被揪出" h="216" src="https://img1.mydrivers.com/img/20220117/Sa351c908-1b9c-404e-8fe8-f9df80474b63.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>已经感染的用户也不要害怕，Intezer也提供了手动杀死SysJoker的方法。</p>
<p>用户可以杀死与SysJoker相关的进程，删除相关的注册表键值和与SysJoker相关的所有文件。</p>
<p>Linux和Mac的感染路径不同，用户可以在Intezer查询到这些参数，分析自己的电脑是否被感染。</p>

           
           
<p class="end"> - THE END -</p> 
            
 <p class="bqian"><a href="https://news.mydrivers.com/tag/eyiruanjian.htm"><i>#</i>恶意软件</a></p>
<p class="url">
     <span>原文链接：<a href="https://mp.weixin.qq.com/s/-Zsm9tji7fJk6QmLsN-6uA">量子位</a></span>
<span>责任编辑：万南</span>
</p>
        
</div>
            