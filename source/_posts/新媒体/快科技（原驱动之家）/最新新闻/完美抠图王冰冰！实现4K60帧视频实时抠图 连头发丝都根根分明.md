
---
title: '完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明'
categories: 
 - 新媒体
 - 快科技（原驱动之家）
 - 最新新闻
headimg: 'https://img1.mydrivers.com/img/20210830/a835940319af48af90ecd02c3ab25b7d.gif'
author: 快科技（原驱动之家）
comments: false
date: Mon, 30 Aug 2021 14:48:31 GMT
thumbnail: 'https://img1.mydrivers.com/img/20210830/a835940319af48af90ecd02c3ab25b7d.gif'
---

<div>   
<p>看这一头蓬松的秀发，加上帅气的动作，你以为是在绿幕前拍大片？</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/a835940319af48af90ecd02c3ab25b7d.gif" style="border: 1px solid black; height: 225px; width: 400px;" w="640" referrerpolicy="no-referrer"></p>
<p>No、No、No</p>
<p>这其实是AI拿来视频实时抠图后的效果。</p>
<p>没想到吧，实时视频抠图，现在能精细到每一根发丝。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/41d24ab8954541a894403b8cff51815a.gif" style="border: 1px solid black; height: 225px; width: 400px;" w="640" referrerpolicy="no-referrer"></p>
<p>换到alpha通道再看一眼，不用多说，德芙打钱吧（手动狗头）。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/c5549def268048c5a2ec63ebaab507b6.gif" style="border: 1px solid black; height: 225px; width: 400px;" w="640" referrerpolicy="no-referrer"></p>
<p>这就是来自字节跳动实习生小哥的最新研究：实时高分辨率视频抠图大法。</p>
<p>无需任何辅助输入，把视频丢给这个名为RVM的AI，它分分钟就能帮你把人像高精度抠出，将背景替换成可以任意二次加工的绿幕。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/b70079bf8d5045acbf4ecf99b20f1c53.gif" style="border: 1px solid black; height: 225px; width: 400px;" w="640" referrerpolicy="no-referrer"></p>
<p>不信有这么丝滑？我们用线上Demo亲自尝试了一波。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="402" src="https://img1.mydrivers.com/img/20210830/1eb5719dd5a041f6b41c7d762120a7af.gif" style="border: 1px solid black; height: 224px; width: 600px;" w="1079" referrerpolicy="no-referrer"></p>
<p>相比之下，现在在线会议软件里的抠图，一旦头发遮住脸，人就会消失……</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="338" src="https://img1.mydrivers.com/img/20210830/e8156d776e9b44b5b2a5588b592fc76e.gif" style="border: 1px solid black; height: 317px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>头发丝更是明显糊了。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/72da973f-e13a-4b8d-a87d-2fb7b04e9f7d.jpg" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="222" src="https://img1.mydrivers.com/img/20210830/S72da973f-e13a-4b8d-a87d-2fb7b04e9f7d.jpg" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>难怪看得网友直言：</p>
<p>不敢想象你们把这只AI塞进手机里的样子。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/7b9a03dc-9d61-4a44-a496-4a17efb5b6fb.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="99" src="https://img1.mydrivers.com/img/20210830/S7b9a03dc-9d61-4a44-a496-4a17efb5b6fb.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>目前，这篇论文已经入选WACV 2022。</p>
<p><strong>你也可以上手一试</strong></p>
<p>目前，RVM已经在GitHub上开源，并给出了两种试玩途径：</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/d847e013-014c-404f-b8f6-0d3a6dbed3eb.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="130" src="https://img1.mydrivers.com/img/20210830/Sd847e013-014c-404f-b8f6-0d3a6dbed3eb.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>于是我们也赶紧上手试了试。</p>
<p>先来看看效果：</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="358" src="https://img1.mydrivers.com/img/20210830/cd24f34d075248c3a58d38f8da179c97.gif" style="border: 1px solid black; height: 336px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>首先来点难度低的。</p>
<p>对于这种人物在画面中基本不移动的情况，RVM可以说是表现的非常好，和人工抠图几乎无差别。</p>
<p>现在，王冰冰进入动森都毫不违和了。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/acec7ce8911a4f87a1bfbadd0d0150d9.gif" style="border: 1px solid black; height: 338px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>于是开脑洞，也变得简单了许多……</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="324" src="https://img1.mydrivers.com/img/20210830/8c8dd2e0b4b44808b3fb933af2a312dd.gif" style="border: black 1px solid;" w="570" referrerpolicy="no-referrer"></p>
<p>咳咳，言归正传。人物动作幅度加大会怎样呢？</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/ebfcf54010f64169813baa8c2cf36b0d.gif" style="border: 1px solid black; height: 338px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>对于多人舞蹈视频而言，RVM的表现也很nice。</p>
<p>即便动来动去、头发乱甩，也没有影响它的抠图效果。</p>
<p>只有在人物出现遮挡的情况下，才会出现瑕疵。</p>
<p>对比前辈方法MODNet，确实有不小的进步。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/fc20aacdf0a04f8b85358281684f6f92.gif" style="border: 1px solid black; height: 338px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>不过我们也发现，如果视频的背景较暗，就会影响RVM的发挥。</p>
<p>比如在这种背景光线昏暗的情况下，抠图的效果就非常不尽人意了。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/aae2701c-b516-4e3d-9824-7805f5c14d56.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="271" src="https://img1.mydrivers.com/img/20210830/Saae2701c-b516-4e3d-9824-7805f5c14d56.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>可以看到，博主老哥的头发完全糊了。</p>
<p>而且身体的边界线也不够清晰。</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="314" src="https://img1.mydrivers.com/img/20210830/a2269992716441fca47d465f2f0de9b5.gif" style="border: 1px solid black; height: 294px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>所以，如果你想自己拍视频试玩，就一定要选择光线充足的场景。</p>
<p><strong>利用时间信息</strong></p>
<p>那么这样的“魔法”，具体又是如何实现的？</p>
<p>照例，我们先来扒一扒论文~</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/c893a46b-5595-4da3-bbad-e23cb74e5599.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="169" src="https://img1.mydrivers.com/img/20210830/Sc893a46b-5595-4da3-bbad-e23cb74e5599.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>实际上，有关视频抠图的算法如今已不鲜见，其中大多数采用的是将视频中的每一帧作为独立图像来实现抠图的方法。</p>
<p>不同与此，在这篇论文中，研究人员构建了一个循环架构，利用上了视频的时间信息，在时间一致性和抠图质量上取得了明显改进。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/ff884774-0f08-4755-b524-e967362cf18a.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="222" src="https://img1.mydrivers.com/img/20210830/Sff884774-0f08-4755-b524-e967362cf18a.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>从上图中可以看出，RVM的网络架构包括3个部分：</p>
<p>特征提取编码器，用来提取单帧特征；</p>
<p>循环解码器，用于汇总时间信息；</p>
<p>深度引导滤波（DGF）模块，用于高分辨率上采样。</p>
<p>其中，循环机制的引入使得AI能够在连续的视频流中自我学习，从而了解到哪些信息需要保留，哪些信息可以遗忘掉。</p>
<p>具体而言，循环解码器采用了多尺度ConvGRU来聚合时间信息。其定义如下：</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/0407d074-2293-4c8b-8ca8-7573d2a95ad2.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="168" src="https://img1.mydrivers.com/img/20210830/S0407d074-2293-4c8b-8ca8-7573d2a95ad2.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>在这个编码器-解码器网络中，AI会完成对高分辨率视频的下采样，然后再使用DGF对结果进行上采样。</p>
<p>除此之外，研究人员还提出了一种新的训练策略：同时使用抠图和语义分割目标数据集来训练网络。</p>
<p>这样做到好处在于：</p>
<p>首先，人像抠图与人像分割任务密切相关，AI必须学会从语义上理解场景，才能在定位人物主体方面具备鲁棒性。</p>
<p>其次，现有的大部分抠图数据集只提供真实的alpha通道和前景信息，所以必须对背景图像进行合成。但前景和背景的光照往往不同，这就影响了合成的效果。语义分割数据集的引入可以有效防止过拟合。</p>
<p>最后，语义分割数据集拥有更为丰富的训练数据。</p>
<p>经过这一番调教之后，RVM和前辈们比起来，有怎样的改进？</p>
<p>从效果对比中就可以明显感受到了：</p>
<p align="center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="360" src="https://img1.mydrivers.com/img/20210830/cacc68cf756545ec990852a98150d8c1.gif" style="border: 1px solid black; height: 338px; width: 600px;" w="640" referrerpolicy="no-referrer"></p>
<p>另外，与MODNet相比，RVM更轻更快。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/de27eba6-34c3-4a0c-9919-b8d16b56074b.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="238" src="https://img1.mydrivers.com/img/20210830/Sde27eba6-34c3-4a0c-9919-b8d16b56074b.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>从下面这张表格中可以看出，在1080p视频上RVM的处理速度是最快的，在512 x 288上比BGMv2略慢，在4K视频上则比带FGF的MODNet慢一点。研究人员分析，这是因为RVM除了alpha通道外还预判了前景。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/7fd9523e-1929-455e-b97c-125d2fc4b78d.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="391" src="https://img1.mydrivers.com/img/20210830/S7fd9523e-1929-455e-b97c-125d2fc4b78d.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>更直观的数据是，在英伟达GTX 1080Ti上，RVM能以76FPS的速度处理4K视频，以104FPS的速度处理HD视频。</p>
<p><strong>一作字节跳动实习生</strong></p>
<p>这篇论文是一作林山川在字节跳动实习期间完成的。</p>
<p style="text-align: center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="400" src="https://img1.mydrivers.com/img/20210830/8d067286-8b30-4f63-82ea-c19ab7c799ee.jpg" style="border: black 1px solid" w="400" referrerpolicy="no-referrer"></p>
<p>他本科、硕士均毕业于华盛顿大学，曾先后在Adobe、Facebook等大厂实习。</p>
<p>2021年3月-6月，林山川在字节跳动实习。8月刚刚入职微软。</p>
<p>事实上，林山川此前就曾凭借AI抠图大法拿下CVPR 2021最佳学生论文荣誉奖。</p>
<p>他以一作身份发表论文《Real-Time High-Resolution Background Matting》，提出了Background Matting V2方法。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/3910c368-88d6-41b0-ad14-314029b785bc.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="344" src="https://img1.mydrivers.com/img/20210830/S3910c368-88d6-41b0-ad14-314029b785bc.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>这一方法能够以30FPS的速度处理4K视频，以60FPS的速度处理HD视频。</p>
<p>值得一提的是，Background Matting这一系列方法不止一次中了CVPR。此前，第一代Background Matting就被CVPR 2020收录。</p>
<p style="text-align: center"><a href="https://img1.mydrivers.com/img/20210830/67e8cb5f-3f0e-43b8-9540-21c2e684cce3.png" target="_blank"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="223" src="https://img1.mydrivers.com/img/20210830/S67e8cb5f-3f0e-43b8-9540-21c2e684cce3.png" style="border: black 1px solid" w="600" referrerpolicy="no-referrer"></a></p>
<p>两次论文的通讯作者都是华盛顿大学副教授Ira Kemelmacher-Shlizerman，她的研究方向为计算机视觉、计算机图形、AR/VR等。</p>
<p style="text-align: center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="200" src="https://img1.mydrivers.com/img/20210830/3341912a-3025-4065-b2fd-bf9505691fa6.jpg" style="border: black 1px solid" w="160" referrerpolicy="no-referrer"></p>
<p>此外，本次论文的二作为Linjie Yang，他是字节跳动的研究科学家。本科毕业于清华大学，在香港中文大学获得博士学位。</p>
<p style="text-align: center"><img alt="完美抠图王冰冰！实现4K60帧视频实时抠图 连头发丝都根根分明" h="400" src="https://img1.mydrivers.com/img/20210830/6f07effa-b501-40a8-9544-3f05df06fabf.jpg" style="border: black 1px solid" w="400" referrerpolicy="no-referrer"></p>
<p>对了，除了能在Colab上试用之外，你也可以在网页版上实时感受一下这只AI的效果，</p>
<p>地址拿好：https://peterl1n.github.io/RobustVideoMatting/#/demo</p>
<p>GitHub地址：https://github.com/PeterL1n/RobustVideoMatting</p>
<p>论文地址：https://arxiv.org/abs/2108.11515</p>
<p>参考链接：https://www.reddit.com/r/MachineLearning/comments/pdbpmg/r_robust_highresolution_video_matting_with/</p>

           
           
<p class="end"> - THE END -</p> 
            
 <p class="bqian"><a href="https://news.mydrivers.com/tag/wangbingbing.htm"><i>#</i>王冰冰</a></p>
<p class="url">
     <span>原文链接：<a href="https://mp.weixin.qq.com/s/HHS888HA0slvjkkkI8HU8w">量子位</a></span>
<span>责任编辑：随心</span>
</p>
        
</div>
            