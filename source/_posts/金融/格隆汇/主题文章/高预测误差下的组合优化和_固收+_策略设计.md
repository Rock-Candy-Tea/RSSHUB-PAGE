
---
title: '高预测误差下的组合优化和_固收+_策略设计'
categories: 
 - 金融
 - 格隆汇
 - 主题文章
headimg: 'https://img3.gelonghui.com/8ffc6-a0a6b6b9-ed23-4d3a-8516-faf82bbbd04f.jpg'
author: 格隆汇
comments: false
date: Mon, 14 Mar 2022 00:00:00 GMT
thumbnail: 'https://img3.gelonghui.com/8ffc6-a0a6b6b9-ed23-4d3a-8516-faf82bbbd04f.jpg'
---

<div>   
<p></p><p></p><p><b>核心观点</b></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><span><strong>传统均值方差模型对收益率预测精度要求较高，而风险预算模型无法建立资产收益率预测和风险预算比例的对应关系，基于NearOpt的组合优化模型既可以将收益预测纳入组合优化，又能够精准控制组合波动，还允许收益</strong><strong>和风险预测存在一定误差，比较适合应用于战略性资产配置。模拟回测中，基于NearOpt的“固收+”策略收益高于风险平价策略80bp，最大回撤低于风险平价策略24bp。</strong></span></p><p></p><p></p><p></p><p></p><p><em>在量化选股策略扩容降频的背景下，更长的预测周期意味着更多的不确定性，股票收益率预测误差必然上升；而资产配置策略面临的“黑天鹅”事件也愈发频繁，中长期的大类资产收益率预测很难达到较高的准确性。因此，无论选股还是资产配置目前都需要一套容错率更高的组合优化算法。本篇报告是AI投资方法论的第四篇，讨论如何在较高的收益预测误差下进行稳健组合优化的问题，最后通过“固收+”策略设计和回测展示其优化效果。</em></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><font color="#3daad6"><br></font></p><h3 style="text-align: center;"><font color="#3daad6">壹  </font></h3><h3 style="text-align: center;"><font color="#3daad6">稳健组合优化框架</font></h3><p><strong><br></strong></p><p></p><p></p><p></p><p></p><p></p><p>传统稳健组合优化主要包括以下三个思路：</p><p>一、<strong>增加资产权重上限</strong>。此方法操作简单，但也导致了优化结果中大量资产权重为设置的权重上限，优化结果具有主观性。</p><p>二、<strong>降低预测估计的标准误</strong>，典型代表为<strong>Black-Litterman</strong>模型。此类方法基于Shrinkage、Robust Statistics、Bayesian Optimisation等技术融入市场均衡收益，降低主观预测收益率和方差的重要性，但在资金非自由流通的市场中，反推出合理的市场均衡收益并非易事，且模型本身未脱离参数过于敏感的均值方差优化框架。</p><p>三、<strong>改进最优化目标</strong>，典型代表为风险平价模型。风险平价模型直接放弃了收益的预测，以风险均摊为优化目标，更适用于保险类资金；DeMiguel（2009）则提出了正则化的改进思路，在优化中加入预测误差的惩罚项，从而达到稳健优化的目的。正则化思路虽然实现了理论上的稳健性，但实证效果表现一般。</p><p>我们认为，参数敏感性问题是最优化问题的内生性问题，无法通过过程优化完成。既然收益率预测存在比较高的预测误差，那么追求数学上的唯一最优解意义不大。在现实投资中，<strong>所有近似最优解都可看作“最优解”，理论最优解仅是现实近似最优解。</strong>因此，<span>组合优化的最优解不能脱离资金需求，能够最大概率满足资金需求（例如目标收益率，可容忍的波动范围等）的配置方案是投资组合管理中的“最优解”。</span></p><p>基于上述理念，由以色列银行开发、VDS Martin等学者完善的NearOpt近似最优组合是较为理想的组合优化模型。NearOpt不是传统意义上的“最”优化算法，而是基于产品设计视角的投资组合管理框架。在此框架下，<strong>NearOpt既可以给出最优域（近似最优组合域），投资者可以引入专家意见和其他非定量的信息来完成最优组合的选择，又能够给出最优解（稳健最优组合），纯定量地完成特定资金需求下的权重配置。</strong></p><p></p><p></p><p><img src="https://img3.gelonghui.com/8ffc6-a0a6b6b9-ed23-4d3a-8516-faf82bbbd04f.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><strong><br></strong></p><h3 style="text-align: center;"><font color="#3daad6">贰</font></h3><h3 style="text-align: center;"><font color="#3daad6">NearOpt优化的实现原理</font></h3><p><strong><br></strong></p><p></p><p></p><p></p><p></p><p></p><p>本节主要介绍NearOpt优化器的构建思路，详细算法可参考第五章附录。NearOpt优化器通过近似最优组合域和稳健最优组合确定资产权重。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/fd5df-8c9c1775-ba8b-4782-8d75-1a794de3c0af.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>近似最优组合域简介</p><p></p><p></p><p></p><p></p><p>通常组合优化模型的结果为有效前沿曲线（下图蓝线）以及最优组合（下图黄点），<span>近似最优组合域为图中的灰色区域背后对应的投资组合空间。</span>从空间几何角度来看，近似最优组合域对应高维空间的凸包（Convex Hull），灰色区域是其在二维空间上的映射。由均值-方差框架下可知，参数的些许调整可能会导致组合权重的巨大变化，不难理解，近似最优组合域内的投资组合权重、风险因子暴露度可能完全不同，但该范围内的投资组合均符合目标收益和目标风险，因此，投资者可以在其范围内根据其他增量信息选择合适的投资组合。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/665c0-d5b6bea8-3bec-4fbe-9076-b84c82580772.png" referrerpolicy="no-referrer"></p><p></p><p></p><p>近似最优组合域的背后逻辑十分直观：如果输入参数小幅改变，则近似最优组合域的形状也会发生微调，原来的最优组合将成为次优组合，原来的某个次优组合将成为新的最优组合，但整体来看，原来处于近似最优组合域内的投资组合大部分仍将是近似最优组合。</p><p></p><p></p><p></p><p></p><p>稳健最优组合简介</p><p></p><p></p><p></p><p></p><p>一旦近似最优组合域确定后，投资者可以在域内寻找偏好的投资组合。在没有其他外部信息的情况下，近似最优组合域的质心（图12点C）自然是默认的最优解。质心对应的组合为最优组合域内所有投资组合权重的平均。<span>当预期收益等模型输入调整时，近似最优组合域的形状可能发生改变，但质心受到的影响最小，因此近似最优组合域的质心可作为稳健最优组合。</span></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><strong><br></strong></p><h3 style="text-align: center;"><font color="#3daad6">叁</font></h3><h3 style="text-align: center;"><font color="#3daad6">NearOpt优化效果实证</font></h3><p><strong><br></strong></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p>收益率预测敏感度</p><p></p><p></p><p></p><p></p><p><img src="https://img3.gelonghui.com/b0ec3-6e96b72d-a1b3-4976-b849-257ac9938387.png" referrerpolicy="no-referrer"></p><p></p><p></p><p><strong>NearOpt参数敏感度远低于均值方差模型。</strong>即使风险厌恶系数高达10，当权益收益率预测从1%升至20%时，均值方差模型权益权重波动变化依然高达50%，这也侧面反映了Black-Litterman等模型的估计改良无法从本质上解决均值方差体系的不稳健性。而NearOpt模型权益权重波动区间不到15%，远小于上述均值方差模型，体现了良好的优化结果稳健性。</p><p><strong>NearOpt给予收益预测较高的容错率。</strong>当权益预期收益率远高于目标收益率时，均值方差模型严重超配权益，而NearOpt在权益上的配置权重在抬升后反而缓慢下降，这是因为其配置一定比例的股票即可满足组合的目标收益，此时算法优化重心在组合风险控制上，通过现金取代债券和权益，降低较高权益配置比例的风险。</p><p><strong>NearOpt容错率取决于目标收益和风险，目标收益越低，容错率越高。</strong>当目标收益较低时，只有当权益收益预测显著高于目标收益时，才有权益权重暴露。上图中在目标波动率3%的前提下，当权益预期收益大于9%时，权益权重才开始大于零。</p><p></p><p></p><p></p><p></p><p>风险控制能力</p><p></p><p></p><p></p><p></p><p><strong>NearOpt模型可实现组合风险精准控制。</strong>我们将目标波动率设置为2%，考察策略回测的实际年化波动率，并逐步放大目标波动率至11%。在所有参数下，策略最终年化波动率均在目标波动率之下，表现了良好的风险控制能力。NearOpt也使得量化回测结果更加真实，弱化样本内过于精准的收益预测对策略表现的提升。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/fe4a4-99fd7700-cad4-49e2-82b7-5153da1dcf9e.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><strong><br></strong></p><h3 style="text-align: center;"><font color="#3daad6">肆</font></h3><h3 style="text-align: center;"><font color="#3daad6">“固收+”策略设计</font></h3><p><strong><br></strong></p><p></p><p></p><p></p><p></p><p></p><p>作为满足稳健型资金需求的财富管理方案，“固收+”产品通常有较为明确的组合目标波动率和目标收益，另一方面大类资产预测难度高，预测误差大，因此NearOpt适用于固收+策略构建。简单起见，我们假设产品可投标的仅包括：沪深300成分股、国债、信用债以及国债逆回购。</p><p></p><p></p><p></p><p></p><p>资产收益率预测</p><p></p><p></p><p></p><p></p><p>本小节介绍我们对沪深300指数、中债-国债总财富指数、中债-信用债总财富指数未来半年收益预测的方法。我们以合理推测价格运行大致方向，不过分追求预测精度为预测原则，以核心指标的均值回复特征为预测思路。</p><p></p><p></p><p></p><p></p><p>沪深300指数收益预测</p><p></p><p></p><p></p><p></p><p>我们把沪深300指数收益分解为股息率、盈利增长与估值变化三大项，前两项提供了长期收益中枢，估值变化是预测核心，我们基于FED股债利差的均值回复特征进行预测，由于其预测误差较高，我们采用两种模型等权的方式。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/7fb16-1f0a6463-d37c-4216-9532-b1ad14a7f5b6.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>模型1：自回归模型AR(1)</p><p></p><p></p><p><img src="https://img3.gelonghui.com/9402d-24cf068c-3cb0-4e30-9a49-49fc3f0f2ea6.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>模型2：反转模型</p><p></p><p></p><p><img src="https://img3.gelonghui.com/b0770-f911598b-406e-4dcf-8b55-60e993bef1df.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>最终预测估值变化和预测沪深300收益分别为：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/3633f-727f1b8c-76b8-40c9-9631-5dad471abb70.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/ffe17-20dc90ab-15a2-4c6d-b77a-53f526f20bad.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/7323a-f5e188b2-e2f0-4cb0-af46-3aaf65c9646e.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>债券指数收益预测</p><p></p><p></p><p></p><p></p><p>债券指数收益可简单分解为到期收益率以及利率变动带来的久期收益，忽略其他因素，其中利率变化是预测核心，同样我们通过利率的均值回复特征进行预测，建模过程和参数与上一小节一致。</p><p></p><p></p><p>模型1：自回归模型AR(1)</p><p></p><p></p><p><img src="https://img3.gelonghui.com/08053-e5b86e49-1de4-4f41-ba75-b38b899c418a.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>模型2：反转模型</p><p></p><p></p><p><img src="https://img3.gelonghui.com/537d6-23a4b2a5-e717-4b6a-a884-ee1b2c33f419.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/e3c60-3544f4ae-bbea-4f93-9497-9ae5f8b411da.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>最终债券指数收益预测为：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/cd14c-bed31a49-2704-4521-81e0-0ecc5c4da573.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>其中债券指数久期通过回归法取经验值5。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/4f1c5-c04f954f-77d5-4b26-8272-c3da4d056df6.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>策略回测设定</p><p></p><p></p><p></p><p></p><p>我们设计了保守型和平衡型两组参数下的“固收+”策略，保守型策略对标风险平价策略，平衡型策略目标收益率更高。</p><p><strong>目标风险</strong>：固收+”策略通常有严格的组合风险控制要求，我们设置保守型策略目标波动率年化2%，积极型策略目标波动率年化4%。</p><p><strong>目标收益率</strong>：由于可投资产标的较少，可能出现没有资产能够满足目标收益率的情况，因此需要对目标收益率进行动态调整，当目标收益率无法满足时，下调目标收益率1%，直至模型可解，由此保证策略在权益资产预期收益率较高的进攻性，预期收益率较低时的防守性。我们设置保守型策略目标年化收益6%，平衡型策略目标年化收益8%。</p><p><strong>调仓频率</strong>：半年调仓，调仓时点为5月初，11月初。</p><p><strong>权重分配</strong>：基于NearOpt模型稳健最优组合分配权重，实际投资决策可通过模型给出的近似最优组合域进行微调。</p><p></p><p></p><p></p><p></p><p>保守型策略表现</p><p></p><p></p><p></p><p></p><p>基于目标风险2%、目标收益6%的 NearOpt模型2007年5月以来实现年化收益5.63%,高于风险平价80bp，最大回撤3.05%，低于风险平价24bp，收益风险比3.26。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/4bda3-ba1cda4c-6832-43fa-b241-7cd0df85608e.png" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/a7da1-07f1d413-caaf-4701-939a-5cec38876d7c.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/ae7f5-55fed706-e9b1-4a54-850f-edb95bee2d09.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>平衡型策略表现</p><p></p><p></p><p></p><p></p><p>基于目标风险4%、目标收益8%的 NearOpt模型2007年5月以来实现年化收益6.60%,最大回撤4.15%，收益风险比2.06。策略在现有预测精度下虽未实现目标收益，但保持了较好的回撤控制能力。未来我们将继续完善资产收益模块，通过融合Black-Litterman模型等方式，给出更为准确的收益率预测，从而提升策略表现。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/17d44-dc303581-1a11-4bdc-a2a9-54cd8e8f89e4.png" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/d203e-afab2b1c-5491-455e-bae4-1c49750c0c0c.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p><img src="https://img3.gelonghui.com/6655f-6909a134-0d97-414c-9015-5e46d2be0800.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>小结</p><p></p><p></p><p></p><p></p><p>基于NearOpt的“固收+”策略将资产绝对收益预测纳入组合优化，同时允许收益和风险预测一定估计误差。回测结果来看，在收益预测没有太大偏误的情况下，策略表现好于风险平价模型，可作为中长期或稳健型资产配置工具。</p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p><font color="#3daad6"><br></font></p><h3 style="text-align: center;"><font color="#3daad6">伍</font></h3><h3 style="text-align: center;"><font color="#3daad6">附录：Near-Opt算法详解</font></h3><p><strong><br></strong></p><p></p><p></p><p></p><p></p><p></p><p></p><p></p><p>算法流程</p><p></p><p></p><p></p><p></p><p>近似最优组合域的构建流程如下：</p><p>1)      求出原始最优组合                                              </p><p>2)      确定目标组合收益率下限以及目标组合波动率上限，确定图3中的灰色区域R</p><p>3)      求出近似最优组合域内收益和波动率均为最高的组合</p><p>4)      求出近似最优组合域内距离权重最远的组合</p><p>5)    求出近似最优组合域内距离最远的组合</p><p>6)      循环求解直至在足够的精度下覆盖了近似最优组合域</p><p>7)      求解近似最优组合域的质心，作为稳健最优组合。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/b4bdd-bb44da02-3985-4a28-968d-3158c39e5773.png" referrerpolicy="no-referrer"></p><p></p><p></p><p></p><p></p><p>数学表达</p><p></p><p></p><p></p><p></p><p>NearOpt模型不仅适用于均值方差模型，理论上可应用于所有优化模型，为了便于理解，本小节主要介绍如何在均值方差模型下求解近似最优组合域。</p><p>第一步，求解传统的均值方差最优化问题：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/117de-047ef5e1-d8d0-4d93-b047-75b78fda518d.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>u为资产预期收益，Σ为协方差矩阵，λ代表风险厌恶系数，Aw=b代表等式约束，Gw≤h代表所有不等式约束。</p><p>第二步，联合最小收益率和最大方差的约束，确定近似最优二维空间R，R满足：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/f79c4-0c13c97e-b3e3-4580-825b-8ba441ad30da.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>第三步，寻找空间R的右上顶点，即收益和风险最大的组合w1   。首先计算该点是因为有效前沿为凹曲线，w1无法由其他近似最优组合线性表示。</p><p>第四步，距离权重最远的组合，数据表达形式如下：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/ba443-231a0200-f98d-4f55-9352-be73c1ce947f.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>第五步为第四步的泛式，当存在i-1个权重时，我们希望第i个权重离i-1个权重线性组合形成的凸多胞体最远，因此，</p><p></p><p></p><p><img src="https://img3.gelonghui.com/0c0a6-485828b8-7b92-4a91-a445-d2713bca8f68.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>其中函数d代表N维空间中某一坐标w与凸多胞体Conv(w1,...,wi-1)的距离。</p><p>第六步，当新增的顶点已经十分接近凸多胞体Conv(w1,...,wn)时，则<span>Conv(w1,...,wn)</span>表明所代表的凸多胞体与近似最优组合域差别较小。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/ba033-58f42490-8f20-4189-8955-d9445dffc27d.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>ε可根据组合配置所需精度决定，若管理人觉得权重1%的变化是无差异的，那么ε选择0.01即可。</p><p>第七步，通过Quickhull等算法求解N维空间（N代表资产数量）凸多胞体的质心。</p><p></p><p></p><p></p><p></p><p>机器学习实现</p><p></p><p></p><p></p><p></p><p>尽管上一小节给出了近似最优组合域的构建方法，但是在实际应用中第五步的最优化问题较为复杂，难以直接求解。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/b9a50-83856795-1f4b-4949-a8db-d0d131f11c5c.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>为此，我们采用支持向量机SVM简化上述最优化问题。</p><p></p><p></p><p><img src="https://img3.gelonghui.com/d6022-63adfe0e-4fb6-469b-9a08-76c77e8708da.png" referrerpolicy="no-referrer"></p><p></p><p></p><p>首先，我们回顾一下SVM算法，简单来说，SVM引入超平面将数据点进行分块。图中wT·x+z=0即为分隔wi与Conv(wi,...,wi-1)的二维“平面”。SVM试图最大化超平面相对两组数据点的距离1/||x||，因此SVM分类算法可表示为：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/a4b7d-d4777e14-bfad-4151-9bc1-7eb216002ca4.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>由图所示，2<span>/||x||</span>即代表<span>wi与Conv(wi,...,wi-1)</span>的距离，因此第五步的最优化问题可表示为：</p><p></p><p></p><p><img src="https://img3.gelonghui.com/c5240-4b72e38d-ccdb-4219-a9d4-b3e4d9c83c2f.jpg" referrerpolicy="no-referrer"></p><p></p><p></p><p>上述最优化问题可通过SLSQP算法求解，极大加快了模型整体求解速度。</p><p></p><p></p><p></p><p></p><p></p>  
</div>
            