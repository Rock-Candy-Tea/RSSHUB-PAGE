
---
title: '如何看待 OPPO 正式发布的首枚 6nm 自研 NPU 芯片？到底有没有用？'
categories: 
 - 社交媒体
 - 知乎
 - 知乎热榜
headimg: 'https://pic2.zhimg.com/v2-c73c84f5ce2ec0a842647c4d8b3c566f_1440w.jpg'
author: 知乎
comments: false
date: Tue, 14 Dec 2021 11:21:29 GMT
thumbnail: 'https://pic2.zhimg.com/v2-c73c84f5ce2ec0a842647c4d8b3c566f_1440w.jpg'
---

<div>   
Navis Li的回答<br><br><p data-pid="cz6KdD7P">CPU 和GPU 大家都很熟悉，一个是中央处理器，另一个则是图形处理器，它们可以说是现代计算设备的核心了。</p><p data-pid="JpXO-IAo">CPU 有一个特点就是它能运行各种复杂程序，但是每一个线程一次只能处理一个，一切需求都要按照顺序执行，所以它就像大学教授，能力强但是工资高。</p><p data-pid="tRpDDL8I">GPU 能并行处理大量的任务，但前提是这样每一个任务并不复杂，任务也都需要 CPU 的调度，它就像是被老师指挥着干活的一大群小学生，用来完成那些让教授去干就很浪费的简单工作。</p><p data-pid="FulCbAPx"><b>而 NPU 则是一个大多数人并不熟悉，但其实已经参与到我们生活中很久了的东西</b></p><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-c73c84f5ce2ec0a842647c4d8b3c566f_1440w.jpg" data-rawwidth="865" data-rawheight="431" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-c73c84f5ce2ec0a842647c4d8b3c566f_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="prQo0bdT">NPU 最擅长的就是图像处理，更确切地说，是 AI 神经网络地图像处理。这和它的原理有关，我们都知道 GPU 是可以大量进行加减乘除的简单运算的，而目前图像识别处理最常用的一种方法是卷积神经网络：</p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-9bc3874dfc7a31b445b763a1d144c299_1440w.jpg" data-rawwidth="865" data-rawheight="437" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-9bc3874dfc7a31b445b763a1d144c299_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="zcL2EMsQ">在卷积的原理就是通过卷积核计算图像的原始信息，在这个过程中需要对两个矩阵的元素进行相乘后相加，为了保证边缘信息不被覆盖，还需要额外补一圈 0, 这意味着计算量的大幅提升。</p><p data-pid="vB_o5e_D">比如说我们现在拍一个 4000*3000 的 1200 万像素图片，它有 4000*3000 个像素，每一个像素都有 RGB 三个值，在这一步就有 1200*3= 3600 万个数据。</p><p data-pid="D9BRABwP">如果我们去用 3*3*3 的卷积核去做一个卷积的话，最终需要 3.2 亿次的乘法计算和接近 3 亿次的加法，所以这对于一个 GPU 来说压力也是很大的。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-abcd46d9bde5fe7b7c44063e7a026c19_1440w.jpg" data-rawwidth="864" data-rawheight="333" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-abcd46d9bde5fe7b7c44063e7a026c19_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="Y28u1DXz">Google 当年为了训练一个识别猫脸的深度学习神经网络，用上万个 x86 CPU核心运行 7 天来才完成。</p><p data-pid="NxvTtMBS">对于 NPU 来说，由于突破了冯·诺伊曼结构把存储和处理放在一起完成，最终就能一次性计算一个大型的矩阵，大幅减小计算量，那么自然也就能提升效率。</p><p data-pid="acrO2wTu">所以 NPU 可能就相当于一帮初中生学会了计算器，能够利用工具快速的解方程，就不用浪费大量的小学生在那算加减乘除去解方程了。</p><h2><b>那么 NPU 的应用具体有什么？</b></h2><p data-pid="fzeT1Z5H">刚刚我们提到过谷歌曾经用卷积神经网络识别猫，那么对于我们的日常拍照来说，手机的景物，动物还有人脸识别几乎都会用到卷积：</p><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-8cd610652215d10a6f9677028987e7b5_1440w.jpg" data-rawwidth="940" data-rawheight="371" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-8cd610652215d10a6f9677028987e7b5_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="mPVFcl2F">之前 OPPO 在去年 Innoday 提到自家的人像算法的时候就给到了上边的这张示意图，在人脸识别的环节就是 Depthwise(DW) 卷积，它和常规卷积的区别就是每一个卷积核负责一个通道是 RGB 进行的，大体上和我们之前说的卷积原理一致。</p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-55f426ae3117bb6efb04d5c428797d16_1440w.jpg" data-rawwidth="865" data-rawheight="436" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-55f426ae3117bb6efb04d5c428797d16_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="cbEwCLja">有了准确的人脸识别之后，我们最熟悉的一些功能比如说 HDR 人脸准确曝光，AI 美妆，还有视频美颜才有可能成为现实。</p><p data-pid="BRkePHnX">对于手机摄影这样计算部分重要性几乎快要等同于硬件重要性的领域，NPU 的需求是非常明确的，只要一个厂商下决心要做好影像，NPU 一定是绕不开的一环。</p><p data-pid="FyJXKAV_">不过我相信有的人也会问下边这个问题。</p><h2><b>为什么 SoC 已经集成了 NPU, 还要自研？</b></h2><p data-pid="3thbOdLb">其实这也是一个通用和专用的取舍，确实像是高通还有联发科都会在自己的 SoC 里做好了一个集成的 NPU, 但是集成就意味着平衡：</p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-0e95d99a2e1d5346a9e047ab2ba02471_1440w.jpg" data-rawwidth="865" data-rawheight="442" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-0e95d99a2e1d5346a9e047ab2ba02471_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="LPRoUa9x">对于不怎么重视影像的厂商，SoC 给了一个更强 NPU 是没有用的，是徒增成本的，所以 SoC 厂商不会为了某一个厂商的强烈要求针对性的在硬件的某一个部分进行改变，这对于重视影像的厂商，则是无法接受的。</p><h3><b>甚至说得更直白一些，平衡也就是平庸。</b></h3><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-e3d48db0b05c4e6a759d779577b9efa1_1440w.jpg" data-rawwidth="864" data-rawheight="463" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-e3d48db0b05c4e6a759d779577b9efa1_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="_XfCAj2S">我们都知道各个厂商一直都在算法上进行大量的投入，<b>现在出现的情况就是 —— 光靠通用的集成 NPU 已经跑不动更大规模的算法了。</b></p><p data-pid="bmIjuEc-">上边的 PPT 不知道有一个细节大家有没有注意到，OPPO 在上一代旗舰上做人脸识别的卷积神经网络需要平均 25ms 才能处理 1 帧，这样就意味着如果你需要高级的美颜算法，那么拍视频就只有 30 帧了。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-7ab6eeb61e2c6ca3822bdd0ffd2a4049_1440w.jpg" data-rawwidth="864" data-rawheight="512" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-7ab6eeb61e2c6ca3822bdd0ffd2a4049_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="0PTZBGcL">更不用说人脸识别还是一个相对简单的处理，而 OPPO 自研的 AI 降噪算法，跑在去年的旗舰 Find X3 Pro 上，尽管已经是当年的旗舰 SoC, <b>但是通用的 NPU 只能做到每秒 2 帧的水平，这意味着也就是拍照片的时候能用上，甚至连拍视频都顾及不上。</b></p><p data-pid="PrPPf0Rq">如果是要用在每秒至少 30 帧的视频上，要么功耗没办法接受，要么功耗冒烟了也跑不出这么高的性能。</p><p data-pid="NYe8B_x9">所以有了马里亚纳 MariSilicon X 这样的半定制化独立芯片之后，由于算法是自家的，硬件也就能根据软件做定制，最终用这个影像 NPU 芯片得到超高的效率。</p><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-5cbb0af10a42c888c5972d54092778d2_1440w.jpg" data-rawwidth="863" data-rawheight="525" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-5cbb0af10a42c888c5972d54092778d2_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="oua1DqOq">根据 OPPO 的说法<b>，它能保证 OPPO 在下一代的旗舰上做到 4K 40 帧的 HDR 视频增强，动态范围可以达到 20bit, 这也就意味着图像中最亮的部分能比最暗的部分亮 100 万倍，而且功耗只有通用 NPU 的一半不到。</b></p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-a642a657277bb63d5359a12b1cff9194_1440w.jpg" data-rawwidth="976" data-rawheight="376" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-a642a657277bb63d5359a12b1cff9194_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="c1ehnifB">另一方面就是更好的细节，如果你熟悉手机摄影的处理流程，那么就会知道常规的计算摄影部分其实是比较靠后的，仅仅在 Yuv 域，也就是在生成 JPG 最终图像的前一步。</p><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-454b0de0655c07b8e0c2e24effee3b20_1440w.jpg" data-rawwidth="865" data-rawheight="360" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-454b0de0655c07b8e0c2e24effee3b20_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="-0lcvg67">这样当然还是比我们后期自己去开美颜软件二次修图会更好的，但是很显然它还可以更好，有了马里亚纳 MariSilicon X 的超高效率，OPPO 就有能力在最原始的 RAW 域阶段开始进行处理。</p><p data-pid="0kgfZlGC"><b>毕竟 RAW 的信息量是最丰富的，它对算法的处理性能、效能和延时的要求也是最高的，所以这还意味着 OPPO 对于 CMOS 的掌控能力会更强。</b></p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-2d500c7c67d88a0ae5123c047110af74_1440w.jpg" data-rawwidth="863" data-rawheight="401" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-2d500c7c67d88a0ae5123c047110af74_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="acmmCtGO">不知道大家记不记得 OPPO 在 Reno 7 系列上选择了一个 RGBW 的 CMOS, 这颗 CMOS 已经把一部分算法集成在了硬件上，能直接把 RGBW 的信息转换为能识别的 RGB 信息。</p><p data-pid="wF51_C34">但是这样的处理也是有一些损失的，而有了马里亚纳 MariSilicon X 之后，OPPO 就能让 Sensor 直接出出 RGB 和 W, 这样会得到两倍的RAW数据，在信噪比和图像的解析率方面都会有非常明显的提升。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-2c5644cff07ab2ae4b2652c554d53628_1440w.jpg" data-rawwidth="865" data-rawheight="471" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-2c5644cff07ab2ae4b2652c554d53628_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="sSYA23JW">这就更进一步的强化了 OPPO 的专有能力，先不说定制的 RGBW 能不能卖给别的厂商，现在就算是能卖，其他厂商在没有马里亚纳 MariSilicon X 的前提下，也是没有办法真正发挥出这颗 CMOS 的性能的。</p><h2><b>MariSilicon X, 可以说是 OPPO 为了积累自己影像领先优势而生的</b></h2><p data-pid="e_D-IL_i"><b>对于 OPPO 终端产品团队来说，它们的目标很明确 — 那就是满足消费者日益增长的对于影像的高要求，同时还要尽可能不增加整机功耗，避免发热和续航减少。</b></p><p data-pid="4pcO-Cih">在这样的前提下，只要有人站出来保证自己能提供对应的解决方案，那么 OPPO 的终端产品团队没有理由拒绝，更何况这是来自己内部的力量。</p><p data-pid="Pgpo-J9t"><b>对于 OPPO 的芯片团队来说，相对于一上来就做通用性很强，壁垒很高的 CPU 或者 GPU 还是有很大难度的，而 NPU 看起来似乎是一个更好的弯道超车的机会。</b></p><p data-pid="H1SyoWd-">因为 NPU 本身属于半定制的芯片，本身非常适合进行 AI 处理，中国也有大量的商用算法有着明确的应用场景已经落地，硬件的需求客观存在，而且在中国厂商在 NPU 设计的领域，和国际差距并不大。</p><p data-pid="ZTqhPFYo"><b>所以这一颗 NPU 并不是 PPT, 而是在下一个影像旗舰上就会搭载，所以我们是可以期待之后的 Find X 的表现的。</b></p><h2><b>NPU可能仅仅是个开始</b></h2><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-97fa04b92f97fcfe20c08dc45a91b734_1440w.jpg" data-rawwidth="864" data-rawheight="346" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-97fa04b92f97fcfe20c08dc45a91b734_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p data-pid="5surL-ZJ">从过去各大拥有自研 SoC 能力的厂商来看，它们也都是一步一步走向罗马的，而回头来看 OPPO 这些年的脚步，似乎也走的越来越明晰。</p><p data-pid="7NbcikW0">我愿意相信，NPU 可能仅仅只是一个开始，任何一个有能力，有野心的厂商都不会放弃全栈自研的梦想，既然一定要有人站出来，那么我希望会是 OPPO.</p>  
</div>
            