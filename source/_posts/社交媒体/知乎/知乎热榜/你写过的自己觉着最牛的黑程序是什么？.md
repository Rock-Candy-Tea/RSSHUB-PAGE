
---
title: '你写过的自己觉着最牛的黑程序是什么？'
categories: 
 - 社交媒体
 - 知乎
 - 知乎热榜
headimg: 'https://pic2.zhimg.com/v2-54180fe44041cf9fca6bcaa0f5384bbb_1440w.jpg'
author: 知乎
comments: false
date: Fri, 29 Oct 2021 11:33:14 GMT
thumbnail: 'https://pic2.zhimg.com/v2-54180fe44041cf9fca6bcaa0f5384bbb_1440w.jpg'
---

<div>   
gjden的回答<br><br><p>补充并科普一下反编译器及我写反编译器的原委：反编译器是一种逆转译编译器，对于我来说她是比编译器更神奇，更有魅力的存在。反编译器最核心的能力就是将编译器编译的二进制程序(机器码或字节码)反向编译成为源代码。</p><p>写反编译器的原委要从2007年5月说起，这时候IDA5.1向全世界发布了反编译插件测试版，这时候IDA早有放风，所以一直关注这事情，等到9月正式版发布了，随后的几个月里各大破解论坛就出现了破解版，可以说IDA反编译插件一问世，就受世界上无数的hacker，cracker以及病毒分析专家所尊崇与惊叹，虽然起初并不完美，但却对于他们来说这是最有魅力的生产力工具，不过贵也是相当贵。</p><p>我也有幸的得到了反编译插件版的IDA5.1，那时简直就像发现新大陆一样：原来二进制程序还能像源代码一样进行分析和定位，搞破解写注册机简直不要太简单了，只能用惊艳来形容。有了神器，不用像以前那样去抠汇编代码。这时候喜欢混迹于看雪论坛，潜水白嫖资源和技术文章，在看雪上混的最大心得就是能知晓当时流行的技术，当时最厉害的技术莫过于虚拟化指令还原以及内核级rootkit的隐藏与保护了，这应该是当时最高级的对抗。</p><p>虚拟化保护应该算是加壳保护技术的天花板，最强的就数VMProtect和Themida了。而内核级rootkit当年也是把各大杀毒虐得体无完肤，当时比较耳目一新的技术就是机器狗的穿还原技术，TDL的内存隐藏技术，以及一些恶意广告病毒里的bootkit等等。因此为了紧跟时代发展，08-09年开始投入大量精力学驱动开发和驱动逆向，同时专研rootkit和anti-rootkit技术，以及VMProtect虚拟化指令还原。这期间写了不少东西，如自己的anti-rootkit工具，IVMP，以及几个防火墙，工作以后也还花了时间继续完善，但是随着杀毒软件对驱动的严防死守，内核级的那些技术东西也慢慢被扼杀了，而IVMP这款虚拟机保护程序也只支持32位，在繁忙的工作压力下，也没时间和精力继续搞下去。10年开始入行信息安全，所做的课题也是保密的，这期间接触了很多国家级的APT攻击样本，工作强度也很大，每个样本都要做深度逆向并尝试做反制，从中也得到大量第一手的技术，当时就感慨国内外安全的技术差距。12年时，我继续搞了搞IVMP，不过搞了一段时间后，听说有老同事出去搞虚拟保护的公司都快不行了，唉，算求了，现在虚拟机保护技术也衰落了，杀毒软件也已经将壳保护软件统统的拉入了黑名单，看见就杀，已经杀红了眼，又是感慨了一阵子。大概12年上半年，也记不清具体是啥时候了，开始萌生了想要搞反编译器的想法，在搞与不搞之间，纠结思考了很长时间。最后才下定了决心，花了大概一两周时间收集论文。研读论文后才发现，反编译器早已有之（在这之前我一直以为IDA是第一款反编译器，不过这不影响IDA的地位，因为之前那些反编译器都只是飘在论文和实验室里，完全经不起现实考验），最早在上个世纪60年代就出现了反编译器，不过上个世纪的反编译器都简陋得不像个反编译器，更像是翻译器，要说真正意义的反编译器还从C.Cifuentes博士的博士论文（1994年）开始出现，不过和其他学术反编译器一样都有个毛病，就是除了证明理论和写论文外，一无是处。不扯远了，论文大概啃了几个月，期间还回去复习了龙书，找到了一些信心，于是打算设计一款x86平台的反编译器。</p><p><br></p><p>终于在2012年5月份，下定决心毫不犹豫的开干，语言选择用C++，花了4个月时间，前端-通用反编译-后端的代码都完成得差不多了，虽然丑陋而且bug也多，不过总算有了个基本的代码框架。这是当时的反编译结果，和IDA比起来还是有很大差距。</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-54180fe44041cf9fca6bcaa0f5384bbb_1440w.jpg" data-rawwidth="717" data-rawheight="991" data-size="normal" data-caption data-default-watermark-src="https://pic4.zhimg.com/v2-cbb415936e18997581e4548d48031032_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-54180fe44041cf9fca6bcaa0f5384bbb_r.jpg" referrerpolicy="no-referrer"></figure><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-9fed0fe3d64472402e470fbef09bd792_1440w.jpg" data-rawwidth="505" data-rawheight="389" data-size="normal" data-caption data-default-watermark-src="https://pic2.zhimg.com/v2-13c67190613e6eaaed08002d7d603747_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-9fed0fe3d64472402e470fbef09bd792_r.jpg" referrerpolicy="no-referrer"></figure><p>接下来的时光里，一直处于修改bug-优化-重构的循环中。直到有一天，有朋友说：“IDA都在搞ARM32和ARM64的反编译了”，我突然开始考虑写这个东西的价值以及以后面临的反编译对抗问题，尤其是病毒类的程序，思来想去，慢慢地没有了想做下去的动力，一个人永远不可能追得上一个公司团队。这个时候随着android的兴起，android平台的病毒也开始大量的出现，因此工作重心开始转移到android上。在经过长时间糟糕的Android分析环境的折磨下，我决定转战Android反编译器，写一款自己的Android反编译器。有了之前反编译器的基础，我很快就在2012年的10月份做了个简单的demo，算是GDA v0.01吧，没有UI，只是简单完成dalvik的前端，为dalvik适配通用反编译器部分，还不具备代码输出功能。dalvik字节码比x86恶心的是有240多条指令，这工作真的是累死人，每条指令都得处理，控制流图、IR也得重新搞，数据流分析和结构化分析需要做调整，因此通用反编译已经改得面目全非了。随后做了v0.01一直到2013年4月的v0.32才开始能够独立的跑起来。这时工作上事情又开始繁重起来，不管怎么样，有空就写吧。接下来的2014年工作上有了很大的变动加上一些个人私事，耽误了一年，反编译器的编写也没有太大的进展。直到2015年才在看雪上发布出第一个公开版本V1.10。随后就是不断更新和维护了。</p><hr><p>原答案如下：</p><h2><b>1、GDA 反编译器</b></h2><p><br></p><p>自己业余（主业做安全研究，病毒分析）写的一款用于Android逆向工程的反编译系统，这是一款纯davilk字节码反编译器。从反编译器的前端，通用反编译到后端断断续续写了快8年，目前已经支持了apk、dex、odex、oat、jar、aar、class文件的反编译，并且基于GDA独有的高速反编译引擎实现了最为快速的路径求解、 漏洞检测、隐私泄露检测、污点传播分析、变量&寄存器追踪、打包器&加固检测等等功能。</p><p>GDA是中国首款也是唯一一款反编译器，也是世界上唯一一款不依赖java环境的反编译器，C++写的，目前仍然未被超越,其中许多反编译优化算法和反编译内核已形成论文和专利。具体的介绍看这里：</p><a data-draft-node="block" data-draft-type="link-card" href="http://link.zhihu.com/?target=https%3A//github.com/charles2gan/GDA-android-reversing-Tool" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">github.com/charles2gan/</span><span class="invisible">GDA-android-reversing-Tool</span><span class="ellipsis"></span></a><p>这是我自己给gda搭的个人网站, 欢迎提建议：</p><a data-draft-node="block" data-draft-type="link-card" href="http://link.zhihu.com/?target=http%3A//www.gda.wiki%3A9090/" data-image="https://pic1.zhimg.com/v2-f4befcc365dcb274db28b523f9583aab_bh.jpg" data-image-width="560" data-image-height="281" class=" wrap external" target="_blank" rel="nofollow noreferrer">GDA主页-功能强大的交互式Android反编译分析工具</a><p>反编译器截图：</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-7b52f1448f37c2ec18c53aa5b6400262_1440w.jpg" data-rawwidth="1431" data-rawheight="698" data-size="normal" data-caption data-default-watermark-src="https://pic4.zhimg.com/v2-1ac0e736a84b6fb34c62cea489649c78_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-7b52f1448f37c2ec18c53aa5b6400262_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-d192304120a4f1eb52a082c65ad78f02_1440w.jpg" data-rawwidth="1200" data-rawheight="697" data-size="normal" data-caption data-default-watermark-src="https://pic1.zhimg.com/v2-0274f0e3db71a9f739fd79727868e9b3_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-d192304120a4f1eb52a082c65ad78f02_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-9aa1bdfeb0ed441e4def1bdfc324ea07_1440w.jpg" data-rawwidth="1198" data-rawheight="699" data-size="normal" data-caption data-default-watermark-src="https://pic2.zhimg.com/v2-95992e3f4d11575f896b17a0324e503e_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-9aa1bdfeb0ed441e4def1bdfc324ea07_r.jpg" referrerpolicy="no-referrer"></figure><p><b>以下是GDA反编译器与世界最顶级Android反编译器的反编译能力对比图：</b></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-d6f54d4f131fc88a841e63a6972cbe11_1440w.jpg" data-rawwidth="1119" data-rawheight="593" data-size="normal" data-caption data-default-watermark-src="https://pic4.zhimg.com/v2-e491ff7490666db4912a1423eb3e5467_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-d6f54d4f131fc88a841e63a6972cbe11_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-04fdb92276a38559b5fbb27cc35dc362_1440w.jpg" data-rawwidth="1080" data-rawheight="850" data-size="normal" data-caption data-default-watermark-src="https://pic3.zhimg.com/v2-b9973155816a1211c134d5a31a1a5a75_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-04fdb92276a38559b5fbb27cc35dc362_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-9526229496a7193e8b68f0d9f8d09d36_1440w.jpg" data-rawwidth="1023" data-rawheight="504" data-size="normal" data-caption data-default-watermark-src="https://pic2.zhimg.com/v2-0a23b33f4876ed37bacee433caae61c7_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-9526229496a7193e8b68f0d9f8d09d36_r.jpg" referrerpolicy="no-referrer"></figure><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-fbed3dda7ab4833e943413a74eccf9c8_1440w.jpg" data-rawwidth="908" data-rawheight="493" data-size="normal" data-caption data-default-watermark-src="https://pic4.zhimg.com/v2-50589c296f1245be0f37e6803bb4c9bf_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-fbed3dda7ab4833e943413a74eccf9c8_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>2、IVMP-虚拟机保护壳</h2><p>早些年的作品，也早就没有继续写了，只支持32位程序的保护。这是一款利用反汇编引擎写的虚拟机壳，原理是将二进制程序编译成自己设计的虚拟机字节码，并清除原程序二进制代码，虚拟的代码存储在新建的Section中，并把自己设计的轻量级虚拟机写原程序中…。保护壳中还加函数链式加密、异常陷阱、反调试、花指令等等技术</p><p>代码片段截图：</p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-c1a71b12db50d7b2a47851e252524ab0_1440w.jpg" data-rawwidth="1028" data-rawheight="455" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-c1a71b12db50d7b2a47851e252524ab0_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-4c844e3227c4db4cc8cbf9b0f2f63bca_1440w.jpg" data-rawwidth="611" data-rawheight="513" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-4c844e3227c4db4cc8cbf9b0f2f63bca_r.jpg" referrerpolicy="no-referrer"></figure><p>UI比较low，加壳保护后可执行程序会变大，但是大不了多少。</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-88793dab6942d1f23659bee078f0a13d_1440w.jpg" data-rawwidth="660" data-rawheight="122" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-88793dab6942d1f23659bee078f0a13d_r.jpg" referrerpolicy="no-referrer"></figure><h2>3、PI控制命令服务器探测工具</h2><p>大概8年前写的，逆向PI远控木马的通信协议，然后写了一个主动探测的C&C自动化工具，C写的。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-fb8d67e2614977d72b5349fe35ccc7f8_1440w.jpg" data-rawwidth="553" data-rawheight="303" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-fb8d67e2614977d72b5349fe35ccc7f8_r.jpg" referrerpolicy="no-referrer"></figure><h2>4、ssl心脏滴血漏洞扫描小工具</h2><p>ssl心脏滴血漏洞爆发时，网上基本上都是python写的扫描工具，当时用的时候个人觉得太慢，花了几分钟用c++写了一个。哈～</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-77cadaaa508b39cc8883048d9f71cc80_1440w.jpg" data-rawwidth="788" data-rawheight="89" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-77cadaaa508b39cc8883048d9f71cc80_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-fce1932c5ec56fe7d3aba4511b3f9155_1440w.jpg" data-rawwidth="931" data-rawheight="452" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-fce1932c5ec56fe7d3aba4511b3f9155_r.jpg" referrerpolicy="no-referrer"></figure><h2>5、shellcode源码转换工具</h2><p><br>以前参加某某安全大赛，为了能够快速构建自定义的shellcode，写了一个可以将源码直接转换为shellcode的源代码处理工具。<br></p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-ac4374930d0a370dffbc8be735c8ced4_1440w.jpg" data-rawwidth="1224" data-rawheight="395" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-ac4374930d0a370dffbc8be735c8ced4_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-9487961981612ec3fa222e175a653221_720w.jpg" data-rawwidth="290" data-rawheight="200" data-size="normal" data-caption class="content_image" referrerpolicy="no-referrer"></figure><h2>6、XCodeGhost检测工具</h2><p>2015年9月，苹果平台XCodeGhost感染上亿APP的恶性安全事件，当时我是第一个发布了可以批量对ipa文件进行xcodeghost检测的工具。利用zip lib在解压缓存中检测特征，不需要落地到磁盘，比用python写的检测工具快几乎30倍以上。（因为python，需要解压ipa后在解压的文件中去搜特征，奇慢无比有许多ipa文件很大几十上百M的很多）</p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-4cd8eaac783f250a231c907281773391_1440w.jpg" data-rawwidth="826" data-rawheight="355" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-4cd8eaac783f250a231c907281773391_r.jpg" referrerpolicy="no-referrer"></figure><p>又从盘里翻到了些...........补上....</p><h2>7、 NTFS_FAT文件系统解析器</h2><p>08年那时，内核级rookit爆发，各种内核级的文件隐藏技术得到大力发展，那是rootkit和anti-rootkit对抗火热的年代，但是就文件隐藏对抗手段来说，最终极的方法当然是磁盘解析了，自己实现ntfs/fat文件系统的解析，发现隐藏的文件。当时也写了个简易的解析程序。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-b1bdc1aa8c6b5b9ca2be402486f193fd_1440w.jpg" data-rawwidth="1154" data-rawheight="562" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-b1bdc1aa8c6b5b9ca2be402486f193fd_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-57c46d156d350352b4a3f6be9db62a61_1440w.jpg" data-rawwidth="1027" data-rawheight="522" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-57c46d156d350352b4a3f6be9db62a61_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>8、内核级防火墙</h2><p><br></p><p>上学时还写过NDIS防火墙和TDI防火墙，不太稳定，完全是为了学习驱动写的。</p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-47aed9333efe790130b8ee9098962acc_1440w.jpg" data-rawwidth="1083" data-rawheight="569" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-47aed9333efe790130b8ee9098962acc_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>9、ARK(anti rootkit)工具</h2><p><br></p><p>这个工具是个败笔，核心功能都是在内核层完成，juyq有检测、保护、强制清除等能力，花费了无数的时间和精力，XueTr出来后自动放弃了。</p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-1b21e94a075a977af7a5bf817ae0d180_1440w.jpg" data-rawwidth="1016" data-rawheight="566" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-1b21e94a075a977af7a5bf817ae0d180_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-7e02ea8764d3d371d26cc53370f3b391_1440w.jpg" data-rawwidth="1197" data-rawheight="567" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-7e02ea8764d3d371d26cc53370f3b391_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-7f2ceb9cfc5c620fbd836842dee0f214_1440w.jpg" data-rawwidth="1077" data-rawheight="571" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-7f2ceb9cfc5c620fbd836842dee0f214_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-110ef2b47269bc1a3651c4442ac5c84d_1440w.jpg" data-rawwidth="1364" data-rawheight="576" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-110ef2b47269bc1a3651c4442ac5c84d_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>10、实验性的Rootkit</h2><p>大概08年吧，学生时代，写过一个内核下无驱动镜像、无驱动对象、隐藏性极好的实验性Rootkit。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-64d76e4a35a6a4a731fd0f6edc2c8117_1440w.jpg" data-rawwidth="678" data-rawheight="564" data-size="normal" data-caption data-qrcode-action="none" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-64d76e4a35a6a4a731fd0f6edc2c8117_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-7ec52162e82a883b5a72d1b8d55f62fe_1440w.jpg" data-rawwidth="601" data-rawheight="531" data-size="normal" data-caption class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-7ec52162e82a883b5a72d1b8d55f62fe_r.jpg" referrerpolicy="no-referrer"></figure><p>还有很多，有的是根据公开的代码改造的，有的按照自己的想法实验的，不列了。</p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-65c3d25ef3674afebe630649b23a462d_720w.jpg" data-rawwidth="209" data-rawheight="648" data-size="normal" data-caption class="content_image" referrerpolicy="no-referrer"></figure><p>还有无数的小程序，比如早些年帮别人写了抢小米手机的自动化程序，群发伪造发送者的邮箱等等，小程序太多也不列了。欢迎拍砖......^^</p>  
</div>
            