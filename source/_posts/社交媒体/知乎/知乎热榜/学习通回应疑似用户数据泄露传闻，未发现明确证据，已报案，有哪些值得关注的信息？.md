
---
title: '学习通回应疑似用户数据泄露传闻，未发现明确证据，已报案，有哪些值得关注的信息？'
categories: 
 - 社交媒体
 - 知乎
 - 知乎热榜
headimg: 'https://pic3.zhimg.com/v2-94f7c143e5461adc5194292252656f29_1440w.jpg?source=b1748391'
author: 知乎
comments: false
date: Tue, 21 Jun 2022 16:27:35 GMT
thumbnail: 'https://pic3.zhimg.com/v2-94f7c143e5461adc5194292252656f29_1440w.jpg?source=b1748391'
---

<div>   
西崎隼人的回答<br><br><p data-pid="W7zVLrzH">我认为学习通存在很大的问题。</p><p data-pid="of1_IuvR">按照业内常用方法，密码一般使用哈希加密后传输，这样即使遭到中间人攻击，也能保护密码不被泄露。</p><p data-pid="o-NSK8MQ">但是，学习通并不是这样。</p><p data-pid="qRKiTTS4">通过对浏览器对网络请求的追踪，可以发现登录请求使用POST方式发送到<a href="http://link.zhihu.com/?target=https%3A//passport2.chaoxing.com/fanyalogin" class=" external" target="_blank" rel="nofollow noreferrer"><span class="invisible">https://</span><span class="visible">passport2.chaoxing.com/</span><span class="invisible">fanyalogin</span><span class="ellipsis"></span></a>。而且看上去好像确实加密了。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-94f7c143e5461adc5194292252656f29_1440w.jpg?source=b1748391" data-rawwidth="590" data-rawheight="412" data-size="normal" data-default-watermark-src="https://pic1.zhimg.com/v2-be42d70f80fb59a59764ebc48e7f6778_720w.jpg?source=b1748391" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-94f7c143e5461adc5194292252656f29_r.jpg?source=b1748391" referrerpolicy="no-referrer"><figcaption>可以见到123456被加密为218b246a6f42ee81</figcaption></figure><p data-pid="cae1Hmqz">通过检查发起程序，我们可以确认请求是谁发起的。</p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-09b5710ddd6d466cf338dcc2f825d35a_1440w.jpg?source=b1748391" data-rawwidth="589" data-rawheight="418" data-size="normal" data-default-watermark-src="https://pic1.zhimg.com/v2-39a281a1ba540bff3e4ad803b3f9a90d_720w.jpg?source=b1748391" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-09b5710ddd6d466cf338dcc2f825d35a_r.jpg?source=b1748391" referrerpolicy="no-referrer"><figcaption>发起程序是login.js</figcaption></figure><p data-pid="lt5FD2uo">在对login.js进行检查后，发现了令人震惊的一幕。</p><figure data-size="normal"><img src="https://pica.zhimg.com/v2-34827758edcc6180126c3cd83987e18a_720w.jpg?source=b1748391" data-rawwidth="397" data-rawheight="402" data-size="normal" data-caption data-default-watermark-src="https://pic1.zhimg.com/v2-78427b64ccdad2023705801095b8031e_720w.jpg?source=b1748391" class="content_image" referrerpolicy="no-referrer"></figure><p data-pid="3MnYgAKj">将整个函数放上来：</p><div class="highlight"><pre><code class="language-js"><span><span class="c1">//手机号+密码登录</span>
<span class="kd">function</span> <span class="nx">loginByPhoneAndPwd</span><span class="p">()&#123;</span>
<span class="nx">util</span><span class="p">.</span><span class="nx">showMsg</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="s2">"phoneMsg"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">util</span><span class="p">.</span><span class="nx">showMsg</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="s2">"pwdMsg"</span><span class="p">,</span><span class="s2">""</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">util</span><span class="p">.</span><span class="nx">showMsg</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span><span class="s2">"err-txt"</span><span class="p">,</span><span class="s2">""</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">phone</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#phone"</span><span class="p">).</span><span class="nx">val</span><span class="p">().</span><span class="nx">trim</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">pwd</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#pwd"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">fid</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#fid"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">refer</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#refer"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">forbidotherlogin</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#forbidotherlogin"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">phone</span><span class="p">))&#123;</span>
<span class="nx">util</span><span class="p">.</span><span class="nx">showMsg</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="s2">"phoneMsg"</span><span class="p">,</span><span class="nx">please_input_phone</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="k">return</span><span class="p">;</span>
<span class="p">&#125;</span><span class="cm">/*else if(!util.isInterPhone(phone) && (phone.length > 50 || !util.checkEmail(phone)))&#123;</span>
<span class="cm">util.showMsg(true,"phoneMsg","手机号格式错误",true);</span>
<span class="cm">return;</span>
<span class="cm">&#125;*/</span>
<span class="k">if</span><span class="p">(</span><span class="nx">util</span><span class="p">.</span><span class="nx">isEmpty</span><span class="p">(</span><span class="nx">pwd</span><span class="p">))&#123;</span>
<span class="nx">util</span><span class="p">.</span><span class="nx">showMsg</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="s2">"pwdMsg"</span><span class="p">,</span><span class="nx">please_input_pwd</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
<span class="k">return</span><span class="p">;</span>
<span class="p">&#125;</span>
<span class="kd">var</span> <span class="nx">t</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#t"</span><span class="p">).</span><span class="nx">val</span><span class="p">();</span>
<span class="k">if</span><span class="p">(</span><span class="nx">t</span> <span class="o">==</span> <span class="s2">"true"</span><span class="p">)&#123;</span>
<span class="kd">var</span> <span class="nx">transferKey</span> <span class="o">=</span>  <span class="s2">"u2oh6Vu^HWe40fj"</span><span class="p">;</span>
<span class="nx">pwd</span> <span class="o">=</span> <span class="nx">encryptByDES</span><span class="p">(</span><span class="nx">pwd</span><span class="p">,</span> <span class="nx">transferKey</span><span class="p">);</span><span class="c1">//这里直接使用可以被还原的DES进行加密</span>
<span class="c1">//pwd = $.base64.btoa(pwd,"UTF-8");</span>
<span class="p">&#125;</span>

<span class="k">if</span><span class="p">(</span><span class="nx">capInstance</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"#needVcode"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">"1"</span><span class="p">)&#123;</span>
<span class="c1">//容错</span>
<span class="nx">loginByPhoneAndPwdSubmit</span><span class="p">();</span>
<span class="p">&#125;</span><span class="k">else</span><span class="p">&#123;</span>
<span class="nx">capInstance</span> <span class="o">&&</span> <span class="nx">capInstance</span><span class="p">.</span><span class="nx">popUp</span><span class="p">();</span>
<span class="p">&#125;</span>
</span></code></pre></div><p data-pid="-Wz1tdVI">不难看出，该程序并非通过哈希进行加密，而是使用可以解密的DES算法进行加密。</p><p data-pid="C8q-gDzE">DES的详细参数见下图：</p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-bc3dc6a2f35895e746eb249ed19404b2_1440w.jpg?source=b1748391" data-rawwidth="1149" data-rawheight="504" data-size="normal" data-default-watermark-src="https://pica.zhimg.com/v2-9fa65ed3fb2bc276f7374ad6ae08edbe_720w.jpg?source=b1748391" class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-bc3dc6a2f35895e746eb249ed19404b2_r.jpg?source=b1748391" referrerpolicy="no-referrer"><figcaption>http://tool.chacuo.net/cryptdes</figcaption></figure><p data-pid="D4Mm2tvK">但是，就算这样，如果按照常理，transferKey是由服务器随机生成的，一般也难以泄露。</p><p data-pid="vYgJWeJ7">那么，为什么会这样？</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-18386ac5ef29c0602deccbf805807026_1440w.jpg?source=b1748391" data-rawwidth="933" data-rawheight="582" data-size="normal" data-default-watermark-src="https://pic2.zhimg.com/v2-8b3f3e53a52d0816de2ef385888b9307_720w.jpg?source=b1748391" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-18386ac5ef29c0602deccbf805807026_r.jpg?source=b1748391" referrerpolicy="no-referrer"><figcaption>可见这个transferKey完全是硬编码在js中的</figcaption></figure><p data-pid="IUPUPCC4"><b>这个transferKey根本就是一个硬编码的固定值嘛。这样一来就有了多种可能：</b></p><p data-pid="JlLl4RF8"><b>1.数据库也是用transferKey加密的，因此在暴露后遭到破解。</b></p><p data-pid="M5Wucas5"><b>2.数据库是明文存储的。</b></p><p data-pid="ELEMs6LP"><b>3.学习通优化技术过差，让密码先从明文变为DES密文，在从DES密文解密为明文，最后进行哈希再与数据库比对。</b></p><p data-pid="b21fHvSO"><b>3.学习通优化技术过差，让密码先从明文变为DES密文，使用DES密文进行哈希再与数据库比对。</b></p><p><br></p><p data-pid="NHDWAPlu"><b>具体怎么样就见仁见智了。</b></p><hr><p data-pid="bcDm5wxP">22日12:21更新</p><a data-draft-node="block" data-draft-type="link-card" href="http://link.zhihu.com/?target=https%3A//github.com/Samueli924/chaoxing/issues/116" data-image="https://pic4.zhimg.com/v2-3a02ae6ef74428fb7def9b6d2284a8d9.jpg?source=b1748391" data-image-width="1200" data-image-height="600" class=" wrap external" target="_blank" rel="nofollow noreferrer">[BUG反馈]前端密码加密更改 · Issue #116 · Samueli924/chaoxing</a><p data-pid="0zn0vNoU">通过对GitHub上超星相关的内容进行检索，可以确定这种奇怪的方法实际上并不是一开始就是这样，而是在26天之前进行的修改。<b>此前采用的加密方式是现在被注释掉的base64加密。</b></p><p data-pid="JtjjGlgj"><b>目前尚不明确超星修改这个的目的。或许是想和自动机器人对抗？不过这样的修改显然达不到那样的目的。</b></p>  
</div>
            