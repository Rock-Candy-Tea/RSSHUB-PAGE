
---
title: '如何看待AI杀入斗地主领域，快手DouZero击败344个AI排名第一？未来人类斗地主能斗过AI吗？'
categories: 
 - 社交媒体
 - 知乎
 - 知乎热榜
headimg: 'https://pic4.zhimg.com/v2-b2942cfc3772c69ea3babfbb515aa48d_1440w.jpg'
author: 知乎
comments: false
date: Wed, 07 Jul 2021 03:44:52 GMT
thumbnail: 'https://pic4.zhimg.com/v2-b2942cfc3772c69ea3babfbb515aa48d_1440w.jpg'
---

<div>   
白小鱼的回答<br><br><h2>十七张牌你能秒我？</h2><p>现在，每当我在网上看到“斗地主”这三个字的时候，脑海中几乎已经联想不到任何事物了，唯有一声声的“得得得得得得~” 浮现耳畔，绕梁三日不绝。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-b2942cfc3772c69ea3babfbb515aa48d_1440w.jpg" data-caption data-size="normal" data-rawwidth="1038" data-rawheight="665" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-b2942cfc3772c69ea3babfbb515aa48d_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>此外，还有一件事令人疑惑的事儿涌上心头，那就是：自信满满的卢本伟为什么被人十七张牌给秒了？（ε=ε=ε=┏(゜ロ゜;)┛</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-c0c49c83b864b330cf73b63a007d432f_1440w.jpg" data-caption data-size="normal" data-rawwidth="1040" data-rawheight="658" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-c0c49c83b864b330cf73b63a007d432f_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>写这个回答之前，我又特意重温了一遍“十七张牌”那条视频，现在看到还是很想笑，因为实在是太经典了，典就典在其过分的偶然与碰巧。</p><p>我曾经也考虑过，自己处于那种情况时会不会预料到对方的手牌。我想，大概率迎来的也是和视频中主人公一样的失败与惊愕吧。恰好，今天看到了DouZero的消息，我不禁开始思索，要是AI碰上了当时的场景，又该作何判断呢？</p><p>怀着这个疑问，我决定深入探索一下棋牌类游戏的现状。以及，这个所谓的DouZero，究竟是什么？</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-37fb9e96d3d6581aaa9c2fff0b1fab05_1440w.jpg" data-caption data-size="normal" data-rawwidth="923" data-rawheight="455" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-37fb9e96d3d6581aaa9c2fff0b1fab05_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>棋牌类游戏现状</h2><p>1997年，美国卡内基梅隆大学的许峰雄博士开发的深蓝电脑成功战胜世界棋王卡西帕罗夫，这是人工智能第一次在世界舞台上击败人类选手。</p><p>卡斯帕罗夫负于深蓝这件事，仿佛是打开了一件潘多拉魔盒。自此以后，AI战胜或者战平人类的事一件接着一件的涌现。次年，REBEL以5:3战胜了世界排名第二的维斯瓦纳坦·阿南德。接着，Deep Junior、Fritz、X3D Fritz、Hydra等相继在国际象棋比赛中战平或战胜对手。</p><p>2006年，“浪潮杯”首届中国象棋人机大战中，5位中国象棋特级大师最终败在超级计算机浪潮天梭手下。</p><p>这样的事件一桩桩一件件的在不断上演着，并且逐渐扩展到了其它棋牌游戏，如黑白棋、双陆棋、日本将棋……</p><p>把时间拨回到2016，这一年，AlphaGo横空出世。接着，便迎来了其与李世石的人机世纪大战，鏖战五局，终以4比1的总分获得胜利。这件棋坛盛事，可以说的是人工智能VS棋牌游戏在公众视野中传播范围最广，印象里最大的一次事件了。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-b9e014ba2dc4adff13208376893da3c3_1440w.jpg" data-caption data-size="normal" data-rawwidth="560" data-rawheight="371" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-b9e014ba2dc4adff13208376893da3c3_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>自此之后，围棋、人工智能、乃至略显生僻的蒙特卡洛和博弈树等词，迅速成为了公众口中热度极高的话题。与此同时，也给大众留下了棋牌类游戏必将败于AI这一印象。</p><p>那么，同为棋牌类游戏的斗地主，与上述提到的国际象棋、将棋、围棋等又有何不同呢？它的破解之道又在何方？</p><p>这次的DouZero，给了我们一些启示。</p><p><br></p><h2>DouZero的难点以及实现原理</h2><p>斗地主与国际象棋、将棋、围棋的不同之处有很多。</p><p>首先，斗地主是一个非完美信息游戏。也就是说，任何一方对于其余两名玩家的手牌都是未知的，这点与围棋的区别很大。对于围棋来讲，博弈双方对于场上的局势都是百分百完全掌握的，信息全部公开。这一点的存在使得斗地主游戏拥有着非常复杂的博弈树以及极其庞大的状态空间。</p><p>其次，除了信息不完整以外，斗地主的另一个独特之处在于其牌型结构较为复杂，例如“单走一个6”、对子、顺子、三带一，以及最经典的由十七张牌连成的“飞机”，总计共有27472种。</p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-1b8db423c9802a67d32442a5030d7c5c_1440w.jpg" data-caption data-size="normal" data-rawwidth="838" data-rawheight="423" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-1b8db423c9802a67d32442a5030d7c5c_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>最后，斗地主还有一个独特之处，其不仅仅有围棋对弈双方的那种竞争关系，还存在两位农民之间的合作关系——合作竞争两开花。这使得解决斗地主问题的难度变的更高了。你想想，当你信心满满的给阿姨倒了杯卡布奇诺的时候，准备迎接这局胜利的时候，却发现她管不上对手，此时内心的痛苦便可想而知了。</p><p>也正因如此，一直以来，斗地主都被视为一个极具挑战性的领域。</p><p>那么，DouZero是怎么斗地主的呢？</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-437f358e6e9d5281198174a060336fb8_1440w.jpg" data-caption data-size="normal" data-rawwidth="1044" data-rawheight="664" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-437f358e6e9d5281198174a060336fb8_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>根据文章内容介绍，斗零的设计受蒙特卡罗方法的启发，将其与深度学习相结合，并利用动作状态编码机制（15x4 的0/1 矩阵）来应对斗地主复杂的牌型组合。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-67aca86955da5b33ab6be0c35bf09b7f_1440w.jpg" data-caption data-size="normal" data-rawwidth="842" data-rawheight="522" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-67aca86955da5b33ab6be0c35bf09b7f_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>具体来说，算法的目标是学习一个价值网络，网络的输入是当前状态和一个动作，输出是在当前状态做这个动作的期望收益（比如胜率），价值网络在每一步计算出哪种牌型赢的概率最大，然后选择最有可能赢的牌型。</p><p>蒙特卡罗方法不断重复这一步骤来估计真实价值，将每一步的state和action输入网络，输出价值并且做出评估，以此来优化价值网络，完成模型的训练。</p><p><br></p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-f63ca0e7c75459591eccea26b0a90c05_720w.jpg" data-caption data-size="normal" data-rawwidth="419" data-rawheight="280" class="content_image" referrerpolicy="no-referrer"></figure><p><br></p><p>为了验证DouZero的能力，论文中给出了许多的实验结果。</p><p>例如，文章里比较了DouZero和以往AI系统相抗衡时的胜率与得分：</p><figure data-size="normal"><img src="https://pic1.zhimg.com/v2-fb5d8f687def5dab257eba16967a5fad_1440w.jpg" data-caption data-size="normal" data-rawwidth="902" data-rawheight="277" class="origin_image zh-lightbox-thumb" data-original="https://pic1.zhimg.com/v2-fb5d8f687def5dab257eba16967a5fad_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>表中的WP代表胜率（Winning Percentage），而ADP代表平均得分（Average Difference in Points）。可以看到，DouZero面对所有已知AI方法时都略胜一筹，无论是WP指标还是ADP指标，其都表现更优。</p><p>此外，作者也将DouZero上传至Botzone平台，计分结果表明，DouZero成功击败其它了344个AI，成功占领了天梯排名第一的宝座。</p><p><br></p><figure data-size="normal"><img src="https://pic2.zhimg.com/v2-cd7fb4e5fff45bcf9c05a95a1d240b9c_1440w.jpg" data-caption data-size="normal" data-rawwidth="494" data-rawheight="310" class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-cd7fb4e5fff45bcf9c05a95a1d240b9c_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>最后，关于斗地主游戏中独有的合作模式，作者在文章中也给出了一个例子，如下图，DouZero预测当前玩家出”3”的获胜概率最高，为0.971，很明显这是为了放只剩一张牌的下家获胜，这表明模型也带有一定的合作性质，而非单单只有竞争。</p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-8813ffab377d33792c767ff2cad0510d_1440w.jpg" data-caption data-size="normal" data-rawwidth="439" data-rawheight="253" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-8813ffab377d33792c767ff2cad0510d_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><h2>未来是谁的天下</h2><p>目前的DouZero，仅仅使用了简单的蒙特卡罗算法，搭配以神经网络和动作编码，便能够登顶天梯。而后续，如果再搭配以更复杂的强化学习算法，我相信其战胜人类只是时间问题。</p><p>根据人的经验建模设计出来的AI，或许会因为数据的缘故，导致其在面对部分牌局时所做出的决策无法达到最优，进而无法应对一部分局面。但如果是像DouZero这样，从零开始，通过强化学习来进行自我博弈，进而不断提高自己的性能的模型，那么其所能够做的训练和拥有的能力，就将大大超出我们的预期了。</p><p>这在文章中也有一个很有趣的示例，在DouZero的自我博弈过程中，前五天在人类数据上的平均胜率都在不断提高，而之后却出现了下降期。这表明其可能学到了一些超出人类预期的出牌思路，而后续更深入的自我博弈则将加重这一过程。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-fda73581c35333ce7bd69f8f6cd5dc3a_1440w.jpg" data-caption data-size="normal" data-rawwidth="432" data-rawheight="337" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-fda73581c35333ce7bd69f8f6cd5dc3a_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>尽管斗地主属于非完美信息游戏，但以AI对于对手手牌的概率分布估计能力，以及基于此所做出的细粒度搜索和判断能力，都将远胜于人类。</p><p><br></p><figure data-size="normal"><img src="https://pic4.zhimg.com/v2-403e61806d2bc83f6a5ec7648623d25c_1440w.jpg" data-caption data-size="normal" data-rawwidth="720" data-rawheight="408" class="origin_image zh-lightbox-thumb" data-original="https://pic4.zhimg.com/v2-403e61806d2bc83f6a5ec7648623d25c_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p>类似于蒙特卡洛这类近似算法，在隐藏空间数目如此之大的游戏中，所获得的优势或许并没有在围棋中那么大，这是因为计算机非常擅长在完全信息下做搜索，而人类玩家则更擅长在非完全信息下进行推理和决策。但是，随着未来游戏 AI在包含大量隐藏状态下进行推理决策、高效学习能力的提高，以及随之而来的模型应对随机事件能力和协作能力的提升，我相信，“DouZero”们终将会在这一游戏上战胜人类。</p><p>当然，如果你是下面这位的话，那当我上面一段都是胡说的（逃 ε=ε=ε=┏(゜ロ゜ ┛ </p><p><br></p><figure data-size="normal"><img src="https://pic3.zhimg.com/v2-f7d99e795149c9fca20583d4fe4f99fc_1440w.jpg" data-caption data-size="normal" data-rawwidth="837" data-rawheight="429" class="origin_image zh-lightbox-thumb" data-original="https://pic3.zhimg.com/v2-f7d99e795149c9fca20583d4fe4f99fc_r.jpg" referrerpolicy="no-referrer"></figure><p><br></p><p><br></p><p><br></p><p><br></p><hr><h2>延伸资料</h2><figure data-size="small"><img src="https://pic2.zhimg.com/v2-25d72987d0d9323d6f9b5ca4fca9caef_1440w.jpg" data-size="small" data-rawwidth="1325" data-rawheight="762" data-default-watermark-src="https://pic3.zhimg.com/v2-aa18d5f396c7261a83c3e7b91bd33681_720w.jpg" class="origin_image zh-lightbox-thumb" data-original="https://pic2.zhimg.com/v2-25d72987d0d9323d6f9b5ca4fca9caef_r.jpg" referrerpolicy="no-referrer"><figcaption>RLcard Showdown</figcaption></figure><p><br></p><p>体验网站 ：<b><a href="http://link.zhihu.com/?target=https%3A//douzero.org/" class=" wrap external" target="_blank" rel="nofollow noreferrer">RLcard Showdown</a></b></p><p>开源项目 ：<a href="http://link.zhihu.com/?target=https%3A//gitee.com/daochenzha/DouZero" class=" wrap external" target="_blank" rel="nofollow noreferrer">Daochen Zha/DouZero</a> （国内版） / <a href="http://link.zhihu.com/?target=https%3A//github.com/kwai/DouZero" class=" wrap external" target="_blank" rel="nofollow noreferrer">kwai/DouZero</a> （国际版）</p><p>论文链接 ：<a href="http://link.zhihu.com/?target=https%3A//arxiv.org/abs/2106.06135" class=" wrap external" target="_blank" rel="nofollow noreferrer">DouZero: Mastering DouDizhu with Self-Play Deep Reinforcement Learning</a> </p><p>论文解读 ：<b><a href="https://zhuanlan.zhihu.com/p/383097277" class="internal">DouZero斗地主AI深度解析，以及RLCard工具包介绍</a></b> <a class="member_mention" href="http://www.zhihu.com/people/0c4068699b9d0d05251c0661775b134d" data-hash="0c4068699b9d0d05251c0661775b134d" data-hovercard="p$b$0c4068699b9d0d05251c0661775b134d">@一堆废纸</a> </p><p><a href="http://link.zhihu.com/?target=https%3A//mp.weixin.qq.com/s/ys5q0BkDzoZtmMgmRwxhkQ" class=" wrap external" target="_blank" rel="nofollow noreferrer">快手开源斗地主AI，入选ICML，能否干得过「冠军」柯洁？</a> <a class="member_mention" href="http://www.zhihu.com/people/1b4aebf9530a50b844ea54b776542e06" data-hash="1b4aebf9530a50b844ea54b776542e06" data-hovercard="p$b$1b4aebf9530a50b844ea54b776542e06">@快手</a> <a class="member_mention" href="http://www.zhihu.com/people/8b7b076e573c66d28bccfde1bc63b38b" data-hash="8b7b076e573c66d28bccfde1bc63b38b" data-hovercard="p$b$8b7b076e573c66d28bccfde1bc63b38b">@快手镜相</a> </p><p>其他：游戏领域，人类与人工智能战况如何：<b><a href="https://www.zhihu.com/question/452375776/answer/1811956327" class="internal">人工智能已在哪些领域超越了人类的表现？</a></b></p><p></p><p></p><p></p>  
</div>
            