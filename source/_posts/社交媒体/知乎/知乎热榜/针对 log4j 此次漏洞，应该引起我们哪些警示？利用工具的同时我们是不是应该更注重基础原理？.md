
---
title: '针对 log4j 此次漏洞，应该引起我们哪些警示？利用工具的同时我们是不是应该更注重基础原理？'
categories: 
 - 社交媒体
 - 知乎
 - 知乎热榜
headimg: 'https://picsum.photos/400/300?random=5707'
author: 知乎
comments: false
date: Tue, 14 Dec 2021 06:28:18 GMT
thumbnail: 'https://picsum.photos/400/300?random=5707'
---

<div>   
乔捷的回答<br><br><p data-pid="E4cWaEd9">就没人吐槽log4j是过度设计了么？这次的安全漏洞让很多用户无故躺枪，绝大部分用户引入log4j只是为了记录些简单的文本，压根没想到log4j还有这么强大的功能，能在字符串里执行远程代码。甚至有些用户都没直接引入log4j，只是因为第三方库用了log4j也躺枪了。</p><p data-pid="JJimEMJF">从设计上看log4j是支持动态的日志内容查找替换这种特性的，只要日志内容里存在$&#123;...&#125;这样的查询文本，log4j就会执行并替换这些查询文本，而查询文本又被设计的非常强大，可以执行JNDI这样的远程服务。先不说这样会造成严重的安全性漏洞，就算把远程执行漏洞堵上了，在记录日志的模块里进行这种复杂的文本替换也会造成潜在的性能问题，如果用户恶意构造特定日志，可能对服务器产生拒绝服务攻击。</p><p data-pid="bE8jLVXm">理论上说日志模块根本不需要这种强大的特性，如果业务需要这种查询文本替换的功能，完全可以引入一个独立的包，专门用于字符串格式化，这样的好处就在于程序员很清楚这个字符串格式化模块的特性，就不会在字符串模板里引入用户侧输入这种不可控的隐患。而日志系统记录用户侧输入是再常见不过的需求，如果记录日志时还需要担心用户侧输入会导致安全隐患，那这种日志模块就别用了，心智负担太大了。</p><p></p>  
</div>
            