
---
title: '_游戏开发小科普-1_马里奥吃了蘑菇为什么会长大_'
categories: 
 - 游戏
 - 小黑盒
 - 游戏新闻
headimg: 'https://imgheybox.max-c.com/bbs/2021/08/07/47a99f4ee83895d9b81620406445a114/thumb.png'
author: 小黑盒
comments: false
date: Sat, 07 Aug 2021 16:46:01 GMT
thumbnail: 'https://imgheybox.max-c.com/bbs/2021/08/07/47a99f4ee83895d9b81620406445a114/thumb.png'
---

<div>   
<blockquote><p>小时候红白机里的马里奥吃掉蘑菇为什么会长大呢?</p><p>这期小科普我们来聊一聊游戏开发中-“物体碰撞”</p><p>顾名思义,游戏中物体之间发生的碰撞总会产生有趣的化学反应</p></blockquote><h2>一 ： 有趣的坐标世界</h2><p>     超级马里奥中,物体都赋予一定的大小(像素),整个屏幕可以被看作一个二维坐标 , 横向为x轴,纵向为Y轴,从0点开始往自己的方向延伸</p><p><img class="lazy" data-height="871" src="https://imgheybox.max-c.com/bbs/2021/08/07/47a99f4ee83895d9b81620406445a114/thumb.png" data-width="1163" referrerpolicy="no-referrer"></p><h4 class="img-desc">超级玛丽关卡1-1</h4><p>如何判定他们会相撞呢 (马里奥吃蘑菇)？</p><p>当马里奥行走,x坐标(假设不跳跃)不断地增加,马里奥左脚设置为x1,右脚为x2</p><p>那么<b>马里奥占据的区间就是[x1,x2]</b>,蘑菇也是同理</p><p>答案就变得简单了起来,<b>当马里奥的坐标包含有蘑菇的坐标区间</b>,那马里奥就与蘑菇碰撞了！</p><p>”Duang Duang Ding  !” 马里奥就变大了 </p><p><img class="lazy" data-height="689" src="https://imgheybox.max-c.com/bbs/2021/08/07/aa909a8c6689d474c562f7d2d608033f/thumb.png" data-width="1698" referrerpolicy="no-referrer"></p><h4 class="img-desc">坐标示意图</h4><p>镜头视角无限放大,马里奥地图就像是一个长方形,那么左下角就是(0,0)一直延伸到地图尽头</p><p>所有物体之间的”碰撞”更像是一个简单的数学坐标运算</p><blockquote><p>小知识 : </p><p>        马里奥按下B键加速运动, v(t)=v(0)+at ,给定一个固定的a(加速度),当速度达到最大值,保持现在的速度</p></blockquote><h2>二： 为什么你会飞哎 ？</h2><p>马里奥中以坐标的形式发生了有趣的碰撞,那有没有更好玩的呢？下来我们看看《植物大战僵尸》</p><p><img class="lazy" data-height="624" src="https://imgheybox.max-c.com/bbs/2021/08/07/b38d3d1e27524734a1d6436c8da816b7/thumb.png" data-width="801" referrerpolicy="no-referrer"></p><h4 class="img-desc">植物大战僵尸-坐标</h4><p>看到整齐的方格,又忍不住画上了坐标表格,开始游戏！</p><p>什么时候开始攻击僵尸呢?(你大声说道)很简单！<b>当他踏过了这条坐标线后！</b></p><p><img class="lazy" data-height="629" src="https://imgheybox.max-c.com/bbs/2021/08/07/156e575815c740c46a840da0f9d22337/thumb.png" data-width="808" referrerpolicy="no-referrer"></p><h4 class="img-desc">豌豆判断敌友军</h4><p>     当豌豆移动坐标时,以每50px增加判断是否接触到了其他物体坐标区间(别忘了上图)</p><p>在判断当前物体的状态(<b>啊喂我友军啊</b>),或者命中了僵尸. 如此同理,就可以看到土豆雷效果了.</p><p><img class="lazy" data-height="629" src="https://imgheybox.max-c.com/bbs/2021/08/07/71ce1db4a2a54342488e97015fa761b4/thumb.png" data-width="803" referrerpolicy="no-referrer"></p><h4 class="img-desc">土豆雷判定</h4><p>很幸运,你看到了那个<b>大西瓜</b>！正是如此！大主角登场了！(玉米：作者就是深井冰啊喂)</p><p><img class="lazy" data-height="631" src="https://imgheybox.max-c.com/bbs/2021/08/07/b61004b8c89ae24eb4f0453ce91e3222/thumb.png" data-width="806" referrerpolicy="no-referrer"></p><h4 class="img-desc">西瓜抛物线</h4><p>       西瓜完美的抛物线(emm,这个好像是包菜？不管了,暂时性眼瞎，Just Call her 西瓜）</p><p>其实他有一个隐藏的子弹在x轴横向射出,直到碰到了僵尸的位置！获取到x坐标！开炮！！</p><p>在西瓜 x 坐标和僵尸之间只需要执行一个抛物线动画 , 最终到达指定坐标位置就好了 .</p><blockquote><p>小知识：</p><p>      聪明的你会问：僵尸他会动啊！坐标不准辣！</p><p>      其实在检测到位置之后,抛物线的时间是固定的,而僵尸移动速度固定</p><p>      所以很容易推算出僵尸会移动多少的x</p><p>      那么僵尸也有一个隐藏的目的地点  (不只是西瓜很贼噢)</p></blockquote><h3>警告 : ( 思考时间 )</h3><p><img class="lazy" data-height="657" src="https://imgheybox.max-c.com/bbs/2021/08/07/c27a73c35aabcb520b38809c505971e2/thumb.png" data-width="1560" referrerpolicy="no-referrer"></p><h4 class="img-desc">抛物线示意图</h4><p>以中间切分,两块的时间是一致的,t1=t2, 飞行时间t = t1 + t2 = 2t1 = (2 vSinφ) / g </p><h2>三： “欺骗”你的视觉效果</h2><p>现在让我们坐着时光机,跳跃另外一个有趣的世界！<b>“虚假的碰撞动画”! </b></p><p><img class="lazy" data-height="797" src="https://imgheybox.max-c.com/bbs/2021/08/07/d082abdafeeecadfc3c8e9c561619124/thumb.png" data-width="1462" referrerpolicy="no-referrer"></p><h4 class="img-desc">夏日狂想曲</h4><p>炎热的夏天总是会让我想起《夏日狂想曲》, 像素风格配合有趣的动作效果简直佳作</p><p>那么在本作物体相互运动是如标题所说”欺骗”动画</p><p>在指定的情况下接收需要播放给玩家的动画(Animation),不断地循环着直到下一个指令的发出 .</p><p><img class="lazy" data-height="828" src="https://imgheybox.max-c.com/bbs/2021/08/07/2992758e66dcb8ab2a7e3921e1665116/thumb.png" data-width="1467" referrerpolicy="no-referrer"></p><h4 class="img-desc">奇异人生：暴风前夕</h4><p>更有趣的是《奇异人生：暴风前夕》中,歌露儿惹了瑞秋生气后在垃圾场打杂的CG动画</p><p>在CG中为了节约成本并不会直接写完整的游戏检测逻辑</p><p>反而有时候会使用“动画”欺骗手法</p><p>棒球挥动自己的,篮球杆也是自己摔倒,很有趣的现象</p><h2>四： 吃我一记“欧欧”上勾拳！</h2><p>什么你说不过瘾 ？那我们来正式进入物体之间的碰撞 ！</p><p><img class="lazy" data-height="809" src="https://imgheybox.max-c.com/bbs/2021/08/07/f6153163fb8d1c3f6fe33ff3f530654a/thumb.png" data-width="1392" referrerpolicy="no-referrer"></p><h4 class="img-desc">闪客快打</h4><p>当游戏引擎的诞生,赋予游戏中物体真实的存在,那就是 - <b>质量(m)</b> , 而他们被亲昵的称呼为:<b>“刚体”</b></p><p>碰撞时间通常都很短,两个物体碰撞,每个物体给对方施加一个冲击力,两个力大小相等,方向相反</p><p>那么游戏中就是:</p><p><img class="lazy" data-height="663" src="https://imgheybox.max-c.com/bbs/2021/08/07/55fc13116b7dcb8be3adf31c68d3c234/thumb.png" data-width="1397" referrerpolicy="no-referrer"></p><h4 class="img-desc">碰撞示意图</h4><blockquote><p><b>基于牛顿碰撞原理,忽略了物体材料内部结构等,都看作为刚体,当然这都是理想化的</b></p><p><b>冲量:  力作用很短的一段时间,而这样的力被称为冲击力</b></p></blockquote><p>   <b> 看这里！</b>别沉迷在现代枪支科技！除了前面的冲量,碰撞分析还依赖另外一个原理:<b>”牛顿动量守恒定律”</b>，意味着发生刚体碰撞后,总动量是不变的</p><p><b>        （师傅别念经啦！都开始听不懂了！）</b></p><p><img class="lazy" data-height="877" src="https://imgheybox.max-c.com/bbs/2021/08/07/734f2c758cf3050ecfd35e1aece2c757/thumb.png" data-width="1174" referrerpolicy="no-referrer"></p><h4 class="img-desc">狂扁小豆丁</h4><p>   那就一起来看看曾经玩过这款揍扁小豆丁的,都喜欢用一个<b>”猛虎扑羊“ + “上勾拳”</b>完美打飞小豆丁 , 豆丁可以横向飞出的更远 ，要感谢动能,</p><blockquote><p><b>动能：与移动物体相关的一种能量</b></p><p><b>           等于物体静止加速到某个速度需要的能量</b></p><p><b>           也等于从该物体运动停下需要的能量</b></p><p><b>直线的动能   KElinear = (1/2)mv2</b></p></blockquote><p>所以你发现大胖子总是打不了太远,小豆丁可以飞到了太空（玩笑）,而自己并没有飞的那么远,</p><p>发生动能的损失,我们称之为:”<b>非弹性”</b></p><p>意味着当动能在碰撞后<b>永久的转换为了应变能</b></p><p>所以看起来也没有那么强烈.</p><p><img class="lazy" data-height="820" src="https://imgheybox.max-c.com/bbs/2021/08/07/2c7303e95b9b131a40c95a44deec2acc/thumb.png" data-width="1468" referrerpolicy="no-referrer"></p><h4 class="img-desc">闪客</h4><p>有的游戏中上挑将敌人打飞后落地(Fc忍者神龟) </p><p> 一般判断点设置为一个区域(三角,矩形),并且被隐藏起来(刚体)</p><p>当他与敌人(刚体)碰撞后,造成倾斜碰撞</p><p>那这种的碰撞可以看作<b>”完全非弹性”</b></p><p>碰撞后彼此黏在一起,以同样的速度移动  (人物随着刀的上移而上移 )</p><p><img class="lazy" data-height="705" src="https://imgheybox.max-c.com/bbs/2021/08/07/43b6e323358763e62d70410d6faa8d82/thumb.png" data-width="1088" referrerpolicy="no-referrer"></p><h4 class="img-desc">冲击力示意图</h4><blockquote><p><b>聪明的你好像发现了问题变得复杂了</b></p><p><b>你有点想要点看评论了！坚持一下！后面有惊喜</b></p><p><b>喂喂喂！说好的小科普呢！ </b></p><p><b>怎么开始有点烧脑了啊喂！感觉被骗了啊喂 ！</b></p></blockquote><h2>五： 碰撞不只是格斗！</h2><p>    欢迎来到三维(3D)世界 , 碰撞不只限于格斗,物体之间的交互,你或许知道游戏地图都具有空气墙,自己更像是在一个《楚门世界》一样的场景</p><p><img class="lazy" data-height="525" src="https://imgheybox.max-c.com/bbs/2021/08/07/c5ebd78fb7b8f1ca091ce529b7690b6c/thumb.png" data-width="1103" referrerpolicy="no-referrer"></p><h4 class="img-desc">召唤师峡谷</h4><p>有时候你或许会好奇(也许没关注过),人物在地图上的行走为什么没有掉下去？</p><p><img class="lazy" data-height="833" src="https://imgheybox.max-c.com/bbs/2021/08/07/9cca6c99b2d273e27a97e013c1cfba4d/thumb.png" data-width="1483" referrerpolicy="no-referrer"></p><h4 class="img-desc">波西亚时光</h4><p>    在Unity这样的引擎中,人物看起来更像是一个胶囊(隐藏),被称为”胶囊碰撞体“,通常会在角色中内嵌<b>胶囊碰撞体(capsule Collider) </b></p><p><img class="lazy" data-height="407" src="https://imgheybox.max-c.com/bbs/2021/08/07/d1a2347d3ff32b3a8563c06018a1c688/thumb.png" data-width="783" referrerpolicy="no-referrer"></p><h4 class="img-desc">人物模型</h4><p>那么地面就可以看作一个巨大的长方体,地形应用的属于”<b>地形碰撞体”(Terrain Collider)</b></p><p>Unity 贴心的为地形碰撞体设置中加入了一个选项”开启树的碰撞体”</p><p><img class="lazy" data-height="389" src="https://imgheybox.max-c.com/bbs/2021/08/07/bf820e860dac948bb74d7715143251f9/thumb.png" data-width="663" referrerpolicy="no-referrer"></p><h4 class="img-desc">地形</h4><p>那么现在完成了人物可以站立在地面上,那么人物跳跃后总是会落回到原地</p><p>那基本原理如之前所说感谢<b>”刚体”（Rigidbody）</b></p><p>在Unity中可以设定物体的<b>质量(Mass)</b>,开启<b>重力(Use Gravity)</b></p><h2>六： 视觉上爆炸的碰撞！</h2><p><img class="lazy" data-height="832" src="https://imgheybox.max-c.com/bbs/2021/08/07/b73a3b55ffdcf0713eb4b25d4386d5e4/thumb.png" data-width="1482" referrerpolicy="no-referrer"></p><h4 class="img-desc">雷曼:传奇</h4><p>    物体的碰撞在游戏中不单纯的只是刚体之间的作用力(冲击力)</p><p>除了有酷炫的音效,充满了光盘的特效以及散落到处的星星(粒子-Shuriken),这些不是本期的主题</p><p>     <b>刚才我们讨论了胶囊碰撞,现在我们的眼光只盯着这个有趣的”胶囊”</b></p><p>     如果让你来思考游戏,你一定会天马行空的想象力告诉我 </p><p>“主角从天而降,坏蛋被压低了,主角伴随着精致的斧子砸中坏蛋,潇洒的<b>向上反弹一下</b>”</p><p><img class="lazy" data-height="402" src="https://imgheybox.max-c.com/bbs/2021/08/07/8a71754a4369d11bb1edf8b2368d1d26/thumb.png" data-width="757" referrerpolicy="no-referrer"></p><h4 class="img-desc">弹簧示意图</h4><p>    这就是有名的<b>”关节组件”</b>,他必须要依赖刚体,而让主角反弹来自于<b>”弹簧”(Spring)</b>,</p><p>而让他不会像弹球一样弹弹弹,来自于<b>”阻尼”(Damper)</b></p><blockquote><p>当阻尼系数越大，弹簧强度减少幅度越大</p></blockquote><p>所以弹簧关节是允许主角(刚体)被拉向一个指定目标位置</p><p>也可以理解为给予了一个作用力回到目标原点(具有阻尼可是回不到原点噢),很像是橡皮筋一样</p><p><img class="lazy" data-height="830" src="https://imgheybox.max-c.com/bbs/2021/08/07/4b9c36ccce2a1bdca2a273fa3ca590d9/thumb.png" data-width="1478" referrerpolicy="no-referrer"></p><h4 class="img-desc">光明记忆</h4><p>     当然再往深入走,在光明记忆,还可以更加细节的设置,比如最小大距离(Min/Max Distance),甚至于断开力,断开转矩,激活碰撞</p><blockquote><p>断开力:     弹簧关节断开所需的转矩力</p><p>断开转矩: 弹簧关节断开所需的转矩力</p><p>激活碰撞: 关节之间也会检测碰撞 (更适合于枪支后坐力,刀弹反人物被震动颤抖)</p></blockquote><h2>七：我愿称你为最强！(悄咪咪,是本次列举游戏中)</h2><p>    或许上述的游戏中你对刚体有了许多的了解,所有的描述都是赋予了极其理想化的模式,那么更好细节就由这款游戏来做结束吧 ！</p><p><img class="lazy" data-height="833" src="https://imgheybox.max-c.com/bbs/2021/08/07/3d614d6cfdab437649f9921309a453c2/thumb.png" data-width="1473" referrerpolicy="no-referrer"></p><h4 class="img-desc">Csgo 烟雾弹抛物线</h4><p>Csgo中投掷物划出一条<b>”完美”</b>的曲线,细心的你总会发现这条抛物线并不是绝对的完美</p><p>因为引擎中涵盖了<b>阻力(流体动力学)</b>,当然为了又可以保证游戏性，阻力存在并不十足的明显.</p><p><img class="lazy" data-height="826" src="https://imgheybox.max-c.com/bbs/2021/08/07/e26c5aa8230c4866100e759eb03beb94/thumb.png" data-width="1478" referrerpolicy="no-referrer"></p><h4 class="img-desc">Csgo烟雾弹碰撞</h4><p>同样的烟雾弹,投掷的速度不通,碰撞墙体时线性冲量也会不同,导致不同的碰撞后物体线性速度</p><p><img class="lazy" data-height="835" src="https://imgheybox.max-c.com/bbs/2021/08/07/01c56a52c119a39a10a867a6598d55b7/thumb.png" data-width="1481" referrerpolicy="no-referrer"></p><h4 class="img-desc">xbox烟</h4><p>假设投掷物是一个圆形刚体(隐藏),当他碰到墙体（刚体）之后，因为<b>摩擦力</b>作用在接触面上阻止相对的运动,所以就最终落直到速度为0,如图可以看到燃烧瓶,闪光弹,烟雾弹的曲线 </p><p><img class="lazy" data-height="832" src="https://imgheybox.max-c.com/bbs/2021/08/07/14f7eaa27b01b14ae87cc7ead3e26448/thumb.png" data-width="1490" referrerpolicy="no-referrer"></p><h4 class="img-desc">道具测试</h4><p><b>八：我愿称你为最强 ！(喂喂喂！说的就是正在看文章的你！)</b></p><p>     文章最开始我们从二维坐标世界,根据x,y轴坐标区间重叠判断碰撞到以隐藏的直线判断,附加了华丽的抛物线做动画效果 , 在到具有”欺骗”手法的CG .</p><p><img class="lazy" data-height="369" src="https://imgheybox.max-c.com/bbs/2021/08/07/8f9a0815f3303c0449e0dc283e310e5f/thumb.png" data-width="1789" referrerpolicy="no-referrer"></p><h4 class="img-desc">二维世界</h4><p><b> </b>抛物线的投掷时间: </p><blockquote><p>t = t1 + t2 = 2t1 = (2Vsinα)/g <b>, </b> </p><p>v = at ， a(加速度)就是重力g,Y轴的速度 v</p></blockquote><p> t自然就就可以解出来了.</p><p>    之后引擎的产生,创造出了游戏中的”动能“</p><blockquote><p><b>冲量又是动能变化向量,动量的改变又等于施加的冲量.</b></p></blockquote><p><img class="lazy" data-height="404" src="https://imgheybox.max-c.com/bbs/2021/08/07/3e0515205dfd32c3c80e2751ed0a7a50/thumb.png" data-width="1105" referrerpolicy="no-referrer"></p><h4 class="img-desc">冲量</h4><blockquote><p>       线性冲量=(t*) - (t+)Fdt = m ( v+ - v*) </p></blockquote><p>可以理解为变化时间与冲击力的乘积,也是质量与碰撞前后速度差的乘积 </p><p>       为什么小豆丁会飞到宇宙,在游戏中质量更低,线性冲量是动能变化的向量</p><p>动能是位移物体相关的能量，物体静止到加速到运动结束需要的能力是守恒的(牛顿动量守恒定律）,</p><blockquote><p>        m1v1- + m2v2- = m1v1+ + m2v2+ ,</p></blockquote><p>故造成 v 的差距巨大 , 位移就会更多 . </p><p><b>当后续又加入了阻力与摩擦力的考虑</b></p><p><img class="lazy" data-height="585" src="https://imgheybox.max-c.com/bbs/2021/08/07/fcf0174fb53e435e4cc491ce660f57a3/thumb.png" data-width="1334" referrerpolicy="no-referrer"></p><h4 class="img-desc">阻碍飞行</h4><p>阻力作用在速度作用线上,只是方向和速度相反,通过伯努利方程,</p><blockquote><p> P/ y + z + V2/(2g) = constant(无摩擦的状态下)  </p></blockquote><blockquote><p>P ： 流体中压力, y 流体比重 , z 海拔 </p><p> v ：流体速度,    g 重力加速度</p></blockquote><p>所以说速度增加时,压力必须减少,反过来同理.压力增加,速度必须减少,记住这个！跳到下个阶段</p><p>        当烟雾弹 (闪光弹别误会！) 做自由落体</p><blockquote><p>我们不考虑x轴,省略Z轴)强制垂直为Y轴</p><p>伴随速度增加,阻力也增加  (看伯努利方程） </p></blockquote><p>当阻力增加和重力一样大,在不考虑其他任何影响外,物体的合力为 0</p><p>那么就以恒定的速度下降了. 所以明白烟雾弹曲线并不是绝对完美了吧.</p><p><img class="lazy" data-height="748" src="https://imgheybox.max-c.com/bbs/2021/08/07/5fe757bb1a6b9c943c5832fb84d7dc45/thumb.png" data-width="1459" referrerpolicy="no-referrer"></p><h4 class="img-desc">摩擦力</h4><p>    如果是一个无摩擦的碰撞,那么Vt-和Vt+是一样的,那么角度A和Θ一致,但是考虑到切线方向速度减少,所以Vt+ 比Vt- 少,那么角度Θ比A会小</p><p>     所谓二维图中A角度比B小,所以弹向了A门外,而切线方向摩擦力与法向碰撞力的比例等于摩擦系数那么 <b>tanC = μ </b> ,这就是<b>摩擦系数</b>.</p><p><br></p><blockquote><p>马里奥吃了蘑菇为什么会长大 ?</p><p><b>可能是马里奥吃的过期蘑菇产生了幻觉吧！</b></p></blockquote><p><br></p><h3>今天的游戏开发小科普到此结束！</h3><h3>还是特别希望得到大家更好的建议！</h3><h3>那么下一期 [游戏开发小科普] 我们不见不散 ！</h3><p><br></p><h3><a href="heybox://open_subject" target="_blank">#黑盒暑期降温计划#</a></h3>  
</div>
            