
---
title: '技术干货 _ 应用上线前的_体检_，你知道需要检测哪些指标吗？'
categories: 
 - 编程
 - segmentfault
 - 用户
headimg: 'https://segmentfault.com/img/bVcRmG5'
author: segmentfault
comments: false
date: 2021-04-19 12:10:41
thumbnail: 'https://segmentfault.com/img/bVcRmG5'
---

<div>   
<p>简介：应用上线前检测哪些项目？如何检测？检测数据指标包括哪些？<br>随着越来越多的企业基于 mPaaS 搭建并上线新的 App，App 的上线质量也成为各个客户关注的重点。上线前检测哪些项目？如何检测？检测数据指标包括哪些？<br><span class="img-wrap"><img class="lazy" src="https://segmentfault.com/img/bVcRmG5" alt="image.png" title="image.png" referrerpolicy="no-referrer"></span></p><p>借着上次去 XX 农信客户去做线上功能检测，加上之前多个 mPaaS 历史项目的经验总结，将 App 上线前 mPaaS 相关检测内容整理沉淀如下。<br><strong>一、安全性</strong><br><strong>1.1 RPC 是否开启国密加密</strong></p><p>对 App 来说，数据通信安全至关重要，mPaaS 已经支持 ECC、RSA 和国密（SM2）三种方式。其中，在金融行业 App 内建议开启加密配置为 SM2 国密加密，满足行业监管要求。配置可以参考产品文档：数据加密<br><strong>1.2 离线包是否开启验签</strong><br><span class="img-wrap"><img class="lazy" src="https://segmentfault.com/img/bVcRjol" alt="image.png" title="image.png" referrerpolicy="no-referrer"></span></p><p>为了保证下发到本地离线包的安全性，mPaaS 提供了离线包验签机制，保证了离线包的安全性。整体示意图如上所示，用户设置流程如下:</p><ol><li>开发者配置好一对公私钥，私钥放在服务端用于对离线包签名，公钥放在客户端，用于对签名对验证。</li><li>在离线包发布平台，如果配置了签名私钥，平台下发的 amr 文件就会带上签名信息（通过私钥对离线包的 hash 值加密后得到的密文）。</li><li>客户端在拿到 amr 包并解压后，客户端会使用在项目中预置的公钥进行签名的验证（解密上一步的密文得到一个 hash 值，同时本地计算离线包的 hash 值，判断两者是否相同），如果相同则通过验证。</li><li>如果签名校验失败，则删除离线包走 fallback 地址。<br>通过离线包的验签机制，可以达到以下的目的：</li><li>保证了离线包的内容完整，解决解压异常，读取异常下的正常显示</li><li>保证了离线包的来源正确，不被本地恶意篡改<br><strong>1.3 userId 信息是否设置正确</strong><br>因为 userId 会被后续用到很多地方，比如推送，白名单。所以一般建议选择服务端的 userId 字段作为存储字段，方便后续和服务端做 userId 字段同步，不建议存储个人手机号或者身份证等个人信息作为 userId。<br><strong>1.4 埋点信息是否包含敏感信息，比如交易单号</strong><br>考虑到埋点的量级很大，所以 mPaas 的埋点默认本地是没有做数据加密的，所以埋点信息不建议包含敏感字段，防止由于埋点导致信息泄漏。敏感字段建议走 RPC 的数据通道上报，保证数据安全。如果有埋点埋敏感字段的诉求，需要主动开启埋点的本地加密配置。<br><strong>1.5 隐私权限配置</strong><br>由于现在监管机构对隐私权限管控比较严格，mPaas 针对权限管控做了对应的接入方案。需要需要确保上线前隐私权限相关配置已经正常接入。<br><strong>二、稳定性</strong><br><strong>2.1 验证在 Android4.X 版本的是否可以正常使</strong>用<br>mPaaS 最低支持 Android 4.3 版本以上，所以发布前需要验证下低版本 Android 设备的可用性，遇到比较多的是在 Android 4.X 设备上由于多 dex 加载导致的类找不到导致的安装闪退问题。<br><strong>2.2 iOS 符号表是否正常上传</strong><br>发布前需要确保 iOS 的符号表已经上传到 mPaaS 后台，方便后台反解闪退信息。<br><strong>2.3 热修复模块是否接入并且验证通过</strong><br>发布前需要确保热修复模块的正常接入以及验证通过，保证上线有针对 Native 模块的热修复能力，保证异常场景下的修复能力。<br><strong>2.4 离线包 Fallback 域名确认</strong><br>确认 Fallback 域名是否是外网可访问的地址，遇到过发布后下发的还是内网地址的 case。<br><strong>2.5 离线包模块接入 CDN</strong><br>上线前做好容量评估，默认 mPaaS 的离线包是存储在 OSS 内的，但是一般建议针对离线包模块接入 CDN，通过 CDN 的缓存功能解决因为离线包下载导致带宽打满的风险，同时相对于 OSS 存储来说，CDN 的费用更低。接入示意图如下：<br><span class="img-wrap"><img class="lazy" src="https://segmentfault.com/img/bVcRmHt" alt="image.png" title="image.png" referrerpolicy="no-referrer"></span></li></ol><p><strong>2.6 RPC 核心链路接口压测</strong><br>上线前需要对 App 核心链路的 RPC 接口做性能压测，获取接口性能瓶颈，可以用做后续的限流值的设定参考。同时需要针对 RPC 限流场景做演练，防止上线限流后客户端出现各种异常。<br><strong>2.7 发布更新功能可用</strong><br>上线前需要验证发布 apk 功能可用，包括发布更新的强制更新功能，保证在极端场景下，需要强制升级使用。<br><strong>三、性能体验</strong><br>3.1 离线包离线功能是否正常生效<br>确保离线包的离线功能正常使用，防止由于离线包各种配置问题导致离线功能不生效。<br><strong>3.2 UC 内核是否正常接入</strong></p><p>确保 UC 内核正确配置接入，主要解决系统 WebView 下的各种兼容性问题。同时 UC 提供了很好的稳定性，比系统 WebView 更稳定。<br>3.3 核心链路离线包是否预制<br>在发布前，需要预制核心链路离线包，保证核心链路在极端异常场景下仍然可以打开。<br><span class="img-wrap"><img class="lazy" src="https://segmentfault.com/img/bVcOben" alt="image.png" title="image.png" referrerpolicy="no-referrer"></span><br><a href="https://developer.aliyun.com/article/783601?utm_content=g_1000264004" rel="nofollow">原文链接</a><br>本文为阿里云原创内容，未经允许不得转载。</p>  
</div>
            