
---
title: '一不小心，它成为了 GitHub Alibaba Group 下 Star 最多的开源项目'
categories: 
 - 编程
 - segmentfault
 - 用户
headimg: 'https://picsum.photos/400/300?random=5490'
author: segmentfault
comments: false
date: 2021-04-13 04:11:35
thumbnail: 'https://picsum.photos/400/300?random=5490'
---

<div>   
<p>简介： 随着微服务的流行，应用更加轻量和高效，但是带来的困境是线上问题排查越来越复杂困难。传统的 Java 排查问题，需要重启应用再进行调试，但是重启应用之后现场会丢失，问题难以复现。<br>来源 | 阿里巴巴云原生公众号</p><p>Arthas Star 突破 2.5 万啦<br>1.png</p><p>开源地址：_h_ttps://github.com/alibaba/arthas<br>文档：<a href="https://arthas.aliyun.com/doc/" rel="nofollow">https://arthas.aliyun.com/doc/</a><br>随着微服务的流行，应用更加轻量和高效，但是带来的困境是线上问题排查越来越复杂困难。传统的 Java 排查问题，需要重启应用再进行调试，但是重启应用之后现场会丢失，问题难以复现。</p><p>因此自 2018 年 9 月，阿里巴巴开源了久经考验，深受开发者喜爱的应用诊断利器 Arthas。</p><p>Arthas 通过创新的字节码织入技术，可以在应用无需重启时，查看调用上下文，高效排查问题；结合火焰图，可以直接定位热点，发现性能瓶颈；通过字节码替换，实现在线热更新代码；同时支持黑屏化和白屏化诊断，可以连接诊断大规模的集群。</p><p>在 2020 年 5 月时，我们做了 Arthas Star 破 2 万的回顾：</p><p>精益求精 | 开源应用诊断利器 Arthas GitHub Star 突破两万<br>冬去春又来，转眼间一年过去了，Arthas 的 Star 数突破 2.5 万了～</p><p>下面来回顾 Arthas 去年的一些数据和工作。</p><p>Arthas 过去一年的数据</p><ol><li>Arthas Github Star 数突破 2.5W<br>2.png</li><li>Arthas Github Contributors 数<br>Arthas 的开源贡献者人数从 85 增长到 119，非常感谢他们的工作：</li></ol><p>3.png</p><ol><li>Arthas 登记公司数从 117 增长到 151 家<br>过去一年，Arthas 在工商银行、中原银行、朴朴科技、贝壳找房、斗鱼等生产场景落地，欢迎更多用户登记：<a href="https://github.com/alibaba/arthas/issues/111%E3%80%82" rel="nofollow">https://github.com/alibaba/ar...</a></li></ol><p>工商银行打造在线诊断平台的探索与实践</p><ol><li>Arthas 在线教程学习人次：133,996，学习时长：51798小时<br>人均体验时长 23 分钟以上。</li></ol><p>4.png</p><ol><li>Arthas zip 包月均下载 6.5w 次<br>上线了 Arthas 新网站之后，我们统计平均每个月 arthas zip 包下载 6.5 万次。所以保守估计，Arthas 平均每个月诊断 6W+ 台机器。</li><li>Arthas 在 ATA 年度技术搜索排行第 6<br>阿里内部的技术论坛 ATA 发布年度热搜关键词 top 100，Arthas 作为 Java 诊断神器是唯一进入 top 10 的非集团指定产品。Arthas 在阿里内部的受欢迎程度可见一斑。</li></ol><p>5..png</p><p>Arthas 过去一年的工作<br>在过去的一年里，Arthas 发布了 19 个 release 版本，做了大量的改进，下面列出一些重点：</p><p>全新的 Bytekit 字节码增强框架<br>完整支持 HTTP API，所有命令都完成适配<br>Tenlet/WebSocket/HTTP API 支持统一的鉴权方案<br>全新的热更新命令 retransform<br>Tunnel Server 支持集群部署，支持查看火焰图，内部上线支持流计算应用<br>增加 arthas-spring-boot-starter 模块，并支持 endpoint，用户可以用编程方式引入 Arthas<br>上线 arthas.aliyun.com 网站，更好服务国内用户</p><ol><li>全新的 Bytekit 字节码增强框架<br>Github:<a href="https://github.com/alibaba/bytekit" rel="nofollow">https://github.com/alibaba/by...</a></li></ol><p>Bytekit 框架可以通过简洁的注解来实现字节码增强，具体功能点：</p><p>丰富的注入点支持<br>动态的 Binding<br>可编程的异常处理<br>比如在函数入口做增强：</p><pre><code>public static class SampleInterceptor &#123;
    @AtEnter(inline = true, suppress = RuntimeException.class, </code></pre><p>suppressHandler = PrintExceptionSuppressHandler.class)</p><pre><code>    public static void atEnter(@Binding.This Object object, 
            @Binding.Class Object clazz,
            @Binding.Args Object[] args, 
            @Binding.MethodName String methodName,
            @Binding.MethodDesc String methodDesc) &#123;
        System.out.println("atEnter, args[0]: " + args[0]);
    &#125;</code></pre><p>inline 支持<br>invokeOrigin 技术<br>比如在 Dubbo Filter 里插入 APM 代码：</p><p>@Instrument(Interface = "org.apache.dubbo.rpc.Filter")<br>public abstract class DubboFilter_APM &#123;</p><pre><code>public Result invoke(Invoker<?> invoker, Invocation invocation) </code></pre><p>throws RpcException &#123;</p><pre><code>    System.err.println("invoker class: " + </code></pre><p>this.getClass().getName());</p><pre><code>    Result result = InstrumentApi.invokeOrigin();
    return result;
&#125;</code></pre><p>&#125;<br>通过 Bytekit 框架，Arthas：</p><p>解决了多个 watch/trace 命令会重复某个类的问题<br>统一使用一个 Transformer，解决了多个增强命令冲突问题<br>实现了动态增强功能，通过指定 ListenerId，watch/trace 命令可以一起协作</p><ol><li>HTTP API 支持<br><a href="https://arthas.aliyun.com/doc/http-api.html" rel="nofollow">https://arthas.aliyun.com/doc...</a><br>Http API 提供类似 RESTful 的交互接口，请求和响应均为 JSON 格式的数据。相对于 Telnet/WebConsole 的输出非结构化文本数据，Http API 可以提供结构化的数据，支持更复杂的交互功能。</li><li>统一鉴权<br>在今天，应用的安全越来越受到重视。因此，诊断工具在提升诊断效率的同时，也要注意自身的安全性。<br>因为 Arthas 增加了 auth 命令，并且统一了 Telnet/WebSocket/HTTP API 的鉴权，参考：</li></ol><p><a href="https://arthas.aliyun.com/doc/auth.html" rel="nofollow">https://arthas.aliyun.com/doc...</a></p><ol><li>全新的热更新命令 retransform<br><a href="https://arthas.aliyun.com/doc/retransform.html" rel="nofollow">https://arthas.aliyun.com/doc...</a><br>之前，Arthas 里的 redefine 命令已经支持热更新功能，但是容易和 jad 命令或者其它 java agent 冲突。因此，我们开发了全新的 retransform 命令。</li></ol><p>retransform 命令和 watch/trace 命令等是同一机制下实现的。如果对同一个类执行多个命令，则会经过下面的处理：</p><p>retransform 命令 -> watch 命令 -> trace命令<br>可以看到，retransform 命令执行后，不会影响 watch/trace 命令。</p><ol><li>Tunnel Server 支持集群部署<br><a href="https://arthas.aliyun.com/doc/tunnel.html" rel="nofollow">https://arthas.aliyun.com/doc...</a><br>通过 Arthas Tunnel Server/Client 可以远程管理/连接多个 Agent。Tunnel Server 新增加功能：</li></ol><p>支持集群部署，支持 redis 存储<br>支持 http proxy，查看火焰图</p><ol><li>arthas-spring-boot-starter<br><a href="https://arthas.aliyun.com/doc/spring-boot-starter.html" rel="nofollow">https://arthas.aliyun.com/doc...</a><br>通过 arthas-spring-boot-starter，用户可以直接以编程方式引入 Arthas，结合 Tunnel Server，可以轻松实现集群化管理。</li><li>全新的网站 arthas.aliyun.com<br><a href="https://arthas.aliyun.com/" rel="nofollow">https://arthas.aliyun.com/</a><br>之前，Arthas 的文档放在 github io 的域名下，经常访问失败。为了改进访问速度，因此，我们建设了全新网站，用户访问文档和下载 Arthas，都更加方便快捷。</li></ol><p>Arthas 有奖征文活动<br>Arthas 征文活动一共办了七期，共收到投稿 30+ 篇，下面是一些优秀的文章：</p><p>工商银行打造在线诊断平台的探索与实践<br>Spring Boot 微服务性能下降九成！使用 Arthas 定位根因<br>是谁在调用我？使用 arthas+jprofiler 做复杂链路分析<br>Arthas 定位 Dubbo 手动注册 Eureka 异常<br>用 Arthas 神器来诊断 HBase 异常进程<br>有奖征文活动还在继续，欢迎大家分享～</p><p>投稿地址：<a href="http://alibabacloud.mikecrm.com/9khcRrs" rel="nofollow">http://alibabacloud.mikecrm.c...</a></p><p>Arthas 规划<br>去年，我们规划了三个目标：</p><p>RESTful API 支持<br>全新的字节码框架 ByteKit<br>插件化支持<br>实际上完成了 2.5 个，其中插件化支持，我们孵化出全新的 One Java Agent 项目来实现。</p><p><a href="https://github.com/alibaba/one-java-agent" rel="nofollow">https://github.com/alibaba/on...</a><br>One Java Agent 项目的目标：</p><p>提供插件化支持，统一管理众多的 Java Agent<br>插件支持 install/unstall，需要插件方实现接口<br>支持传统的 java agent，即已经开发好的 java agent<br>从开源到现在，Arthas 在 Github 上一共有 1200 多个 Issue，最近我们回收了第一个 Issue：</p><p>6.png</p><p>在不断增强功能的同时，我们一直在持续改进 Arthas 的易用性。</p><p>不断改进帮助文档<br>上线 arthas.aliyun.com ，改进国内用户访问速度<br>为大部分命令准备交互式的在线教程<br>我们相信：赠人玫瑰之手，经久犹有余香，感谢广大用户的支持和喜爱。</p><p>欢迎登陆 start.aliyun.com 知行动手实验室体验 Arthas 57 个动手实验：<br><a href="https://start.aliyun.com/handson-lab/#!category=arthas" rel="nofollow">https://start.aliyun.com/hand...</a></p><p>1617788975354-c95a0286-f1af-4bba-b19b-7b2d5e44df6d.gif</p><p>Arthas 实验预览<br><a href="https://developer.aliyun.com/article/783418?utm_content=g_1000261660" rel="nofollow">原文链接</a><br>本文为阿里云原创内容，未经允许不得转载。</p>  
</div>
            