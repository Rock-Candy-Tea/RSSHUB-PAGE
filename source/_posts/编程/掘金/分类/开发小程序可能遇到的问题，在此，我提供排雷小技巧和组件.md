
---
title: '开发小程序可能遇到的问题，在此，我提供排雷小技巧和组件'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79a40134b88f48acab05a03fbe5c8b53~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Tue, 06 Jul 2021 01:51:21 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79a40134b88f48acab05a03fbe5c8b53~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>@charset "UTF-8";.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#2b2b2b;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(159,219,252,.15) 3%,transparent 0),linear-gradient(1turn,rgba(159,219,252,.15) 3%,transparent 0);background-size:20px 20px;background-position:50%&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;padding:30px 0;margin-top:35px;margin-bottom:10px;color:#4dd0e1&#125;.markdown-body h1&#123;font-size:30px;text-align:center;position:relative;width:max-content;margin:0 auto&#125;.markdown-body h1:before&#123;position:absolute;content:"";z-index:-1;top:-20px;height:100%;width:100px;left:0;right:0;margin:0 auto;background:url(data:image/png;base64,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) no-repeat 50%;background-size:64px 64px;opacity:.84&#125;.markdown-body h1:after&#123;position:absolute;content:"";width:150%;left:-25%;height:50%;bottom:12px;border-radius:50%;background:linear-gradient(transparent 80%,rgba(77,208,225,.8));background-size:400% 200%;opacity:.6;animation:h1Animate 6s linear infinite&#125;@keyframes h1Animate&#123;0%&#123;background-position:100% 100%&#125;50%&#123;background-position:100% 50%&#125;to&#123;background-position:100% 100%&#125;&#125;.markdown-body h2&#123;display:block;border-bottom:4px solid #4dd0e1;position:relative;font-size:24px;padding:12px 32px;margin:30px 0&#125;.markdown-body h2:before&#123;width:24px;height:24px;left:0;top:0;margin:auto;background-size:24px 24px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAADGklEQVRYR81X32vTYBQ999s6mFjQgQ+DrbHiVFZYU4cDcQ/6pGhTFVYFEXGi82H+Bz448UnEF1Fx9ccEEcXpZE3d5tP2ooKiTacTHaLNpigMHDgnU9tcSbrWrkwWR0sbyEOSe885ObnfvV8IRT6oyPwoLQHBx+OVM5WJvSyEVAhnBOjt7yU/+/rr6r6l8TMO+F/EN0JQhICqQpD/xaRpcpAc9tS+M+9lBCia/oqBamK+zeDuQogQZaKJk3wcQjxSva7tGQGB2Ke1zIk3DNyMyNL+QpCnMQOaPsDAVuGAp9cjvbYc8Ec/bCYSg0zoiHilk1tHxqsqEsYlML4kjIpT/eurJxRNPweQU5VdrWaOEo1fgKAVbBgXIz73kF3R/ph+ghgdzMYWM29eAWlBJqgZaFlFYtC6nhWpaDqnSGlIlV1WjJ3DloDNgyNLncudqgX//Ucg3LxuStHGuhi8pqKCW3rqV342rwFjRznKm+/LNaN2yC237ThgF2wxcfMLeP6+ncrKzoPoKTGeLQbYbg4TNoC5iZPJY5HGVRdSNZAWYBclD3FzBQzrR8hACAKdzBzKA/4/IYioDQaOskBbpEG6PO8qKKSAEi3CnEb0Pw4oMf0OmKbTDWqh3Lw6EIiNBZi5lxh3wz4puBD5ovqAMvxhHSdFKxE1CQe3m/07TeTX4lcJdAhE+1Sv65Z5P/ByvIGTRowIZ9igbtXnmrOsbTvgj+kHBNMuBu9OdVw8EeU4nC1A0cYmAHZOTRrLhra4Z8ywnSN6vZHAFTA2WnnMfQB3qz73ddsOZM8CACFDIPSgQXqebXEgqgeZcAeEe6pXasm1f8ew3igMtAHWac0Uc/jYdyAaP0xEBwFsmgUPqbJ0NE2UKj4EGcahiOzuyhagaHpnmtgcVgTcCMuua7YdyAHbA3ArQNscVFbb4635aD6fnYaTvxxi9UNP7ddMXaRWVBdAcaLk6bDXPZCNZ9uBXEsDUX1T2Cc9yjig6Z0EHg3LK8/aqf6MwJKchkXfks1+0+JtSq3qLPa23BRR1B+T/6nkfMaW1r9hPt/MLtYfTLEpP+T9FNoAAAAASUVORK5CYII=)&#125;.markdown-body h2:after,.markdown-body h2:before&#123;content:"";display:block;position:absolute;bottom:0&#125;.markdown-body h2:after&#123;right:0;width:400px;height:10px;border-top-right-radius:24px;background:linear-gradient(90deg,#fff,#4dd0e1);max-width:50vw&#125;.markdown-body h3&#123;margin:30px 0;font-size:18px;position:relative;padding:4px 32px;width:max-content&#125;.markdown-body h3:before&#123;border-bottom:2px solid #4dd0e1;width:100%;content:"";display:block;height:28px;position:absolute;left:0;top:0;bottom:-2px;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);background-repeat:no-repeat;animation:h3AnimationBefore 2s infinite alternate&#125;@keyframes h3AnimationBefore&#123;0%&#123;width:28px&#125;25%&#123;width:100%&#125;50%&#123;width:100%&#125;to&#123;width:100%&#125;&#125;.markdown-body h3:after&#123;content:"";display:block;width:28px;height:28px;position:absolute;border:2px solid #4dd0e1;border-radius:50%;right:-15px;top:0;bottom:0;margin:auto;background-size:28px 28px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABRklEQVRYR2NkGGDAOMD2M4w6YDQERkNg+ITAppcfY/8zMv3wF+NdTUrZQpUQ2PT6cz8Dw/8CkMWMDIwNvqK8jcQ6gmIHNN19EaXPx1XPyMCghrCUKcpPlGc5MY6gyAE+Fx52MjL8j3cU5a1UYWXtZGBkEAVb+p8hxU+Mby5NHQCxnKEMaskzJ37uFmUetkmMjAzrfUX4woixHBJlZAA0y2EmPPYU4enLkhGeQIqRJDsAh+UgO7duNpD3IcVykkOA2paT5ABaWE60A2hlOdEO8D3/4CMDIyMfWvySFefoaYSoROh74eFXBgYGLiTNVLGc+BC48PAnAwMDG9QBVLOcaAd8P5ox+x/jf5AjGLgYfnwnKqv9/8/PwPO/kFF/MSj0cAKiouD/0bgYoixFU8RovWgJIX1EOYCQIZTIjzpgNARGQ2DAQwAAvHBaIdB7zxsAAAAASUVORK5CYII=);animation:h3AnimationAfter 2s infinite alternate&#125;@keyframes h3AnimationAfter&#123;0%&#123;transform:rotate(0)&#125;10%&#123;transform:rotate(0)&#125;50%&#123;transform:rotate(-1turn)&#125;to&#123;transform:rotate(-1turn)&#125;&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin:22px 0;letter-spacing:2px;font-size:14px;word-spacing:2px&#125;.markdown-body img&#123;max-width:80%;border-radius:6px;display:block;margin:20px auto!important;object-fit:contain;box-shadow:0 0 16px hsla(0,0%,43.1%,.45)&#125;.markdown-body figcaption&#123;display:block;font-size:13px;color:#2b2b2b&#125;.markdown-body figcaption:before&#123;content:"";background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAGFBMVEVHcExAuPtAuPpAuPtAuPpAuPtAvPxAuPokzOX5AAAAB3RSTlMAkDLqNegkoiUM7wAAAGBJREFUKM9jYBhcgMkBTUDVBE1BeDGqEtXychNUBeXlKEqACsrLQxB8lnCQQClCiWt5OYoSiAIkJVAF5eVBqAqAShTAAs7l5ShKWMwRAmAlSArASpAVgJUkCqIAscESHwCVVjMBK9JnbQAAAABJRU5ErkJggg==);display:inline-block;width:18px;height:18px;background-size:18px;background-repeat:no-repeat;background-position:50%;margin-right:5px;margin-bottom:-5px&#125;.markdown-body hr&#123;border:none;border-top:1px solid #4dd0e1;margin-top:32px;margin-bottom:32px&#125;.markdown-body del&#123;color:#4dd0e1&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:rgba(77,208,225,.08);color:#26c6da;padding:.195em .4em&#125;.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace;overflow:auto;position:relative;line-height:1.75;box-shadow:0 0 8px hsla(0,0%,43.1%,.45);border-radius:4px;margin:16px&#125;.markdown-body pre:before&#123;content:"";display:block;height:30px;width:100%;margin-bottom:-7px;background:url(data:image/png;base64,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) 10px 10px no-repeat;background-size:40px&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;color:#4dd0e1;border-bottom:1px solid #4dd0e1;font-weight:400;text-decoration:none;margin:0 4px&#125;.markdown-body a:active,.markdown-body a:hover&#123;background-color:rgba(77,208,225,.1)&#125;.markdown-body strong&#123;color:#26c6da&#125;.markdown-body strong:before&#123;content:"「"&#125;.markdown-body strong:after&#123;content:"」"&#125;.markdown-body em&#123;font-style:normal;color:#4dd0e1;font-weight:700&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:rgba(77,208,225,.05)&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;margin:2em 0;padding:24px 32px;border-left:4px solid #26c6da;background:rgba(77,208,225,.15);position:relative&#125;.markdown-body blockquote:before&#123;content:"❝";top:8px;left:8px;color:#4dd0e1;font-size:30px;line-height:1;font-weight:700;position:absolute;opacity:.7&#125;.markdown-body blockquote:after&#123;content:"❞";font-size:30px;position:absolute;right:8px;bottom:0;color:#4dd0e1;opacity:.7&#125;.markdown-body blockquote p&#123;color:#595959;line-height:2&#125;.markdown-body ol,.markdown-body ul&#123;color:#595959;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>前段时间开发了一个小程序，也是我第一个小程序，开发过程总会遇到一些奇奇怪怪的问题，但最后的最后都解决了，今天我来总结、复盘一下，毕竟好记性不如烂笔头，希望对大家也有所帮助。</p>
<h3 data-id="heading-0">小问题，大影响</h3>
<p>1.微信开发者工具有时候热更新不起作用甚至白屏，重新编译也不行;
有时候一点样式出错，预览整个都白屏，调试器里也不说哪里的问题，直接就给你弃疗不显示，重新编译也无法解决问题;
合并分支，调试器里乱报文体不存在，其实内容存在。</p>
<pre><code class="hljs language-js copyable" lang="js">强行退出后再次打开项目
<span class="copy-code-btn">复制代码</span></code></pre>
<p>2.require和import引入文件及模板有时不生效</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">import</span> 的路径只能是相对路径，比如你希望引用 utils/util.js，在不管多深的组件里面你都要慢慢 ../ 点到根目
录，同样 .wxss 文件 @<span class="hljs-keyword">import</span> 导入文件时也只能使用相对路径，所以就会出现../../../../../../utils/fetch.js.
<span class="hljs-built_in">require</span>的引入只能是相对路径，例如<span class="hljs-keyword">const</span> separateMall = <span class="hljs-built_in">require</span>(<span class="hljs-string">'../api/separateMall'</span>);
<span class="copy-code-btn">复制代码</span></code></pre>
<p>3.wxss文件中按ES6规范写法，报错</p>
<pre><code class="hljs language-js copyable" lang="js">只支持ES5写法
<span class="copy-code-btn">复制代码</span></code></pre>
<p>4.模板 &#123;&#123;&#125;&#125; 中调用了方法都不能执行</p>
<pre><code class="hljs language-js copyable" lang="js">模板 &#123;&#123;&#125;&#125; 中连方法都不能执行，只能处理简单的运算如 + - * /，如果遇到数据需要 <span class="hljs-built_in">Number</span>，toFixed等等的场景，
需要在 .js 文件中预先格式化好再一个个 setData，比如经常写的 &#123;&#123;curSpec.allPrice.toFixed(<span class="hljs-number">2</span>)&#125;&#125;，直接不显示.
<span class="copy-code-btn">复制代码</span></code></pre>
<p>5.按钮button自定义（宽高）样式,在wxss设置无效</p>
<pre><code class="hljs language-js copyable" lang="js">注意，你在css(wxss)里面直接设置button的width,height是无效的！！！必须在html(wxml)里面的style进行设置！！！
<button style=<span class="hljs-string">"width: 14vmin;height: 14vmin;"</span>>有效 </button>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>6.小程序中 button没有办法去掉border或隐藏border，border：none;border-width:0;这两个属性都无效</p>
<pre><code class="hljs language-js copyable" lang="js">button::after &#123;
          <span class="hljs-attr">display</span>: none;
        &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>7.小程序顶部导航栏标题不居中，小程序默认在andriod中居左，ios中居中</p>
<pre><code class="hljs language-js copyable" lang="js">解决方法：自定义导航栏
<span class="hljs-attr">window</span>: &#123;
      <span class="hljs-attr">backgroundTextStyle</span>: <span class="hljs-string">'light'</span>,
      <span class="hljs-attr">navigationBarBackgroundColor</span>: <span class="hljs-string">'#666'</span>,
　　　 <span class="hljs-attr">navigationStyle</span>: <span class="hljs-string">'custom'</span>
    &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>8.访问H5页面没效果，<code><web-view src="&#123;&#123;api_root&#125;&#125;index/index/aboutus"></web-view></code></p>
<pre><code class="hljs language-js copyable" lang="js">微信小程序访问H5需要配置业务域名，配置业务域名需要把微信公众平台生成的校验文件放在域名根目录下
需要保证文件访问时间小于一秒
<span class="copy-code-btn">复制代码</span></code></pre>
<ol start="9">
<li>this.data赋值页面没重新渲染</li>
</ol>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-built_in">this</span>.data与<span class="hljs-built_in">this</span>.setData的关系就是<span class="hljs-built_in">this</span>.setData里面存储的是<span class="hljs-built_in">this</span>.data的副本，而界面是从<span class="hljs-built_in">this</span>.setData里
面托管的<span class="hljs-built_in">this</span>.data的副本取数据的。所以我们更改<span class="hljs-built_in">this</span>.data并不会直接更新界面，因为这个时候的<span class="hljs-built_in">this</span>.setData里
面的副本还是没有更新前的。
想重新渲染用<span class="hljs-built_in">this</span>.setData进行赋值
<span class="copy-code-btn">复制代码</span></code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/79a40134b88f48acab05a03fbe5c8b53~tplv-k3u1fbpfcp-watermark.image" alt="1625562740(1).jpg" loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-1">编码得这样得那样，才能达到效果</h3>
<h4 data-id="heading-2">1.自定义组件和父子组件的传参</h4>
<p>在 pages 同级目录下，新建 components 文件夹，用于存放不同的组件，右键选择 “新建组件”，输入名称（inputNumber），自动生成四种类型的文件</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fb2043bf52c74d72a0e07318e37ef400~tplv-k3u1fbpfcp-watermark.image" alt="1625551938.jpg" loading="lazy" referrerpolicy="no-referrer"></p>
<p>在需要使用自定义组件父级页面的 json 文件中添加引用,然后进行使用，同时传递给子级一个函数
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1d24cfb472684e119d455d92fcb11180~tplv-k3u1fbpfcp-watermark.image" alt="1625552612(1).jpg" loading="lazy" referrerpolicy="no-referrer"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1cc74034d7d7420d95ada58078aa372f~tplv-k3u1fbpfcp-watermark.image" alt="1625552830(1).jpg" loading="lazy" referrerpolicy="no-referrer">
然后在子级页面对于父组件传递来的参数可进行使用或回调
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6b7b1b94aad48fdaf0bb6f693ec5eaa~tplv-k3u1fbpfcp-watermark.image" alt="1625553081(1).jpg" loading="lazy" referrerpolicy="no-referrer">
父级对于回调函数进行处理
<img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5896c81683d442cea15d42dbb718c349~tplv-k3u1fbpfcp-watermark.image" alt="1625553165.jpg" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-3">2.嵌入HTML代码</h4>
<p>在<a href="https://gitee.com/Small-upon/wx-parse" target="_blank" rel="nofollow noopener noreferrer">wxParse</a>下载文件，下载完之后我们需要用到目录下的wxParse文件夹，把他拷贝到我们的项目中</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c3f2a40c73b84ea099110b3070656f3f~tplv-k3u1fbpfcp-watermark.image" alt="1625554128(1).jpg" loading="lazy" referrerpolicy="no-referrer">
在app.wxss全局样式文件中，引入wxParse.wxss文件</p>
<pre><code class="hljs language-js copyable" lang="js">@<span class="hljs-keyword">import</span> <span class="hljs-string">"/plug/wxParse/wxParse.wxss"</span>;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>在我们要（嵌入的HTML代码）的wxjs文件中引入wxParse.js，然后进行引用</p>
<pre><code class="hljs language-jslet copyable" lang="jslet"> wxParse.wxParse("content" , "html",news.content,this,0);
<span class="copy-code-btn">复制代码</span></code></pre>
<p>引用函数定义如下：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a94ffb851084190a508313391c542bc~tplv-k3u1fbpfcp-watermark.image" alt="v2-9c441b336d10bc3a5134d5949879a274_r.png" loading="lazy" referrerpolicy="no-referrer">
在我们要（嵌入的HTML代码）的wxml中引入wxParse.wxml文件</p>
<pre><code class="hljs language-js copyable" lang="js"><<span class="hljs-keyword">import</span> src=<span class="hljs-string">"../../plug/wxParse/wxParse.wxml"</span> />
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">template</span> <span class="hljs-attr">is</span>=<span class="hljs-string">"wxParse"</span> <span class="hljs-attr">data</span>=<span class="hljs-string">"&#123;&#123;wxParseData:content.nodes&#125;&#125;"</span> /></span></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c2ccbfd2513a4a6384e0f770d5ff92b2~tplv-k3u1fbpfcp-watermark.image" alt="1625554681(1).jpg" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-4">3.微信授权登录</h4>
<p>登录流程时序</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c9f97fbbd29144fc9940d051019e673e~tplv-k3u1fbpfcp-watermark.image" alt="api-login.2fcc9f35.jpg" loading="lazy" referrerpolicy="no-referrer">
在页面上创建一个button标签把 open-type 设置为 getUserInfo 代码如下：</p>
<pre><code class="hljs language-js copyable" lang="js"><button <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"login"</span> bindgetphonenumber=<span class="hljs-string">"login"</span> open-type=<span class="hljs-string">"getPhoneNumber"</span>>微信手机号快捷登录</button>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>调用接口获取登录凭证（code）。通过凭证进而换取用户登录态信息，包括用户在当前小程序的唯一标识（openid）、微信开放平台帐号下的唯一标识（unionid，若当前小程序已绑定到微信开放平台帐号）及本次登录的会话密钥（session_key）等。用户数据的加解密通讯需要依赖会话密钥完成。更多使用方法详见 <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/login.html" target="_blank" rel="nofollow noopener noreferrer">小程序登录</a>。</p>
<p>第一步：获取code</p>
<p>在登录页面初始的时间就获取code，不然获取信息的时候获取有时候首次会失败：</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-function"><span class="hljs-title">init</span>(<span class="hljs-params"></span>)</span>&#123;
   wx.login(&#123;
      <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-params">result</span> =></span> &#123;
        <span class="hljs-keyword">if</span> (result.code) &#123;
          <span class="hljs-built_in">this</span>.setData(&#123;
            <span class="hljs-attr">code</span>: result.code
          &#125;)
        &#125;
      &#125;
    &#125;)
    &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>第二步，根据code获取openid和session_key,然后带着openid调用登录接口</p>
<p>点击按钮的代码，获取到encryptedData和iv进行获取Openid，然后进行登录：</p>
<pre><code class="hljs language-js copyable" lang="js">  <span class="hljs-comment">// 登录</span>
  <span class="hljs-function"><span class="hljs-title">login</span>(<span class="hljs-params">e</span>)</span> &#123;
    <span class="hljs-built_in">this</span>.setData(&#123;
      <span class="hljs-attr">isRequest</span>: <span class="hljs-literal">true</span>
    &#125;)
    <span class="hljs-keyword">var</span> errMsg = e.detail.errMsg;
    <span class="hljs-keyword">if</span> (errMsg === <span class="hljs-string">'getPhoneNumber:ok'</span>) &#123;
    <span class="hljs-comment">//获取encryptedData和iv</span>
      <span class="hljs-keyword">var</span> iv = e.detail.iv, encryptedData = e.detail.encryptedData;
      <span class="hljs-keyword">let</span> param = &#123;
        <span class="hljs-attr">app_type</span>: <span class="hljs-number">2</span>,
        encryptedData,
        iv
      &#125;
      <span class="hljs-built_in">this</span>.getOpenid(param);
    &#125;
  &#125;,
  <span class="hljs-comment">// 获取openId,进行登录</span>
  <span class="hljs-function"><span class="hljs-title">getOpenid</span>(<span class="hljs-params">param</span>)</span> &#123;
    <span class="hljs-keyword">const</span> &#123; code &#125; = <span class="hljs-built_in">this</span>.data;
    <span class="hljs-comment">//检查code是否过期</span>
    wx.checkSession(&#123;
      <span class="hljs-attr">success</span>: <span class="hljs-function">() =></span> &#123;
        <span class="hljs-keyword">if</span> (code) &#123;
          <span class="hljs-comment">// 获取用户的openId</span>
          param = &#123;
            ...param,
            <span class="hljs-attr">code</span>: code,  <span class="hljs-comment">//传入code参数获取用户的openId</span>
          &#125;
          <span class="hljs-comment">//获取Openid，我是自己封装了接口所以如下调用</span>
          common.getOpenid(&#123;
            <span class="hljs-attr">data</span>:
              param, <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =></span> &#123;
                ;
                <span class="hljs-keyword">let</span> data = result.data;
                <span class="hljs-comment">//一切就绪，调用登录接口</span>
                user.mobilelogin(&#123;
                  <span class="hljs-attr">data</span>: &#123; <span class="hljs-attr">mobile</span>: data.decodeResult.phoneNumber, <span class="hljs-attr">xcx_openid</span>: data.openid &#125;,                       <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">result</span>) =></span> &#123;
                    wx.setStorageSync(<span class="hljs-string">'userInfo'</span>, result.data.userinfo)
                    App.globalData.userInfo = result.data.userinfo
                  &#125;
                &#125;);
              &#125;
          &#125;)
        &#125;
      &#125;,
      <span class="hljs-attr">fail</span>: <span class="hljs-function">() =></span> &#123;
        <span class="hljs-built_in">this</span>.init();
      &#125;
    &#125;)
  &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-5">4.微信提供5中跳转方式</h4>
<p>1、wx.navigateTo(OBJECT)</p>
<p>　　保留当前页面，跳转到应用内的某个页面</p>
<p>2、wx.redirectTo(OBJECT)</p>
<p>　　关闭当前页面，跳转到应用内的某个页面。</p>
<p>3、wx.switchTab(OBJECT)</p>
<p>　　跳转到 tabBar 页面，并关闭其他所有非 tabBar 页面</p>
<p>4、wx.navigateBack(OBJECT)</p>
<p>　　关闭当前页面，返回上一页面或多级页面。</p>
<p>5、wx.reLaunch(OBJECT)</p>
<p>　　关闭所有页面，打开到应用内的某个页面。</p>
<p>在做返回的功能时，注意navigateBack不会调用onload方法。可以把onload换成onShow方法，每次加载页面时会自动调用onShow方法</p>
<p>修改上一个页面数据使得返回做出反应，下面提供一种解决方法</p>
<p>用navigateBack跳转不用考虑页面传参问题，直接setData就好</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">var</span> pages = getCurrentPages(); <span class="hljs-comment">//获取当前页面</span>
<span class="hljs-keyword">var</span>  prevPage = <span class="hljs-literal">null</span>;
 <span class="hljs-keyword">if</span> (pages.length > <span class="hljs-number">1</span>) &#123;
        prevPage = pages[pages.length - <span class="hljs-number">2</span>];<span class="hljs-comment">//获取上一页面</span>
      &#125; 
prePage.setData(&#123;
     <span class="hljs-attr">msg</span>:<span class="hljs-string">'修改成功'</span> <span class="hljs-comment">//给上一页面的变量赋值</span>
&#125;)
prePage.getPageData(); <span class="hljs-comment">//调用上一页面的方法（加载数据）</span>
wx.navigateBack(&#123;     <span class="hljs-comment">//返回上一页面</span>
      <span class="hljs-attr">delta</span>: <span class="hljs-number">1</span>,
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-6">5.微信支付</h4>
<p>调用好自己服务器的接口，带返回参数调用函数doWxPay，然后对应处理</p>
<pre><code class="hljs language-js copyable" lang="js"> <span class="hljs-function"><span class="hljs-title">doWxPay</span>(<span class="hljs-params">param</span>)</span> &#123;
      <span class="hljs-keyword">const</span> _this = <span class="hljs-built_in">this</span>;
      <span class="hljs-comment">//小程序发起微信支付</span>
      wx.requestPayment(&#123;
        <span class="hljs-attr">timeStamp</span>: param.data.timeStamp,<span class="hljs-comment">//记住，这边的timeStamp一定要是字符串类型的，不然会报错</span>
        <span class="hljs-attr">nonceStr</span>: param.data.nonceStr,
        <span class="hljs-attr">package</span>: param.data.package,
        <span class="hljs-attr">signType</span>: <span class="hljs-string">'MD5'</span>,
        <span class="hljs-attr">paySign</span>: param.data.paySign,
        <span class="hljs-attr">success</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">event</span>) </span>&#123;
          
        &#125;,
        <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>&#123;
         
        &#125;,
        <span class="hljs-attr">complete</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;

        &#125;
      &#125;);
    &#125;,
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-7">6.radio默认样式修改</h4>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/* 选中后的 背景样式 （红色背景 无边框 可根据UI需求自己修改） */</span>
 
radio .wx-radio-input.wx-radio-input-checked &#123;
  border-color: #03a9f4;
  background: #03a9f4;
&#125;
 
<span class="hljs-comment">/* 自定义样式.... */</span>
 
radio .wx-radio-input &#123;
  <span class="hljs-attr">height</span>: 40rpx;
  width: 40rpx;
  margin-top: -4rpx;
  border-radius: <span class="hljs-number">50</span>%;
  border: 2rpx solid #<span class="hljs-number">999</span>;
  background: transparent;
&#125;
 
<span class="hljs-comment">/* 选中后的 对勾样式 （白色对勾 可根据UI需求自己修改） */</span>
 
radio .wx-radio-input.wx-radio-input-checked::before &#123;
  border-radius: <span class="hljs-number">50</span>%; <span class="hljs-comment">/* 圆角 */</span>
  width: 40rpx; <span class="hljs-comment">/* 选中后对勾大小，不要超过背景的尺寸 */</span>
  height: 40rpx; <span class="hljs-comment">/* 选中后对勾大小，不要超过背景的尺寸 */</span>
  line-height: 40rpx;
  text-align: center;
  font-size: 30rpx; <span class="hljs-comment">/* 对勾大小 30rpx */</span>
  color: #fff; <span class="hljs-comment">/* 对勾颜色 白色 */</span>
  background: #f00;
  transform: translate(-<span class="hljs-number">50</span>%, -<span class="hljs-number">50</span>%) scale(<span class="hljs-number">1</span>);
  -webkit-transform: translate(-<span class="hljs-number">50</span>%, -<span class="hljs-number">50</span>%) scale(<span class="hljs-number">1</span>);
&#125;

<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-8">7.获取二维码带过来参数</h4>
<pre><code class="copyable">let url = decodeURIComponent(option.q);
console.log(url);

<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-9">8.加空格</h4>
<pre><code class="hljs language-js copyable" lang="js"><!-- 无论多少个空格都会被替换为一个空格 -->
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'c1'</span>></span><span class="hljs-tag"><<span class="hljs-name">text</span>></span>我是c1我有4个空格啊    啊<span class="hljs-tag"></<span class="hljs-name">text</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>

<!-- 事实证明添加绑定的空格数据是无效的 -->
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'c2'</span>></span><span class="hljs-tag"><<span class="hljs-name">text</span>></span>我是c2我有4个空格啊&#123;&#123;"       "&#125;&#125;啊<span class="hljs-tag"></<span class="hljs-name">text</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>

<!-- 如果不加decode=<span class="hljs-string">"true"</span> &nbsp会被识别突显 但是无法转化成空格 -->
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'c3'</span>></span><span class="hljs-tag"><<span class="hljs-name">text</span>></span>我是c3我有4个空格啊<span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span>啊<span class="hljs-tag"></<span class="hljs-name">text</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>

<!-- 这个是正确的操作，也是网上查到的操作，缺点是要添加多少个空格就要加多少&nbsp; -->
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'c4'</span>></span><span class="hljs-tag"><<span class="hljs-name">text</span> <span class="hljs-attr">decode</span>=<span class="hljs-string">'true'</span>></span>我是c4我有4个空格啊<span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span><span class="hljs-symbol">&nbsp;</span>啊<span class="hljs-tag"></<span class="hljs-name">text</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>

<!-- 这个是最开始我使用的操作，它好在可以自定义长度而不用使用多个&nbsp; 但是需要注意，这里只能使用text组件，其他的组件没有效果 -->
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'c5'</span>></span><span class="hljs-tag"><<span class="hljs-name">text</span> ></span>我是c5我有4个空格啊<span class="hljs-tag"><<span class="hljs-name">text</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">'display:inline-block;width:150px'</span>></span><span class="hljs-tag"></<span class="hljs-name">text</span>></span>啊<span class="hljs-tag"></<span class="hljs-name">text</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d245d29c493d476b9146a665f59e83f1~tplv-k3u1fbpfcp-watermark.image" alt="20181120085702813.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-10">9. 选择照片上传</h4>
<pre><code class="hljs language-js copyable" lang="js">  <span class="hljs-comment">// 选择照片</span>
  <span class="hljs-function"><span class="hljs-title">changeImage</span>(<span class="hljs-params"></span>)</span> &#123;
    <span class="hljs-keyword">const</span> _this = <span class="hljs-built_in">this</span>;
    wx.chooseImage(&#123;
      <span class="hljs-attr">count</span>:<span class="hljs-number">1</span>,
      <span class="hljs-function"><span class="hljs-title">success</span>(<span class="hljs-params">res</span>)</span> &#123;
        <span class="hljs-keyword">const</span> tempFilePaths = res.tempFilePaths
        wx.uploadFile(&#123;
          <span class="hljs-attr">url</span>: <span class="hljs-string">`<span class="hljs-subst">$&#123;App.api_root&#125;</span>/upload`</span>, 
          <span class="hljs-attr">filePath</span>: tempFilePaths[<span class="hljs-number">0</span>],
          <span class="hljs-attr">name</span>: <span class="hljs-string">'file'</span>,
          <span class="hljs-attr">header</span>: &#123;
            <span class="hljs-string">'content-type'</span>: <span class="hljs-string">'multipart/form-data'</span>,
            <span class="hljs-attr">token</span>: wx.getStorageSync(<span class="hljs-string">'userInfo'</span>).token
          &#125;,
          <span class="hljs-attr">DATA</span>: &#123;
            <span class="hljs-attr">file</span>: tempFilePaths
          &#125;,
          <span class="hljs-attr">success</span>: <span class="hljs-function">(<span class="hljs-params">res</span>) =></span> &#123;
            <span class="hljs-keyword">const</span> data = <span class="hljs-built_in">JSON</span>.parse(res.data)
            _this.setData(&#123;
              <span class="hljs-attr">avatar</span>: data.data.full_url,
              <span class="hljs-attr">url</span>: data.data.url
            &#125;)
          &#125;
        &#125;)
      &#125;
    &#125;)
  &#125;,
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-11">10.获取滚动高度</h4>
<pre><code class="hljs language-js copyable" lang="js">wx.createSelectorQuery().select(<span class="hljs-string">'#id'</span>).boundingClientRect(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">rect</span>)</span>&#123;
      rect.id      <span class="hljs-comment">// 节点的ID</span>
      rect.dataset <span class="hljs-comment">// 节点的dataset</span>
      rect.left    <span class="hljs-comment">// 节点的左边界坐标</span>
      rect.right   <span class="hljs-comment">// 节点的右边界坐标</span>
      rect.top     <span class="hljs-comment">// 节点的上边界坐标</span>
      rect.bottom  <span class="hljs-comment">// 节点的下边界坐标</span>
      rect.width   <span class="hljs-comment">// 节点的宽度</span>
      rect.height  <span class="hljs-comment">// 节点的高度</span>
&#125;).exec()
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-12">11.下拉刷新，显示三个小点</h4>
<p>当前文件json文件：</p>
<pre><code class="hljs language-js copyable" lang="js">&#123;
  <span class="hljs-string">"usingComponents"</span>: &#123;
    <span class="hljs-string">"loadMore"</span>: <span class="hljs-string">"/components/loadMore/loadMore"</span>
  &#125;,
  <span class="hljs-string">"enablePullDownRefresh"</span>: <span class="hljs-literal">true</span>
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>app.json配置</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-string">"window"</span>: &#123;
    <span class="hljs-string">"navigationBarBackgroundColor"</span>: <span class="hljs-string">"#fff"</span>
  &#125;,
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-13">自定义组件，提高代码复用性</h3>
<h4 data-id="heading-14">1.底部弹窗组件</h4>
<p>父组件json修改：</p>
<pre><code class="hljs language-js copyable" lang="js">&#123;
  <span class="hljs-string">"usingComponents"</span>: &#123;
    <span class="hljs-string">"modal"</span>: <span class="hljs-string">"/components/modal/modal"</span>
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>父组件html:</p>
<pre><code class="hljs language-js copyable" lang="js"><modal id=<span class="hljs-string">"cancelOrder"</span> closeAble title=<span class="hljs-string">"标题"</span>>
内容
</modal>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>js代码：</p>
<pre><code class="hljs language-js copyable" lang="js">Component(&#123;
  <span class="hljs-attr">options</span>: &#123;
    <span class="hljs-attr">styleIsolation</span>: <span class="hljs-string">'apply-shared'</span>
  &#125;,
  <span class="hljs-attr">data</span>:&#123;
    <span class="hljs-attr">hideModal</span>:<span class="hljs-literal">true</span>, <span class="hljs-comment">//模态框的状态  true-隐藏  false-显示</span>
    <span class="hljs-attr">animationData</span>:&#123;&#125;,<span class="hljs-comment">//</span>
  &#125;,
  <span class="hljs-attr">properties</span>:&#123;
    <span class="hljs-comment">// 标题</span>
    <span class="hljs-attr">title</span>:&#123;
      <span class="hljs-attr">type</span>:<span class="hljs-built_in">String</span>,
      <span class="hljs-attr">value</span>:<span class="hljs-string">''</span>
    &#125;,
    <span class="hljs-comment">// 是否显示×按钮</span>
    <span class="hljs-attr">closeAble</span>:&#123;
    <span class="hljs-attr">type</span>:<span class="hljs-built_in">Boolean</span>,
    <span class="hljs-attr">value</span>:<span class="hljs-literal">false</span>,<span class="hljs-comment">//是否显示右上角关闭按钮</span>
    &#125;
  &#125;,
<span class="hljs-attr">methods</span>:&#123;
  <span class="hljs-comment">// 显示遮罩层</span>
  <span class="hljs-attr">showModal</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-keyword">var</span> that=<span class="hljs-built_in">this</span>;
    that.setData(&#123;
      <span class="hljs-attr">hideModal</span>:<span class="hljs-literal">false</span>
    &#125;)
    <span class="hljs-keyword">var</span> animation = wx.createAnimation(&#123;
      <span class="hljs-attr">duration</span>: <span class="hljs-number">600</span>,<span class="hljs-comment">//动画的持续时间 默认400ms   数值越大，动画越慢   数值越小，动画越快</span>
      <span class="hljs-attr">timingFunction</span>: <span class="hljs-string">'ease'</span>,<span class="hljs-comment">//动画的效果 默认值是linear</span>
    &#125;)
    <span class="hljs-built_in">this</span>.animation = animation 
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
      that.fadeIn();<span class="hljs-comment">//调用显示动画</span>
    &#125;,<span class="hljs-number">200</span>)   
  &#125;,
  
  <span class="hljs-comment">// 隐藏遮罩层</span>
  <span class="hljs-attr">hideModal</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-keyword">var</span> that=<span class="hljs-built_in">this</span>; 
    <span class="hljs-keyword">var</span> animation = wx.createAnimation(&#123;
      <span class="hljs-attr">duration</span>: <span class="hljs-number">800</span>,<span class="hljs-comment">//动画的持续时间 默认400ms   数值越大，动画越慢   数值越小，动画越快</span>
      <span class="hljs-attr">timingFunction</span>: <span class="hljs-string">'ease'</span>,<span class="hljs-comment">//动画的效果 默认值是linear</span>
    &#125;)
    <span class="hljs-built_in">this</span>.animation = animation
    that.fadeDown();<span class="hljs-comment">//调用隐藏动画   </span>
    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
      that.setData(&#123;
        <span class="hljs-attr">hideModal</span>:<span class="hljs-literal">true</span>
      &#125;,<span class="hljs-function">()=></span>&#123;
        that.triggerEvent(<span class="hljs-string">"hideModal"</span>);
      &#125;)      
    &#125;,<span class="hljs-number">400</span>)<span class="hljs-comment">//先执行下滑动画，再隐藏模块</span>
    
  &#125;,
  
  <span class="hljs-comment">//动画集</span>
  <span class="hljs-attr">fadeIn</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-built_in">this</span>.animation.translateY(<span class="hljs-number">0</span>).step()
    <span class="hljs-built_in">this</span>.setData(&#123;
      <span class="hljs-attr">animationData</span>: <span class="hljs-built_in">this</span>.animation.export()<span class="hljs-comment">//动画实例的export方法导出动画数据传递给组件的animation属性</span>
    &#125;)    
  &#125;,
  <span class="hljs-attr">fadeDown</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-built_in">this</span>.animation.translateY(<span class="hljs-number">300</span>).step()
    <span class="hljs-built_in">this</span>.setData(&#123;
      <span class="hljs-attr">animationData</span>: <span class="hljs-built_in">this</span>.animation.export(),  
    &#125;)
  &#125;,
  <span class="hljs-attr">preventTouchMove</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;
    <span class="hljs-keyword">return</span>;
  &#125;
&#125;
&#125;)

<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxml代码：</p>
<pre><code class="hljs language-js copyable" lang="js"><view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"modals modals-bottom-dialog"</span> hidden=<span class="hljs-string">"&#123;&#123;hideModal&#125;&#125;"</span> >
    <span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"modals-cancel"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"hideModal"</span>  <span class="hljs-attr">catchtouchmove</span>=<span class="hljs-string">"preventTouchMove"</span>  ></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
    <span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"bottom-dialog-body bottom-pos"</span> <span class="hljs-attr">animation</span>=<span class="hljs-string">"&#123;&#123;animationData&#125;&#125;"</span>></span>
        <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"title"</span> <span class="hljs-attr">hidden</span>=<span class="hljs-string">"&#123;&#123;!title&#125;&#125;"</span> ></span>&#123;&#123;title&#125;&#125;<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
        <span class="hljs-tag"><<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/images/icon/guanbi.png"</span> <span class="hljs-attr">hidden</span>=<span class="hljs-string">"&#123;&#123;!closeAble&#125;&#125;"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"hideModal"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"closeAble"</span>></span><span class="hljs-tag"></<span class="hljs-name">image</span>></span>
       <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"body-content"</span> <span class="hljs-attr">catchtouchmove</span>=<span class="hljs-string">"preventTouchMove"</span>></span>
        <span class="hljs-tag"><<span class="hljs-name">slot</span>></span><span class="hljs-tag"></<span class="hljs-name">slot</span>></span>
       <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
</view>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxss样式：</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/*模态框*/</span>
.modals &#123;
  <span class="hljs-attr">position</span>: fixed;
  z-index: <span class="hljs-number">999</span>;
  top: <span class="hljs-number">0</span>;
  left: <span class="hljs-number">0</span>;
  right: <span class="hljs-number">0</span>;
  bottom: <span class="hljs-number">0</span>;
&#125;

.modals-cancel &#123;
  <span class="hljs-attr">position</span>: absolute;
  z-index: <span class="hljs-number">1000</span>;
  top: <span class="hljs-number">0</span>;
  left: <span class="hljs-number">0</span>;
  right: <span class="hljs-number">0</span>;
  bottom: <span class="hljs-number">0</span>;
  background-color: rgba(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">.5</span>);
  overflow:hidden !important;
&#125;

.bottom-dialog-body &#123;
  border-radius: 16rpx 16rpx 0px 0px;
  position: absolute;
  z-index: <span class="hljs-number">10001</span>;
  bottom: <span class="hljs-number">0</span>;
  left: <span class="hljs-number">0</span>;
  right: <span class="hljs-number">0</span>;
  <span class="hljs-comment">/* padding: 30rpx; */</span>
  min-height: 100rpx;
  max-height:<span class="hljs-number">100</span>%;
  background-color: #fff;
&#125;
.body-content&#123;
  <span class="hljs-attr">padding</span>: 40rpx 20rpx;
  position: relative;
&#125;
.title&#123;
  <span class="hljs-attr">width</span>: calc (<span class="hljs-number">100</span>% - 50rpx );
  text-align: center;
  font-size:28rpx;
  line-height: 40rpx;
  font-weight: <span class="hljs-number">800</span>;
  border-bottom:1px solid #f5f5f5;
  padding: 30rpx;
&#125;
.closeAble&#123;
  <span class="hljs-attr">width</span>: 30rpx;
  height: 30rpx;
position: absolute;
top:35rpx;
right: 30rpx;
z-index: <span class="hljs-number">1</span>;
&#125;
<span class="hljs-comment">/*动画前初始位置*/</span>
.bottom-pos &#123;
  -webkit-transform: translateY(<span class="hljs-number">100</span>%);
  transform: translateY(<span class="hljs-number">100</span>%);
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>父组件想控制自定义底部弹窗，需要wxml里给个id（modal），js中的attached函数进行获取id：this.modal = this.selectComponent(<code>#modal</code>);，往后就可以进行调用自定义组件内的函数，进行操控。</p>
<h4 data-id="heading-15">2.头部组件</h4>
<p>组件原理具体参考<a href="https://segmentfault.com/a/1190000018733860" target="_blank" rel="nofollow noopener noreferrer">小程序自定义导航栏适配（完美版）</a>，在这就不描述了</p>
<p>父组件json修改：</p>
<pre><code class="hljs language-js copyable" lang="js">&#123;
  <span class="hljs-string">"usingComponents"</span>: &#123;
    <span class="hljs-string">"navigation"</span>: <span class="hljs-string">"/components/navigation/navigation"</span>
  &#125;,
    <span class="hljs-string">"navigationStyle"</span>: <span class="hljs-string">"custom"</span>
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>父组件wxml：</p>
<pre><code class="hljs language-js copyable" lang="js"><navigation bind:back=<span class="hljs-string">'navToBack'</span> customBack=<span class="hljs-string">"true"</span> backIcon=<span class="hljs-string">'/images/icon/fanghui_hei@2x.png'</span> titleText =<span class="hljs-string">'我的积分'</span>>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>js代码：</p>
<pre><code class="hljs language-js copyable" lang="js">Component(&#123;
    <span class="hljs-attr">properties</span>: &#123;
        <span class="hljs-attr">background</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">'rgba(255, 255, 255, 1)'</span>
        &#125;,
        <span class="hljs-attr">color</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">'rgba(0, 0, 0, 1)'</span>
        &#125;,
        <span class="hljs-attr">mainColor</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">'#fff'</span>
        &#125;,
        <span class="hljs-attr">titleText</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">''</span>
        &#125;,
        <span class="hljs-attr">titleArray</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">Array</span>,
            <span class="hljs-attr">value</span>: [],
            <span class="hljs-function"><span class="hljs-title">observer</span>(<span class="hljs-params">newsProps</span>)</span> &#123;
                <span class="hljs-built_in">this</span>.setData(&#123;
                    <span class="hljs-attr">type</span>: newsProps[<span class="hljs-number">0</span>].type
                &#125;)
            &#125;
        &#125;,
        <span class="hljs-attr">titleImg</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">''</span>
        &#125;,
        <span class="hljs-attr">backIcon</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">'/images/icon/fanghui_hei@2x.png'</span>
        &#125;,
        <span class="hljs-attr">homeIcon</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-string">''</span>
        &#125;,
        <span class="hljs-attr">fontSize</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-number">16</span>
        &#125;,
        <span class="hljs-attr">iconHeight</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-number">19</span>
        &#125;,
        <span class="hljs-attr">iconWidth</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,
            <span class="hljs-attr">value</span>: <span class="hljs-number">58</span>
        &#125;,
        <span class="hljs-attr">customBack</span>: &#123;
            <span class="hljs-attr">type</span>: <span class="hljs-built_in">Boolean</span>,
            <span class="hljs-attr">value</span>:<span class="hljs-literal">false</span>
        &#125;
    &#125;,
    <span class="hljs-attr">attached</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-keyword">var</span> that = <span class="hljs-built_in">this</span>;
        that.setNavSize();
        that.setStyle();
    &#125;,
    <span class="hljs-attr">data</span>: &#123;
        <span class="hljs-attr">type</span>: <span class="hljs-string">''</span><span class="hljs-comment">//当前默认选中</span>
    &#125;,
    <span class="hljs-attr">methods</span>: &#123;
        <span class="hljs-comment">// 通过获取系统信息计算导航栏高度        </span>
        <span class="hljs-attr">setNavSize</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
            <span class="hljs-keyword">var</span> that = <span class="hljs-built_in">this</span>
                , sysinfo = wx.getSystemInfoSync()
                , statusHeight = sysinfo.statusBarHeight
                , isiOS = sysinfo.system.indexOf(<span class="hljs-string">'iOS'</span>) > -<span class="hljs-number">1</span>
                , navHeight;
            <span class="hljs-keyword">if</span> (!isiOS) &#123;
                navHeight = <span class="hljs-number">48</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                navHeight = <span class="hljs-number">44</span>;
            &#125;
            that.setData(&#123;
                <span class="hljs-attr">status</span>: statusHeight,
                <span class="hljs-attr">navHeight</span>: navHeight
            &#125;)
        &#125;,
        <span class="hljs-attr">setStyle</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
            <span class="hljs-keyword">var</span> that = <span class="hljs-built_in">this</span>
                , containerStyle
                , textStyle
                , iconStyle;
            containerStyle = [
                <span class="hljs-string">'background:'</span> + that.data.background
            ].join(<span class="hljs-string">';'</span>);
            textStyle = [
                <span class="hljs-string">'color:'</span> + that.data.color,
                <span class="hljs-string">'font-size:'</span> + that.data.fontSize + <span class="hljs-string">'px'</span>
            ].join(<span class="hljs-string">';'</span>);
            iconStyle = [
                <span class="hljs-string">'width: '</span> + that.data.iconWidth + <span class="hljs-string">'px'</span>,
                <span class="hljs-string">'height: '</span> + that.data.iconHeight + <span class="hljs-string">'px'</span>
            ].join(<span class="hljs-string">';'</span>);
            that.setData(&#123;
                <span class="hljs-attr">containerStyle</span>: containerStyle,
                <span class="hljs-attr">textStyle</span>: textStyle,
                <span class="hljs-attr">iconStyle</span>: iconStyle
            &#125;)
        &#125;,
        <span class="hljs-comment">// 返回事件        </span>
        <span class="hljs-attr">back</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
            <span class="hljs-keyword">if</span>(<span class="hljs-built_in">this</span>.properties.customBack)&#123;
                <span class="hljs-built_in">this</span>.triggerEvent(<span class="hljs-string">'back'</span>)
            &#125;<span class="hljs-keyword">else</span>&#123;
                wx.navigateBack(&#123;
                  <span class="hljs-attr">delta</span>: <span class="hljs-number">1</span>
                &#125;)
            &#125;
        &#125;,
        <span class="hljs-attr">home</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
            <span class="hljs-built_in">this</span>.triggerEvent(<span class="hljs-string">'home'</span>, &#123;&#125;);
        &#125;,
        <span class="hljs-comment">// 切换tab</span>
        <span class="hljs-function"><span class="hljs-title">switchTab</span>(<span class="hljs-params">e</span>)</span> &#123;
            <span class="hljs-keyword">const</span> &#123; type &#125; = e.currentTarget.dataset;
            <span class="hljs-built_in">this</span>.setData(&#123;
                type
            &#125;)
            <span class="hljs-built_in">this</span>.triggerEvent(<span class="hljs-string">'switchTab'</span>,type)
        &#125;
    &#125;
&#125;)



<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxml代码：</p>
<pre><code class="hljs language-js copyable" lang="js"><view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">'nav'</span> style=<span class="hljs-string">"height: &#123;&#123;status + navHeight&#125;&#125;px;background-color: &#123;&#123;mainColor?mainColor:'#fff'&#125;&#125;"</span>>
  <span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'status'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'height: &#123;&#123;status&#125;&#125;px;&#123;&#123;containerStyle&#125;&#125;'</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
  <span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'navbar'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'height: &#123;&#123; navHeight&#125;&#125;px'</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'back-icon'</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"&#123;&#123;backIcon&#125;&#125;"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">'back'</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'&#123;&#123;backIcon&#125;&#125;'</span>></span><span class="hljs-tag"></<span class="hljs-name">image</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'home-icon'</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"&#123;&#123;homeIcon&#125;&#125;"</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">'home'</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'&#123;&#123;homeIcon&#125;&#125;'</span>></span><span class="hljs-tag"></<span class="hljs-name">image</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'nav-icon'</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"&#123;&#123;titleImg&#125;&#125;"</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">image</span> <span class="hljs-attr">src</span>=<span class="hljs-string">'&#123;&#123;titleImg&#125;&#125;'</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'&#123;&#123;iconStyle&#125;&#125;'</span>></span><span class="hljs-tag"></<span class="hljs-name">image</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'nav-title'</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"&#123;&#123;titleText && !titleImg&#125;&#125;"</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">'&#123;&#123;textStyle&#125;&#125;'</span>></span>&#123;&#123;titleText&#125;&#125;<span class="hljs-tag"></<span class="hljs-name">text</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'nav-title-tab'</span> <span class="hljs-attr">wx:if</span>=<span class="hljs-string">"&#123;&#123;titleArray && !titleImg&&!titleText&#125;&#125;"</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"switchTab"</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">'&#123;&#123;textStyle&#125;&#125;'</span> <span class="hljs-attr">data-type</span>=<span class="hljs-string">"&#123;&#123;item.type&#125;&#125;"</span> <span class="hljs-attr">wx:for</span>=<span class="hljs-string">"&#123;&#123;titleArray&#125;&#125;"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">" title-tab &#123;&#123;type===item.type?'active':''&#125;&#125;"</span>></span>
&#123;&#123;item.text&#125;&#125;
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
  <span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
</view>
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span>  <span class="hljs-attr">style</span>=<span class="hljs-string">'height: &#123;&#123;status + navHeight&#125;&#125;px'</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxss样式：</p>
<pre><code class="hljs language-js copyable" lang="js">.nav &#123;
  <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>%;
  position: fixed;
  left: 0rpx;
  top: 0rpx;

  z-index: <span class="hljs-number">1</span>;
&#125;

.navbar &#123;
  <span class="hljs-attr">position</span>: relative;
&#125;

.back-icon,
.home-icon &#123;
  <span class="hljs-attr">width</span>: 28px;
  height: <span class="hljs-number">100</span>%;
  position: absolute;
  transform: translateY(-<span class="hljs-number">50</span>%);
  top: <span class="hljs-number">50</span>%;
  display: flex;
&#125;

.back-icon &#123;
  <span class="hljs-attr">left</span>: 16px;
&#125;

.home-icon &#123;
  <span class="hljs-attr">left</span>: 44px
&#125;

.back-icon image &#123;
  <span class="hljs-attr">width</span>: 44rpx;
  height: 44rpx;
  margin: auto;
&#125;

.home-icon image &#123;
  <span class="hljs-attr">width</span>: 20px;
  height: 20px;
  margin: auto;
&#125;

.nav-title,
.nav-icon &#123;
  <span class="hljs-attr">position</span>: absolute;
  transform: translate(-<span class="hljs-number">50</span>%, -<span class="hljs-number">50</span>%);
  left: 100px;
  top: <span class="hljs-number">50</span>%;
  font-size: <span class="hljs-number">0</span>;
&#125;

<span class="hljs-comment">/* 切换tab */</span>
.nav-title-tab &#123;
  <span class="hljs-attr">width</span>: <span class="hljs-number">68</span>%;
margin-left: 70rpx;
  height: <span class="hljs-number">100</span>%;
  display: flex;
  justify-content: center;
  align-items: center;
&#125;

.title-tab &#123;
  <span class="hljs-attr">position</span>: relative;
  padding: 10rpx;
&#125;

.active::after &#123;
  <span class="hljs-attr">content</span>: <span class="hljs-string">''</span>;
  position: absolute;
  width: 24rpx;
  height: 6rpx;
  bottom: 0rpx;
  left: calc(<span class="hljs-number">50</span>% - 12rpx);
  background-size: <span class="hljs-number">100</span>% <span class="hljs-number">100</span>%;
  background: url(<span class="hljs-string">'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAGCAYAAAA2aTUtAAAA/klEQVQoU3WSSU7DQBBFX3VLSAwnS9bmCnARlnCaSLlMtrAgSEzCdozchb4rjY0UFq2qHlyv/i+bN80ZbXsHNMAFMAAH3PspmvW4d5h1QET3dsqhpZQes6/jue7iHD7Iecdm82S+Wt1jdov7N2YD7odjcT1WHsXjw2UR7VtSihjgmneU0pHzGznvzdfrPXCJ+/ALCVhVUiHaq9gMDHUVEApTikYESemdcSxS8ozZ1UmIrALZJUsCNncs6+bOawNLiJSUUqTkAbiZZiHLwiLNQkUDsrRsVnLaLt1rCQavuL/YYvDXwPmfwYcS/QTqOuz6f/BSPCvL+ZNx3LHdPv4A9RPu5WDz5hwAAAAASUVORK5CYII='</span>);
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-16">3.密码输入</h4>
<pre><code class="hljs language-js copyable" lang="js">&#123;
  <span class="hljs-string">"usingComponents"</span>: &#123;
    <span class="hljs-string">"inputFrame"</span>: <span class="hljs-string">"/components/inputFrame/inputFrame"</span>
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>父组件wxml：</p>
<pre><code class="hljs language-js copyable" lang="js"><inputFrame
  value=<span class="hljs-string">""</span>
  plaintext
  focus=<span class="hljs-string">"&#123;&#123; true &#125;&#125;"</span>
  <span class="hljs-attr">bind</span>:finished=<span class="hljs-string">"onFinished"</span>
  id=<span class="hljs-string">"input-frame"</span>
/>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>js代码：</p>
<pre><code class="hljs language-js copyable" lang="js">
Component(&#123;
  <span class="hljs-attr">externalClasses</span>: [<span class="hljs-string">'custom-class'</span>],
  <span class="hljs-attr">options</span>: &#123;
    <span class="hljs-attr">styleIsolation</span>: <span class="hljs-string">'shared'</span>
  &#125;,
  <span class="hljs-attr">properties</span>: &#123;
    <span class="hljs-attr">plaintext</span>: <span class="hljs-built_in">Boolean</span>,
    <span class="hljs-attr">value</span>: <span class="hljs-built_in">String</span>,
    <span class="hljs-attr">focus</span>: <span class="hljs-built_in">Boolean</span>,
    <span class="hljs-comment">// divider</span>
    <span class="hljs-attr">frameStyle</span>: <span class="hljs-built_in">String</span>,
    <span class="hljs-attr">space</span>: &#123;
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">Number</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-number">6</span>
    &#125;
  &#125;,
  <span class="hljs-attr">data</span>: &#123;
    <span class="hljs-attr">_value</span>: <span class="hljs-string">''</span>,
    <span class="hljs-attr">valueList</span>: [],
    <span class="hljs-attr">cursor</span>: <span class="hljs-number">99</span>,
    <span class="hljs-attr">isFocus</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">height</span>:<span class="hljs-string">''</span><span class="hljs-comment">//软键盘出来，输入框距离底部的距离</span>
  &#125;,
  <span class="hljs-attr">lifetimes</span>: &#123;
    <span class="hljs-attr">attached</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
      <span class="hljs-built_in">this</span>.setData(&#123;
        <span class="hljs-attr">isFocus</span>: <span class="hljs-built_in">this</span>.properties.focus,
        <span class="hljs-attr">_value</span>: <span class="hljs-built_in">this</span>.properties.value
      &#125;);
      <span class="hljs-built_in">this</span>.init();
      <span class="hljs-built_in">this</span>.setCursorPosition();
    &#125;
  &#125;,
  <span class="hljs-attr">methods</span>: &#123;
    <span class="hljs-attr">init</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
      <span class="hljs-keyword">var</span> value = <span class="hljs-built_in">this</span>.data._value;
      <span class="hljs-keyword">var</span> plaintext = <span class="hljs-built_in">this</span>.properties.plaintext;
      <span class="hljs-keyword">if</span> (!plaintext) &#123;
        value = value.replace(<span class="hljs-regexp">/./igm</span>, <span class="hljs-string">'●'</span>);
      &#125;
      <span class="hljs-built_in">this</span>.setData(&#123; <span class="hljs-attr">valueList</span>: value.split(<span class="hljs-string">''</span>) &#125;);
    &#125;,
    <span class="hljs-attr">setCursorPosition</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
      <span class="hljs-built_in">this</span>.setData(&#123; <span class="hljs-attr">cursor</span>: <span class="hljs-built_in">this</span>.data._value.length &#125;);
    &#125;,
    <span class="hljs-attr">onClick</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">value</span>) </span>&#123;
      <span class="hljs-built_in">this</span>.setData(&#123; <span class="hljs-attr">isFocus</span>: value &#125;);
      wx.onKeyboardHeightChange(<span class="hljs-function"><span class="hljs-params">res</span> =></span> &#123;
        <span class="hljs-built_in">this</span>.setData(&#123;
        <span class="hljs-attr">height</span>:res.height*<span class="hljs-number">2</span>+<span class="hljs-number">40</span>
      &#125;)
      &#125;)
    &#125;,
    <span class="hljs-attr">onInputChange</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;
      <span class="hljs-keyword">var</span> value = e.detail.value;
      <span class="hljs-keyword">var</span> space = <span class="hljs-built_in">this</span>.properties.space;
      <span class="hljs-built_in">this</span>.setData(&#123; <span class="hljs-attr">_value</span>: value &#125;);
      <span class="hljs-built_in">this</span>.triggerEvent(<span class="hljs-string">'change'</span>, value);
      <span class="hljs-built_in">this</span>.init();

      <span class="hljs-keyword">if</span> (value.length >= space) &#123;
        <span class="hljs-built_in">this</span>.triggerEvent(<span class="hljs-string">'finished'</span>, value);
      &#125;
    &#125;,
    <span class="hljs-attr">onInputFocus</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
      <span class="hljs-built_in">this</span>.setCursorPosition();
    &#125;,
    <span class="hljs-attr">getValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
      <span class="hljs-keyword">var</span> number = <span class="hljs-built_in">this</span>.properties.space;
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">this</span>.data._value.slice(<span class="hljs-number">0</span>, number);
    &#125;,
    <span class="hljs-attr">setValue</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">v</span>) </span>&#123;
      <span class="hljs-keyword">if</span> (v == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span>;

      v = <span class="hljs-built_in">String</span>(v);
      <span class="hljs-built_in">this</span>.setData(&#123; <span class="hljs-attr">_value</span>: v &#125;);
      <span class="hljs-built_in">this</span>.init();
    &#125;,
    <span class="hljs-comment">// bindkeyboardheightchange:function(v)&#123;</span>
    <span class="hljs-comment">//   const &#123;height&#125;=v.detail;</span>
    <span class="hljs-comment">//   this.setData(&#123;</span>
    <span class="hljs-comment">//     height:height*2+40</span>
    <span class="hljs-comment">//   &#125;)</span>
    <span class="hljs-comment">// &#125;</span>
  &#125;
&#125;)

<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxml代码：</p>
<pre><code class="hljs language-js copyable" lang="js"><view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"input-frame custom-class &#123;&#123; frameStyle &#125;&#125;"</span>  style=<span class="hljs-string">"margin-bottom:&#123;&#123;height&#125;&#125;rpx"</span>>
  <!-- hide -->
  <span class="xml"><span class="hljs-tag"><<span class="hljs-name">input</span> 
    <span class="hljs-attr">type</span>=<span class="hljs-string">"text"</span> 
    <span class="hljs-attr">class</span>=<span class="hljs-string">"input-frame-input"</span> 
    <span class="hljs-attr">value</span>=<span class="hljs-string">"&#123;&#123; _value &#125;&#125;"</span> 
    <span class="hljs-attr">maxlength</span>=<span class="hljs-string">"&#123;&#123; space &#125;&#125;"</span>
    <span class="hljs-attr">cursor</span>=<span class="hljs-string">"&#123;&#123; cursor &#125;&#125;"</span>
    <span class="hljs-attr">focus</span>=<span class="hljs-string">"&#123;&#123; isFocus &#125;&#125;"</span>
    <span class="hljs-attr">type</span>=<span class="hljs-string">"number"</span>
    <span class="hljs-attr">bind:input</span>=<span class="hljs-string">"onInputChange"</span>
    <span class="hljs-attr">bind:focus</span>=<span class="hljs-string">"onInputFocus"</span>
    <span class="hljs-attr">bindkeyboardheightchange</span>=<span class="hljs-string">"bindkeyboardheightchange"</span>
    <span class="hljs-attr">adjust-position</span>=<span class="hljs-string">"&#123;&#123;false&#125;&#125;"</span>
    <span class="hljs-attr">hold-keyboard</span>=<span class="hljs-string">"&#123;&#123;true&#125;&#125;"</span>
  /></span></span>

  <!-- input -->
  <span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span> 
    <span class="hljs-attr">class</span>=<span class="hljs-string">"input-item &#123;&#123;(!valueList.length&&index===0)||(valueList.length&&index===valueList.length&&valueList.length<6)?'active':''&#125;&#125;"</span> 
    <span class="hljs-attr">bind:tap</span>=<span class="hljs-string">"onClick"</span> 
    <span class="hljs-attr">wx:for</span>=<span class="hljs-string">"&#123;&#123; space &#125;&#125;"</span> 
    <span class="hljs-attr">wx:key</span>=<span class="hljs-string">"index"</span>
  ></span>
  <span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">hidden</span>=<span class="hljs-string">"&#123;&#123;!valueList[index]&#125;&#125;"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"status-point"</span>></span><span class="hljs-tag"></<span class="hljs-name">view</span>></span>
  <span class="hljs-tag"></<span class="hljs-name">view</span>></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>

<span class="copy-code-btn">复制代码</span></code></pre>
<p>wxss代码：</p>
<pre><code class="hljs language-js copyable" lang="js">.input-frame &#123;
  <span class="hljs-comment">/* position: relative; */</span>
  <span class="hljs-attr">display</span>: flex;
  justify-content: space-around;
  width: <span class="hljs-number">94</span>%;
  margin: <span class="hljs-number">0</span> auto;
&#125;

.input-frame .input-item &#123;
  border-radius: 16rpx;
  width: 100rpx;
  height: 100rpx;
  display: flex;
  justify-content: center;
  align-items: center;
  border: 1px solid #ccc;
&#125;
.input-frame  .active&#123;
border-color: #f995a2;
&#125;

.input-frame-input &#123;
  <span class="hljs-attr">position</span>: absolute;
  top: <span class="hljs-number">0</span>;
  left: <span class="hljs-number">0</span>;
  right: <span class="hljs-number">0</span>;
  bottom: <span class="hljs-number">0</span>;
  width: <span class="hljs-number">100</span>%;
  height: <span class="hljs-number">100</span>%;
  opacity: <span class="hljs-number">0</span>;
  <span class="hljs-comment">/* left: -5000px; */</span>
&#125;

<span class="hljs-comment">/* .input-frame .input-item:not(:nth-last-child(1)) &#123;
  border-right-color: transparent;
&#125; */</span>

<span class="hljs-comment">/* divider style */</span>
.input-frame.divider .input-item &#123;
  border-top-color: transparent;
  border-right-color: transparent;
  border-left-color: transparent;
  margin: <span class="hljs-number">0</span> 7px;
  width: 40px;
  height: 40px;
&#125;

.status-point &#123;
  <span class="hljs-attr">display</span>: inline-block;
  width: 20rpx;
  height: 20rpx;
  border-radius: <span class="hljs-number">50</span>%;
  background-color: black;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-17">end</h3>
<p>网上的帖子大多深浅不一，甚至有些前后矛盾，在下的文章都是学习过程中的总结，如果发现错误，欢迎留言指出~</p></div>  
</div>
            