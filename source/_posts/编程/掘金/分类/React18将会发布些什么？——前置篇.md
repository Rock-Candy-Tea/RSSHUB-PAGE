
---
title: 'React18将会发布些什么？——前置篇'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://picsum.photos/400/300?random=3538'
author: 掘金
comments: false
date: Tue, 06 Jul 2021 18:48:33 GMT
thumbnail: 'https://picsum.photos/400/300?random=3538'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%&#125;.markdown-body p&#123;color:#595959;font-size:15px;line-height:2;font-weight:400&#125;.markdown-body p+p&#123;margin-top:16px&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;padding:30px 0;margin:0;color:#135ce0&#125;.markdown-body h1&#123;position:relative;text-align:center;font-size:22px;margin:50px 0&#125;.markdown-body h1:before&#123;position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)&#125;.markdown-body h2&#123;position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0&#125;.markdown-body h3&#123;font-size:16px&#125;.markdown-body ul&#123;list-style:disc outside;margin-left:2em;margin-top:1em&#125;.markdown-body li&#123;line-height:2;color:#595959&#125;.markdown-body img.loaded&#123;margin:0 auto;display:block&#125;.markdown-body blockquote&#123;background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5&#125;.markdown-body blockquote p&#123;color:#666;line-height:2&#125;.markdown-body a&#123;color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none&#125;.markdown-body em strong,.markdown-body strong&#123;color:#036aca&#125;.markdown-body hr&#123;border-top:1px solid #135ce0&#125;.markdown-body pre&#123;overflow:auto&#125;.markdown-body code,.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body table&#123;border-collapse:collapse;margin:1rem 0;overflow-x:auto&#125;.markdown-body table td,.markdown-body table th&#123;border:1px solid #dfe2e5;padding:.6em 1em&#125;.markdown-body table tr&#123;border-top:1px solid #dfe2e5&#125;.markdown-body table tr:nth-child(2n)&#123;background-color:#f6f8fa&#125;</style><h2 data-id="heading-0">写在前面：</h2>
<blockquote>
<p>本文源于个人对 React 的兴趣，听闻 React18 的新消息非常开心。但遍历了中文社区之后，其实都是一些总结性的文章，看完之后个人还是处于云里雾里的状态。因此还是自己去翻看了 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions" ref="nofollow noopener noreferrer">Discuss</a>，发现英文原文写的非常好，通俗易懂。所以决定在阅读过程中将它们翻译出来，但个人还是更希望大家去看原文，贴近社区。</p>
</blockquote>
<h2 data-id="heading-1">系列：</h2>
<ol>
<li><a href="https://juejin.cn/post/6982167430093078559/" target="_blank" title="https://juejin.cn/post/6982167430093078559/">React18将会发布些什么？—— 自动批处理篇</a></li>
</ol>
<h2 data-id="heading-2">正文：</h2>
<h3 data-id="heading-3">开箱即用的提升（升级到18即可获得的能力）:</h3>
<ol>
<li>自动批处理（Automactic batching for fewer renders）。</li>
<li>Suspense 组件的 SSR 支持。</li>
<li>修复 Suspense 组件的奇怪行为。</li>
</ol>
<p>以上的能力只用将React版本升级到18并且使用 <strong>New Root API</strong> 来挂载根节点即可获得。</p>
<hr>
<h3 data-id="heading-4">Concurrent Features</h3>
<p>React18 是第一个选择性的提供了 concurrent 特性的版本，由以下几个api组成：</p>
<ul>
<li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F41" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/41" ref="nofollow noopener noreferrer">startTransition</a></strong>: 当你的应用处于很重的状态计算渲染的过程中的时候，让你的界面依然能够保持可交互。</li>
<li><strong>useDeferredValue</strong>: 让你可以选择界面中不那么重要的部分延迟渲染。</li>
<li><code><SuspenseList /></code>： 让你决定组件渲染并显示的顺序。</li>
<li><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F37" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/37" ref="nofollow noopener noreferrer">Streaming SSR with selective hydration</a></strong>: 在SSR的场景中能够让你的页面更快的进入可交互状态。</li>
</ul>
<p>你可以在你的应用中小范围的尝试使用这些特性，而不需要为整个应用都套上<code><StrictMode></code>。</p>
<p><em>注意：如果你比较熟悉 Concurrent Mode，你可以看看这篇文章：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F64" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/64" ref="nofollow noopener noreferrer">What happened to concurrent "mode"</a></em></p>
<hr>
<h3 data-id="heading-5">那有关在Suspense中做数据取回的部分呢？</h3>
<p>在 React18 中发布了一些跟<code>Suspense</code>相关的基础性工作，但这其中还暂时没有包括数据取回部分的最佳实践。我们认为，完整的解决方案应该包含 <a href="https://link.juejin.cn/?target=https%3A%2F%2Freactjs.org%2Fblog%2F2020%2F12%2F21%2Fdata-fetching-with-react-server-components.html" target="_blank" rel="nofollow noopener noreferrer" title="https://reactjs.org/blog/2020/12/21/data-fetching-with-react-server-components.html" ref="nofollow noopener noreferrer">Server Component</a> 和 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F25" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/25" ref="nofollow noopener noreferrer">built-in Cache</a>，但是这些工作仍然在进行当中。所有，我们也许会在 18.x 的某一个版本中跟它见面，这一次的 18.0 并不会有这一部分的特性。</p>
<hr>
<h3 data-id="heading-6">如何升级呢？</h3>
<p>无论你正在使用 React16 还是 React17，升级到 React18 都是一样的操作（只需要把根据节点的渲染方式从<code>ReactDOM.render</code>替换成<code>ReactDOM.createRoot</code>）。在升级之后，我们推荐你重新全面测试一下你的应用，以便你能够着手解决因为一些「开箱即用的提升」带来的问题。</p>
<p>对于进一步的升级明细，移步：</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F6" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/6" ref="nofollow noopener noreferrer">How to upgrade to React 18 on the client</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F22" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/22" ref="nofollow noopener noreferrer">How to upgrade to React 18 on the server</a></li>
</ul>
<hr>
<h3 data-id="heading-7">更新计划</h3>
<h4 data-id="heading-8">安装 React18</h4>
<p>要安装最新的 React18 alpha 版本，要添加上<code>@alpha</code>标签：</p>
<pre><code class="hljs language-bash copyable" lang="bash">npm install react@alpha react-dom@alpha
<span class="copy-code-btn">复制代码</span></code></pre>
<p>我们没有确定具体的发布时间，但我们期望的发布线如下：</p>
<ul>
<li>React18 Alpha（现在可用）</li>
<li>React18 Public Beta（数月后）</li>
<li>React18 RC（数月后）</li>
<li>React18 （RC版本后的2-4周）</li>
</ul>
<h4 data-id="heading-9">Alpha</h4>
<p>这是 React18 最初的一个预览版本。我们相信当你看到它的时候，React18 中绝大多数的特性都已经稳定。但是，我们仍有一些需要最终敲定的API。例如：<code>useMutableSource</code>和<code>useOpaqueIdentifier</code>等。我们会在接下来的时间里持续迭代它们，并收集社区中的反馈进行最终的敲定。</p>
<p>这个阶段我们也会持续和社区中较流行的三方包作者们交流沟通，确保他们能够得到 React18 最新的支持。</p>
<p>在 Alpha 阶段，我们只希望社区中的三方包维护者们以及 React 组成员们来试用 React18 并且进行反馈。</p>
<h4 data-id="heading-10">Beta</h4>
<p>当我们所有的特性都已经完成，我们会发布 React18 Beta。这个版本中会包含最终敲定的所有新特性以及大变更，但仍可能在其中有一些未被发现的bug。</p>
<p>在这个阶段，我们会邀请更大的社区团队来试用 React18 并进行反馈，以收集并解决余下的bug。</p>
<h4 data-id="heading-11">RC</h4>
<p>一旦我们完成所有的特性，并且认为它们足够稳定能够发布了，我们就会切换到 RC。在这个版本，我们欢迎所有的开发者们来试用最新的版本，并且认为它能够运行生产版本中了。</p>
<h4 data-id="heading-12">Stable</h4>
<p>最后，我们将迎来最终发布版本～</p>
<h4 data-id="heading-13">发布标签</h4>
<p>当我们进入到某个阶段，对应的<code>tag</code>会遵循如下的格式：</p>
<ul>
<li><code>react@alpha</code>: <code>18.0.0-alpha-<sha>-<date></code></li>
<li><code>react@beta</code>: <code>18.0.0-alpha-<sha>-<date></code></li>
</ul>
<p>和我们在<code>experimental</code>标签阶段流程类似，我们会在晚上自动发布一个基于sha的带有最新变更的版本。如果你对我们的<code>next</code>流程比较熟悉，我们的工作流程其实是一模一样的，只是增加了一些更有意义的标签。</p>
<hr>
<h3 data-id="heading-14">Refs</h3>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F4" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/4" ref="nofollow noopener noreferrer">Introducing React 18</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freactwg%2Freact-18%2Fdiscussions%2F9" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reactwg/react-18/discussions/9" ref="nofollow noopener noreferrer">Installing React 18 Alpha</a></li>
</ul></div>  
</div>
            