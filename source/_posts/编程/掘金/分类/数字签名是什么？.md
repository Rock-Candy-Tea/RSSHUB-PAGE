
---
title: '数字签名是什么？'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/376b5754bd404f9e9a4aa4b6776e293d~tplv-k3u1fbpfcp-zoom-1.image'
author: 掘金
comments: false
date: Mon, 29 Mar 2021 19:02:16 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/376b5754bd404f9e9a4aa4b6776e293d~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p><strong>公钥用来加密信息，私钥用来数字签名。</strong></p>
<ol>
<li>
<p>服务器有两把钥匙，一把是<strong>公钥</strong>，另一把是<strong>私钥</strong>。</p>
<p>服务器把公钥发送给每个客户端。</p>
<p><img alt="数字签名是什么？.md 2019-09-08 21-13-58.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/376b5754bd404f9e9a4aa4b6776e293d~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
</li>
<li>
<p><strong>客户端发送消息</strong></p>
<p>客户端向服务器发送消息，将消息用公钥加密。</p>
<p>服务器收到消息后，用私钥解密，获取消息内容。</p>
<p><img alt="数字签名是什么？.md 2019-09-08 21-53-03.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c5792e391cf24e13b94a9d39e1cb66a4~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<blockquote>
<p>服务器私钥不泄露，就是安全的，即使消息被他人窃取，也无法解开。其实一般情况下，私钥也不会泄露。</p>
</blockquote>
</li>
<li>
<p><strong>服务端发送消息：数字签名</strong>(即私钥加密)</p>
<p>服务器给客户端回复消息，</p>
<ul>
<li><a href="https://www.imyangyong.com/blog/2019/09/%E5%8E%9F%E7%90%86%E6%A6%82%E5%BF%B5/Hash%20%E5%87%BD%E6%95%B0/" target="_blank" rel="nofollow noopener noreferrer">Hash 函数</a>生成消息的摘要(digest)。</li>
<li>私钥对摘要进行加密，生成 “数字签名”。</li>
</ul>
<p><img alt="未命名文件.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9bedf34ad7f74ac3bdb181b01e1ca35e~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>服务器将 <strong>数字签名</strong> ，附在消息下面，一起发给客户端。</p>
<p><img alt="未命名文件 (1) 下午11.29.36.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b720ec4203b54ea1ab22c8bb7990c399~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
</li>
<li>
<p><strong>客户端解密</strong></p>
<p>客户端收到消息后。</p>
<ul>
<li>取下数字签名，用服务器的公钥解密，得到消息的摘要。（可以解密，证明消息是服务器发出的）</li>
<li>再对消息本身使用 hash 函数，将得到的结果与上一步的摘要比对。（两者一致，就证明未被修改过）</li>
</ul>
<p><img alt="未命名文件.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4313ed5d3d064943b280b51dab895741~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
</li>
</ol>
<h1 data-id="heading-0">数字证书</h1>
<p>通过以上示例，信息交换很安全，那么为什么还需要 “<strong>数字证书</strong>(Digital Certificate)” 呢？</p>
<p>假设小明偷偷使用了你的电脑，用他自己的公钥换走了真实服务器的公钥。此时你的电脑实际拥有的是小明的公钥，但还以为是服务器的公钥。因此，小明就可以冒充服务器，用自己的私钥做成“数字签名”，发送消息给你，你会误用小明的公钥解密。后来你感觉不对劲，发现自己无法确定<code>公钥</code>是否真的属于真实服务器。</p>
<p>那么如何才能证明 <strong>公钥</strong> 是真实服务器的呢？</p>
<h2 data-id="heading-1">1. 数字证书</h2>
<p>服务器可以找“<strong>证书中心(certificate authority，简称CA)</strong>”，为公钥做公证。</p>
<p>证书中心(CA)用自己的私钥，对服务器的公钥和一些相关信息一起加密，生成“<strong>数字证书(Digital Certificate)</strong>”。</p>
<p><img alt="未命名文件.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a077571f3e1f4fdbbbf84699131e30d2~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-2">2. 附加数字证书</h2>
<p>服务器拿到数字证书以后，再给客户端发送消息，只要在签名的同时，再附上数字证书就行了。</p>
<p><img alt="未命名文件 (1).png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/264bb0d9844049d6bcd5576c533a9362~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-3">3. 客户端获取真实公钥</h2>
<p>客户端收到消息后，用CA的公钥解开数字证书，就可以拿到服务器的真实公钥了，然后就能证明“数字签名”是否真的为真实服务器所签。</p>
<p><img alt="未命名文件 (2).png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6be491178b154f47b3250ee727f16943~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<blockquote>
<p>CA都是一些可靠的大机构，它们的公钥在自己网站上提供下载，所以无法伪造。</p>
</blockquote>
<h1 data-id="heading-4">实例应用</h1>
<p>这里我们看一个“数字证书”的实例：<strong>https协议</strong>。这个协议主要用于网页加密。</p>
<p><img alt="bg2011080914.jpg" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/552eadc4e43c48a1982cbea8d3b1682f~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>客户端（浏览器）的"证书管理器"，有"受信任的根证书颁发机构"列表。客户端会根据这张列表，查看解开数字证书的公钥是否在列表之内。</p>
<p><img alt="钥匙串访问 2019-09-09 11-07-30.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c9994fff64da4013a88e246ad71c73bb~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-5">非法警告</h2>
<ol>
<li>
<p>如果数字证书记载的网址，与你正在浏览的网址不一致，就说明这张证书可能被冒用，浏览器会发出警告。</p>
<p><img alt="bg2011080918.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c9e82803d1b46c8b711964a2fb0b014~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
</li>
<li>
<p>如果这张数字证书不是由受信任的机构颁发的，浏览器会发出另一种警告。</p>
<p><img alt="bg2011080919.jpg" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65e3f5e0edb94f8b8d963f1252906b28~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
</li>
</ol>
<h1 data-id="heading-6">参考</h1>
<ol>
<li><a href="http://www.ruanyifeng.com/blog/2011/08/what_is_a_digital_signature.html" target="_blank" rel="nofollow noopener noreferrer">数字签名是什么？</a> by <a href="http://www.ruanyifeng.com/" target="_blank" rel="nofollow noopener noreferrer">阮一峰</a></li>
</ol></div> <div class="image-viewer-box" data-v-78c9b824><!----></div>  
</div>
            