
---
title: '函数式编程'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://picsum.photos/400/300?random=7382'
author: 掘金
comments: false
date: Sat, 28 Aug 2021 21:20:07 GMT
thumbnail: 'https://picsum.photos/400/300?random=7382'
---

<div>   
<div class="markdown-body html cache"><style>.markdown-body .octicon&#123;display:inline-block;fill:currentColor;vertical-align:text-bottom&#125;.markdown-body .anchor&#123;float:left;line-height:1;margin-left:-20px;padding-right:4px&#125;.markdown-body .anchor:focus&#123;outline:none&#125;.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link&#123;color:#1b1f23;vertical-align:middle;visibility:hidden&#125;.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor&#123;text-decoration:none&#125;.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link&#123;visibility:visible&#125;.markdown-body h1:hover .anchor .octicon-link:before,.markdown-body h2:hover .anchor .octicon-link:before,.markdown-body h3:hover .anchor .octicon-link:before,.markdown-body h4:hover .anchor .octicon-link:before,.markdown-body h5:hover .anchor .octicon-link:before,.markdown-body h6:hover .anchor .octicon-link:before&#123;width:16px;height:16px;content:" ";display:inline-block;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' aria-hidden='true'%3E%3Cpath fill-rule='evenodd' d='M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z'/%3E%3C/svg%3E")&#125;.markdown-body&#123;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%;color:#24292e;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;font-size:16px;line-height:1.5;word-wrap:break-word&#125;.markdown-body details&#123;display:block&#125;.markdown-body summary&#123;display:list-item&#125;.markdown-body a&#123;background-color:initial&#125;.markdown-body a:active,.markdown-body a:hover&#123;outline-width:0&#125;.markdown-body strong&#123;font-weight:inherit;font-weight:bolder&#125;.markdown-body h1&#123;margin:.67em 0&#125;.markdown-body img&#123;border-style:none&#125;.markdown-body code,.markdown-body kbd,.markdown-body pre&#123;font-family:monospace,monospace;font-size:1em&#125;.markdown-body hr&#123;box-sizing:initial;overflow:visible&#125;.markdown-body input&#123;font:inherit;margin:0;overflow:visible&#125;.markdown-body [type=checkbox]&#123;box-sizing:border-box;padding:0&#125;.markdown-body *&#123;box-sizing:border-box&#125;.markdown-body input&#123;font-family:inherit;font-size:inherit;line-height:inherit&#125;.markdown-body a&#123;color:#0366d6;text-decoration:none&#125;.markdown-body a:hover&#123;text-decoration:underline&#125;.markdown-body strong&#123;font-weight:600&#125;.markdown-body hr&#123;height:0;margin:15px 0;overflow:hidden;background:transparent;border-bottom:1px solid #dfe2e5&#125;.markdown-body hr:after,.markdown-body hr:before&#123;display:table;content:""&#125;.markdown-body hr:after&#123;clear:both&#125;.markdown-body table&#123;border-spacing:0;border-collapse:collapse&#125;.markdown-body td,.markdown-body th&#123;padding:0&#125;.markdown-body details summary&#123;cursor:pointer&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;margin-top:0;margin-bottom:0&#125;.markdown-body h1&#123;font-size:32px&#125;.markdown-body h1,.markdown-body h2&#123;font-weight:600&#125;.markdown-body h2&#123;font-size:24px&#125;.markdown-body h3&#123;font-size:20px&#125;.markdown-body h3,.markdown-body h4&#123;font-weight:600&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:14px&#125;.markdown-body h5,.markdown-body h6&#123;font-weight:600&#125;.markdown-body h6&#123;font-size:12px&#125;.markdown-body p&#123;margin-top:0;margin-bottom:10px&#125;.markdown-body blockquote&#123;margin:0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:0;margin-top:0;margin-bottom:0&#125;.markdown-body ol ol,.markdown-body ul ol&#123;list-style-type:lower-roman&#125;.markdown-body ol ol ol,.markdown-body ol ul ol,.markdown-body ul ol ol,.markdown-body ul ul ol&#123;list-style-type:lower-alpha&#125;.markdown-body dd&#123;margin-left:0&#125;.markdown-body code,.markdown-body pre&#123;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px&#125;.markdown-body pre&#123;margin-top:0;margin-bottom:0&#125;.markdown-body input::-webkit-inner-spin-button,.markdown-body input::-webkit-outer-spin-button&#123;margin:0;-webkit-appearance:none;appearance:none&#125;.markdown-body :checked+.radio-label&#123;position:relative;z-index:1;border-color:#0366d6&#125;.markdown-body .border&#123;border:1px solid #e1e4e8!important&#125;.markdown-body .border-0&#123;border:0!important&#125;.markdown-body .border-bottom&#123;border-bottom:1px solid #e1e4e8!important&#125;.markdown-body .rounded-1&#123;border-radius:3px!important&#125;.markdown-body .bg-white&#123;background-color:#fff!important&#125;.markdown-body .bg-gray-light&#123;background-color:#fafbfc!important&#125;.markdown-body .text-gray-light&#123;color:#6a737d!important&#125;.markdown-body .pl-3,.markdown-body .px-3&#123;padding-left:16px!important&#125;.markdown-body .px-3&#123;padding-right:16px!important&#125;.markdown-body .f6&#123;font-size:12px!important&#125;.markdown-body .lh-condensed&#123;line-height:1.25!important&#125;.markdown-body .text-bold&#123;font-weight:600!important&#125;.markdown-body .pl-c&#123;color:#6a737d&#125;.markdown-body .pl-c1,.markdown-body .pl-s .pl-v&#123;color:#005cc5&#125;.markdown-body .pl-e,.markdown-body .pl-en&#123;color:#6f42c1&#125;.markdown-body .pl-s .pl-s1,.markdown-body .pl-smi&#123;color:#24292e&#125;.markdown-body .pl-ent&#123;color:#22863a&#125;.markdown-body .pl-k&#123;color:#d73a49&#125;.markdown-body .pl-pds,.markdown-body .pl-s,.markdown-body .pl-s .pl-pse .pl-s1,.markdown-body .pl-sr,.markdown-body .pl-sr .pl-cce,.markdown-body .pl-sr .pl-sra,.markdown-body .pl-sr .pl-sre&#123;color:#032f62&#125;.markdown-body .pl-smw,.markdown-body .pl-v&#123;color:#e36209&#125;.markdown-body .pl-bu&#123;color:#b31d28&#125;.markdown-body .pl-ii&#123;color:#fafbfc;background-color:#b31d28&#125;.markdown-body .pl-c2&#123;color:#fafbfc;background-color:#d73a49&#125;.markdown-body .pl-c2:before&#123;content:"^M"&#125;.markdown-body .pl-sr .pl-cce&#123;font-weight:700;color:#22863a&#125;.markdown-body .pl-ml&#123;color:#735c0f&#125;.markdown-body .pl-mh,.markdown-body .pl-mh .pl-en,.markdown-body .pl-ms&#123;font-weight:700;color:#005cc5&#125;.markdown-body .pl-mi&#123;font-style:italic;color:#24292e&#125;.markdown-body .pl-mb&#123;font-weight:700;color:#24292e&#125;.markdown-body .pl-md&#123;color:#b31d28;background-color:#ffeef0&#125;.markdown-body .pl-mi1&#123;color:#22863a;background-color:#f0fff4&#125;.markdown-body .pl-mc&#123;color:#e36209;background-color:#ffebda&#125;.markdown-body .pl-mi2&#123;color:#f6f8fa;background-color:#005cc5&#125;.markdown-body .pl-mdr&#123;font-weight:700;color:#6f42c1&#125;.markdown-body .pl-ba&#123;color:#586069&#125;.markdown-body .pl-sg&#123;color:#959da5&#125;.markdown-body .pl-corl&#123;text-decoration:underline;color:#032f62&#125;.markdown-body .mb-0&#123;margin-bottom:0!important&#125;.markdown-body .my-2&#123;margin-bottom:8px!important;margin-top:8px!important&#125;.markdown-body .pl-0&#123;padding-left:0!important&#125;.markdown-body .py-0&#123;padding-top:0!important;padding-bottom:0!important&#125;.markdown-body .pl-1&#123;padding-left:4px!important&#125;.markdown-body .pl-2&#123;padding-left:8px!important&#125;.markdown-body .py-2&#123;padding-top:8px!important;padding-bottom:8px!important&#125;.markdown-body .pl-3&#123;padding-left:16px!important&#125;.markdown-body .pl-4&#123;padding-left:24px!important&#125;.markdown-body .pl-5&#123;padding-left:32px!important&#125;.markdown-body .pl-6&#123;padding-left:40px!important&#125;.markdown-body .pl-7&#123;padding-left:48px!important&#125;.markdown-body .pl-8&#123;padding-left:64px!important&#125;.markdown-body .pl-9&#123;padding-left:80px!important&#125;.markdown-body .pl-10&#123;padding-left:96px!important&#125;.markdown-body .pl-11&#123;padding-left:112px!important&#125;.markdown-body .pl-12&#123;padding-left:128px!important&#125;.markdown-body hr&#123;border-bottom-color:#eee&#125;.markdown-body kbd&#123;display:inline-block;padding:3px 5px;font:11px SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;line-height:10px;color:#444d56;vertical-align:middle;background-color:#fafbfc;border:1px solid #d1d5da;border-radius:3px;box-shadow:inset 0 -1px 0 #d1d5da&#125;.markdown-body:after,.markdown-body:before&#123;display:table;content:""&#125;.markdown-body:after&#123;clear:both&#125;.markdown-body>:first-child&#123;margin-top:0!important&#125;.markdown-body>:last-child&#123;margin-bottom:0!important&#125;.markdown-body a:not([href])&#123;color:inherit;text-decoration:none&#125;.markdown-body blockquote,.markdown-body details,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul&#123;margin-top:0;margin-bottom:16px&#125;.markdown-body hr&#123;height:.25em;padding:0;margin:24px 0;background-color:#e1e4e8;border:0&#125;.markdown-body blockquote&#123;padding:0 1em;color:#6a737d;border-left:.25em solid #dfe2e5&#125;.markdown-body blockquote>:first-child&#123;margin-top:0&#125;.markdown-body blockquote>:last-child&#123;margin-bottom:0&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25&#125;.markdown-body h1&#123;font-size:2em&#125;.markdown-body h1,.markdown-body h2&#123;padding-bottom:.3em;border-bottom:1px solid #eaecef&#125;.markdown-body h2&#123;font-size:1.5em&#125;.markdown-body h3&#123;font-size:1.25em&#125;.markdown-body h4&#123;font-size:1em&#125;.markdown-body h5&#123;font-size:.875em&#125;.markdown-body h6&#123;font-size:.85em;color:#6a737d&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:2em&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:0;margin-bottom:0&#125;.markdown-body li&#123;word-wrap:break-all&#125;.markdown-body li>p&#123;margin-top:16px&#125;.markdown-body li+li&#123;margin-top:.25em&#125;.markdown-body dl&#123;padding:0&#125;.markdown-body dl dt&#123;padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:600&#125;.markdown-body dl dd&#123;padding:0 16px;margin-bottom:16px&#125;.markdown-body table&#123;display:block;width:100%;overflow:auto&#125;.markdown-body table th&#123;font-weight:600&#125;.markdown-body table td,.markdown-body table th&#123;padding:6px 13px;border:1px solid #dfe2e5&#125;.markdown-body table tr&#123;background-color:#fff;border-top:1px solid #c6cbd1&#125;.markdown-body table tr:nth-child(2n)&#123;background-color:#f6f8fa&#125;.markdown-body img&#123;max-width:100%;box-sizing:initial;background-color:#fff&#125;.markdown-body img[align=right]&#123;padding-left:20px&#125;.markdown-body img[align=left]&#123;padding-right:20px&#125;.markdown-body code&#123;padding:.2em .4em;margin:0;font-size:85%;background-color:rgba(27,31,35,.05);border-radius:3px&#125;.markdown-body pre&#123;word-wrap:normal&#125;.markdown-body pre>code&#123;padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0&#125;.markdown-body .highlight&#123;margin-bottom:16px&#125;.markdown-body .highlight pre&#123;margin-bottom:0;word-break:normal&#125;.markdown-body .highlight pre,.markdown-body pre&#123;padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f6f8fa;border-radius:3px&#125;.markdown-body pre code&#123;display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:initial;border:0&#125;.markdown-body .commit-tease-sha&#123;display:inline-block;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:90%;color:#444d56&#125;.markdown-body .full-commit .btn-outline:not(:disabled):hover&#123;color:#005cc5;border-color:#005cc5&#125;.markdown-body .blob-wrapper&#123;overflow-x:auto;overflow-y:hidden&#125;.markdown-body .blob-wrapper-embedded&#123;max-height:240px;overflow-y:auto&#125;.markdown-body .blob-num&#123;width:1%;min-width:50px;padding-right:10px;padding-left:10px;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;line-height:20px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;vertical-align:top;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none&#125;.markdown-body .blob-num:hover&#123;color:rgba(27,31,35,.6)&#125;.markdown-body .blob-num:before&#123;content:attr(data-line-number)&#125;.markdown-body .blob-code&#123;position:relative;padding-right:10px;padding-left:10px;line-height:20px;vertical-align:top&#125;.markdown-body .blob-code-inner&#123;overflow:visible;font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace;font-size:12px;color:#24292e;word-wrap:normal;white-space:pre&#125;.markdown-body .pl-token.active,.markdown-body .pl-token:hover&#123;cursor:pointer;background:#ffea7f&#125;.markdown-body .tab-size[data-tab-size="1"]&#123;-moz-tab-size:1;tab-size:1&#125;.markdown-body .tab-size[data-tab-size="2"]&#123;-moz-tab-size:2;tab-size:2&#125;.markdown-body .tab-size[data-tab-size="3"]&#123;-moz-tab-size:3;tab-size:3&#125;.markdown-body .tab-size[data-tab-size="4"]&#123;-moz-tab-size:4;tab-size:4&#125;.markdown-body .tab-size[data-tab-size="5"]&#123;-moz-tab-size:5;tab-size:5&#125;.markdown-body .tab-size[data-tab-size="6"]&#123;-moz-tab-size:6;tab-size:6&#125;.markdown-body .tab-size[data-tab-size="7"]&#123;-moz-tab-size:7;tab-size:7&#125;.markdown-body .tab-size[data-tab-size="8"]&#123;-moz-tab-size:8;tab-size:8&#125;.markdown-body .tab-size[data-tab-size="9"]&#123;-moz-tab-size:9;tab-size:9&#125;.markdown-body .tab-size[data-tab-size="10"]&#123;-moz-tab-size:10;tab-size:10&#125;.markdown-body .tab-size[data-tab-size="11"]&#123;-moz-tab-size:11;tab-size:11&#125;.markdown-body .tab-size[data-tab-size="12"]&#123;-moz-tab-size:12;tab-size:12&#125;.markdown-body .task-list-item&#123;list-style-type:none&#125;.markdown-body .task-list-item+.task-list-item&#123;margin-top:3px&#125;.markdown-body .task-list-item input&#123;margin:0 .2em .25em -1.6em;vertical-align:middle&#125;</style><h3 data-id="heading-0"><strong>我们为什么现在要函数式编程</strong>？</h3>
<ul>
<li>函数式编程是随着React的流行受到越来越多的关注</li>
<li>Vue3也开始拥抱函数式编程</li>
<li>函数式编程也可以抛弃this</li>
<li>打包过程中可以更好的利用three shaking过滤无用代码</li>
<li>方便测试，方便并行处理</li>
<li>有很多库可以帮助我们进行函数式开发：lodash、underscore、ramda</li>
</ul>
<h3 data-id="heading-1"><strong>什么是函数式编程</strong></h3>
<blockquote>
<p>函数式编程（function programming，FP），FP是编程范式之一，我们常听说的编程范还有面向过程编程、面向对象编程。</p>
</blockquote>
<ul>
<li>面向对象编程的思维方式：把现实世界中的事物抽象成程序世界中的类和对象，通过封装、继承和多态来演示事物事件的联系；</li>
<li>函数式编程的思维方式：把现实世界的事物和事物之间的联系抽象到程序世界（对运算过程进行抽象）</li>
</ul>
<h3 data-id="heading-2">函数式编程思维方式的理解</h3>
<ul>
<li>
<p>程序的本质：根据输入某种运算获得相应的输出，程序开发古城中涉及很多有输入和输出的函数</p>
</li>
<li>
<p>x->f(联系、映射)->y,y=f(x),输入x，通过某种联系得到结果y,这里面的联系f就是我们的运算过程（也就是函数式编程的函数），通过f(x)得到y;</p>
</li>
<li>
<p>函数式编程中的函数指的不是程序中的函数（方法），而是数学中的函数即映射关系，例如：y=sin(x),x和y的关系</p>
</li>
<li>
<p>“相同的输入始终要得到相同的输出”（纯函数）</p>
</li>
<li>
<pre><code class="copyable"> 总结：函数式编程用来描述数据（函数）之间的映射，对其数据运算过程的抽象
<span class="copy-code-btn">复制代码</span></code></pre>
</li>
</ul>
<h3 data-id="heading-3">函数式编程和面向对象编程的不同</h3>
<ul>
<li>
<pre><code class="copyable"> 从思维方式上来说面向对象编程是对事物的抽象，二函数式编程式对运算过程的抽象
<span class="copy-code-btn">复制代码</span></code></pre>
</li>
</ul>
<h3 data-id="heading-4">函数是一等公民：MDN First-class Function</h3>
<p>一等公民可以作为：函数可以存储在变量中；函数作为参数；函数作为返回值；
例如：字符串在几乎所有编程语言中都是一等公民，字符串可以作为函数参数 、函数返回值、赋值给变量。</p>
<p>在JavaScript中函数就是一个"普通的对象"（可以通过new Function（）），我们可以把函数存储到变量/数组中，它还可以作为另一个函数的参数和返回值，甚至我们可以在程序运行的时候通过 new Function（alert（‘1’）），因此JavaScript中函数是一等公民。</p>
<p>来构造一个新函数；</p>
<ul>
<li>把函数赋值给变量</li>
</ul>
<pre><code class="hljs language-把函数赋值给变量 copyable" lang="把函数赋值给变量">let fn = function() &#123;
    console.log('Hello First-class Function')
&#125;
fn()
//一个示例
const Blogcontroller = &#123;
    index(posts) &#123;return Views.index(posts)&#125; //index方法和内部调用的方法有相同的形式，参数和返回值相同；一个函数包含一个函数，形式相同，其实就是相同的函数
    show (post) &#123; return Views.show(post) &#125;,
    create (attrs) &#123; return Db.create(attrs) &#125;,
    update (post, attrs) &#123; return Db.update(post, attrs) &#125;,
    destroy (post) &#123; return Db.destroy(post) &#125;
&#125;
//优化：把函数的一个方法赋值另一个方法（赋值方法本身），而不是把函数的调用赋值给另一个方法
const Blogcontroller = &#123;
    index： Views.index //复制方法本身
    show: Views.show
    create: Db.create
    update: Db.update
    destroy: Db.destroy
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-5">高阶函数</h3>
<p>概念：高阶函数 可以把“函数作为参数” 传递给另一个函数；可以把函数作为另一个函数的“返回结果”</p>
<p>高阶函数是用来抽象通用的问题高阶函数----作为参数；函数作为参数的话，参数会变得更加灵活，调用函数的方法forEach不用考虑函数是如何实现的；</p>
<p>一、 函数作为参数传递</p>
<p>模拟forEach：遍历数组每个数字，并且返回数组的每一项</p>
<p>例如：函数参数：2个参数，第一个参数首先传一个数组，第二个是参数，遍历数组后， 每次对数组的处理操作是不同的，内容是变化的</p>
<pre><code class="copyable">function forEach( array, fn) &#123;
    for( let i =0; i< array.length; i++) &#123;
        fn(array[i])
    &#125;
&#125;

// 测试
let  arr = [1,2,3,4,7,8]
//item,用来接受item的每一项
forEach(arr,function(item)&#123;
    console.log(item)
&#125;)

//模拟：filter：过滤数组中满足条件的数据存储，返回最终结果
function fliter(arr, fn) &#123;
    let   results = [] //存储结果
    for(let i=0; i< arr.length; i++)&#123;
        if(fn(arr[i]))&#123; // 数组是否满足条件的每一项
            results.push(arr[i])
        &#125;
    &#125;
    return results
&#125;

// 测试
let arrFliter= [2,1,56,8]
let f = fliter(arrFliter, function (item)&#123;
    return item % 2 == 0
&#125;)
console.log('过滤的结果',f)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>二、函数作为作为返回值</p>
<p>高阶函数-----作为返回值，就是函数生成一个函数</p>
<pre><code class="copyable">/*
*高阶函数语法展示
*/
function makeFn() &#123;
    let msg = 'Hello msg'
    return function () &#123;
        console.log(msg)
    &#125;
&#125;
//调用方式一
const fn = makeFn()
fn()
// 调用方式二
makeFn()()

//once: 只让函数只执行一次，场景：在支付的时候，一个订单，用户点击多次按钮，只让用户执行一次
function once (fn) &#123;
    let done = false //fn没有执行
    return function () &#123;
        if(!done) &#123;
            done = true
            fn.apply(this,arguments)
        &#125;
    &#125;
&#125;
//测试
let pay = once(function (money) &#123;
    console.log(`支付: $&#123;money&#125; RMB`)
&#125;)
pay(5)
pay(5)
pay(5)
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-6">使用高阶函数的意义</h3>
<ul>
<li>抽象可以帮我们屏蔽细节，只需要关注与我们的目标</li>
<li>高阶函数是用来 “ 抽象通用 “的问题</li>
</ul>
<p>高阶函数： forEach filter 例子如上</p>
<h3 data-id="heading-7">常用的高阶函数</h3>
<p>forEach、map、 filter、 every、 some、 find/findIndex、 reduce、 sort</p>
<pre><code class="copyable">// 模拟常用高阶函数：map every some

// map:对数组的元素进行遍历，并对每一项进行处理，处理结果并返回新数组
const map = (array, fn) => &#123;
    let results = [] // 新数组
    for (let value of array) &#123;
        results.push(fn(value))
    &#125;
    return results
&#125;
//测试map
let arr = [1,2,34,5,4]
arrMap = map(arr, v => v*v)
console.log('map',arrMap)

// every:判断数组的每一项是否符合条件，如果有一项不符合，就返回false；返回true/false
 const every = (array, fn) => &#123;
     let result = true
     for(let value of array) &#123;
         result = fn(value)
         if(!result) &#123;
            break
         &#125;
     &#125;
     return result
 &#125;

 // 测试every
 let  arrE = [122,33,11,14]
 let r = every(arrE, v=> v>10)
 console.log('every', r)

 //some:检测数组中的元素是否有一个满足数组中的条件,有一个满足返回
 const some = (array, fn) => &#123;
    let result = false
    for(let value of array) &#123;
        result = fn(value)
        if(result) &#123;
            break
        &#125;
    &#125;
    return result
 &#125;

 // 测试 
 let arrSome = [1,3,5,9]
 let sr = some(arrSome, v=>v % 2 === 0)
 console.log('some', sr)
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-8">闭包</h3>
<p>概念：闭包（Closure）函数和其他周围的状态（词法环境）的引用捆绑在一起形成闭包。
可以在另一个作用域中调用一个函数的内部函数并访问到该函数的作用域中的成员，</p>
<p>在另一个作用域中可以调用manFn()的内部函数
当我们调用这个内部函数的时候，可以访问到manFn()的内部成员</p>
<pre><code class="copyable">function makeFn() &#123;
    let msg = 'Hello msg'
    return function () &#123;
        console.log(msg)
    &#125;
&#125;
函数里面返回了一个函数，并且返回的函数内部引用了外部函数的成员，就形成了闭包
//调用方式一
makeFn就是引用了内部的函数，被外部引用就不能释放
const fn = makeFn()
fn()
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-9">闭包的本质</h3>
<p>函数在执行的时候会放到一个执行栈上当函数执行完毕之后会从执行栈上移除，但是堆上的作用域成员  <strong>因为被外部引用不能释放</strong>  ，因此内部函数依然可以访问外部函数的成员</p>
<p>闭包案例</p>
<pre><code class="copyable"><!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0, user-scalable=no">
  </head>
  <body>
      <script>
        //求员工的工资
        // getSalary(12000, 2000) 
        // getSalary(15000, 3000)
        // getSalary(15000, 4000) 
//为不同级别的员工计算工资,传入基本工资加绩效
        function makeSalary(base) &#123;
          return function (performance) &#123;
            return base + performance
          &#125;
        &#125;
        let salaryLever1 = makeSalary(12000)
        let salaryLever2 = makeSalary(15000)

        console.log(salaryLever1(2000))
        console.log(salaryLever2(2000))
      </script>
  </body>
</html>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-10">纯函数</h3>
<h3 data-id="heading-11">纯函数的概念</h3>
<ul>
<li>相同的输入永远会得到相同的输出，而且没有任何可观察的副作用</li>
<li>纯函数就类似数学中的函数(用来描述输入和输出之间的关系)，y = f(x)</li>
<li>函数式编程 <strong>不会保留计算中间</strong>  的结果，所以变量是不可变的（无状态的）</li>
<li>我们可以把一个函数的执行结果交给另一个函数去处理</li>
<li>lodash 是一个纯函数的功能库，提供了对数组、数字、对象、字符串、函数等操作的一些方法</li>
<li>数组的 slice 和 splice 分别是：纯函数和不纯的函数
<ul>
<li>slice 返回数组中的指定部分，不会改变原数组</li>
<li>splice 对数组进行操作返回该数组，会改变原数组</li>
</ul>
</li>
</ul>
<pre><code class="copyable">// slice /splice

// 纯函数 相同输入得到相同的输出
let array = [1,2,34,5]
console.log(array.slice(0,3)) //没有改变原数组
console.log(array.slice(0,3)) 
console.log(array.slice(0,3)) 

console.log(array.splice(0,3)) // 改变原数组，返回新数组
console.log(array.splice(0,3))
console.log(array.splice(0,3))
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-12">lodash</h3>
<pre><code class="copyable">// 初始化，package.json  npm init -y  ===>  npm i lodash
// first lasr toUpper reverse each includes find findeIndex
const _ = require('lodash')

const array = ['jack', 'tom', 'lucy', 'kate']

console.log(_.first(array))
console.log(_.last(array))
console.log(_.toUpper(_.first(array)))
console.log(_.reverse(array))

const r = _.each(array, (item, index) =>&#123;
    console.log(item, index)
&#125;)
console.log(r)
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-13">纯函数的好处</h3>
<ul>
<li>可缓存：因为纯函数对相同的输入始终有相同的结果，所以可以把纯函数的课过缓存起来</li>
</ul>
<pre><code class="copyable">// 记忆函数
const _ = require('lodash')

function getArea() &#123;
    return Math.PI*r*r
&#125;

let getAreaWithMemory = _.memoize(getArea) 
console.log(getAreaWithMemory(4))
//从缓存中取数据
console.log(getAreaWithMemory(4))
console.log(getAreaWithMemory(4))

//模拟memoize的实现
function memoize (f) &#123;
    //把f存储
    let cache = &#123;&#125;
    return function () &#123;
        let key = JSON.stringify(arguments)
        cache[key] = cache[key] || f.apply(f, arguments) 
        return cache[arg_str]
    &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<ul>
<li>
<p>可测试：纯函数让测试更加方便</p>
</li>
<li>
<p>并行处理</p>
<ul>
<li>在多线处理环境下并行操作共享的内存数据很可能出现意外情况</li>
<li>纯函数不需要共享的内存数据，所以在并行环境下可以任意运行纯函数</li>
</ul>
</li>
</ul>
<h3 data-id="heading-14">纯函数的副作用</h3>
<ul>
<li>纯函数：对于相同的输入永远会得到相同的输出，而且没有任何可观察的副作用</li>
</ul>
<pre><code class="copyable">// 不纯的

let mini = 18

function checkAge (age) &#123;

return age >= mini

&#125;

// 纯的(有硬编码，后续可以通过柯里化解决)

function checkAge (age) &#123;

let mini = 18

return age >= mini

&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>副作用让一个函数变的不纯(如上例:全局变量)，纯函数的根据相同的输入返回相同的输出，如果函数依赖于外部的状态就无法保证输出相同，就会带来副作用。</p>
<h3 data-id="heading-15">副作用来源：</h3>
<ul>
<li>配置文件</li>
<li>数据库</li>
<li>获取用户的输入</li>
</ul>
<p>所有的  “<strong>外部交互</strong> ”都有可能带来 ”<strong>副作用</strong>“， 副作用也使得方法通用性下降不适合扩展和可重用性， 同时副作用会给程序中带来安全隐患给程序带来不确定性，但是副作用不可能完全禁止，尽可能控制它们在可控范围内发生。</p>
<h3 data-id="heading-16">柯里化</h3>
<p>使用柯里化解决上一个案例只能够硬编码问题</p>
<pre><code class="copyable">// 柯里化演示
function checkAge(age) &#123;
    let min = 18
    return age >= min
&#125;

// // 普通的纯函数
function checkAge (min, age) &#123;
    return age >= min
&#125;
console.log(checkAge(18,20))
console.log(checkAge(18,24))
console.log(checkAge(22,24))

//柯里化
function checkAge(min) &#123;
    return function(age) &#123;
        return age >= min
    &#125;
&#125;

let check18 = checkAge(18)
let check20 = checkAge(20)

console.log(check18(20))
console.log(check20(22))

//es6优化
let checkAge = min => (age => age >= min) 
let check22 = checkAge(22)
console.log(check22(20))
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-17">柯里化</h3>
<ul>
<li>当一个函数有多个参数的时候先传递题部分参数调用它（这部分参数以后永远不变）
然后返回一个新的函数接受剩余的参数，返回结果</li>
</ul>
<h3 data-id="heading-18">lodash中的柯里化函数</h3>
<ul>
<li>_curry(func)
<ul>
<li>功能：创建一个函数，该函数接受一个或者多个func的参数，如果func所需要的参数都被提供则执行func并返回执行的结果，否则继续返回该函数并等待接受剩余的参数</li>
<li>参数：需要柯里化的函数</li>
<li>返回值：柯里化后的函数</li>
</ul>
</li>
</ul>
<pre><code class="copyable">const _= require('lodash')

//要柯里化的函数
function getSum(a, b, c) &#123;
    return a + b + c
&#125;

const curried = _.curry(getSum)

//接受全部参数
console.log(curried(1,2,3))

// 接受部分参数,返回新的一个函数,等待接收剩余的参数
console.log(caches(1)(2,3))

console.log(curried(1,2)(3))
<span class="copy-code-btn">复制代码</span></code></pre>
<p>案例</p>
<pre><code class="copyable">//柯里化案例：lodash curry
//判断一个字符串是否有空字符，或者提取字符串所有空字符， match
const _= require('lodash')

// 柯里化
 const match = _.curry(function(reg, str) &#123;
    return str.match(reg)
&#125;)

const haveSpace = match(/\s+/g) 
const haveNumber = match(/\d+/g)

console.log(haveSpace('hello world'))
console.log(haveNumber('1234abcd'))

// 过滤数组空白字符， filter

const filter = _.curry(function(func, array) &#123;
    return array.filter(func)
&#125;)
console.log(filter(haveSpace, ['John Conner', 'John_Donner']))

// 过滤数组空白字符， filter 优化 
const findSpace = filter(haveSpace)
console.log(findSpace(['John Conner', 'John_Donner']))
<span class="copy-code-btn">复制代码</span></code></pre>
<p>模拟实现lodash中curry的方法</p>
<pre><code class="copyable">//模拟实现lodash中curry的方法
const _= require('lodash')

//要柯里化的函数
function getSum(a, b, c) &#123;
    return a + b + c
&#125;

// const curried = _.curry(getSum) // lodash参数
const curried = curry(getSum) // 在自定义curry
//接受全部参数
console.log(curried(1,2,3))

// 接受部分参数,返回新的一个函数,等待接收剩余的参数
console.log(caches(1)(2,3))

console.log(curried(1,2)(3))

function curry(func)&#123;
    return function curriedFn(...args) &#123;
        //判断实参和形参的个数
        if(args.length < func.length)&#123;
            return function () &#123;
                //合并
                return curriedFn(...args.concat(Array.from(arguments)))
            &#125;
        &#125;
        // 实参和形参个数相同，调用 func，返回结果
        return func(...args)
    &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-19">柯里化总结</h3>
<ul>
<li>柯里化可以让我们给一个函数传递较少的参数得到一个已经记住了某些固定参数的新函数</li>
<li>这是一种函数参数的程序</li>
<li>让函数变得更令化，让函数的粒度更小</li>
<li>可以把多元函数转换成一元函数，可以组合使用函数产生强大的功效</li>
</ul></div>  
</div>
            