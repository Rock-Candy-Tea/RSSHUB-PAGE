
---
title: 'vue clié¡¹ç›®æ„å»ºæ‰“åŒ…ä¼˜åŒ–åˆæ¢'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbedc66bbafc46ecbf24566346569527~tplv-k3u1fbpfcp-zoom-1.image'
author: æ˜é‡‘
comments: false
date: Sun, 02 May 2021 00:01:45 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbedc66bbafc46ecbf24566346569527~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">èƒŒæ™¯</h2>
<p>å› ä¸ºå…¬å¸çš„å‰ç«¯é¡¹ç›®åœ¨æ‰“åŒ…æ„å»ºæ–¹é¢æ—¶é—´å±å®é•¿å¾—ç¦»è°±ï¼Œå†·å¯åŠ¨å¤§çº¦5minï¼Œæœ¬åœ°æ„å»ºæ‰“åŒ…ä¹Ÿå¤§çº¦5min,åˆ°çº¿ä¸Šè…¾è®¯äº‘dockeræ„å»ºæ‰“åŒ…å…¨è¿‡ç¨‹éœ€è¦16~20minã€‚å› æ­¤ä¸ä»…æå¤§å½±å“å¼€å‘æ•ˆç‡ï¼Œä¹Ÿå¤§å¤§å»¶è¿Ÿäº†ç»™æµ‹è¯•äº¤ä»˜çš„æ—¶é—´ã€‚</p>
<h2 data-id="heading-1">ä¼˜åŒ–æ€è·¯</h2>
<ul>
<li>äº†è§£é¡¹ç›®å½“å‰webpacké…ç½®</li>
<li>æ„å»ºç›¸å…³ä¼˜åŒ–</li>
<li>æ‰“åŒ…ä½“ç§¯ç›¸å…³ä¼˜åŒ–</li>
<li>dockerç›¸å…³ä¼˜åŒ–</li>
</ul>
<h2 data-id="heading-2">é‡åŒ–å·¥å…·</h2>
<h3 data-id="heading-3">speed-measure-webpack-plugin</h3>
<h4 data-id="heading-4">ä»‹ç»ï¼š</h4>
<p><a href="https://www.npmjs.com/package/speed-measure-webpack-plugin" target="_blank" rel="nofollow noopener noreferrer">speed-measure-webpack-plugin npm</a></p>
<blockquote>
<p>The first step to optimising your webpack build speed, is to know where to focus your attention.
This plugin measures your webpack build speed, giving an output like this:</p>
</blockquote>
<p>é€šè¿‡smpè¾“å‡ºçš„åˆ†æå¯ä»¥æ¸…æ¥šçš„äº†è§£åˆ°webpackæ„å»ºè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸€é˜¶æ®µçš„loaderä»¥åŠpluginçš„å·¥ä½œèŠ±è´¹çš„æ—¶é—´ã€‚</p>
<h4 data-id="heading-5">ä½¿ç”¨æ–¹å¼ï¼š</h4>
<pre><code class="hljs language-javascript copyable" lang="javascript"># Yarn
yarn add -D speed-measure-webpack-plugin

<span class="hljs-keyword">const</span> SpeedMeasurePlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'speed-measure-webpack-plugin'</span>)
<span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
    config
      .plugin(<span class="hljs-string">'speed-measure-webpack-plugin'</span>)
      .use(SpeedMeasurePlugin)
      .end()
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨æœ¬é¡¹ç›®ä¸­ä½¿ç”¨å…¶ä»–çš„ä½¿ç”¨éƒ½ä¼šæŠ¥errorï¼Œä½†æ˜¯ä»¥ä¸Šçš„ç”¨æ³•ä¼¼ä¹ä¸ä¼šåŒºåˆ†pluginä¸loaderçš„ä½¿ç”¨ï¼Œç”šè‡³æ²¡æœ‰å…¶ä»–pluginçš„ä½¿ç”¨æƒ…å†µä¿¡æ¯ï¼Œè¿·æƒ‘~ã€‚</p>
<h3 data-id="heading-6">webpack-bundle-analyzer</h3>
<h4 data-id="heading-7">ä»‹ç»ï¼š</h4>
<p><a href="https://www.npmjs.com/package/webpack-bundle-analyzer" target="_blank" rel="nofollow noopener noreferrer">webpack-bundle-analyzer npm</a>
ç”¨æ¥åˆ†æwebapckæ„å»ºæ‰“åŒ…åçš„æ–‡ä»¶ï¼Œå¦‚åˆ†åŒ…æƒ…å†µï¼Œå ç”¨ä½“ç§¯ç­‰å‚æ•°çš„åˆ†æã€‚</p>
<h4 data-id="heading-8">ä½¿ç”¨æ–¹å¼ï¼š</h4>
<pre><code class="hljs language-javascript copyable" lang="javascript"># Yarn
yarn add -D webpack-bundle-analyzer

<span class="hljs-keyword">const</span> BundleAnalyzerPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack-bundle-analyzer'</span>).BundleAnalyzerPlugin;
<span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> BundleAnalyzerPlugin()
  ]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä½†æ˜¯åœ¨vue-cliä¸­æœ‰reportå‘½ä»¤å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œç„¶åå»distæ‰“åŒ…ç›®å½•æ‰“å¼€report.htmlã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">vue-cli-service build --report
or
vue-cli-service build --report-json
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-9">æŸ¥çœ‹vue-cliå½“å‰webpacké…ç½®</h2>
<h3 data-id="heading-10">ä»‹ç»</h3>
<p>vue-cliè„šæ‰‹æ¶ä¼šæœ‰webpackçš„å¾ˆå¤šé»˜è®¤è¡Œä¸ºï¼Œå› æ­¤æˆ‘ä»¬å¾—çŸ¥é“åŸºäºvue-cliçš„é¡¹ç›®ï¼Œå½“å‰çš„webpackéƒ½é…ç½®äº†å•¥ï¼Œç„¶åæ‰èƒ½åšé’ˆå¯¹æ€§çš„åˆ†æä¸ä¼˜åŒ–ã€‚</p>
<blockquote>
<p><code>vue-cli-service</code> æš´éœ²äº† <code>inspect</code> å‘½ä»¤ç”¨äºå®¡æŸ¥è§£æå¥½çš„ webpack é…ç½®ã€‚é‚£ä¸ªå…¨å±€çš„ <code>vue</code> å¯æ‰§è¡Œç¨‹åºåŒæ ·æä¾›äº† <code>inspect</code> å‘½ä»¤ï¼Œè¿™ä¸ªå‘½ä»¤åªæ˜¯ç®€å•çš„æŠŠ <code>vue-cli-service inspect</code> ä»£ç†åˆ°äº†ä½ çš„é¡¹ç›®ä¸­ã€‚</p>
</blockquote>
<h3 data-id="heading-11">ä½¿ç”¨æ–¹å¼ï¼š</h3>
<pre><code class="hljs language-javascript copyable" lang="javascript">#æ ¹æ®modeï¼Œåˆ†åˆ«ç”Ÿæˆå¼€å‘ç¯å¢ƒã€ç”Ÿäº§ç¯å¢ƒçš„é…ç½®
vue inspect --mode production > output.js
#è¾“å…¥å‘½ä»¤åï¼Œåœ¨æ ¹ç›®å½•ä¼šç”Ÿäº§ä¸€ä¸ªoutput.jsæ–‡ä»¶
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¦‚æœ<code>vue command not found</code>çš„é”™å¯ä»¥å…¨å±€å®‰è£…æ³¨å†Œä¸€ä¸‹vueå‘½ä»¤<code>npm install -gÂ vue-cli</code></p>
<h2 data-id="heading-12">æ„å»ºç›¸å…³ä¼˜åŒ–</h2>
<h3 data-id="heading-13">hard-source-webpack-plugin</h3>
<h4 data-id="heading-14">ä»‹ç»</h4>
<p><a href="https://www.npmjs.com/package/hard-source-webpack-plugin" target="_blank" rel="nofollow noopener noreferrer">hard-source-webpack-plugin npm</a></p>
<blockquote>
<p>HardSourceWebpackPluginÂ is a plugin for webpack to provide an intermediate caching step for modules. In order to see results, you'll need to run webpack twice with this plugin: the first build will take the normal amount of time. The second build will be signficantly faster.</p>
</blockquote>
<p>åœ¨å¯åŠ¨é¡¹ç›®æ—¶ä¼šé’ˆå¯¹é¡¹ç›®ç”Ÿæˆç¼“å­˜ï¼Œè‹¥æ˜¯é¡¹ç›®æ— packageæˆ–å…¶ä»–å˜åŒ–ï¼Œä¸‹æ¬¡å°±ä¸ç”¨èŠ±è´¹æ—¶é—´é‡æ–°æ„å»ºï¼Œç›´æ¥å¤ç”¨ç¼“å­˜ã€‚</p>
<h4 data-id="heading-15">ä½¿ç”¨æ–¹å¼ï¼š</h4>
<pre><code class="hljs language-javascript copyable" lang="javascript">#yarn
yarn add -D hard-source-webpack-plugin

<span class="hljs-keyword">const</span> HardSourceWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'hard-source-webpack-plugin'</span>)
<span class="hljs-built_in">module</span>.exports = &#123;
<span class="hljs-attr">configureWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
  config.plugin.push(
    <span class="hljs-comment">// ä¸ºæ¨¡å—æä¾›ä¸­é—´ç¼“å­˜ï¼Œç¼“å­˜è·¯å¾„æ˜¯ï¼šnode_modules/.cache/hard-source</span>
      <span class="hljs-comment">// solve Configuration changes are not being detected</span>
      <span class="hljs-keyword">new</span> HardSourceWebpackPlugin(&#123;
        <span class="hljs-attr">root</span>: process.cwd(),
        <span class="hljs-attr">directories</span>: [],
        <span class="hljs-attr">environmentHash</span>: &#123;
          <span class="hljs-attr">root</span>: process.cwd(),
          <span class="hljs-attr">directories</span>: [],
          <span class="hljs-attr">files</span>: [<span class="hljs-string">'package.json'</span>, <span class="hljs-string">'yarn.lock'</span>, <span class="hljs-string">'vue.config.js'</span>]
        &#125;
      &#125;)
      <span class="hljs-comment">// é…ç½®äº†filesçš„ä¸»è¦åŸå› æ˜¯è§£å†³é…ç½®æ›´æ–°ï¼Œcacheä¸ç”Ÿæ•ˆäº†çš„é—®é¢˜ï¼Œé…ç½®åæœ‰åŒ…çš„å˜åŒ–ï¼Œpluginä¼šé‡æ–°æ„å»ºä¸€éƒ¨åˆ†cache</span>
    )
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-16">æ³¨æ„ï¼š</h4>
<p><code>Could not freeze : Cannot read property 'hash' of undefined</code> åˆ é™¤node_modules/.cacheåï¼Œé‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œäº§ç”Ÿè¿™ä¸ªé—®é¢˜çš„åŸå› å¯èƒ½æ˜¯å¼‚æ­¥åŠ è½½æ¨¡å—æ—¶ç¼–è¯‘äº§ç”Ÿçš„é”™è¯¯ï¼Œå¯å‚è€ƒï¼š</p>
<h3 data-id="heading-17">ç¼©å°æ–‡ä»¶æ£€ç´¢è§£æèŒƒå›´</h3>
<p>ä¸ºé¿å…æ— ç”¨çš„æ£€ç´¢ä¸é€’å½’éå†ï¼Œå¯ä»¥ä½¿ç”¨aliasæŒ‡å®šå¼•ç”¨æ—¶å€™çš„æ¨¡å—ï¼ŒnoParseï¼Œå¯¹ä¸ä¾èµ–æœ¬åœ°ä»£ç çš„ç¬¬ä¸‰æ–¹ä¾èµ–ä¸è¿›è¡Œè§£æã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-comment">// å®šä¹‰getAliasPathæ–¹æ³•ï¼ŒæŠŠç›¸å¯¹è·¯å¾„è½¬æ¢æˆç»å¯¹è·¯å¾„</span>
<span class="hljs-keyword">const</span> getAliasPath = <span class="hljs-function"><span class="hljs-params">dir</span> =></span> join(__dirname, dir)
<span class="hljs-built_in">module</span>.exports = &#123;
<span class="hljs-attr">configureWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
    config.module.noParse = <span class="hljs-regexp">/^(vu|vue-router|vuex|vuex-router-sync|lodash|echarts|axios|element-ui)$/</span>
  &#125;
  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
    <span class="hljs-comment">// æ·»åŠ åˆ«å</span>
    config.resolve.alias
      .set(<span class="hljs-string">'@'</span>, getAliasPath(<span class="hljs-string">'src'</span>))
      .set(<span class="hljs-string">'assets'</span>, getAliasPath(<span class="hljs-string">'src/assets'</span>))
      .set(<span class="hljs-string">'utils'</span>, getAliasPath(<span class="hljs-string">'src/utils'</span>))
      .set(<span class="hljs-string">'views'</span>, getAliasPath(<span class="hljs-string">'src/views'</span>))
      .set(<span class="hljs-string">'components'</span>, getAliasPath(<span class="hljs-string">'src/components'</span>))
&#125;
  <span class="hljs-comment">// ç”Ÿäº§ç¯å¢ƒç¦ç”¨eslint</span>
  <span class="hljs-attr">lintOnSave</span>: !process.env.NODE_ENV !== <span class="hljs-string">'production'</span>,
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-18">å‡å°‘æ‰“åŒ…ä½“ç§¯</h3>
<h4 data-id="heading-19">image-webpack-plugin å›¾ç‰‡å‹ç¼©</h4>
<p>å¯¹å›¾ç‰‡åƒç´ è¦æ±‚æ²¡å¾ˆæè‡´çš„ï¼Œè¿™ä¸ªå‹ç¼©è¿˜æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå‹ç¼©ç‡è‚‰çœ¼çœ‹èµ·æ¥æ„Ÿè§‰æ˜¯æ²¡å¤ªå¤§åŒºåˆ«ã€‚
è¿™é‡Œæ³¨æ„ä¸€ä¸‹ï¼Œæˆ‘æ²¡æœ‰å¯¹svgè¿›è¡Œå‹ç¼©ï¼ŒåŸå› æ˜¯å‹ç¼©çš„svg,å†é€šè¿‡æ„å»ºæ—¶è¢«æ‰“åŒ…æˆbase64æ—¶ï¼Œç”Ÿæˆçš„base64ä¼šæœ‰é—®é¢˜ï¼Œæ— æ³•è®¿é—®ã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">chainWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
   <span class="hljs-comment">// å¯¹å›¾ç‰‡è¿›è¡Œå‹ç¼©</span>
    config.module
      .rule(<span class="hljs-string">'images'</span>)
      .test(<span class="hljs-regexp">/\.(png|jpe?g|gif)(\?.*)?$/</span>)
      .use(<span class="hljs-string">'image-webpack-loader'</span>)
      .loader(<span class="hljs-string">'image-webpack-loader'</span>)
      .options(&#123; <span class="hljs-attr">bypassOnDebug</span>: <span class="hljs-literal">true</span> &#125;)
      .end()
&#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-20">UglifyJsPluginåˆ é™¤console æ³¨é‡Š</h4>
<p>uglifyJsPlugin ç”¨æ¥å¯¹jsæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œå‡å°jsæ–‡ä»¶çš„å¤§å°ã€‚å…¶ä¼šæ‹–æ…¢webpackçš„ç¼–è¯‘é€Ÿåº¦ï¼Œå»ºè®®å¼€å‘ç¯å¢ƒæ—¶å…³é—­ï¼Œç”Ÿäº§ç¯å¢ƒå†å°†å…¶æ‰“å¼€ã€‚
æ›´å»ºè®®è§„èŒƒå›¢é˜Ÿæˆå‘˜çš„ä»£ç ä¸Šå»è§£å†³ã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">#yarn
yarn add -D uglifyjs-webpack-plugin

<span class="hljs-keyword">const</span> UglifyJsPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'uglifyjs-webpack-plugin'</span>)

<span class="hljs-built_in">module</span>.exports = &#123;
<span class="hljs-attr">configureWebpack</span>: <span class="hljs-function"><span class="hljs-params">config</span> =></span> &#123;
  config.plugin.push(
    <span class="hljs-keyword">new</span> UglifyJsPlugin(&#123;
        <span class="hljs-attr">uglifyOptions</span>: &#123;
          <span class="hljs-comment">// åˆ é™¤æ³¨é‡Š</span>
          <span class="hljs-attr">output</span>: &#123;
            <span class="hljs-attr">comments</span>: <span class="hljs-literal">false</span>
          &#125;,
          <span class="hljs-comment">// åˆ é™¤console debugger åˆ é™¤è­¦å‘Š</span>
          <span class="hljs-attr">compress</span>: &#123;
            <span class="hljs-attr">warnings</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">drop_console</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//console</span>
            <span class="hljs-attr">drop_debugger</span>: <span class="hljs-literal">false</span>,
            <span class="hljs-attr">pure_funcs</span>: [<span class="hljs-string">'console.log'</span>] <span class="hljs-comment">//ç§»é™¤console</span>
          &#125;
        &#125;,
        <span class="hljs-attr">sourceMap</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">parallel</span>: <span class="hljs-literal">true</span> <span class="hljs-comment">//ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œè¿è¡Œæ¥æé«˜æ„å»ºé€Ÿåº¦ã€‚é»˜è®¤å¹¶å‘è¿è¡Œæ•°ï¼šos.cpus().length - 1ã€‚</span>
      &#125;)
    )
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-21">DLLåŠ¨æ€é“¾æ¥åº“</h3>
<p>è¿™ä¸ªæ’ä»¶æ˜¯åœ¨ä¸€ä¸ªé¢å¤–çš„ç‹¬ç«‹çš„ webpack è®¾ç½®ä¸­åˆ›å»ºä¸€ä¸ªåªæœ‰ dll çš„ bundle(dll-only-bundle)ã€‚ è¿™ä¸ªæ’ä»¶ä¼šç”Ÿæˆä¸€ä¸ªåä¸º manifest.json çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”¨æ¥è®© DLLReferencePlugin æ˜ å°„åˆ°ç›¸å…³çš„ä¾èµ–ä¸Šå»çš„ã€‚</p>
<blockquote>
<p>å¯ä»¥ç®€å•ç†è§£ä¸ºæŠŠä¸€äº›ä¾èµ–ä»é¡¹ç›®çš„bundleä¸­æ‹†åˆ†å‡ºå»ï¼Œé€šè¿‡æ˜ å°„å…³ç³»ç”¨è¯·æ±‚æ¥åŠ è½½ã€‚æˆ‘è®¤ä¸ºæ‹†åˆ†å‡ºå»ä¹‹åä¸ä¼šå†åœ¨é¡¹ç›®é‡Œè¢«è§£æï¼Œå› æ­¤å¯¹æ„å»ºï¼Œä½“ç§¯éƒ½æ˜¯æœ‰æ‰€å¸®åŠ©çš„ã€‚</p>
</blockquote>
<p>é…ç½®DllPlugin,å¯ä»¥åˆ†ä¸ºä¸‹é¢å‡ ä¸ªæ­¥éª¤ï¼š</p>
<ol>
<li>æ–°å»ºwebpack.dll.config.jsæ–‡ä»¶(å…¶ä»–å‘½åéƒ½å¯ä»¥)ï¼Œé…ç½®éœ€è¦æ‹†åˆ†çš„æ’ä»¶ï¼›</li>
<li>åœ¨package.jsonæ–‡ä»¶ä¸­æ–°å»ºä¸€æ¡å‘½ä»¤æ¥ä¸“é—¨æ‰“åŒ…ï¼Œ<code>"build:dll":"webpack --config webpack.dll.config.js"</code>; è¿è¡Œè¯¥å‘½ä»¤ï¼›</li>
<li>åœ¨vue.config.js æ–‡ä»¶ä¸­é…ç½®<code>DllReferencePlugin</code>,ä¸»è¦æŠŠdllå¼•ç”¨åˆ°éœ€è¦é¢„ç¼–è¯‘çš„ä¾èµ–ï¼›</li>
<li>åœ¨index.htmlæ‰‹åŠ¨å¼•å…¥æ‹†åˆ†çš„bundleåŒ…ï¼ˆæ”¾åˆ°cdnçš„è¯ä¼šæ›´å¥½ï¼‰</li>
</ol>
<p>å®‰è£…ï¼š</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">#yarn 
yarn add webpack-cli@^<span class="hljs-number">3.2</span><span class="hljs-number">.3</span> add-asset-html-webpack-plugin@^<span class="hljs-number">3.1</span><span class="hljs-number">.3</span> clean-webpack-plugin@^<span class="hljs-number">1.0</span><span class="hljs-number">.1</span> --dev
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-comment">// webpack.dll.config.js</span>
<span class="hljs-comment">/* eslint-disable @typescript-eslint/no-var-requires */</span>
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>)
<span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'webpack'</span>)
<span class="hljs-keyword">const</span> CleanWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">'clean-webpack-plugin'</span>)
<span class="hljs-comment">// dllæ–‡ä»¶å­˜æ”¾çš„ç›®å½•</span>
<span class="hljs-keyword">const</span> dllPath = <span class="hljs-string">'public/vendor'</span>

<span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">entry</span>: &#123;
    <span class="hljs-comment">// éœ€è¦æå–çš„åº“æ–‡ä»¶</span>
    <span class="hljs-attr">vendor</span>: [<span class="hljs-string">'vue'</span>, <span class="hljs-string">'vue-router'</span>, <span class="hljs-string">'vuex'</span>],
    <span class="hljs-attr">utils</span>: [<span class="hljs-string">'axios'</span>, <span class="hljs-string">'lodash'</span>]
  &#125;,
  <span class="hljs-attr">output</span>: &#123;
    <span class="hljs-attr">path</span>: path.join(__dirname, dllPath),
    <span class="hljs-attr">filename</span>: <span class="hljs-string">'[name].dll.js'</span>,
    <span class="hljs-comment">// vendor.dll.jsä¸­æš´éœ²å‡ºçš„å…¨å±€å˜é‡å</span>
    <span class="hljs-comment">// ä¿æŒä¸ webpack.DllPlugin ä¸­åç§°ä¸€è‡´</span>
    <span class="hljs-attr">library</span>: <span class="hljs-string">'[name]_[hash]'</span>
  &#125;,
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-comment">// æ¸…é™¤ä¹‹å‰çš„dllæ–‡ä»¶</span>
    <span class="hljs-keyword">new</span> CleanWebpackPlugin([<span class="hljs-string">'*.*'</span>], &#123;
      <span class="hljs-attr">root</span>: path.join(__dirname, dllPath)
    &#125;),
    <span class="hljs-comment">// manifest.json æè¿°åŠ¨æ€é“¾æ¥åº“åŒ…å«äº†å“ªäº›å†…å®¹</span>
    <span class="hljs-keyword">new</span> webpack.DllPlugin(&#123;
      <span class="hljs-attr">path</span>: path.join(__dirname, dllPath, <span class="hljs-string">'[name]-manifest.json'</span>),
      <span class="hljs-comment">// ä¿æŒä¸ output.library ä¸­åç§°ä¸€è‡´</span>
      <span class="hljs-attr">name</span>: <span class="hljs-string">'[name]_[hash]'</span>,
      <span class="hljs-attr">context</span>: process.cwd()
    &#125;)
  ]
<span class="hljs-number">12</span>

<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨<code>vue.config.js plugin</code>ä¸­ä½¿ç”¨</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">config.plugin.push(
  <span class="hljs-keyword">new</span> DllReferencePlugin(&#123;
    <span class="hljs-attr">context</span>: process.cwd(),
    <span class="hljs-attr">manifest</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./public/vendor/vendor-manifest.json'</span>)
  &#125;),
    <span class="hljs-keyword">new</span> DllReferencePlugin(&#123;
    <span class="hljs-attr">context</span>: process.cwd(),
    <span class="hljs-attr">manifest</span>: <span class="hljs-built_in">require</span>(<span class="hljs-string">'./public/vendor/utils-manifest.json'</span>)
  &#125;),
    <span class="hljs-comment">// å°† dll æ³¨å…¥åˆ° ç”Ÿæˆçš„ html æ¨¡æ¿ä¸­</span>
    <span class="hljs-keyword">new</span> AddAssetHtmlPlugin(&#123;
    <span class="hljs-comment">// dllæ–‡ä»¶ä½ç½®</span>
    <span class="hljs-attr">filepath</span>: getPath(<span class="hljs-string">'./public/vendor/*.js'</span>),
    <span class="hljs-comment">// dll å¼•ç”¨è·¯å¾„</span>
    <span class="hljs-attr">publicPath</span>: <span class="hljs-string">'./vendor'</span>,
    <span class="hljs-comment">// dllæœ€ç»ˆè¾“å‡ºçš„ç›®å½•</span>
    <span class="hljs-attr">outputPath</span>: <span class="hljs-string">'./vendor'</span>
  &#125;)
)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-22">splitChunks åˆ†å‰²ä»£ç </h3>
<p><a href="https://webpack.docschina.org/plugins/split-chunks-plugin/" target="_blank" rel="nofollow noopener noreferrer">split-chunks-plugin webpack</a></p>
<ul>
<li>chunks: è¡¨ç¤ºå“ªäº›ä»£ç éœ€è¦ä¼˜åŒ–ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼šinitial(åˆå§‹å—)ã€async(æŒ‰éœ€åŠ è½½å—)ã€all(å…¨éƒ¨å—)ï¼Œé»˜è®¤ä¸ºasync</li>
<li>minSize: è¡¨ç¤ºåœ¨å‹ç¼©å‰çš„æœ€å°æ¨¡å—å¤§å°ï¼Œé»˜è®¤ä¸º30000</li>
<li>minChunks: è¡¨ç¤ºè¢«å¼•ç”¨æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1</li>
<li>maxAsyncRequests: æŒ‰éœ€åŠ è½½æ—¶å€™æœ€å¤§çš„å¹¶è¡Œè¯·æ±‚æ•°ï¼Œé»˜è®¤ä¸º5</li>
<li>maxInitialRequests: ä¸€ä¸ªå…¥å£æœ€å¤§çš„å¹¶è¡Œè¯·æ±‚æ•°ï¼Œé»˜è®¤ä¸º3</li>
<li>automaticNameDelimiter: å‘½åè¿æ¥ç¬¦</li>
<li>name: æ‹†åˆ†å‡ºæ¥å—çš„åå­—ï¼Œé»˜è®¤ç”±å—åå’Œhashå€¼è‡ªåŠ¨ç”Ÿæˆ</li>
<li>cacheGroups: ç¼“å­˜ç»„ã€‚ç¼“å­˜ç»„çš„å±æ€§é™¤ä¸Šé¢æ‰€æœ‰å±æ€§å¤–ï¼Œè¿˜æœ‰test, priority, reuseExistingChunk
<ul>
<li>test: ç”¨äºæ§åˆ¶å“ªäº›æ¨¡å—è¢«è¿™ä¸ªç¼“å­˜ç»„åŒ¹é…åˆ°</li>
<li>priority: ç¼“å­˜ç»„æ‰“åŒ…çš„å…ˆåä¼˜å…ˆçº§</li>
<li>reuseExistingChunk: å¦‚æœå½“å‰ä»£ç å—åŒ…å«çš„æ¨¡å—å·²ç»æœ‰äº†ï¼Œå°±ä¸åœ¨äº§ç”Ÿä¸€ä¸ªæ–°çš„ä»£ç å—</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-javascript copyable" lang="javascript">config.optimization = &#123;
  <span class="hljs-attr">runtimeChunk</span>: <span class="hljs-string">'single'</span>,
  <span class="hljs-attr">splitChunks</span>: &#123;
    <span class="hljs-attr">chunks</span>: <span class="hljs-string">'all'</span>, <span class="hljs-comment">// è¡¨ç¤ºå“ªäº›ä»£ç éœ€è¦ä¼˜åŒ–ï¼Œæœ‰ä¸‰ä¸ªå¯é€‰å€¼ï¼šinitial(åˆå§‹å—)ã€async(æŒ‰éœ€åŠ è½½å—)ã€all(å…¨éƒ¨å—)ï¼Œé»˜è®¤ä¸ºasync</span>
    <span class="hljs-attr">maxInitialRequests</span>: <span class="hljs-literal">Infinity</span>, <span class="hljs-comment">// æŒ‰éœ€åŠ è½½æ—¶å€™æœ€å¤§çš„å¹¶è¡Œè¯·æ±‚æ•°ï¼Œé»˜è®¤ä¸º5</span>
    <span class="hljs-attr">minSize</span>: <span class="hljs-number">30000</span>, <span class="hljs-comment">// ä¾èµ–åŒ…è¶…è¿‡300000bitå°†è¢«å•ç‹¬æ‰“åŒ…</span>
    <span class="hljs-comment">// ç¼“å­˜ç»„</span>
    <span class="hljs-comment">// priority: ç¼“å­˜ç»„æ‰“åŒ…çš„å…ˆåä¼˜å…ˆçº§</span>
    <span class="hljs-comment">// minChunks: è¡¨ç¤ºè¢«å¼•ç”¨æ¬¡æ•°ï¼Œé»˜è®¤ä¸º1</span>
    <span class="hljs-attr">cacheGroups</span>: &#123;
      <span class="hljs-comment">//å…¬å…±æ¨¡å—</span>
      <span class="hljs-attr">commons</span>: &#123;
        <span class="hljs-attr">name</span>: <span class="hljs-string">'chunk-commons'</span>,
        <span class="hljs-attr">test</span>: resolve(<span class="hljs-string">'src'</span>), <span class="hljs-comment">// can customize your rules</span>
        <span class="hljs-attr">minSize</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">//å¤§å°è¶…è¿‡100ä¸ªå­—èŠ‚</span>
        <span class="hljs-attr">minChunks</span>: <span class="hljs-number">3</span>, <span class="hljs-comment">//  minimum common number</span>
        <span class="hljs-attr">priority</span>: <span class="hljs-number">5</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>
      &#125;,
      <span class="hljs-comment">// ç¬¬ä¸‰æ–¹åº“</span>
      <span class="hljs-attr">libs</span>: &#123;
        <span class="hljs-attr">name</span>: <span class="hljs-string">'chunk-libs'</span>,
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]/</span>,
        priority: <span class="hljs-number">10</span>,
        <span class="hljs-attr">chunks</span>: <span class="hljs-string">'initial'</span>, <span class="hljs-comment">// only package third parties that are initially dependent</span>
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>
      &#125;,
      <span class="hljs-attr">echarts</span>: &#123;
        <span class="hljs-attr">name</span>: <span class="hljs-string">'chunk-echarts'</span>,
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/[\\/]node_modules[\\/]echarts[\\/]/</span>,
        chunks: <span class="hljs-string">'all'</span>,
        <span class="hljs-attr">priority</span>: <span class="hljs-number">12</span>,
        <span class="hljs-attr">reuseExistingChunk</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">enforce</span>: <span class="hljs-literal">true</span>
      &#125;
    &#125;
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-23">æ€»ç»“</h2>
<p>ä»¥ä¸Šæ˜¯æˆ‘åœ¨å…¬å¸é¡¹ç›®åšçš„ä¸€äº›å°ä¼˜åŒ–ï¼Œå¯¹å…¶ä»–é¡¹ç›®ä¸ä¸€å®šé€‚ç”¨ï¼Œç”šè‡³ä½¿ç”¨ä¸Šä¹Ÿä¸æ˜¯æœ€ä¼˜ï¼Œä½†ç›®å‰å¯¹æœ¬é¡¹ç›®å¾ˆå¤§ç¨‹åº¦ä¸Šè¿˜æ˜¯æœ‰å¸®åŠ©çš„ã€‚æ›´å¤šwebpackä¼˜åŒ–çš„æ€è·¯ï¼Œæˆ‘é™„ä¸Šä¸ªæ€ç»´å¯¼å›¾å§ã€‚(ä»…ä¾›å­¦ä¹ ï¼Œè®°å½•ğŸ“)
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dbedc66bbafc46ecbf24566346569527~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-24">å…¶ä»–</h2>
<p><a href="https://cli.vuejs.org/zh/" target="_blank" rel="nofollow noopener noreferrer">Vue CLI</a></p>
<p><a href="https://github.com/fncheng/blog/issues/26" target="_blank" rel="nofollow noopener noreferrer">vue-cliä¸­çš„configureWebpackè®¾ç½®</a></p>
<p><a href="https://shanyue.tech/frontend-engineering/docker.html#" target="_blank" rel="nofollow noopener noreferrer">å¦‚ä½•ä½¿ç”¨ docker éƒ¨ç½²å‰ç«¯é¡¹ç›®</a></p></div>  
</div>
            