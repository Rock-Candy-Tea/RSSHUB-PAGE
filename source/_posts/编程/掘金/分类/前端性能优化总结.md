
---
title: '前端性能优化总结'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/408ad6a8e16549da970437fc14ececb5~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Wed, 01 Sep 2021 01:06:52 GMT
thumbnail: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/408ad6a8e16549da970437fc14ececb5~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body html cache"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">1.减少HTTP请求</h2>
<p>一个完整的 HTTP 请求需要经历 DNS 查找，TCP 握手，浏览器发出 HTTP 请求，服务器接收请求，服务器处理请求并发回响应，浏览器接收响应等过程。建立连接和下载数据都需要时间，应尽量将多个小文件合并为一个大文件，从而减少 HTTP 请求次数。</p>
<h2 data-id="heading-1">2.将 CSS 放在文件头部，JavaScript 文件放在底部</h2>
<p>所有放在 head 标签里的 CSS 和 JS 文件都会堵塞渲染（CSS 不会阻塞 DOM 解析）。如果这些 CSS 和 JS 需要加载和解析很久的话，那么页面就空白了。所以 JS 文件要放在底部，等 HTML 解析完了再加载 JS 文件。</p>
<p>那为什么 CSS 文件还要放在头部呢？</p>
<p>因为先加载 HTML 再加载 CSS，会让用户第一时间看到的页面是没有样式的、“丑陋”的，为了避免这种情况发生，就要将 CSS 文件放在头部了。</p>
<p>另外，JS 文件也不是不可以放在头部，只要给 script 标签加上 defer 属性就可以了，异步下载，延迟执行。</p>
<h2 data-id="heading-2">3.减少重绘重排</h2>
<p><strong>浏览器渲染过程</strong></p>
<ol>
<li>解析HTML生成DOM树。</li>
<li>解析CSS生成CSSOM规则树。</li>
<li>解析JS，操作 DOM 树和 CSSOM 规则树。</li>
<li>将DOM树与CSSOM规则树合并在一起生成渲染树。</li>
<li>遍历渲染树开始布局，计算每个节点的位置大小信息。</li>
<li>浏览器将所有图层的数据发送给GPU，GPU将图层合成并显示在屏幕上。</li>
</ol>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/408ad6a8e16549da970437fc14ececb5~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p><strong>重排</strong>
元素位置和尺寸发生改变、DOM元素的增删、添加行内样式、浏览器窗口发生改变、页面首次渲染，元素相对于文档定位改变时会导致浏览器重新生成渲染树，这个过程叫重排。
<strong>重绘</strong>
当重新生成渲染树后，会将渲染树每个节点绘制到屏幕，这个过程叫重绘。颜色改变、背景图片改变，只要不影响元素相对于浏览器文档位置的改变，就只导致重绘。</p>
<p>如何减少重排重绘？
减少DOM操作、避免使用行内样式、修改DOM节点的多条语句合并成一条语句来执行。</p>
<h2 data-id="heading-3">4.图片优化</h2>
<h3 data-id="heading-4">图片延迟加载</h3>
<p>在页面中，先不给图片设置路径，只有当图片出现在浏览器的<strong>可视区域</strong>时，才去加载真正的图片，这就是延迟加载，即懒加载。实现原理：<a href="https://juejin.im/entry/6844903482164510734" title="https://juejin.im/entry/6844903482164510734" target="_blank">web 前端图片懒加载实现原理</a></p>
<h3 data-id="heading-5">使用字体图标 iconfont 代替图片图标</h3>
<p>字体图标就是将图标制作成一个字体，使用时就跟字体一样，可以设置属性，例如 font-size、color 等等，非常方便。并且字体图标是矢量图，不会失真。并且生成的文件特别小。</p>
<h3 data-id="heading-6">使用精灵图</h3>
<p>所谓精灵图就是把很多的小图片合并到一张较大的图片里，所以在首次加载页面的时候，就不用加载过多的小图片，只需要加载出来将小图片合并起来的那一张大图片也就是精灵图即可，这样在一定程度上减少了页面的加载速度，也一定程度上缓解了服务器的压力。
使用：将精灵图设为一个大背景，然后通过background-position来移动背景图，从而显示出我们想要显示出来的部分。
缺点：图片的背景都是我们详细测量而得出来的，当需要改动页面，会很麻烦。</p>
<h3 data-id="heading-7">尽可能利用 CSS3 效果代替图片</h3>
<p>有很多图片使用 CSS 效果（渐变、阴影等）就能画出来，这种情况选择 CSS3 效果更好。因为代码大小通常是图片大小的几分之一甚至几十分之一。</p>
<h3 data-id="heading-8">使用 webp 格式的图片</h3>
<p>WebP 的优势体现在它具有更优的图像数据压缩算法，能带来更小的图片体积，而且拥有肉眼识别无差异的图像质量；同时具备了无损和有损的压缩模式、Alpha 透明以及动画的特性，在 JPEG 和 PNG 上的转化效果都相当优秀、稳定和统一。</p>
<p>WebP优势可查看文档：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.zhihu.com%2Fquestion%2F27201061" title="https://link.juejin.cn/?target=https%3A%2F%2Fwww.zhihu.com%2Fquestion%2F27201061" target="_blank">WebP 相对于 PNG、JPG 有什么优势？</a></p>
<h2 data-id="heading-9">5.压缩文件</h2>
<p>压缩文件可以减少文件下载时间，让用户体验性更好。</p>
<p>gzip 是目前最流行和最有效的压缩方法，可以通过向 HTTP 请求头中的 Accept-Encoding 头添加 gzip 标识来开启这一功能。</p>
<p>在 webpack 可以使用如下插件进行压缩：</p>
<ul>
<li>JavaScript：UglifyPlugin</li>
<li>CSS ：MiniCssExtractPlugin</li>
<li>HTML：HtmlWebpackPlugin</li>
</ul>
<h2 data-id="heading-10">6.善用缓存，不重复加载相同资源</h2>
<p>为了避免用户每次访问网站都得请求文件，我们可以通过添加 Expires 或 max-age 来控制这一行为。Expires 设置了一个时间，只要在这个时间之前，浏览器都不会请求文件，而是直接使用缓存。而 max-age 是一个相对时间，建议使用 max-age 代替 Expires 。这里又设计HTTP缓存的知识——强缓存和协商缓存。</p>
<h2 data-id="heading-11">7.使用事件代理</h2>
<p>事件代理(委托):把原本需要绑定在子元素的响应事件委托给父元素，让父元素担任事件监听的职务。原理是DOM元素的事件冒泡。
优点：节省内存空间，减少事件注册(比如鼠标事件和键盘事件，ul代理所有li的click事件，新增元素时无需再次对其进行事件绑定)。</p>
<h2 data-id="heading-12">8.静态资源使用CDN</h2>
<p>内容分发网络(CDN)是一组分布在多个不同地理位置的web服务器。这些服务器存储着数据的副本，因此服务器会根据哪些服务器离用户距离最近来满足数据的请求。
CDN的两个核心点：</p>
<ul>
<li>缓存：就是指我们把资源复制一份到CDN服务器的这个过程</li>
<li>回溯：指CDN发现自己没有这个资源(一般是缓存的数据过期了)，转头向根服务器(或者上级服务器)去要资源的这个过程</li>
</ul>
<p>CDN原理：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.cnblogs.com%2Fcrazylqy%2Fp%2F7110156.html" target="_blank" rel="nofollow noopener noreferrer" title="https://www.cnblogs.com/crazylqy/p/7110156.html" ref="nofollow noopener noreferrer">CDN原理</a></p>
<h2 data-id="heading-13">9.使用服务器端渲染</h2>
<p>客户端渲染: 获取HTML文件，根据需要下载 JavaScript 文件，运行文件，生成 DOM，再渲染。</p>
<p>服务端渲染：服务端返回 HTML 文件，客户端只需解析 HTML。</p>
<ul>
<li>优点：首屏渲染快，SEO好。</li>
<li>缺点：配置麻烦，增加了服务器的计算压力</li>
</ul>
<p>区别：客户端渲染的网站是直接返回HTML文件，而服务端渲染的网站是渲染完页面再返回这个HTML文件。Vue的SSR就是服务端渲染。</p>
<h2 data-id="heading-14">10.webpack按需加载代码——Tree-Shaking</h2>
<p>懒加载或者按需加载，是一种很好的优化网页或应用的方式。这种方式实际上是先把你的代码在一些逻辑断点处分离开，然后在一些代码块中完成某些操作后，立即引用或即将引用另外一些新的代码块。这样加快了应用的初始加载速度，减轻了它的总体体积，因为某些代码块可能永远不会被加载。</p>
<p>在 webpack 项目中，有一个入口文件，相当于一棵树的主干，入口文件有很多依赖的模块，相当于树枝。实际情况中，虽然依赖了某个模块，但其实只使用其中的某些功能。通过 tree-shaking，将没有使用的模块摇掉，这样来达到删除无用代码的目的。(ES6的import动态引入组件实现按需加载)</p>
<p><a href="https://juejin.cn/post/6844903544756109319" target="_blank" title="https://juejin.cn/post/6844903544756109319">Tree-Shaking性能优化实践 - 原理篇</a></p>
<h2 data-id="heading-15">11.使用 Web Workers</h2>
<p>Web Worker 使用其他工作线程从而独立于主线程之外，它可以执行任务而不干扰用户界面。一个 worker 可以将消息发送到创建它的 JavaScript 代码, 通过将消息发送到该代码指定的事件处理程序（反之亦然）。</p>
<p>Web Worker 适用于那些处理纯数据，或者与浏览器 UI 无关的长时间运行脚本。</p>
<p>参考文档:<a href="https://juejin.cn/post/6892994632968306702#heading-37" target="_blank" title="https://juejin.cn/post/6892994632968306702#heading-37">前端性能优化24条建议</a></p></div>  
</div>
            