
---
title: 'å‡å¦‚åªå‰©ä¸‹canvasæ ‡ç­¾'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/780f76521af74f218a9278287beb3e84~tplv-k3u1fbpfcp-watermark.image'
author: æ˜é‡‘
comments: false
date: Tue, 04 May 2021 16:43:27 GMT
thumbnail: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/780f76521af74f218a9278287beb3e84~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><blockquote>
<p>å…³æ³¨å…¬ä¼—å·â€œæ‰§é¸¢è€…â€ï¼Œå›å¤â€œcanvasâ€è·å–å¯¹åº”æºç ï¼Œå›å¤â€œèµ„æ–™â€è·å–500Gèµ„æ–™ï¼ˆå„â€œå…µç§â€å‡æœ‰ï¼‰ï¼Œè¿˜æœ‰ä¸“ä¸šäº¤æµç¾¤ç­‰ä½ ä¸€èµ·æ¥æ½‡æ´’ã€‚</p>
</blockquote>
<h2 data-id="heading-0">ä¸€ã€èƒŒæ™¯</h2>
<blockquote>
<p>å¦‚æœåªå‰©ä¸‹canvasæ ‡ç­¾ï¼Œè¯¥å¦‚ä½•å»ç»˜åˆ¶é¡µé¢ä¸­çš„å†…å®¹å‘¢ï¼Ÿè¿™ä¹Ÿè®¸æ˜¯ä¸€ä¸ªä¼ªå‘½é¢˜ï¼Œä½†æ˜¯ç”¨canvasç¡®äº‹èƒ½å¤Ÿå¸®åŠ©å®Œæˆå¾ˆå¤šäº‹ã€‚ä»Šå¤©å°±ç”¨canvas+ASTè¯­æ³•æ ‘æ„å»ºä¸€ä¸ªä¿¡æ¯æµæ ·å¼ã€‚</p>
</blockquote>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/780f76521af74f218a9278287beb3e84~tplv-k3u1fbpfcp-watermark.image" alt="canvasä¿¡æ¯æµ.gif" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-1">äºŒã€ç»˜åˆ¶æµç¨‹</h2>
<blockquote>
<p>å°†æ•´ä¸ªç»˜åˆ¶æµç¨‹åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼šåŸºæœ¬å…ƒç´ ã€ASTè¯­æ³•æ ‘ã€ä¸»å‡½æ•°ç±»ã€‚åŸºæœ¬å…ƒç´ æŒ‡çš„æ˜¯å›¾ç‰‡ã€æ–‡å­—ã€çŸ©å½¢ã€åœ†ç­‰ï¼›ASTè¯­æ³•æ ‘åœ¨æœ¬å¤„å€¼å¾—å°±æ˜¯åŒ…å«ä¸€äº›å±æ€§çš„jså¯¹è±¡ï¼›ä¸»å‡½æ•°ç±»æŒ‡å¯¹å¤–æš´éœ²çš„æ¥å£ï¼Œé€šè¿‡è°ƒç”¨å®ç°æœ€ç»ˆç»˜åˆ¶ã€‚</p>
</blockquote>
<h3 data-id="heading-2">2.1 åŸºæœ¬å…ƒç´ </h3>
<blockquote>
<p>ä¸ç®¡å¤šä¹ˆå¤æ‚çš„äº‹ç‰©è‚¯å®šéƒ½æ˜¯ç”±ä¸€ç³»åˆ—ç®€å•çš„å…ƒç´ ç»„æˆï¼Œä¾‹å¦‚æ±½è½¦è‚¯å®šæ˜¯é€šè¿‡ä¸€äº›ç®€å•çš„æœºæ¢°é›¶é…ä»¶ç»„æˆï¼›ç”µè„‘ä¹Ÿæ˜¯é€šè¿‡ç”µé˜»ã€ç”µå®¹ç­‰é›¶é…ä»¶ç»„æˆã€‚ç½‘é¡µä¹Ÿä¸ä¾‹å¤–ï¼Œä¹Ÿæ˜¯é€šè¿‡æ–‡å­—ã€å›¾ç‰‡ã€çŸ©å½¢ç­‰ç»„æˆã€‚</p>
</blockquote>
<h4 data-id="heading-3">2.1.1 åŠ è½½å›¾ç‰‡</h4>
<blockquote>
<p>å›¾ç‰‡æ˜¯ä¸€ä¸ªé¡µé¢ä¸­çš„çµé­‚å…ƒç´ ï¼Œåœ¨é¡µé¢ä¸­å æ®ç»å¤§éƒ¨åˆ†ç©ºé—´ã€‚</p>
</blockquote>
<pre><code class="copyable">class DrawImage &#123;
    constructor(ctx, imageObj) &#123;
        this.ctx = ctx;
        this.imageObj = imageObj;
    &#125;

    draw() &#123;
        const &#123;centerX, centerY, src, sx = 1, sy = 1&#125; = this.imageObj;
        const img = new Image();
        img.onload = () => &#123;
            const imgWidth = img.width;
            const imgHeight = img.height;
            this.ctx.save();
            this.ctx.scale(sx, sy);
            this.ctx.drawImage(img, centerX - imgWidth * sx / 2, centerY - imgHeight * sy / 2);
            this.ctx.restore();
        &#125;;
        img.src = src;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-4">2.1.2 ç»˜åˆ¶æ–‡å­—</h4>
<blockquote>
<p>æ–‡å­—èƒ½å¤Ÿæé«˜é¡µé¢çš„å¯è¯»æ€§ï¼Œè®©è§‚å¯Ÿè¯¥é¡µé¢çš„æ¯ä¸€ä¸ªäººéƒ½èƒ½å¤Ÿå¿«é€Ÿäº†è§£è¯¥é¡µé¢çš„æ€æƒ³ã€‚</p>
</blockquote>
<pre><code class="copyable">class DrawText &#123;
    constructor(ctx, textObj) &#123;
        this.ctx = ctx;
        this.textObj = textObj;
    &#125;

    draw() &#123;
        const &#123;x, y, font, content, lineHeight = 20, width, fillStyle = '#000000', textAlign = 'start', textBaseline = 'middle'&#125; = this.textObj;
        const branchsContent = this.getBranchsContent(content, width);
        this.ctx.save();
        this.ctx.fillStyle = fillStyle;
        this.ctx.textAlign = textAlign;
        this.ctx.textBaseline = textBaseline;
        this.ctx.font = font;
        branchsContent.forEach((branchContent, index) => &#123;
            this.ctx.fillText(branchContent, x, y + index * lineHeight);
        &#125;);
        this.ctx.restore();
    &#125;

    getBranchsContent(content, width) &#123;
        if (!width) &#123;
            return [content];
        &#125;
        const charArr = content.split('');
        const branchsContent = [];
        let tempContent = '';
        charArr.forEach(char => &#123;
            if (this.ctx.measureText(tempContent).width < width && this.ctx.measureText(tempContent + char).width <= width) &#123;
                tempContent += char;
            &#125;
            else &#123;
                branchsContent.push(tempContent);
                tempContent = '';
            &#125;
        &#125;);
        branchsContent.push(tempContent);
        return branchsContent;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-5">2.1.3 ç»˜åˆ¶çŸ©å½¢</h4>
<blockquote>
<p>é€šè¿‡çŸ©å½¢å…ƒç´ èƒ½å¤Ÿä¸æ–‡å­—ç­‰å…ƒç´ é…åˆè¾¾åˆ°æ„æƒ³ä¸åˆ°çš„æ•ˆæœã€‚</p>
</blockquote>
<pre><code class="copyable">class DrawRect &#123;
    constructor(ctx, rectObj) &#123;
        this.ctx = ctx;
        this.rectObj = rectObj;
    &#125;

    draw() &#123;
        const &#123;x, y, width, height, fillStyle, lineWidth = 1&#125; = this.rectObj;
        this.ctx.save();
        this.ctx.fillStyle = fillStyle;
        this.ctx.lineWidth = lineWidth;
        this.ctx.fillRect(x, y, width, height);
        this.ctx.restore();
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-6">2.1.4 ç»˜åˆ¶åœ†</h3>
<blockquote>
<p>åœ†ä¸çŸ©å½¢æ‰¿æ‹…çš„è§’è‰²ä¸€è‡´ï¼Œä¹Ÿæ˜¯åœ¨é¡µé¢ä¸­æ¯”è¾ƒé‡è¦çš„è§’è‰²ã€‚</p>
</blockquote>
<pre><code class="copyable">class DrawCircle &#123;
    constructor(ctx, circleObj) &#123;
        this.ctx = ctx;
        this.circleObj = circleObj;
    &#125;

    draw() &#123;
        const &#123;x, y, R, startAngle = 0, endAngle = Math.PI * 2, lineWidth = 1, fillStyle&#125; = this.circleObj;
        this.ctx.save();
        this.ctx.lineWidth = lineWidth;
        this.ctx.fillStyle = fillStyle;
        this.ctx.beginPath();
        this.ctx.arc(x, y, R, startAngle, endAngle);
        this.ctx.closePath();
        this.ctx.fill();
        this.ctx.restore();
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-7">2.2 ASTæ ‘</h3>
<blockquote>
<p>ASTæŠ½è±¡è¯­æ³•æ ‘æ˜¯æºä»£ç è¯­æ³•ç»“æ„çš„ä¸€ç§æŠ½è±¡è¡¨ç¤ºã€‚å®ƒä»¥æ ‘çŠ¶çš„å½¢å¼è¡¨ç°ç¼–ç¨‹è¯­è¨€çš„è¯­æ³•ç»“æ„ï¼Œæ ‘ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½è¡¨ç¤ºæºä»£ç ä¸­çš„ä¸€ç§ç»“æ„ã€‚ä¾‹å¦‚ï¼Œåœ¨Vueä¸­ï¼Œå°†æ¨¡æ¿è¯­æ³•è½¬æ¢ä¸ºASTæŠ½è±¡è¯­æ³•æ ‘ï¼Œç„¶åå†å°†æŠ½è±¡è¯­æ³•æ ‘è½¬æ¢ä¸ºHTMLç»“æ„ï¼Œå’±ä»¬åœ¨åˆ©ç”¨canvasç»˜åˆ¶é¡µé¢æ—¶ä¹Ÿåˆ©ç”¨ASTæŠ½è±¡è¯­æ³•æ ‘æ¥è¡¨ç¤ºé¡µé¢ä¸­çš„å†…å®¹ï¼Œå®ç°çš„ç±»å‹æœ‰rectï¼ˆçŸ©å½¢ï¼‰ã€imgï¼ˆå›¾ç‰‡ï¼‰ã€textï¼ˆæ–‡å­—ï¼‰ã€circleï¼ˆåœ†ï¼‰ã€‚</p>
</blockquote>
<blockquote>
<p>æœ¬æ¬¡å°†ç»˜åˆ¶çš„å†…å®¹åŒ…å«é™æ€é¡µé¢éƒ¨åˆ†å’ŒåŠ¨ç”»éƒ¨åˆ†ï¼Œæ‰€ä»¥å°†åˆ©ç”¨ä¸¤ä¸ªcanvaså®ç°ï¼Œæ¯ä¸ªcanvaså°†å¯¹åº”ä¸€ä¸ªASTæ ‘ï¼Œåˆ†åˆ«ä¸ºé™æ€éƒ¨åˆ†ASTæ ‘å’ŒåŠ¨æ€éƒ¨åˆ†ASTæ ‘ã€‚</p>
</blockquote>
<h4 data-id="heading-8">2.2.1 é™æ€éƒ¨åˆ†ASTæ ‘</h4>
<blockquote>
<p>æœ¬æ¬¡ç»˜åˆ¶çš„é¡µé¢ä¸­é™æ€éƒ¨åˆ†çš„ASTæ ‘å¦‚ä¸‹æ‰€ç¤ºï¼ŒåŒ…å«çŸ©å½¢ã€å›¾ç‰‡ã€æ–‡å­—ã€‚</p>
</blockquote>
<pre><code class="copyable">const graphicAst = [
    &#123;
        type: 'rect',
        x: 0,
        y: 0,
        width: 1400,
        height: 400,
        fillStyle: '#cec9ae'
    &#125;,
    &#123;
        type: 'img',
        centerX: 290,
        centerY: 200,
        sx: 0.9,
        sy: 0.9,
        src: 'https://gimg2.baidu.com/image_search/src=http%3A%2F%2Finews.gtimg.com%2Fnewsapp_match%2F0%2F11858683821%2F0.jpg&refer=http%3A%2F%2Finews.gtimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1622015341&t=cc1bd95777dfa37d88c48bb6e179778e'
    &#125;,
    &#123;
        type: 'text',
        x: 600,
        y: 60,
        textAlign: 'start',
        textBaseline: 'middle',
        font: 'normal 40px serif',
        lineHeight: 50,
        width: 180,
        fillStyle: '#000000',
        content: 'ç°å¤ªç‹¼æ˜¯æœ€å¥½çš„ä¸€å¤´ç‹¼ï¼Œå®ƒæ¯å¤©éƒ½åœ¨æ¢¦æƒ³ç€åƒç¾Šï¼Œä¸€ç›´æ²¡æœ‰å®ç°ï¼Œä½†æ˜¯ä»ä¸æ°”é¦ã€‚'
    &#125;,
    &#123;
        type: 'text',
        x: 600,
        y: 170,
        textAlign: 'start',
        textBaseline: 'middle',
        font: 'normal 30px serif',
        lineHeight: 50,
        width: 180,
        fillStyle: '#7F7F7F',
        content: 'ä¸ºç°å¤ªç‹¼åŠ æ²¹ã€ä¸ºç°å¤ªç‹¼å–å½©ï¼ŒğŸ˜„'
    &#125;,
    &#123;
        type: 'text',
        x: 1200,
        y: 360,
        textAlign: 'start',
        textBaseline: 'ideographic',
        font: 'normal 30px serif',
        lineHeight: 50,
        width: 180,
        fillStyle: '#949494',
        content: 'é˜…è¯»'
    &#125;,
    &#123;
        type: 'text',
        x: 1260,
        y: 363,
        textAlign: 'start',
        textBaseline: 'ideographic',
        font: 'normal 30px serif',
        lineHeight: 50,
        width: 180,
        fillStyle: '#949494',
        content: '520'
    &#125;
];
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-9">2.2.2 åŠ¨æ€éƒ¨åˆ†ASTæ ‘</h4>
<blockquote>
<p>æœ¬æ¬¡ç»˜åˆ¶çš„é¡µé¢ä¸­åŠ¨ç”»éƒ¨åˆ†çš„ASTæ ‘åŠ¨æ€ç”Ÿæˆï¼Œç”±ä¸€ç³»åˆ—åŠ¨æ€é¢œè‰²çš„åœ†ç»„æˆã€‚</p>
</blockquote>
<pre><code class="copyable">function getMarqueeAst(startX, endX, count, options = &#123;&#125;) &#123;
    const &#123;y = 15, R = 15&#125; = options;
    if (!(endX >= startX && count > 0)) &#123;
        return [];
    &#125;
    const interval = (endX - startX) / count;
    const marqueeAstArr = [];
    for (let i = 0; i < count; i++) &#123;
        const RValue = Math.random() * 255;
        const GValue = Math.random() * 255;
        const BValue = Math.random() * 255;
        const fillStyle = `rgb($&#123;RValue&#125;, $&#123;GValue&#125;, $&#123;BValue&#125;)`;
        marqueeAstArr.push(&#123;
            type: 'circle',
            x: startX + i * interval,
            y,
            R,
            fillStyle
        &#125;);
    &#125;

    return marqueeAstArr;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-10">2.3 ä¸»å‡½æ•°ç±»</h3>
<blockquote>
<p>é™¤äº†ä¸Šè¿°ä¸€äº›åŸºæœ¬å…ƒç´ ç±»ï¼Œå°†é€šè¿‡ä¸€ä¸ªä¸»å‡½æ•°ç±»å¯¹å¤–è¿›è¡Œæš´éœ²ã€‚</p>
</blockquote>
<pre><code class="copyable">class Draw &#123;
    constructor(canvasDom) &#123;
        this._canvasDom = canvasDom;
        this.ctx = this._canvasDom.getContext('2d');
        this.width = this._canvasDom.width;
        this.height = this._canvasDom.height;
    &#125;

    // ç»˜åˆ¶å‡½æ•°
    draw(ast) &#123;
        ast.forEach(elementObj => &#123;
            this.drawFactory(elementObj);
            const &#123;children&#125; = elementObj;
            // é€’å½’è°ƒç”¨
            if (children && Array.isArray(children)) &#123;
                this.draw(children);
            &#125;
        &#125;);
    &#125;

    // å·¥å‚æ¨¡å‹ç»˜åˆ¶å¯¹åº”åŸºæœ¬å…ƒç´ 
    drawFactory(elementObj) &#123;
        const &#123;type&#125; = elementObj;
        switch(type) &#123;
            case 'img': &#123;
                this.drawImage(elementObj);
                break;
            &#125;
            case 'text': &#123;
                this.drawText(elementObj);
                break;
            &#125;
            case 'rect': &#123;
                this.drawRect(elementObj);
                break;
            &#125;
            case 'circle': &#123;
                this.drawCircle(elementObj);
                break;
            &#125;
        &#125;
    &#125;

    drawImage(imageObj) &#123;
        const drawImage = new DrawImage(this.ctx, imageObj);
        drawImage.draw();
    &#125;

    drawText(textObj) &#123;
        const drawText = new DrawText(this.ctx, textObj);
        drawText.draw();
    &#125;

    drawRect(rectObj) &#123;
        const drawRect = new DrawRect(this.ctx, rectObj);
        drawRect.draw();
    &#125;

    drawCircle(circleObj) &#123;
        const drawCircle = new DrawCircle(this.ctx, circleObj);
        drawCircle.draw();
    &#125;

    clearCanvas() &#123;
        this.ctx.clearRect(0, 0, this.width, this.height);
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-11">2.4 å†…å®¹ç»˜åˆ¶</h3>
<blockquote>
<p>å‰é¢çš„å‡†å¤‡å·¥ä½œå·²ç»å®Œæˆï¼Œä¸‹é¢å°†å„ä¸ªå‡½æ•°å’ŒASTæ ‘è”åŠ¨èµ·æ¥ï¼Œè¾¾åˆ°æƒ³è¦çš„æ•ˆæœã€‚</p>
</blockquote>
<h4 data-id="heading-12">2.4.1 é™æ€å†…å®¹ç»˜åˆ¶</h4>
<blockquote>
<p>å…ˆå°†é™æ€éƒ¨åˆ†çš„å†…å®¹ç»˜åˆ¶å¥½ï¼Œä½œä¸ºé¡µé¢çš„åŸºçŸ³ã€‚</p>
</blockquote>
<pre><code class="copyable">const basicCanvasDom = document.getElementById('basicCanvas');
const drawBasicInstance = new Draw(basicCanvasDom);
drawBasicInstance.draw(graphicAst);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78ac1f956f6d4fe5a02b928d3c5e2ccf~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-13">2.4.2 ç»˜åˆ¶åŠ¨ç”»è·‘é©¬ç¯</h4>
<blockquote>
<p>å†ç»™è¯¥éƒ¨åˆ†å†…å®¹æ¥ç‚¹åŠ¨ç”»æ•ˆæœï¼Œæ›´åŠ æ¿€åŠ¨äººå¿ƒã€‚</p>
</blockquote>
<pre><code class="copyable">const animationCanvasDom = document.getElementById('animationCanvas');
const drawAnimationInstance = new Draw(animationCanvasDom);

let renderCount = 0;
function animate() &#123;
    if (renderCount % 5 === 0) &#123;
        drawAnimationInstance.clearCanvas();
        drawAnimationInstance.draw(getMarqueeAst(20, 1440, 22));
        drawAnimationInstance.draw(getMarqueeAst(20, 1440, 22, &#123;
            y: 380
        &#125;));
    &#125;
    window.requestAnimationFrame(animate);
    renderCount++;
&#125;
animate();
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/780f76521af74f218a9278287beb3e84~tplv-k3u1fbpfcp-watermark.image" alt="canvasä¿¡æ¯æµ.gif" loading="lazy" referrerpolicy="no-referrer"></p>
<ol>
<li>
<p>æœ¬æ–‡å¯¹åº”æºç ï¼Œå…³æ³¨å…¬ä¼—å·â€œæ‰§é¸¢è€…â€ï¼Œå›å¤â€œcanvasâ€è·å–</p>
</li>
<li>
<p>å¦‚æœè§‰å¾—è¿™ç¯‡æ–‡ç« è¿˜ä¸é”™ï¼Œæ¥ä¸ªåˆ†äº«ã€ç‚¹èµå§ï¼Œè®©æ›´å¤šçš„äººä¹Ÿçœ‹åˆ°</p>
</li>
</ol></div>  
</div>
            