
---
title: '前端性能优化'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://cors.zfour.workers.dev/?http://s4.sinaimg.cn/mw69'
author: 掘金
comments: false
date: Mon, 09 Aug 2021 18:14:23 GMT
thumbnail: 'https://cors.zfour.workers.dev/?http://s4.sinaimg.cn/mw69'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>“<strong>这是我参与8月更文挑战的第5天，活动详情查看：<a href="https://juejin.cn/post/6987962113788493831" title="https://juejin.cn/post/6987962113788493831" target="_blank">8月更文挑战</a></strong>”</p>
<h5 data-id="heading-0">1，尽可能的缩小webpack或者其他打包工具生成的包的大小</h5>
<ul>
<li>去除不必要的插件</li>
<li>去除devtool选项</li>
<li>分离CSS 安装插件：npm install extract-text-webpack-plugin --save</li>
<li>使用webpack.optimize.UglifyJsPlugin插件压缩混淆</li>
<li>提取第三方库 像 react 这个库的核心代码就有 627 KB，这样和我们的源代码放在一起打包，体积肯定会很大。所以可以在 webpack 中设置</li>
</ul>
<p>**</p>
<pre><code class="copyable">&#123;
  entry: &#123;
   bundle: 'app'
    vendor: ['react']
  &#125;
  plugins: &#123;
    new webpack.optimize.CommonsChunkPlugin('vendor',  'vendor.js')
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<ul>
<li>webpack 插件列表。例如，当多个 bundle 共享一些相同的依赖，CommonsChunkPlugin 有助于提取这些依赖到共享的 bundle 中，来避免重复打包。可以像这样添加</li>
<li>按需打包</li>
</ul>
<h5 data-id="heading-1">2，防抖（debounce）/节流</h5>
<ul>
<li>防抖：高频率事件在n秒内触发一次，如果再次触发，则重新计时</li>
</ul>
<p>**</p>
<pre><code class="copyable">/*
 * @fn：要防抖执行的函数
 * @wait：防抖等待的时间
 * @immediate: true 表立即执行，false 表非立即执行
 */
debounce(fn, interval) &#123;
    let timeout;
    return function() &#123;
          let ctx = this;
          let args = arguments;

          if (timeout) clearTimeout(timeout);

         timeout = setTimeout(() => &#123;
            fn.apply(ctx, args);
      &#125;, interval);
&#125;&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<ul>
<li>节流：高频率事件在n秒内触发一次，n秒内不再触发</li>
</ul>
<p>**</p>
<pre><code class="copyable">/*
 * @fn：要防抖执行的函数
 * @wait：防抖等待的时间
 * @immediate: true 表立即执行，false 表非立即执行
 */
 
throttle(fn, interval) &#123;
      let last = 0;
      return function() &#123;
         let ctx = this;
         let args = arguments;

         let now = +new Date();
         if (now - last > interval) &#123;
             last = now;
             fn.apply(ctx, args);
         &#125;
&#125;&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>区别：防抖动和节流本质不一样；防抖是将多次执行变为最后一次执行，节流是将多次执行变成每隔一段时间执行。</p>
<h5 data-id="heading-2">3、图片懒加载（当图片出现在页面中，把data-src赋值给src）</h5>
<p>**</p>
<pre><code class="copyable"><img src="https://cors.zfour.workers.dev/?http://s4.sinaimg.cn/mw69" alt="1" data-src="https://cors.zfour.workers.dev/?http://img4.imgtn.bdimg.com/it/gp=0.jpg">
<span class="copy-code-btn">复制代码</span></code></pre>
<p>当载入页面时，先把可视区域内的img标签的data-src属性值负给src，然后监听滚动事件，把用户即将看到的图片加载。这样便实现了懒加载</p>
<h5 data-id="heading-3">4，提取组件的 CSS 到单独到文件</h5>
<p>当使用单文件组件时，组件内的 CSS 会以  标签的方式通过 JavaScript 动态注入。这有一些小小的运行时开销，将所有组件的 CSS 提取到同一个文件可以避免这个问题，也会让 CSS 更好地进行压缩和缓存
</p><h5 data-id="heading-4">5，GZip压缩</h5>
<p>在服务器端对文件进行压缩，在浏览器端对文件解压缩，可有效减少通信传输的数据量<br>
项目开启Gzip</p>
<ul>
<li>npm install compression</li>
<li>配置 server.js 新加如下命令</li>
</ul>
<p>**</p>
<pre><code class="copyable">var compression = require('compression')
var app = express();
//尽量在其他中间件前使用compression
app.use(compression());
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-5">6，使用浏览器缓存</h5>
<p>**</p>
<pre><code class="copyable">cache-control：用于控制HTTP缓存；
Expires：指定的时间内，同样的请求都可以使用缓存。
max-age ：判断 max-age 时间，时间内请求直接从浏览器缓存中获取，时间外直接请求，可以消除Expires的限制
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-6">7，图片优化（建议使用png）</h5>
<ul>
<li>jpg 有损压缩 压缩率高 不支持透明</li>
<li>png 支持透明 浏览器兼容性好</li>
<li>webp 压缩程度更好 在iOS webview有兼容性问题</li>
<li>SVG 矢量图 图片样式相对简单的场景</li>
</ul>
<p>大小比较：</p>
<blockquote>
<p>通常地，PNG ≈ JPG > GIF<br>
透明性：PNG > GIF > JPG<br>
色彩丰富程度：JPG > PNG >GIF<br>
兼容程度：GIF ≈ JPG > PNG</p>
</blockquote>
<h5 data-id="heading-7">8，使用服务端渲染的方式</h5>
<h5 data-id="heading-8">9、按照页面或者组件分块懒加载</h5>
<h5 data-id="heading-9">10，本地储存的使用</h5>
<ul>
<li>Cookie可以用来存储用户爱好和购买记录，用户浏览过的网站，曾经点击过的广告等信息；</li>
<li>Session Storage 更适合用来存储生命周期和它同步的会话级别的信息。这些信息只适用于当前会话，当你开启新的会话时，它也需要相应的更新或释放，比如微博的 Session Storage 就主要是存储你本次会话的浏览足迹；</li>
<li>Local Storage 的特点之一是持久，有时我们更倾向于用它来存储一些内容稳定的资源。比如图片内容丰富的电商网站会用它来存储 Base64 格式的图片字符串；</li>
<li>IndexDB 是一个运行在浏览器上的非关系型数据库，IndexDB 可以看做是 LocalStorage 的一个升级，当数据的复杂度和规模上升到了 LocalStorage 无法解决的程度，我们毫无疑问可以请出 IndexDB 来帮忙。</li>
</ul></div>  
</div>
            