
---
title: 'æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å›¾åºŠ'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3b42aa3f7f442ef9aa271c33dfbf005~tplv-k3u1fbpfcp-zoom-1.image'
author: æ˜é‡‘
comments: false
date: Sun, 18 Jul 2021 09:34:04 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3b42aa3f7f442ef9aa271c33dfbf005~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">å‰è¨€</h2>
<p>æˆ‘ä»¬åœ¨ä½¿ç”¨Typoraè¿›è¡Œåˆ›ä½œæ—¶ï¼Œæ–‡ç« ä¸­çš„å›¾ç‰‡å¯ä»¥é€‰æ‹©ä¿å­˜åˆ°æœ¬åœ°æˆ–è€…ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡æ–¹çš„å›¾åºŠã€‚</p>
<p>å¦‚æœå›¾ç‰‡ä¿å­˜åˆ°æœ¬åœ°ï¼Œå½“æˆ‘ä»¬éœ€è¦åœ¨äº’è”ç½‘å’Œåˆ«äººåˆ†äº«è‡ªå·±åˆ›ä½œçš„å†…å®¹æ—¶ï¼Œå›¾ç‰‡æ˜¯æ— æ³•æ˜¾ç¤ºçš„ï¼Œè€Œç¬¬ä¸‰æ–¹å›¾åºŠåŸºæœ¬ä¸Šéƒ½æ˜¯æ”¶è´¹çš„ã€‚</p>
<p>æœ¬æ–‡å°±å°†è·Ÿå¤§å®¶åˆ†äº«ä¸‹å¦‚ä½•æ­å»ºä¸€ä¸ªå±äºè‡ªå·±çš„å›¾åºŠï¼Œæ¬¢è¿å„ä½æ„Ÿå…´è¶£çš„å¼€å‘è€…é˜…è¯»æœ¬æ–‡ã€‚</p>
<h2 data-id="heading-1">ç¯å¢ƒæ­å»º</h2>
<p>åœ¨typoraçš„åå¥½é…ç½®ä¸­ï¼Œæˆ‘ä»¬åˆ‡æ¢åˆ°å›¾åƒä¸€æ ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b3b42aa3f7f442ef9aa271c33dfbf005~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717193829888" loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li>å›¾ä¸­åºå·1ä½ç½®ï¼Œå¯ä»¥é€‰æ‹©æ’å…¥å›¾ç‰‡æ—¶çš„è¡Œä¸ºï¼Œç‚¹å¼€åæˆ‘ä»¬é€‰æ‹©ä¸Šä¼ å›¾ç‰‡é€‰é¡¹</li>
<li>å›¾ä¸­åºå·2ä½ç½®ï¼Œå¯ä»¥é€‰æ‹©ä¸Šä¼ å›¾ç‰‡æ—¶ç”¨å“ªä¸ªå›¾åºŠå®¢æˆ·ç«¯ï¼Œç‚¹å¼€åæˆ‘ä»¬é€‰æ‹©uPicé€‰é¡¹</li>
</ul>
<h3 data-id="heading-2">å®‰è£…å›¾åºŠå®¢æˆ·ç«¯</h3>
<p>è¿›å…¥uPicé¡¹ç›®çš„<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fgee1k%2FuPic" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/gee1k/uPic" ref="nofollow noopener noreferrer">GitHubä¸»é¡µ</a>ï¼Œåœ¨<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fgee1k%2FuPic%2Freleases" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/gee1k/uPic/releases" ref="nofollow noopener noreferrer">Releases</a>é¡µé¢<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fgee1k%2FuPic%2Freleases%2Fdownload%2Fv0.21.1%2FuPic.zip" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/gee1k/uPic/releases/download/v0.21.1/uPic.zip" ref="nofollow noopener noreferrer">ä¸‹è½½</a>å®‰è£…åŒ…å³å¯ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78aa650750434882a2b903cff1b6a39a~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717200041404" loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä¸‹è½½å®Œæˆï¼Œè§£å‹åï¼Œå°†å…¶æ‹–æ‹½åˆ° <strong>åº”ç”¨ç¨‹åº</strong> æ–‡ä»¶å¤¹ä¸­ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8f31ae3d36f040d7ac1ebf579f0bc853~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717200357604" loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-3">é…ç½®å®¢æˆ·ç«¯</h3>
<p>æ‰“å¼€åº”ç”¨ç¨‹åºåï¼Œä¼šåœ¨èœå•æ å‡ºç°ä¸€ä¸ªå›¾æ ‡ï¼Œç‚¹å‡»ååœ¨å‡ºç°çš„é€‰é¡¹ä¸­ï¼Œç‚¹å‡»â€œåå¥½è®¾ç½®â€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/645874b9622a4a398c27a0cb8ffc9fb4~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717201111583" loading="lazy" referrerpolicy="no-referrer"></p>
<p>åœ¨æ‰“å¼€çš„ç•Œé¢ä¸­ï¼Œç‚¹å‡»å·¦ä¸‹è§’çš„åŠ å·ï¼Œåœ¨å¼¹å‡ºçš„é€‰é¡¹ä¸­ç‚¹å‡»è‡ªå®šä¹‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/176174d814d94aab83dffa7190a767dd~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717201448420" loading="lazy" referrerpolicy="no-referrer"></p>
<p>é€‰æ‹©è‡ªå®šä¹‰åï¼Œä¼šå‡ºç°å¦‚ä¸‹æ‰€ç¤ºçš„ç•Œé¢ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8a587e70561b4cbb98a4e003ab49922c~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717202944353" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-4">ä¸Šä¼ èµ„æºæ‰€éœ€é…ç½®</h4>
<p>æˆ‘ä»¬å…ˆæ¥é™ä¸‹å‰4ä¸ªæ ‡æ³¨çš„ä½œç”¨ï¼š</p>
<ul>
<li>åºå·1æ ‡æ³¨ä¸ºä¸Šä¼ æœåŠ¡çš„æ¥å£åœ°å€</li>
<li>åºå·2æ ‡æ³¨ä¸ºæ¥å£çš„è¯·æ±‚æ–¹å¼</li>
<li>åºå·3æ ‡æ³¨ï¼Œæ¥å£è§£ææ–‡ä»¶æµæ—¶çš„å­—æ®µå</li>
<li>åºå·4æ ‡æ³¨ä¸ºè°ƒç”¨ä¸Šä¼ æ¥å£æ—¶æ‰€éœ€çš„å…¶ä»–å­—æ®µï¼Œç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/40381f14890d430194ad4d636cd44be6~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717203729412" loading="lazy" referrerpolicy="no-referrer"></p>
<blockquote>
<p>æ³¨æ„ï¼šæˆ‘ä»¬éœ€è¦å¢åŠ ä¸€ä¸ªHeaderå­—æ®µï¼Œé”®åä¸ºï¼š<code>Content-Type</code>ï¼Œå€¼ä¸ºï¼š<code>multipart/form-data; charset=utf-8;</code>ã€‚</p>
<p>å¦‚æœä¸æ·»åŠ ï¼Œä½ çš„æ¥å£åˆ™ä¼šæŠ¥é”™ã€‚</p>
<p>bodyå­—æ®µåˆ™æ˜¯ä½ è°ƒç”¨ä¸Šä¼ æ¥å£æ—¶ï¼Œæ‰€éœ€çš„å…¶å®ƒé¢å¤–å‚æ•°ã€‚</p>
</blockquote>
<h4 data-id="heading-5">è·å–èµ„æºæ‰€éœ€é…ç½®</h4>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹ä¸‹å…¶ä»–æ ‡æ³¨çš„ä½œç”¨ï¼š</p>
<ul>
<li>
<p>æ ‡æ³¨5çš„å€¼ä¸ºä¸Šä¼ æˆåŠŸåï¼Œæ¥å£æ‰€è¿”å›çš„æ–‡ä»¶è·¯å¾„åœ°å€ã€‚ä¾‹å¦‚è¿”å›<code>&#123;path:"/uploads/20199afrj.png"&#125;</code>ï¼Œæˆ‘ä»¬éœ€è¦å–å‡ºpathçš„å€¼ï¼Œè¿™é‡Œå°±éœ€è¦å†™<code>["path"]</code>ï¼Œå±‚çº§æ·±çš„è¯åˆ™éœ€è¦ç»§ç»­å‘æ•°ç»„ä¸­è¿½åŠ å…ƒç´ ï¼Œè¯¦æƒ…è¯·ç§»æ­¥ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fblog.svend.cc%2Fupic%2Ftutorials%2Fcustom%2F%23URL-%25E8%258E%25B7%25E5%258F%2596%25E8%25A7%2584%25E5%2588%2599" target="_blank" rel="nofollow noopener noreferrer" title="https://blog.svend.cc/upic/tutorials/custom/#URL-%E8%8E%B7%E5%8F%96%E8%A7%84%E5%88%99" ref="nofollow noopener noreferrer">URL è·å–è§„åˆ™</a></p>
</li>
<li>
<p>æ ‡æ³¨6ä¸ºè·å–åˆ°ä¸Šä¼ çš„æ–‡ä»¶åï¼Œéœ€è¦è¿›è¡Œæ‹¼æ¥çš„åŸŸåå‰ç¼€</p>
</li>
<li>
<p>é…ç½®å®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥ç‚¹å‡»éªŒè¯æ¥çœ‹ä¸‹æœåŠ¡æ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœæ­£å¸¸ä½ ä¼šçœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºçš„æç¤ºï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f6e581bd189f4c65880c51f494167aff~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717212425413" loading="lazy" referrerpolicy="no-referrer"></p>
</li>
</ul>
<p>æœ€åï¼Œç‚¹å‡»æ ‡æ³¨7çš„ä¿å­˜ï¼Œæˆ‘ä»¬çš„é…ç½®å°±å®Œæˆäº†ã€‚</p>
<h2 data-id="heading-6">ä¸Šä¼ æœåŠ¡</h2>
<p>ä¸Šä¼ æœåŠ¡å¯ä»¥ä½¿ç”¨ä»»ä½•ä¸€é—¨åç«¯è¯­è¨€æ¥ç¼–å†™ï¼Œåªè¦éµå¾ªæ–‡ä»¶ä¸Šä¼ è§„èŒƒå³å¯ï¼Œç”±äºåç«¯è¯­è¨€æˆ‘åªä¼šJavaï¼Œæœ¬æ–‡å°±ä»¥Java+SpringBootæ¡†æ¶ä¸ºä¾‹ï¼Œå†™ä¸€æ®µç¤ºä¾‹ä»£ç ã€‚</p>
<h3 data-id="heading-7">æ§åˆ¶å±‚</h3>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹<code>controller</code>å±‚çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-keyword">import</span> org.springframework.stereotype.Controller;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.*;
<span class="hljs-keyword">import</span> com.lk.service.FileUploadService;
<span class="hljs-keyword">import</span> javax.annotation.Resource;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;

<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Controller</span>
<span class="hljs-comment">// å…è®¸è·¨åŸŸè®¿é—®</span>
<span class="hljs-meta">@CrossOrigin()</span>
<span class="hljs-meta">@RequestMapping("/uploads")</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileUploadController</span> </span>&#123;
    <span class="hljs-comment">// æ³¨å…¥æ–‡ä»¶ä¸Šä¼ æœåŠ¡</span>
    <span class="hljs-meta">@Resource(name = "FileUploadServiceImpl")</span>
    <span class="hljs-keyword">private</span> FileUploadService fileUploadService;
  
    <span class="hljs-meta">@PostMapping("/singleFileUploadToPath")</span>
    <span class="hljs-meta">@ResponseBody</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map<String, Object> <span class="hljs-title">singleFileUploadToPath</span><span class="hljs-params">(<span class="hljs-meta">@RequestParam("file")</span> MultipartFile file, <span class="hljs-meta">@RequestParam("path")</span> String path)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;
        Map<String, Object> result = <span class="hljs-keyword">new</span> HashMap<>(<span class="hljs-number">16</span>);
        <span class="hljs-comment">// è°ƒç”¨å•æ–‡ä»¶ä¸Šä¼ æ¥å£</span>
        <span class="hljs-keyword">return</span> fileUploadService.singleFileUpload(file, path);
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä¸Šè¿°ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ¥å—ä¸¤ä¸ªå‚æ•°ï¼š</p>
<ul>
<li>fileï¼šä¸Šä¼ è¿‡æ¥çš„æ–‡ä»¶æµ</li>
<li>pathï¼šä¸Šä¼ è·¯å¾„å</li>
</ul>
<h3 data-id="heading-8">æ¥å£å±‚</h3>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹<code>service</code>å±‚çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;

<span class="hljs-comment">// æ–‡ä»¶ä¸Šä¼ æ¥å£</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">FileUploadService</span> </span>&#123;
      <span class="hljs-function">Map<String, Object> <span class="hljs-title">singleFileUpload</span><span class="hljs-params">(MultipartFile file, String path)</span> <span class="hljs-keyword">throws</span> IOException</span>;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-9">å®ç°å±‚</h3>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹<code>serviceimpl</code>å±‚çš„ä»£ç ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-keyword">import</span> java.util.Map;
<span class="hljs-keyword">import</span> com.lk.service.FileUploadService;
<span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.util.HashMap;
<span class="hljs-keyword">import</span> java.io.File;
<span class="hljs-keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="hljs-keyword">import</span> org.springframework.stereotype.Service;
<span class="hljs-keyword">import</span> org.springframework.web.multipart.MultipartFile;
<span class="hljs-keyword">import</span> com.lk.utils.UUIDUtil;
<span class="hljs-keyword">import</span> com.lk.utils.DateUtil;
<span class="hljs-keyword">import</span> com.lk.utils.FileUtil;

<span class="hljs-meta">@Slf4j</span>
<span class="hljs-meta">@Service("FileUploadServiceImpl")</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FileUploadServiceImpl</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">FileUploadService</span> </span>&#123;
    <span class="hljs-comment">// ä»é…ç½®æ–‡ä»¶è¯»å–æ–‡ä»¶è·¯å¾„</span>
    <span class="hljs-meta">@Value("$&#123;uploadFilePath&#125;")</span>
    <span class="hljs-keyword">private</span> String fileBaseUrl;
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Map<String, Object> <span class="hljs-title">singleFileUpload</span><span class="hljs-params">(MultipartFile file, String path)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.writeFile(file, path);
    &#125;
  
    <span class="hljs-function"><span class="hljs-keyword">private</span> Map<String, Object> <span class="hljs-title">writeFile</span><span class="hljs-params">(MultipartFile file, String path)</span> <span class="hljs-keyword">throws</span> IOException </span>&#123;
        String fileType = file.getContentType();
        <span class="hljs-keyword">long</span> fileSize = file.getSize();
        log.info(<span class="hljs-string">"[æ–‡ä»¶ç±»å‹] - [&#123;&#125;]"</span>, fileType);
        log.info(<span class="hljs-string">"[æ–‡ä»¶åç§°] - [&#123;&#125;]"</span>, file.getOriginalFilename());
        log.info(<span class="hljs-string">"[æ–‡ä»¶å¤§å°] - [&#123;&#125;]"</span>, fileSize);
        <span class="hljs-comment">// æ–‡ä»¶å</span>
        String fileName = file.getOriginalFilename();
        <span class="hljs-keyword">assert</span> fileName != <span class="hljs-keyword">null</span>;
        <span class="hljs-comment">// ç”Ÿæˆæ–‡ä»¶å</span>
        String finalFileName = UUIDUtil.getUUID()+fileName.substring(fileName.lastIndexOf(<span class="hljs-string">"."</span>));
        <span class="hljs-comment">// å‘å®¢æˆ·ç«¯æ¨é€æ–‡ä»¶ä¿¡æ¯</span>
        Map<String, Object> result = <span class="hljs-keyword">new</span> HashMap<>(<span class="hljs-number">16</span>);
        <span class="hljs-keyword">if</span> (path.length() != <span class="hljs-number">0</span>) &#123;
            String dayTime = DateUtil.getTimeForDay();
            String writePath = fileBaseUrl + path + <span class="hljs-string">"/"</span> + dayTime + <span class="hljs-string">"/"</span>;
            <span class="hljs-comment">// è·¯å¾„ä¸å­˜åœ¨æ—¶ï¼Œåˆ™åˆ›å»º</span>
            Boolean touchResult  = FileUtil.touchFolder(writePath);
            <span class="hljs-keyword">if</span> (!touchResult) &#123;
                result.put(<span class="hljs-string">"code"</span>, -<span class="hljs-number">2</span>);
                result.put(<span class="hljs-string">"msg"</span>, <span class="hljs-string">"æœåŠ¡å™¨é”™è¯¯: è·¯å¾„åˆ›å»ºå¤±è´¥"</span>);
                log.error(<span class="hljs-string">"ä¸Šä¼ è·¯å¾„åˆ›å»ºå¤±è´¥"</span> + writePath);
                <span class="hljs-keyword">return</span> result;
            &#125;
            <span class="hljs-comment">// åˆ™å†™å…¥æŒ‡å®šè·¯å¾„ä¸‹</span>
            file.transferTo(<span class="hljs-keyword">new</span> File(writePath + finalFileName));
            result.put(<span class="hljs-string">"path"</span>, dayTime + <span class="hljs-string">"/"</span> + finalFileName);
        &#125; <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-comment">// å°†æ–‡ä»¶å†™å…¥é»˜è®¤è·¯å¾„ä¸‹</span>
            file.transferTo(<span class="hljs-keyword">new</span> File(fileBaseUrl + finalFileName));
        &#125;
        result.put(<span class="hljs-string">"code"</span>, <span class="hljs-number">0</span>);
        result.put(<span class="hljs-string">"data"</span>, <span class="hljs-string">"ä¸Šä¼ æˆåŠŸ"</span>);
        result.put(<span class="hljs-string">"contentType"</span>, file.getContentType());
        result.put(<span class="hljs-string">"fileName"</span>, finalFileName);
        result.put(<span class="hljs-string">"fileSize"</span>, file.getSize() + <span class="hljs-string">""</span>);
        <span class="hljs-keyword">return</span> result;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-10">å›¾åºŠå®¢æˆ·ç«¯è¯·æ±‚å¤´é…ç½®</h3>
<p>ä¸Šè¿°ä»£ç ä¸­æ‰€åˆ—ä¸¾çš„ä¸Šä¼ æœåŠ¡ï¼Œå‡ºäº†<code>file</code>å­—æ®µå¤–ï¼Œè¿˜éœ€è¦ä¼ <code>path</code>å­—æ®µï¼Œé‚£ä¹ˆåœ¨å›¾åºŠå®¢æˆ·ç«¯çš„é…ç½®å°±å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b26c22b640c348c1bec45b8e1cc8275f~tplv-k3u1fbpfcp-zoom-1.image" alt="image-20210717222238001" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-11">å®ç°æ•ˆæœ</h2>
<p>æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹é…ç½®å®Œæˆåçš„æ•ˆæœï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/839fbcdbeb7f49f288dbc525d40030a4~tplv-k3u1fbpfcp-zoom-1.image" alt="1111.gif" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-12">å†™åœ¨æœ€å</h2>
<p>è‡³æ­¤ï¼Œæ–‡ç« å°±åˆ†äº«å®Œæ¯•äº†ã€‚</p>
<p>æˆ‘æ˜¯<strong>ç¥å¥‡çš„ç¨‹åºå‘˜</strong>ï¼Œä¸€ä½å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆã€‚</p>
<p>å¦‚æœä½ å¯¹æˆ‘æ„Ÿå…´è¶£ï¼Œè¯·ç§»æ­¥æˆ‘çš„<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.kaisir.cn%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://www.kaisir.cn/" ref="nofollow noopener noreferrer">ä¸ªäººç½‘ç«™</a>ï¼Œè¿›ä¸€æ­¥äº†è§£ã€‚</p>
<ul>
<li>æ–‡ä¸­å¦‚æœ‰é”™è¯¯ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºæŒ‡æ­£ï¼Œå¦‚æœè¿™ç¯‡æ–‡ç« å¸®åˆ°äº†ä½ ï¼Œæ¬¢è¿ç‚¹èµå’Œå…³æ³¨ğŸ˜Š</li>
<li>æœ¬æ–‡é¦–å‘äºæ˜é‡‘ï¼Œæœªç»è®¸å¯ç¦æ­¢è½¬è½½ğŸ’Œ</li>
</ul></div>  
</div>
            