
---
title: '奥运会想多场比赛同时看怎么办？看我用vue+jquery+videojs实现'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6f838186ab04cbbbdf72b205a3ad914~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Fri, 30 Jul 2021 09:06:59 GMT
thumbnail: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6f838186ab04cbbbdf72b205a3ad914~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p><strong>最近在参与研发一个项目功能，大体是某地地图上展示区域内所有摄像头，点击摄像头时可以实时播放监控视频。</strong></p>
<p><strong>由于在开发阶段，视频流并未选择真实监控数据，而是m3u8格式的cctv直播链接，同事路过时正好看见我在测试视频播放，当时开着cctv1和cctv5，都在直播奥运比赛，“这个功能妙哇！实现了可以播放多个奥运比赛的功能”，便问我这功能能不能提出来，周末在家方便看奥运会嘿嘿，于是我结束了下午的摸鱼之旅...</strong></p>
<p><strong>最终效果：</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6f838186ab04cbbbdf72b205a3ad914~tplv-k3u1fbpfcp-watermark.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>gitee地址：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgitee.com%2Fharry_potter123%2Fcctv-player" target="_blank" rel="nofollow noopener noreferrer" title="https://gitee.com/harry_potter123/cctv-player" ref="nofollow noopener noreferrer">gitee.com/harry_potte…</a></p>
<p>实现过程：</p>
<p>创建vue项目，然后</p>
<pre><code class="copyable">npm install jquery
npm install video.jsz
<span class="copy-code-btn">复制代码</span></code></pre>
<p>在public/libs/flv目录下引入 videojs-flvh265.min.js</p>
<p>main.js配置</p>
<pre><code class="copyable">import $ from 'jquery';import 'video.js/dist/video-js.css'//视频播放window.$ = $;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>app.vue配置</p>
<pre><code class="copyable"><template>  <div id="app">    <div id="earthDiv">      <div class="container">        <ul id="ulId">          <li @click="playVideo(0)">cctv-1</li>          <li @click="playVideo(1)">cctv-2</li>          <li @click="playVideo(2)">cctv-3</li>          <li @click="playVideo(3)">cctv-4</li>          <li @click="playVideo(4)">cctv-5</li>          <li @click="playVideo(5)">cctv-6</li>          <li @click="playVideo(6)">cctv-7</li>          <li @click="playVideo(7)">cctv-8</li>          <li @click="playVideo(8)">cctv-9</li>          <li @click="playVideo(9)">cctv-10</li>          <li @click="playVideo(10)">cctv-11</li>          <li @click="playVideo(11)">cctv-12</li>          <li @click="playVideo(12)">cctv-13</li>          <li @click="playVideo(13)">cctv-14</li>          <li @click="playVideo(14)">cctv-15</li>        </ul>      </div>    </div>  </div></template><script>import videojs, &#123; log &#125; from "video.js";export default &#123;  data() &#123;    return &#123;      videoList: [        &#123; name: "cctv1",src: "http://ivi.bupt.edu.cn/hls/cctv1hd.m3u8",&#125;,        &#123; name: "cctv2",src: "http://ivi.bupt.edu.cn/hls/cctv2.m3u8",&#125;,        &#123; name: "CCTV3高清",src: "http://ivi.bupt.edu.cn/hls/cctv3hd.m3u8",&#125;,        &#123; name: "CCTV4高清",src: "http://ivi.bupt.edu.cn/hls/cctv4.m3u8",&#125;,        &#123; name: "CCTV5+高清", src: "http://ivi.bupt.edu.cn/hls/cctv5phd.m3u8",&#125;,        &#123; name: "CCTV6高清",src: "http://ivi.bupt.edu.cn/hls/cctv6hd.m3u8",&#125;,        &#123; name: "CCTV7高清",src: "http://ivi.bupt.edu.cn/hls/cctv7.m3u8"&#125;,        &#123; name: "CCTV-8高清 ",src: "http://ivi.bupt.edu.cn/hls/cctv8hd.m3u8",&#125;,        &#123; name: "CCTV-9高清 ",src: "http://ivi.bupt.edu.cn/hls/cctv9.m3u8"&#125;,        &#123; name: "CCTV-10高清 ",src: "http://ivi.bupt.edu.cn/hls/cctv10.m3u8"&#125;,        &#123; name: "CCTV-11高清 ", src: "http://ivi.bupt.edu.cn/hls/cctv11.m3u8" &#125;,        &#123; name: "CCTV-12高清 ", src: "http://ivi.bupt.edu.cn/hls/cctv12.m3u8" &#125;,        &#123; name: "CCTV-13高清 ", src: "http://ivi.bupt.edu.cn/hls/cctv13.m3u8" &#125;,        &#123; name: "CCTV-14高清 ", src: "http://ivi.bupt.edu.cn/hls/cctv14.m3u8" &#125;,        &#123; name: "CCTV-15高清 ", src: "http://ivi.bupt.edu.cn/hls/cctv15.m3u8" &#125;,      ],    &#125;;  &#125;,  created() &#123;&#125;,  mounted() &#123;    this.loadExtraScripts();  &#125;,  methods: &#123;    playVideo(index) &#123;      let data = this.videoList[index];      let link = data.src;      let name = data.name;      let videoId = "videoShow" + index;      let htmlStr = `<div class="videoBox" id="$&#123;videoId&#125;">            <header style="background-color:white;width:100%"><span>$&#123;name&#125;</span><span class="closeVideo">X</span></header>            <div style="width: 100%; height: 100%;">            <video  id="my-video$&#123;index&#125;"  class="video-js vjs-default-skin" controls  preload="auto"  width="440px" > <source  id="videoPlay"  src="http://ivi.bupt.edu.cn/hls/cctv3hd.m3u8"  type="application/x-mpegURL"/></video>            </div>            </div>`;      $("#earthDiv").append(htmlStr);      $(".container").bind("selectstart", function() &#123;        return false;      &#125;);      let thisBlock = $(`#$&#123;videoId&#125;`);      let myPlayer = videojs(`my-video$&#123;index&#125;`);      myPlayer.src([        &#123;          type: "application/x-mpegURL",          src: link,        &#125;,      ]);      myPlayer.play();      $(`#$&#123;videoId&#125; .closeVideo`).on("click", function() &#123;        $(this)          .parent()          .parent()          .remove();      &#125;);      $(`#$&#123;videoId&#125; header`).mousedown(function(e) &#123;        e.stopPropagation();        var drag = thisBlock[0];        var e = e || window.event;        var diffX = e.clientX - drag.offsetLeft;        var diffY = e.clientY - drag.offsetTop;        document.onmousemove = function(e) &#123;          var e = e || window.event;          var left = e.clientX - diffX;          var top = e.clientY - diffY;          if (left < 0) &#123;            left = 0;          &#125; else if (left > window.innerWidth - drag.offsetWidth) &#123;            left = window.innerWidth - drag.offsetWidth;          &#125;          if (top < 0) &#123;            top = 0;          &#125; else if (top > window.innerHeight - drag.offsetHeight) &#123;            top = window.innerHeight - drag.offsetHeight;          &#125;          drag.style.left = left + "px";          drag.style.top = top + "px";        &#125;;        document.onmouseup = function(e) &#123;          this.onmousemove = null;          this.onmouseup = null;          if (drag.releaseCapture) &#123;            drag.releaseCapture();          &#125;        &#125;;      &#125;);    &#125;,    //动态引入额外的js脚本    loadExtraScripts() &#123;      //引入videojs-flvh265.min.js      const video_script = document.createElement("script");      video_script.type = "text/javascript";      video_script.src = "./libs/flv/videojs-flvh265.min.js";      document.body.appendChild(video_script);    &#125;,  &#125;,&#125;;</script><style lang="less">.my-video0-dimensions &#123;  width: 100%;  height: 100%;&#125;#app &#123;  width: 100%;  height: 100%;&#125;.videoBox &#123;  position: fixed;  top: calc(50% - 150px);  left: calc(50% - 220px);  background-color: black;  width: 440px;  height: 300px;  z-index: 9;&#125;.closeVideo &#123;  margin-right: 10px;&#125;.closeVideo:hover &#123;  cursor: pointer;&#125;.videoBox header &#123;  display: flex;  justify-content: space-between;&#125;* &#123;  padding: 0;  margin: 0;&#125;ul &#123;  display: flex;  justify-content: center;  list-style: none;&#125;ul li &#123;  width: 70px;  height: 30px;  border: 1px solid #ccc;  margin-top: 20px;  margin-left: 25px;  line-height: 30px;  text-align: center;  border-radius: 4px;  box-shadow: 1px 1px 4px rgba(0, 0, 0, 0.27),    0 0 40px rgba(0, 0, 0, 0.06) inset;&#125;ul li:hover &#123;  cursor: pointer;&#125;</style>
<span class="copy-code-btn">复制代码</span></code></pre>
<p><strong>由于同事家用电脑没有安装环境，因此需要修改打包配置（用浏览器直接打开dist文件内的index.html便可以直接使用</strong>）vue.config.js</p>
<pre><code class="copyable">module.exports = &#123;    publicPath:'./'&#125;
<span class="copy-code-btn">复制代码</span></code></pre></div>  
</div>
            