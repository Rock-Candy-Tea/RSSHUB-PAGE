
---
title: '网络基础'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a6e1d90cbab45da9cde8fbff545362c~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Tue, 29 Jun 2021 23:43:14 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a6e1d90cbab45da9cde8fbff545362c~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;color:#383838;font-size:15px;line-height:37.5px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:120px&#125;.markdown-body ::selection&#123;color:#fff;background-color:#a862ea&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;margin:30px 0 15px;color:#a862ea&#125;.markdown-body h1&#123;line-height:2;font-size:1.4em&#125;.markdown-body h1~p:first-of-type:first-letter&#123;color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder&#125;.markdown-body h2&#123;font-size:1.2em&#125;.markdown-body h3&#123;font-size:1.1em&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:2em&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;padding-left:.2em&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:10px&#125;.markdown-body li::marker&#123;color:#a862ea&#125;.markdown-body li,.markdown-body p&#123;opacity:.9;vertical-align:baseline;transition:all .1s ease&#125;.markdown-body li:hover,.markdown-body p:hover&#123;opacity:1&#125;.markdown-body a&#123;display:inline-block;color:#a862ea;cursor:pointer;padding-bottom:2px;text-decoration:none;position:relative&#125;.markdown-body a:after&#123;content:"";position:absolute;width:98%;height:2px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out&#125;.markdown-body a:hover:after&#123;transform:scaleX(1);transform-origin:bottom left&#125;.markdown-body a:active,.markdown-body a:link&#123;color:#a862ea&#125;.markdown-body img&#123;max-width:100%;user-select:none;margin:1em 0;box-shadow:0 0 20px 0 #e7daff;transition:transform .2s ease 0s;background-color:#f8f5ff&#125;.markdown-body img:hover&#123;opacity:1;transform:translateY(-2px)&#125;.markdown-body blockquote&#123;padding:.5em 1em;margin:15px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:4px solid #a862ea;background-color:#f8f5ff&#125;.markdown-body blockquote>p&#123;margin:0&#125;.markdown-body code&#123;padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff&#125;.markdown-body pre&#123;margin:2em 0;box-shadow:0 0 20px #e7daff&#125;.markdown-body pre>code&#123;display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:22.5px;color:#383838;border-radius:3px;scroll-behavior:smooth&#125;.markdown-body pre>code::-webkit-scrollbar&#123;height:6px;background-color:#f8f5ff&#125;.markdown-body pre>code::-webkit-scrollbar-thumb&#123;background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px&#125;.markdown-body hr&#123;margin:2em 0;border-top:1px solid #a862ea&#125;.markdown-body table&#123;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #e7daff&#125;.markdown-body thead&#123;color:#a862ea;background:#f8f5ff&#125;.markdown-body td,.markdown-body th&#123;padding:1em .5em&#125;.markdown-body tr&#123;background-color:#fcfcfc&#125;@media (max-width:720px)&#123;.markdown-body&#123;font-size:12px&#125;&#125;</style><h3 data-id="heading-0">1. 同源策略</h3>
<p>同源策略是指域名, 协议, 端口相同; 不同源的客户端脚本在没明确授权的情况下, 不能读写对方的资源, 从而保护用户的隐私, 这就是为什么需要同源策略的原因</p>
<p>以百度网址为例<code>https://www.baidu.com/</code></p>
<ul>
<li>协议 - <code>https</code></li>
<li>域名 - <code>www.baidu.com</code></li>
<li>端口 - <code>443</code></li>
</ul>
<blockquote>
<ul>
<li>https 端口默认为 443</li>
<li>http 端口默认为 80</li>
<li>默认端口可以隐藏, 加上端口号之后百度网址为 <code>https://www.baidu.com:443/</code></li>
</ul>
</blockquote>
<blockquote>
<p>以<code>http://www.example.com/dir/page.html</code>为例, 以下与之的同源情况:</p>
<ul>
<li><code>http://www.example.com/dir2/other.html</code>同源</li>
<li><code>http://example.com/dir/other.html</code>不同源（域名不同）</li>
<li><code>http://v2.www.example.com/dir/other.html</code>不同源（域名不同）</li>
<li><code>http://www.example.com:81/dir/other.html</code>不同源（端口不同）</li>
</ul>
</blockquote>
<h4 data-id="heading-1">1.1 协议</h4>
<p>协议简单来说就是人类和计算机沟通的一些交流规则</p>
<h5 data-id="heading-2">1.1.1 HTTP</h5>
<p>HTTP由请求与响应构成, 是一个标准的客户端服务器模型, HTTP协议永远都是客户端发起请求, 服务器回送响应</p>
<blockquote>
<p>HTTP: 超文本传输协议, 是一种用于分布式、协作式和超媒体信息系统的应用层协议</p>
</blockquote>
<p>HTTP是一个无状态的协议; 无状态是指客户端和服务器之间不需要建立持久的连接, 所以当客户端向服务器发出请求, 且服务器返回响应之后, 连接就被关闭了</p>
<p>HTTP缺点</p>
<ul>
<li>通信使用明文, 可能被窃听</li>
<li>不验证通信方的身份, 可能遭遇伪装</li>
<li>无法证明报文的完整性, 有可能遭遇篡改</li>
</ul>
<h5 data-id="heading-3">1.1.2 HTTPS</h5>
<ul>
<li>HTTPS: HTTP + 加密 + 认证 + 完整性保护 = HTTPS</li>
<li>HTTPS是在HTTP上建立SSL加密层, 并对传输数据进行加密, 是HTTP协议的安全版; HTTPS = HTTP + TLS/SSL</li>
</ul>
<blockquote>
<p>HTTPS: 超文本传输安全协议, 是一种通过计算机网络进行安全通信的传输协议</p>
</blockquote>
<h4 data-id="heading-4">1.2 域名</h4>
<blockquote>
<p>域名用于在数据传输时对计算机的定位标识</p>
</blockquote>
<p>域名和IP地址是互相映射的, 由于<code>IP</code>地址不方便记忆等特点, 人们设计出了域名; 但是单凭一个域名也不能让我们直接访问到正确的地址, 只有将域名解析成实际的网络地址, 才能访问成功; 这种解析工作则由专门的域名系统——<code>DNS</code>完成</p>
<h4 data-id="heading-5">1.3 端口</h4>
<p>如果把 IP 地址比作一间房子, 端口就是出入这间房子的门, 一个IP地址的端口可以有多个</p>
<h4 data-id="heading-6">1.4 经典问题, 在浏览器中输入一个 url 会发生什么?</h4>
<ul>
<li>浏览器通过<code>DNS</code>域名解析到服务IP</li>
<li>客户端通过<code>TCP</code>协议建立到服务器的<code>TCP</code>连接(三次握手)
<ul>
<li>三次握手的过程如下</li>
<li>客户端发送连接, 请求报文(SYN), 此时客户端处于<code>SYN_SEND</code>状态</li>
<li>服务端接收连接后回复ACK报文, 并未这次连接分配资源</li>
<li>客户端收到ACK报文后也想服务端发动ACK报文, 并分配资源, 这样TCP连接就建立了</li>
</ul>
</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a6e1d90cbab45da9cde8fbff545362c~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li>客户端(浏览器)向web服务器端(HTTP服务器)发送HTTP协议包, 请求服务器里的资源文档</li>
<li>服务器向客户端发送HTTP协议应答包</li>
<li>客户端和服务器断开(四次握手), 客户端开始解析处理HTTP文档
<ul>
<li>
<p>四次挥手过程如下</p>
</li>
<li>
<p>客户端发起终端连接请求, 也就是发送FIN报文, 服务端接到FIN报文后, 意思是说: "我客户端没有数据要发送给你了, 但是如果你还有数据没有发送完成, 则不必着急关闭(Socket), 可以继续发送数据"</p>
</li>
<li>
<p>服务端发送ACK, 告诉客户端, 你的请求我收到了, 但是我还没准备好, 请继续等我的消息, waiting: 这时候客户端就进入FIN_WAIT状态, 继续等待服务端的FIN报文</p>
</li>
<li>
<p>当服务端确定数据已发送完成, 则向客户端发送FIN报文, 告诉客户端, 我这边数据发完了, 准备关闭连接了</p>
</li>
<li>
<p>客户端收到FIN报文后. 就可以到可以关闭连接了, 但是他还是不相信网络, 怕服务端不知道要关闭, 所以发送ACK后进入TIME_WAIT状态, 如果服务端没有收到ACK则可以重传, 服务端收到ACK后, 就知道可以断开连接了; 客户端等待了2MSL后依然没有收到回复, 则证明服务端已正常关闭, 此时, 客户端也可以断开连接, TCP连接就这样关闭了</p>
</li>
</ul>
</li>
</ul>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bdea4821c2cd4d5fa008c4b6adf327c5~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p></div>  
</div>
            