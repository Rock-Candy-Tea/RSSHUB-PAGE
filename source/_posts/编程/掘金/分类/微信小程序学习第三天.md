
---
title: '微信小程序学习第三天'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b06c4630e83946fc8e2ea05e5a2cc022~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Sat, 07 Aug 2021 00:15:10 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b06c4630e83946fc8e2ea05e5a2cc022~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p><code>这是我参与8月更文挑战的第7天，活动详情查看：</code><a href="https://juejin.cn/post/6987962113788493831" target="_blank" title="https://juejin.cn/post/6987962113788493831">更文挑战</a></p>
<h3 data-id="heading-0">数据相关</h3>
<h4 data-id="heading-1">修改数据</h4>
<p>Page构造函数，接收一个对象，对象有data属性，该属性是页面中的数据的存储地点。</p>
<p>我们想要在页面运行一段时间之后，修改页面上的数据。因为是数据驱动，所以我们修改数据。</p>
<p>修改方式： 该对象的某一个方法内 调用this.setData来修改数据</p>
<p>this.setData(obj);</p>
<p>obj.key: 要修改的层级路径</p>
<p>obj.value: 层级路径对应的值</p>
<p>这样就可以在修改数据的同时，修改页面上的显示内容</p>
<p>demo:</p>
<p>原始页面：</p>
<pre><code class="hljs language-js copyable" lang="js"><view>
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">text</span>></span>&#123;&#123;title&#125;&#125;<span class="hljs-tag"></<span class="hljs-name">text</span>></span></span>
</view>
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">view</span>></span>
<span class="hljs-tag"><<span class="hljs-name">text</span>></span>&#123;&#123;people.name&#125;&#125;<span class="hljs-tag"></<span class="hljs-name">text</span>></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>原始数据:</p>
<pre><code class="hljs language-js copyable" lang="js">data: &#123;
<span class="hljs-attr">title</span>: <span class="hljs-string">"今天天气不错"</span>,
    <span class="hljs-attr">people</span>: &#123;
        <span class="hljs-attr">name</span>: <span class="hljs-string">"王老五"</span>
    &#125;
&#125;,
<span class="copy-code-btn">复制代码</span></code></pre>
<p>渲染页面：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b06c4630e83946fc8e2ea05e5a2cc022~tplv-k3u1fbpfcp-watermark.image" alt="图片10.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-2">数据丢失</h4>
<p>千万不要直接this.data.xxx = xxx;</p>
<p>因为此时只是修改了数据，但没有触发修改页面内容的机制。导致页面与数据不一致。</p>
<h3 data-id="heading-3">事件</h3>
<p>在微信小程序中，事件分两类，一类是冒泡事件，用<code>bind-*</code>来添加 一类是不冒泡事件, 用<code>catch-*</code>来添加</p>
<h4 data-id="heading-4">冒泡事件</h4>
<p>绑定冒泡事件，通过<code>bind-*</code>添加， 如下：给id是child的组件添加了一个tap事件，事件函数的名称是child。要求必须在对应的js文件中，添加child事件函数</p>
<p>wxml:</p>
<pre><code class="hljs language-js copyable" lang="js"><view id=<span class="hljs-string">"father"</span>>
父亲
<view id=<span class="hljs-string">"child"</span> bindtap=<span class="hljs-string">'child'</span>>儿子</view>
</view>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>js:</p>
<pre><code class="hljs language-js copyable" lang="js">Page(&#123;
<span class="hljs-comment">/*** 页面的初始数据*/</span>
<span class="hljs-attr">data</span>: &#123;
&#125;,
 <span class="hljs-comment">/*** 生命周期函数--监听页面加载*/</span>
 <span class="hljs-attr">onLoad</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">options</span>) </span>&#123;
&#125;,
<span class="hljs-attr">child</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">"子元素的事件"</span>)
&#125;
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>点击触发：</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f4c9e148c0144465b4ad08851bfaa757~tplv-k3u1fbpfcp-watermark.image" alt="图片1.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>现在我们再去给父组件绑定一个同类型事件。</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/01780d1ff04d47a68da11d99efdb4ac9~tplv-k3u1fbpfcp-watermark.image" alt="图片2.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-5">不冒泡事件</h4>
<p>将绑定的方式从bind-修改为catch-即可</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aaa31ec160f64141b2d1902c9ed542f2~tplv-k3u1fbpfcp-watermark.image" alt="图片3.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-6">自定义属性</h4>
<p>通过<code>data-*</code>给组件添加自定义属性。如何获取这些自定义属性呢？</p>
<p>答：通过事件获取 在事件函数中有一个事件对象 从它身上可以得到对应的自定义属性。</p>
<p>demo：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/643d27ba2aa84c008e7f220830a6a171~tplv-k3u1fbpfcp-watermark.image" alt="图片4.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>如何获取？ 答：通过<code>e.currentTarget.dataset.xx</code></p>
<h4 data-id="heading-7">事件对象</h4>
<p>查看:</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/72b4dabe099d41a2ba34f05f16f6c56d~tplv-k3u1fbpfcp-watermark.image" alt="图片5.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>changedTouches: 手指的位置集合 里面的每一个成员代表一个手指</p>
<p>成员：手指信息</p>
<p>     clientX: 手指在视口中的x位置</p>
<p>     clientY: 手指在视口中的y位置</p>
<p>     pageX: 手指在页面中的x位置</p>
<p>     pageY: 手指在页面中的y位置</p>
<p>currentTarget: 绑定事件的组件对象 拥有各种属性</p>
<p>     id: 组件的id</p>
<p>     offsetLeft：距离父组件的left位置</p>
<p>     offsetTop: 距离付组件的top位置</p>
<p>     dataset:组件的自定义数据集合对象</p>
<p>detail：手指的位置</p>
<p>target：触发事件的组件 跟currentTarget结构一致</p>
<p>timeStamp：时间戳 表示页面加载开始，距离事件触发一共过了多久 毫秒值单位</p>
<p>touches：与changedTouches结构一致</p>
<p>type：事件类型</p>
<h3 data-id="heading-8">路由</h3>
<p>微信小程序中的路由，指的就是页面之间的跳转</p>
<h4 data-id="heading-9">页面分类</h4>
<p>微信小程序的所有页面都被配置在app.json中的pages数组里。</p>
<p>可是还有一部分是配置在tabBar的list中的。</p>
<p>tabBar页面：在pages中也在tabBar的list中的页面，我们叫做tabBar页面。</p>
<p>普通页面：在pages中，但不在tabBar中的页面，我们叫做普通页面。</p>
<h4 data-id="heading-10">跳转方式分类</h4>
<ul>
<li>第一种：通过组件跳转</li>
</ul>
<p>组件名称：navigator</p>
<p>属性：</p>
<p>url: 跳转的目标页面地址</p>
<p>open-type: 打开方式 这个值要根据目标页面的类型决定</p>
<p>如果目标页面是一个tabBar页面，那么要设置为 switchTab</p>
<p>如果目标页面是一个普通页面，那么要设置为navigateTo</p>
<ul>
<li>通过代码跳转</li>
</ul>
<h4 data-id="heading-11">跳转方式</h4>
<h5 data-id="heading-12">通过组件跳转tabBar页面</h5>
<pre><code class="hljs language-js copyable" lang="js"><navigator url=<span class="hljs-string">"/pages/second/second"</span> open-type=<span class="hljs-string">"switchTab"</span>>跳转到第二个页面</navigator>
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-13">通过组件跳转普通页面</h5>
<pre><code class="hljs language-js copyable" lang="js"><navigator url=<span class="hljs-string">"/pages/third/third"</span> open-type=<span class="hljs-string">"navigateTo"</span>>跳转到第三个页面</navigator>
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-14">通过代码跳转tabBar页面</h5>
<pre><code class="hljs language-js copyable" lang="js">wx.switchTab(&#123;
    <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/second/second'</span>
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-15">通过代码跳转普通页面</h5>
<pre><code class="hljs language-js copyable" lang="js">wx.navigateTo(&#123;
   <span class="hljs-attr">url</span>: <span class="hljs-string">'/pages/third/third'</span>
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<h5 data-id="heading-16">补充</h5>
<p>以上是常规的跳转方式，都是打开目标页面，隐藏当前页面。还有一些方式，是会对当前页面进行操作的。</p>
<p>重定向方式</p>
<p>组件：</p>
<p>重定向到三页</p>
<p>代码：<code>wx.redirectTo(&#123;url: "/pages/third/third"&#125;)</code></p>
<p>后退方式：</p>
<p>组件：<code><navigator open-type='navigateBack'>后退</navigator></code>
代码: <code>wx.navigateBack()</code></p>
<h4 data-id="heading-17">页面历史记录</h4>
<p>微信小程序中的历史记录是采用堆栈结构。</p>
<p>堆栈：先进后出，后进先出</p>
<p>队列：先进先出，后进后出</p>
<h5 data-id="heading-18">情况1 跳转到tabBar页面</h5>
<p>当前页面：隐藏</p>
<p>目标页面：加载、显示、渲染</p>
<h5 data-id="heading-19">情况2 navigateTo到普通页面</h5>
<p>当前页面：隐藏</p>
<p>目标页面：加载、显示、渲染</p>
<h5 data-id="heading-20">情况3 redirectTo到普通页面</h5>
<p>当前页面：卸载</p>
<p>目标页面：加载、显示、渲染</p>
<h5 data-id="heading-21">情况4 navigateBack</h5>
<p>当前页面：卸载</p>
<p>目标页面：显示</p></div>  
</div>
            