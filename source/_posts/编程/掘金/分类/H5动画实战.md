
---
title: 'H5动画实战'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1940b7e0a15a4b19b2f7f17e68b533a9~tplv-k3u1fbpfcp-zoom-1.image'
author: 掘金
comments: false
date: Fri, 09 Apr 2021 03:33:07 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1940b7e0a15a4b19b2f7f17e68b533a9~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h3 data-id="heading-0">前言</h3>
<p>动画效果一直是人机交互的一个非常重要的部分，动画效果的引入，会让交互变得更加友好，让用户获得更加愉悦的体验。而随着市场环境变化，手机性能越来越好，网速越来越快，以及用户视觉效果要求越来越高，作为一名网页开发者，动画也是一个必会的技能。由此本文和大家分享下动画方面的技术实践经验。</p>
<h3 data-id="heading-1">动画的形成</h3>
<p>多张不同的图像连在一起就会变成了动态的图像。在网页端的世界里，浏览器在视觉暂留时间内，连续不断的逐帧输出图像。每一帧输出一张图像，形成了用户视觉效果中的动画。那么怎么高效的通过一帧帧输出连续流畅的动画，是有很多种动画技术可以都可以实现的。</p>
<h3 data-id="heading-2">动画技术</h3>
<p>下面以当今主流的动画技术，分成四个部分给大家介绍下，分别为<code>纯Css</code>、<code>Lottie库</code>、<code>Svga库</code>、<code>Creatjs库</code>。</p>
<h4 data-id="heading-3">一、纯CSS</h4>
<p>1.1 <code>Animation</code>动画属性主要结合<code>@keyframes</code>规则来创建动画。</p>
<p>下面以语音喇叭声波动效为例：
中间的小圆点是一直存在的，第一条和第二条线都是<code>1/4</code>的圆弧，分别间隔<code>0.2s</code>去循环显示隐藏。</p>
<p><img alt="声波动效.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1940b7e0a15a4b19b2f7f17e68b533a9~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-selector-class">.second</span> &#123;
    <span class="hljs-attribute">animation</span>: fadeInOut <span class="hljs-number">1s</span> infinite <span class="hljs-number">0.2s</span>;
&#125;
<span class="hljs-selector-class">.third</span> &#123;
   <span class="hljs-attribute">animation</span>: fadeInOut <span class="hljs-number">1s</span> infinite <span class="hljs-number">0.4s</span>;
&#125;
<span class="hljs-keyword">@keyframes</span> fadeInOut &#123;
  <span class="hljs-number">0%</span> &#123;
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">0</span>;
    <span class="hljs-comment">/*初始状态 透明度为0*/</span>
  &#125;
  <span class="hljs-number">100%</span> &#123;
    <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;
    <span class="hljs-comment">/*结尾状态 透明度为1*/</span>
  &#125;
&#125;

<span class="copy-code-btn">复制代码</span></code></pre>
<p>我们一般用阶跃函数<code>step</code>来做帧动画。
下面是<code>linear</code>和<code>step</code>的具体案例：</p>
<p><a href="https://codepen.io/huihui/pen/ExPKbdj" target="_blank" rel="nofollow noopener noreferrer">codepen.io/huihui/pen/…</a></p>
<p>先生成<code>Sprite</code>图片，再移动<code>X</code>轴位置形成帧动画。</p>
<p><img alt="image1.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c7ca793dca544c57963d70b97e117d10~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p><img alt="linear-step.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c89b2fc4eeb74969bf23c2b27a1fa0bf~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>1.2 <code>Transform</code>属性应用于元素的2D或3D转换。该属性允许我们对元素进行旋转、缩放、倾斜、移动、透视以及使用矩阵函数。分别为<code>rotate</code>，<code>scale</code>，<code>skew</code>，<code>translate</code>，<code>perspective</code>以及<code>matrix</code>。还可以通过<code>transform-origin</code>用来确定中心点的位置为<code>X、Y、Z</code>，默认值：50% 50% 0。
这里有个很好的例子来演示<code>Transform</code>属性：<a href="https://c.runoob.com/codedemo/3391" target="_blank" rel="nofollow noopener noreferrer">c.runoob.com/codedemo/33…</a></p>
<p><img alt="transform.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/28ef4281dafd4333b9f03cf7c7553a0c~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>下面以翻牌动效为例，主要是通过透视<code>perspective</code>属性来实现：</p>
<p>要达到图中<code>第一组翻牌</code>的效果。首先设置<code>transform-style: preserve-3d</code>，使被转换的子元素保留其<code>3D</code>转换。如果不加透视距离<code>perspective</code>，则会为<code>第三组翻牌</code>中的效果，扁平没有<code>Z</code>轴的立体感。其次添加了透视距离后，如果<code>Z</code>轴相同，三个卡片是会有重叠的现象，如<code>第二组翻牌</code>中的效果。最后特意给<code>卡片一</code>加大了<code>Z</code>轴距离。这样通过透视，如果<code>Z</code>轴距离越大，卡片就看上去越小。可以用<code>scale</code>放大了<code>卡片一</code>。</p>
<p><img alt="排行榜翻牌.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e26bf22eaf54448e874db57882fa2a3d~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-selector-class">.card-board</span>&#123;
  <span class="hljs-attribute">perspective</span>: <span class="hljs-number">800</span>;
&#125;
<span class="hljs-selector-class">.board-item-wrap1</span>&#123;
  <span class="hljs-attribute">transform</span>: <span class="hljs-built_in">scale</span>(<span class="hljs-number">1.1</span>) <span class="hljs-built_in">translateZ</span>(-<span class="hljs-number">100px</span>);
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<blockquote>
<p>提示：一般用<code>transform: translateZ(0)</code>，开启<code>3D</code>引擎，触发<code>GPU</code>加速，让网页动画更流畅。</p>
</blockquote>
<p>1.3 <code>Transition</code>属性是用来设置动画过渡效果的，可以设置动画的过渡时间和延迟时间。还可以添加动画函数<code>animation-timing-function</code>，其默认值为<code>ease</code>。可用贝塞尔曲线来做为动画速度曲线，推荐一个贝塞尔曲线的可视化网址：<a href="https://cubic-bezier.com/" target="_blank" rel="nofollow noopener noreferrer">cubic-bezier</a>，</p>
<p><img alt="贝塞尔曲线.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abef8f5d10dc4a4187274bf00420ed86~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer">
以地图页的动画为例：
品牌岛屿的移动效果用了<code>ease</code>，由于后面的品牌需要模糊，设置了较晚模糊的贝塞尔曲线</p>
<p><img alt="map.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dca4664140544ff6b2bf80ac849bb1f0~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-attribute">transition</span>: transform <span class="hljs-number">1s</span> ease,filter <span class="hljs-number">1s</span> <span class="hljs-built_in">cubic-bezier</span>(.<span class="hljs-number">06</span>,.<span class="hljs-number">45</span>,.<span class="hljs-number">82</span>,<span class="hljs-number">1.34</span>);
<span class="copy-code-btn">复制代码</span></code></pre>
<p><a href="https://cubic-bezier.com/#.06,.45,.82,1.34" target="_blank" rel="nofollow noopener noreferrer">cubic-bezier.com/#.06,.45,.8…</a></p>
<p><img alt="image2.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f97c86898298491baa3560f79ba610c1~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>1.4 <code>Js</code>动画事件监听：
动画事件有：</p>
<blockquote>
<p><a href="https://www.runoob.com/jsref/event-animationstart.html" target="_blank" rel="nofollow noopener noreferrer">animationstart</a> - CSS动画开始后触发</p>
</blockquote>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLElement/animationiteration_event" target="_blank" rel="nofollow noopener noreferrer">animationiteration</a>- CSS 动画重复播放时触发</p>
</blockquote>
<blockquote>
<p><a href="https://www.runoob.com/jsref/event_animationend.html" target="_blank" rel="nofollow noopener noreferrer">animationend</a> - CSS动画完成后触发</p>
</blockquote>
<p>过渡事件有：</p>
<blockquote>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Events/transitionend" target="_blank" rel="nofollow noopener noreferrer">transitionend</a>- 该事件在 CSS 完成过渡后触发。</p>
</blockquote>
<p>注意：<code>transitionend</code>存在个问题.如果<code>transition</code>中,变换的属性有多个，就会触发多次。比如如果同时设置宽高的过渡效果（transition:width:.2s,height:.2s），那么<code>transitionend</code>事件就会触发<code>2</code>次。</p>
<p>以<code>2</code>秒消失提示框为例：</p>
<p>动画结束<code>2</code>秒后隐藏，用<code>animationEnd</code>事件来监听。</p>
<p><img alt="toast.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/70a7801a3bd74891b074997adbf840ef~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>兼容性：
上面<code>4</code>个事件都存在兼容性问题，在<code>Android5</code>下或<code>Ios9.3</code>下都需要加<code>webkit</code>前缀才能兼容，例如<code>animationstart</code>事件在<code>Android5</code>下需要用<code>webkitAnimationStart</code>。</p>
<p><img alt="webkit.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1af9ca58f424efa94733c00c3adf4eb~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>兼容性这块本人封装了插件<a href="https://www.npmjs.com/package/jdyfe-eventployfill" target="_blank" rel="nofollow noopener noreferrer">jdyfe-eventployfill</a>，原理是用<code>createElement</code>创建一个元素但是不插入页面<code>Dom</code>,查找<code>style</code>中是否有动画事件，来作为<code>webkit</code>的兼容判断
使用方法</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">import</span> &#123; janimationstart, janimationiteration, janimationend, jtransitionend &#125; <span class="hljs-keyword">from</span><span class="hljs-string">'jdyfe-eventPloyfill'</span>
    ...
    dom.addEventListener(janimationstart, <span class="hljs-function">()=></span>&#123;&#125;)
    dom.addEventListener(janimationiteration, <span class="hljs-function">()=></span>&#123;&#125;)
    dom.addEventListener(janimationend, <span class="hljs-function">()=></span>&#123;&#125;)
    dom.addEventListener(jtransitionend, <span class="hljs-function">()=></span>&#123;&#125;)
    ...
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-4">二、Lottie</h4>
<p><code>airbnb</code>提供的开源动画库<a href="https://github.com/airbnb/lottie-web" target="_blank" rel="nofollow noopener noreferrer">Lottie</a></p>
<blockquote>
<p>支持多版本，<code>React Native</code>，<code>web</code>和  <code>iOS</code>， <code>Android</code> 版本</p>
</blockquote>
<blockquote>
<p>用矢量图导出。</p>
</blockquote>
<blockquote>
<p>在浏览器中生成的是<code>svg</code>标签，不会失真</p>
</blockquote>
<p>案例为：
<a href="https://codepen.io/airnan/pen/MPmQQB" target="_blank" rel="nofollow noopener noreferrer">codepen.io/airnan/pen/…</a></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">var</span> svgContainer = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'svgContainer'</span>)
<span class="hljs-keyword">var</span> animItem = bodymovin.loadAnimation(&#123;
  <span class="hljs-attr">wrapper</span>: svgContainer,<span class="hljs-comment">//div的id</span>
  <span class="hljs-attr">animType</span>: <span class="hljs-string">'svg'</span>
  <span class="hljs-attr">loop</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">path</span>: <span class="hljs-string">'https://labs.nearpod.com/bodymovin/demo/markus/halloween/markus.json'</span>
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>更多<code>Lottie</code>案例：<a href="https://codepen.io/collection/nVYWZR/" target="_blank" rel="nofollow noopener noreferrer">codepen.io/collection/…</a></p>
<p><code>Lottie</code>还和京东的<code>JDReact</code>框架结合，推出了<code>JDLottieLoadingView</code>和<code>JDLottieView</code>组件。其中<code>JDLottieLoadingView</code>主要是显示加载中的动效，会默认引用<code>loading</code>动画样式。<code>JDLottieView</code>是<code>Lottie</code>在<code>JDReact</code>上的封装，用法不变。</p>
<p>案例代码如下：</p>
<pre><code class="hljs language-js copyable" lang="js"><JDLottieLoadingView
    autoSize=&#123;<span class="hljs-literal">false</span>&#125; 
    source=&#123;<span class="hljs-string">"loading.json"</span>&#125;
/>
<span class="xml"><span class="hljs-tag"><<span class="hljs-name">JDLottieView</span>
    <span class="hljs-attr">autoPlay</span>=<span class="hljs-string">&#123;true&#125;</span>
    <span class="hljs-attr">autoSize</span>=<span class="hljs-string">&#123;true&#125;</span>
    <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;width:</span> <span class="hljs-attr">100</span>, <span class="hljs-attr">backgroundColor:</span> '<span class="hljs-attr">black</span>'&#125;&#125;
    <span class="hljs-attr">source</span>=<span class="hljs-string">&#123;require(</span>'<span class="hljs-attr">.</span>/<span class="hljs-attr">animations</span>/<span class="hljs-attr">LottieWalkthrough</span>')&#125;
    <span class="hljs-attr">progress</span>=<span class="hljs-string">&#123;0&#125;</span>
    <span class="hljs-attr">loop</span>=<span class="hljs-string">&#123;true&#125;</span>
/></span></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-5">三、Svga</h4>
<p>SVGA 是一种跨平台的开源动画格式，集成 svga player 之后可直接使用，安装<code>svgaplayerweb</code>包即可，</p>
<blockquote>
<p>支持多版本，兼容 <code>iOS</code> / <code>Android</code> / <code>Flutter</code> / <code>Web</code> 多个平台的动画格式</p>
</blockquote>
<blockquote>
<p>支持位图和矢量图</p>
</blockquote>
<blockquote>
<p>在浏览器中生成的是<code>canvas</code>标签</p>
</blockquote>
<p>案例代码如下：</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> SVGA <span class="hljs-keyword">from</span> <span class="hljs-string">'svgaplayerweb'</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">AniSvga</span>(<span class="hljs-params">props</span>) </span>&#123;
  useEffect(<span class="hljs-function">() =></span> &#123;
    <span class="hljs-keyword">var</span> player = <span class="hljs-keyword">new</span> SVGA.Player(<span class="hljs-string">'#demoCanvas1'</span>)
    <span class="hljs-keyword">var</span> parser = <span class="hljs-keyword">new</span> SVGA.Parser(<span class="hljs-string">'#demoCanvas1'</span>) <span class="hljs-comment">// Must Provide same selector eg:#demoCanvas IF support IE6+</span>
    parser.load(<span class="hljs-string">'./plugin/mengniu.svga'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">videoItem</span>) </span>&#123;
        player.setVideoItem(videoItem)
        player.startAnimation()
    &#125;)
    <span class="hljs-keyword">return</span> <span class="hljs-function">()=></span>&#123;
      player.clear()
    &#125;
  &#125;, [])
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">"jdyfe-svgaPage"</span>></span>
      <span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"demoCanvas1"</span> ></span><span class="hljs-tag"></<span class="hljs-name">div</span>></span>
    <span class="hljs-tag"></<span class="hljs-name">div</span>></span></span>
  )
&#125;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> AniSvga
<span class="copy-code-btn">复制代码</span></code></pre>
<p><code>svga</code>在线预览：<a href="https://svga.io/svga-preview.html" target="_blank" rel="nofollow noopener noreferrer">svga.io/svga-previe…</a></p>
<p>某些<code>Android</code>操作系统缺少<code>Blob</code>支持，所以需要自行添加<code>Blob Polyfill</code>。</p>
<p><img alt="image3.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/beaeb64c83d04ed5a52531f40670ded0~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"//cdn.bootcss.com/blob-polyfill/1.0.20150320/Blob.min.js"</span>></span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h4 data-id="heading-6">四、Createjs</h4>
<p><code>CreateJS</code>是基于<code>HTML5</code>开发的一套模块化的工具库。
基于这些库，可以非常快捷地开发出基于<code>HTML5</code>的游戏、动画和交互应用。</p>
<h6 data-id="heading-7">4.1 EaselJS</h6>
<p><code>EaselJS</code>提供了<code>JavaScript</code>库，可轻松操作<code>HTML5 Canvas</code>元素。</p>
<p>可以绘制<a href="http://www.createjs.cc/src/docs/easeljs/classes/Stage.html" target="_blank" rel="nofollow noopener noreferrer">Stage</a>舞台、<a href="http://www.createjs.cc/src/docs/easeljs/classes/Container.html" target="_blank" rel="nofollow noopener noreferrer">Container</a>容器和<a href="http://www.createjs.cc/src/docs/easeljs/classes/Sprite.html" target="_blank" rel="nofollow noopener noreferrer">Sprite</a>精灵的大小位置等，还提供很多事件可以做交互，很适合纯互动游戏制作。
精灵可以用<code>TexturePacker </code>软件来生成雪碧图，导出<code>Createjs</code>的<code>json</code>文件。</p>
<p><img alt="image4.png" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/24fdbbca380c4b4daa3cb6062c794d99~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<h6 data-id="heading-8">4.2 TweenJs</h6>
<p><code>TweenJs</code>主要是调整动画属性，例如</p>
<pre><code class="hljs language-js copyable" lang="js">target.alpha = <span class="hljs-number">1</span>
createjs.Tween.get(target).wait(<span class="hljs-number">500</span>).to(&#123;<span class="hljs-attr">alpha</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">visible</span>:<span class="hljs-literal">false</span>&#125;, <span class="hljs-number">1000</span>).call(handleComplete)
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleComplete</span>(<span class="hljs-params"></span>) </span>&#123;
        <span class="hljs-comment">//渐变完成执行</span>
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<blockquote>
<p>这个渐变将会先等待0.5秒，渐变目标的alpha属性从0到1，并且visible属性从true变为false，这个过程用时1秒，最后调用handleComplete函数。</p>
</blockquote>
<h6 data-id="heading-9">4.3 SoundJs</h6>
<p><code>SoundJs</code>主要用来加载处理音频的。</p>
<blockquote>
<p>暂停，恢复 声音</p>
</blockquote>
<blockquote>
<p>控制声音的音量，静音</p>
</blockquote>
<blockquote>
<p>监听声音实例中的事件，如完成，循环，或失败事件</p>
</blockquote>
<pre><code class="hljs language-js copyable" lang="js"> createjs.Sound.alternateExtensions = [<span class="hljs-string">"mp3"</span>]
 createjs.Sound.on(<span class="hljs-string">"fileload"</span>, <span class="hljs-built_in">this</span>.loadHandler, <span class="hljs-built_in">this</span>)
 createjs.Sound.registerSound(<span class="hljs-string">"path/to/mySound.ogg"</span>, <span class="hljs-string">"sound"</span>)
 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadHandler</span>(<span class="hljs-params">event</span>) </span>&#123;
     <span class="hljs-comment">// 这会引发针对每个已注册的声音。</span>
     <span class="hljs-keyword">var</span> instance = createjs.Sound.play(<span class="hljs-string">"sound"</span>)  <span class="hljs-comment">// 发挥使用ID。也可以使用完整的源路径或event.src。</span>
     instance.on(<span class="hljs-string">"complete"</span>, <span class="hljs-built_in">this</span>.handleComplete, <span class="hljs-built_in">this</span>)
     instance.volume = <span class="hljs-number">0.5</span>
 &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h6 data-id="heading-10">4.4 PreloadJS</h6>
<p><code>PreloadJS</code>是一个用来管理和协调相关资源加载的类库，它可以帮助你预先加载相关资源。对比自己写监听<code>load</code>事件来确认完成加载，<code>PreloadJS</code>更方便，并且支持预加载多种类型的数据，例如：图片、文件、音频、数据等等。
<code>PreloadJS</code>主要是用<code>URL. createObjectURL </code>创建了<code>Blob</code>对象，然后赋值给URL，移除的时候用 <code>URL.revokeObjectURL</code>方法移除<code>Blob</code>对象。所以会在<code>network</code>中看到<code>Blob</code>对象。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">import</span> createjs <span class="hljs-keyword">from</span> <span class="hljs-string">'jdyfe-createjs'</span>
<span class="hljs-keyword">const</span> loader = <span class="hljs-keyword">new</span> createjs.LoadQueue(<span class="hljs-literal">true</span>)
loader.loadManifest([bgAry[<span class="hljs-number">0</span>], ...imgAry])
loader.on(<span class="hljs-string">'complete'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
       <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'complete'</span>)<span class="hljs-comment">//全部加载完成</span>
&#125;)
loader.on(<span class="hljs-string">'fileload'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>&#123;
       <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'fileload---'</span>, e.target.progress)<span class="hljs-comment">//进度条</span>
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<p>案例</p>
<p><code>createjs</code>官网不支持<code>npm</code>方式使用，我们用<code>webpack</code>重新打包生成了一个<code>umd</code>模块<a href="https://www.npmjs.com/package/jdyfe-createjs" target="_blank" rel="nofollow noopener noreferrer">jdyfe-createjs</a>，可供大家下载和使用。</p>
<p>下面案例包含了上面说的<code>4</code>个模块，也用到了<code>jdyfe-createjs</code>，具体可看：<a href="https://github.com/raoenhui/react-example/blob/master/src/AniCreatejs/index.jsx" target="_blank" rel="nofollow noopener noreferrer">Belly跑步案例</a></p>
<p><img alt="createjs.gif" class="lazyload" src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/44678f7767474fbba7cd5bb1112aa10b~tplv-k3u1fbpfcp-zoom-1.image" data-width="800" data-height="600" referrerpolicy="no-referrer"></p>
<p>Happy coding .. :)</p>
<h3 data-id="heading-11">相关链接</h3>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Animation/play" target="_blank" rel="nofollow noopener noreferrer">developer.mozilla.org/en-US/docs/…</a></p>
<p><a href="http://www.createjs.cc/src/docs/tweenjs/classes/CSSPlugin.html" target="_blank" rel="nofollow noopener noreferrer">www.createjs.cc/src/docs/tw…</a></p>
<p><a href="https://raoenhui.github.io/react/2021/01/02/animation/index.html" target="_blank" rel="nofollow noopener noreferrer">原文地址</a></p></div> <div class="image-viewer-box" data-v-78c9b824><!----></div>  
</div>
            