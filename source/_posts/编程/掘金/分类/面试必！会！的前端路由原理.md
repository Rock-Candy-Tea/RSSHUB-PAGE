
---
title: '面试必！会！的前端路由原理'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e4516eac9084953b04eeba7834c0886~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?'
author: 掘金
comments: false
date: Wed, 14 Sep 2022 01:17:23 GMT
thumbnail: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e4516eac9084953b04eeba7834c0886~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?'
---

<div>   
<div class="markdown-body cache"><style>.markdown-body&#123;color:#383838;font-size:15px;line-height:30px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:60px&#125;.markdown-body ::selection&#123;color:#fff;background-color:#a862ea&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;margin:24px 0 12px;color:#a862ea&#125;.markdown-body h1&#123;line-height:2;font-size:1.4em&#125;.markdown-body h1~p:first-of-type:first-letter&#123;color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder&#125;.markdown-body h2&#123;font-size:1.2em&#125;.markdown-body h3&#123;font-size:1.1em&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:2em&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;padding-left:.2em&#125;.markdown-body ol li::marker,.markdown-body ul li::marker&#123;color:#a862ea&#125;.markdown-body ol li.task-list-item,.markdown-body ul li.task-list-item&#123;list-style:none&#125;.markdown-body ol li.task-list-item ol,.markdown-body ol li.task-list-item ul,.markdown-body ul li.task-list-item ol,.markdown-body ul li.task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:10px&#125;.markdown-body a,.markdown-body code,.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6,.markdown-body li,.markdown-body p&#123;opacity:.85;vertical-align:baseline;transition:all .1s ease&#125;.markdown-body a:hover,.markdown-body code:hover,.markdown-body h1:hover,.markdown-body h2:hover,.markdown-body h3:hover,.markdown-body h4:hover,.markdown-body h5:hover,.markdown-body h6:hover,.markdown-body li:hover,.markdown-body p:hover&#123;opacity:1&#125;.markdown-body a&#123;display:inline-block;color:#a862ea;cursor:pointer;text-decoration:none;position:relative&#125;.markdown-body a:after&#123;content:"";position:absolute;width:98%;height:1px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out&#125;.markdown-body a:hover:after&#123;transform:scaleX(1);transform-origin:bottom left&#125;.markdown-body a:active,.markdown-body a:link&#123;color:#a862ea&#125;.markdown-body img&#123;max-width:100%;user-select:none;margin:1em 0;transition:transform .2s ease 0s;background-color:#f8f5ff;box-shadow:0 0 10px #e7daff&#125;.markdown-body img:hover&#123;opacity:1;box-shadow:0 0 20px #e7daff;transform:translateY(-1px)&#125;.markdown-body blockquote&#123;padding:.5em 1em;margin:12px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:3px solid #a862ea;background-color:#f8f5ff&#125;.markdown-body blockquote>p&#123;margin:0&#125;.markdown-body .math&#123;font-style:italic;margin:12px 0;padding:.5em 1em;background-color:#f8f5ff&#125;.markdown-body .math>p&#123;margin:0&#125;.markdown-body code&#123;padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff&#125;.markdown-body pre&#123;margin:2em 0&#125;.markdown-body pre>code&#123;display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:18px;color:#383838;border-radius:2px;scroll-behavior:smooth;box-shadow:0 0 10px #e7daff&#125;.markdown-body pre>code:hover&#123;box-shadow:0 0 20px #e7daff&#125;.markdown-body pre>code::-webkit-scrollbar&#123;height:6px;background-color:#f8f5ff&#125;.markdown-body pre>code::-webkit-scrollbar-thumb&#123;background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px&#125;.markdown-body hr&#123;margin:2em 0;border-top:1px solid #a862ea&#125;.markdown-body table&#123;width:100%;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse&#125;.markdown-body thead&#123;color:#a862ea;background:#f8f5ff&#125;.markdown-body td,.markdown-body th&#123;padding:.5em;border:1px solid #e7daff&#125;.markdown-body tr&#123;background-color:#f8f5ff&#125;@media (max-width:720px)&#123;.markdown-body&#123;font-size:12px&#125;&#125;</style><p>“我报名参加金石计划1期挑战——瓜分10万奖池，这是我的第5篇文章，<a href="https://s.juejin.cn/ds/jooSN7t" title="https://s.juejin.cn/ds/jooSN7t" target="_blank">点击查看活动详情</a>”
金秋九月，秋招也已经开始了，如果你对前端路由这方面的还不是很懂，请食用本文，好了废话不多说我们开始步入正题。</p>
<h2 data-id="heading-0">什么是前端路由</h2>
<p>前端的路由可以理解成：用来描述 url（web页面的地址） 与 UI（用户界面） 之间的映射关系，就是当 url 发生变化，那么 UI 也会发生变化，那么这种映射关系就叫前端的路由。并且这个路由是一种单向映射的，url==>UI</p>
<h2 data-id="heading-1">为什么要有前端路由？</h2>
<p>随着<a href="https://link.juejin.cn/?target=https%3A%2F%2Fbaike.baidu.com%2Fitem%2FSPA%2F17536313" target="_blank" rel="nofollow noopener noreferrer" title="https://baike.baidu.com/item/SPA/17536313" ref="nofollow noopener noreferrer">单页Web应用</a>（说通俗点就是在页面里面如果要查看某条数据的具体内容，但是鼠标点击进去浏览器不会产生一个新的页面）的广大应用，在单页面应用里如何进行数据的变化以及页面的跳转从而使得单页面应用即使只有一个html文件，但是也可以像多页面应用一样包含丰富的内容；此时前端路由就应运而生。</p>
<h2 data-id="heading-2">如何实现前端路由？</h2>
<p>如何实现前端的路由，问题有哪些？</p>
<p>我们都知道在页面上，当页面的url地址改变了，那么这个页面的UI也就会相应的发生改变；我们点击页面上的某个地方，就可能会导致url地址的改变，从而导致UI的改变，例如：在这个页面上点击API,这是点击前页面的url</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1e4516eac9084953b04eeba7834c0886~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="QQ图片20220914154617.png" loading="lazy" referrerpolicy="no-referrer">
当我们点击API,页面的url就会变成下面这样子，同时这个页面没刷新</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9aae430b8d854a4780872f3b2c403319~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="QQ图片20220914154626.png" loading="lazy" referrerpolicy="no-referrer">
那么<strong>第一个问题就来了：当url发生改变的时候，如何检测到url发生变化 ？</strong></p>
<p>解决了第一个问题接下来的问题就是：监测到url发生变化，我们就要渲染相应改变后url的页面，<strong>在改变url的同时但是不引起页面刷新</strong>，让这个页面至始至终都是一个单页面应用。</p>
<h3 data-id="heading-3">方法一：hash</h3>
<p>首先我们要知道浏览器也有hash，就是某个页面url地址#后面跟着的东西，例如：</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5afc4cd54a0844cf9ec3fccbb5cf2ba7~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image?" alt="QQ图片20220914162652.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>并且改变url中的hash值部分，页面是不会刷新的，所以这里就解决了第二个问题，那么如何检测到url发生变化？
我们又要知道浏览器有可以检测到hash值改变的方法：hashchange方法</p>
<p>我们只要检测到hash值的改变，获取到当前改变后的hash值，再根据hash值来切换页面内容就可以了。</p>
<pre><code class="hljs language-xml copyable" lang="xml"><span class="hljs-meta"><!DOCTYPE <span class="hljs-keyword">html</span>></span>
<span class="hljs-tag"><<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>></span>
<span class="hljs-tag"><<span class="hljs-name">head</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">title</span>></span>Document<span class="hljs-tag"></<span class="hljs-name">title</span>></span>
<span class="hljs-tag"></<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">body</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">ul</span>></span>
        <span class="hljs-comment"><!-- 加了# 浏览器会将其认成一个hash值，从而不刷新页面 --></span>
    <span class="hljs-tag"><<span class="hljs-name">li</span>></span> <span class="hljs-tag"><<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#/home"</span>></span>首页<span class="hljs-tag"></<span class="hljs-name">a</span>></span><span class="hljs-tag"></<span class="hljs-name">li</span>></span>  
    <span class="hljs-tag"><<span class="hljs-name">li</span>></span><span class="hljs-tag"><<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"#/about"</span>></span>关于<span class="hljs-tag"></<span class="hljs-name">a</span>></span><span class="hljs-tag"></<span class="hljs-name">li</span>></span>
<span class="hljs-tag"></<span class="hljs-name">ul</span>></span>

        <span class="hljs-comment"><!-- 渲染对应的UI --></span>
        <span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"routerView"</span>></span><span class="hljs-tag"></<span class="hljs-name">div</span>></span>
        <span class="hljs-tag"><<span class="hljs-name">script</span>></span><span class="javascript">
            <span class="hljs-keyword">let</span> routerView = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'routerView'</span>)
            <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'hashchange'</span>, onHashChange ) <span class="hljs-comment">// 浏览器可以检测到hash值改变，监听hash值的改变；如果改变就触发onHashChange函数</span>
            
            <span class="hljs-comment">// 检测hash值的改变，控制渲染对应的UI</span>
            <span class="hljs-keyword">function</span> <span class="hljs-title function_">onHashChange</span>(<span class="hljs-params"></span>)&#123;
                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(location.<span class="hljs-property">hash</span>);  <span class="hljs-comment">// 本地的hash值</span>
                <span class="hljs-keyword">switch</span>(location.<span class="hljs-property">hash</span>)&#123;
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'#/home'</span>:
                    routerView.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">'Home'</span>
                    <span class="hljs-keyword">return</span> 
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'#/about'</span>:
                    routerView.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">'About'</span>
                    <span class="hljs-keyword">return</span> 
                    <span class="hljs-attr">default</span>:
                        <span class="hljs-keyword">return</span> 
                &#125;
            &#125;
            routerView.<span class="hljs-property">innerHTML</span>=<span class="hljs-string">'Home'</span>
        </span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"></<span class="hljs-name">body</span>></span>
<span class="hljs-tag"></<span class="hljs-name">html</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-4">方法二：history 模式</h3>
<p>history是HTML5提供的一个对象方法，并且它提供三个方法：</p>
<ol>
<li>
<p>pushState</p>
</li>
<li>
<p>replaceState  // 1与2这两个方法都是修改url的，并且这两个方法修改url的时候，是不会引起页面刷新的</p>
</li>
<li>
<p>popState  // 监听url的变化</p>
</li>
</ol>
<p>这三个方法简直就是为前端路由而生呀！</p>
<p>这个方法原理就是：当我们在页面点击某处要切换内容，如果我们不使用hash值就必然会导致页面的刷新，那么我们要做的就是将这个页面跳转遏制住，此时我们就要知道有个阻止默认事件发生的函数：preventDefault（）；让这个函数阻止页面跳转这个默认行为。然后我们再使用pushState或者replaceState方法与popState方法配合，<strong>当我们点击跳转页面时，首先拦截下来跳转这个行为，然后使用pushState或者replaceState方法进行不刷新页面跳转，再监听页面跳转这一行为，然后匹配对应页面的内容</strong>，这样前端路由就实现了呀。
代码实现：</p>
<pre><code class="hljs language-xml copyable" lang="xml"><span class="hljs-meta"><!DOCTYPE <span class="hljs-keyword">html</span>></span>
<span class="hljs-tag"><<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>></span>
<span class="hljs-tag"><<span class="hljs-name">head</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">http-equiv</span>=<span class="hljs-string">"X-UA-Compatible"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"IE=edge"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"viewport"</span> <span class="hljs-attr">content</span>=<span class="hljs-string">"width=device-width, initial-scale=1.0"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">title</span>></span>Document<span class="hljs-tag"></<span class="hljs-name">title</span>></span>
<span class="hljs-tag"></<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">body</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">ul</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">li</span>></span><span class="hljs-tag"><<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/home"</span>></span>首页<span class="hljs-tag"></<span class="hljs-name">a</span>></span><span class="hljs-tag"></<span class="hljs-name">li</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">li</span>></span><span class="hljs-tag"><<span class="hljs-name">a</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"/about"</span>></span>关于<span class="hljs-tag"></<span class="hljs-name">a</span>></span><span class="hljs-tag"></<span class="hljs-name">li</span>></span>
  <span class="hljs-tag"></<span class="hljs-name">ul</span>></span>

  <span class="hljs-comment"><!-- 渲染对应的UI --></span>
  <span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"routerView"</span>></span><span class="hljs-tag"></<span class="hljs-name">div</span>></span>

  <span class="hljs-tag"><<span class="hljs-name">script</span>></span><span class="javascript"> 
    <span class="hljs-keyword">let</span> routerView = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'routerView'</span>)  <span class="hljs-comment">// 控制它显示DOM结构</span>

    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'DOMContentLoaded'</span>, onLoad)  <span class="hljs-comment">// 一开始加载页面的时候，监听页面加载，调用onLoad函数</span>
    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'popstate'</span>, onPopState)  <span class="hljs-comment">// 浏览器的前进后退能匹配</span>
    
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onLoad</span>(<span class="hljs-params"></span>) &#123;  
      <span class="hljs-title function_">onPopState</span>()  <span class="hljs-comment">// 匹配路径，展示对应的html</span>

      <span class="hljs-keyword">let</span> links = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelectorAll</span>(<span class="hljs-string">'li a[href]'</span>)  <span class="hljs-comment">// 获取a标签的href属性</span>
      <span class="hljs-comment">// 拦截a标签的默认跳转行为</span>
      links.<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">a</span> =></span> &#123;
        a.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'click'</span>, <span class="hljs-function">(<span class="hljs-params">e</span>) =></span> &#123;  <span class="hljs-comment">// 当我们点击a标签时，阻止跳转页面的行为</span>
          e.<span class="hljs-title function_">preventDefault</span>() <span class="hljs-comment">// 阻止a标签的href行为</span>
          
          history.<span class="hljs-title function_">pushState</span>(<span class="hljs-literal">null</span>, <span class="hljs-string">''</span>, a.<span class="hljs-title function_">getAttribute</span>(<span class="hljs-string">'href'</span>))  <span class="hljs-comment">// 跳转，第三个参数就是要跳转的页面</span>
          <span class="hljs-title function_">onPopState</span>()  <span class="hljs-comment">// 再匹配路径，展示对应的html</span>
        &#125;)
      &#125;)
    &#125;
    <span class="hljs-comment">// 匹配路径，展示对应的html</span>
    <span class="hljs-keyword">function</span> <span class="hljs-title function_">onPopState</span>(<span class="hljs-params"></span>) &#123;
      <span class="hljs-comment">// console.log(location.pathname);</span>
      <span class="hljs-keyword">switch</span> (location.<span class="hljs-property">pathname</span>) &#123;
        <span class="hljs-keyword">case</span> <span class="hljs-string">'/home'</span>:
          routerView.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'<h2>home page</h2>'</span>
          <span class="hljs-keyword">return</span>
        <span class="hljs-keyword">case</span> <span class="hljs-string">'/about'</span>:
          routerView.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">'<h2>about page</h2>'</span>
          <span class="hljs-keyword">return</span>
        <span class="hljs-attr">default</span>:
          <span class="hljs-keyword">return</span>
      &#125;
    &#125;
  </span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"></<span class="hljs-name">body</span>></span>
<span class="hljs-tag"></<span class="hljs-name">html</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre></div>  
</div>
            