
---
title: '学习设计模式之——单例模式'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://picsum.photos/400/300?random=936'
author: 掘金
comments: false
date: Thu, 10 Jun 2021 22:29:05 GMT
thumbnail: 'https://picsum.photos/400/300?random=936'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h1 data-id="heading-0">前言</h1>
<p>最近开始学习设计模式，一共23种设计模式，作为学习且在项目中最实用的也就那么几种，所以一个一个开始攻破设计莫，学的就是设计模式的思想。</p>
<h1 data-id="heading-1">什么是单例模式</h1>
<p>首先听名字就知道：“单例”说明全局只会有这一个实例。所以不能出现下面这种情况：</p>
<pre><code class="copyable">class Person &#123;&#125;

 const p1 = new Person()
 const p2 = new Person()
 console.log(p1 === p2) // false
<span class="copy-code-btn">复制代码</span></code></pre>
<p>所以为了实现单例，应该怎么做呢？</p>
<h1 data-id="heading-2">原理</h1>
<p>既然不能出现多次实例，那就下一次实例化的时候判断该类是否已经被实例化了，所以无非就是在类中判断是否实例化。</p>
<pre><code class="copyable">class Person &#123;
  static getInstance() &#123;
    if (!Person.instance) &#123;
      Person.instance = new Person();
    &#125;
    return Person.instance;
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>首先这里写了个静态方法，该方法返回的就是这个类的实例，主要是判断是否存在过该类的实例，有就直接返回，没有就 new 一个出来。接着我们调用测试一下。</p>
<pre><code class="copyable">const p1 = Person.getInstance();
const p2 = Person.getInstance();
console.log(p1 === p2); // true
<span class="copy-code-btn">复制代码</span></code></pre>
<p>这样就实现了全局唯一实例</p>
<h1 data-id="heading-3">应用场景</h1>
<p>学习了单例模式，那么这种单例模式应用的场景是怎么样的呢。接下来就来实现一个全局弹窗（Modal）的实现。</p>
<ul>
<li>首先写两个按钮，分别控制弹窗的显示和隐藏，其他样式先就不一一写了</li>
</ul>
<pre><code class="copyable"><div id='open'>打开</div>
<div id='close'>关闭</div>
<span class="copy-code-btn">复制代码</span></code></pre>
<ul>
<li>实现一个Modal类</li>
</ul>
<pre><code class="copyable">class Modal &#123;
  constructor() &#123;
    this.modal = document.createElement("div");
    this.modal.innerHTML = "还未登录";
    this.modal.id = "modal";
    this.modal.style.border = "1px solid red";
    this.modal.style.display = "none";
    document.body.appendChild(this.modal);
  &#125;
  static getInstance() &#123;
    if (!Modal.instance) &#123;
      Modal.instance = new Modal();
    &#125;
    return Modal.instance;
  &#125;
  show() &#123;
    this.modal.style.display = "block";
  &#125;
  hide() &#123;
    this.modal.style.display = "none";
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<ul>
<li>最后给按钮绑定点击事件</li>
</ul>
<pre><code class="copyable">document.getElementById("open").addEventListener("click", () => &#123;
  const modal = Modal.getInstance();
  modal.show();
&#125;);
document.getElementById("close").addEventListener("click", () => &#123;
  const modal = Modal.getInstance();
  modal.hide();
&#125;);
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-4">分析</h1>
<p>先贴出了代码，然后再逐个分析</p>
<ul>
<li>定义的Modal类里面有一个构造器，改构造器只有一个<code>modal</code>对象，该对象就是我们要创建的弹窗DOM对象。所以该对象就会有<code>innerHTML</code>、<code>id</code>、<code>style</code>等属性，最后我们把该对象放在body上。而这个构造器就说明我们在后面实例化的时候就会实例出来一个对象，就是这个弹窗的DOM。</li>
<li>第二个代码块就是静态方法，来识别单例模式。如果没有这个判断是被，则每次点击‘打开’按钮就会重新生成新的实例，这就与我们的单例模式背道而驰了。</li>
<li>最后就是show函数和hide函数，分别控制实例化后的modal 的显示和隐藏</li>
</ul>
<h1 data-id="heading-5">最后</h1>
<p>分析到这了，其实也没啥子好写的了，相比看看代码就很明了了，之所以写这篇文章也是在加强自己的对单例模式的印象。因为之前都没怎么学习过设计模式，模模糊糊的也不清楚这些设计模式用在什么地方，该怎么用，导致写的代码很多都很垃圾。而最近几天学习设计模式，就知道了学习设计模式能让代码变得这么高大上。所以这里也很荣幸看到了<code>修言</code>哥的<a href="https://juejin.cn/book/6844733790204461070" target="_blank">JavaScript 设计模式核心原理与应用实践</a>这本小册。学习了很多，后面还会对其他的设计模式逐个击破。</p></div>  
</div>
            