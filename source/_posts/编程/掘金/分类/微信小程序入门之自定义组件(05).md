
---
title: '微信小程序入门之自定义组件(05)'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/802c994148e74dbe8823243a9e534912~tplv-k3u1fbpfcp-zoom-1.image'
author: 掘金
comments: false
date: Mon, 31 May 2021 22:30:46 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/802c994148e74dbe8823243a9e534912~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>这是我参与更文挑战的第1天，活动详情查看： <a href="https://juejin.cn/post/6967194882926444557" target="_blank">更文挑战</a></p>
<h1 data-id="heading-0">自定义组件</h1>
<hr color="#000000" size="1"">
<p>类似vue或者react中的自定义组件
⼩程序允许我们使⽤⾃定义组件的⽅式来构建⻚⾯。</p>

<hr color="#000000" size="1"">
<h1 data-id="heading-1">一、 创建自定义组件</h1>
<p>类似于页面，一个自定义组件由 <code>json</code> <code>wxml</code> <code>wxss</code> <code>js</code> 4个文件组成
可以在微信开发者⼯具中快速创建组件的⽂件结构</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/802c994148e74dbe8823243a9e534912~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer"></p>
<p>在⽂件夹内 components/myHeader ，创建组件名为 myHeader</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f1004ef5bfa4b1b8894902b64d9b744~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-2">1. 声明组件</h2>
<p>⾸先需要在组件的 json ⽂件中进⾏⾃定义组件声明
myHeader.json</p>
<pre><code class="hljs language-html copyable" lang="html">&#123;
  "component": true
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-3">2. 编辑组件</h2>
<p>同时，还要在组件的 wxml ⽂件中编写组件模板，在 wxss ⽂件中加⼊组件样式
slot 表⽰插槽，类似vue中的slot
myHeader.wxml</p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-comment"><!-- 这是自定义组件的内部WXML结构 --></span>
<span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"inner"</span>></span>
 &#123;&#123;innerText&#125;&#125;
    <span class="hljs-tag"><<span class="hljs-name">slot</span>></span><span class="hljs-tag"></<span class="hljs-name">slot</span>></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>在组件的 wxss ⽂件中编写样式
==注意==：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。
myHeader.wxss</p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-comment">/* 这里的样式只应用于这个自定义组件 */</span>
<span class="hljs-selector-class">.inner</span> &#123;
  <span class="hljs-attribute">color</span>: red; 
  &#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-4">3. 注册组件</h2>
<p>在组件的 js ⽂件中，需要使⽤ Component() 来注册组件，并提供组件的属性定义、内部数据和 ⾃定义⽅法
myHeader.js</p>
<pre><code class="hljs language-js copyable" lang="js">Component(&#123;
  <span class="hljs-attr">properties</span>: &#123;
    <span class="hljs-comment">// 这里定义了innerText属性，属性值可以在组件使用时指定</span>
    <span class="hljs-attr">innerText</span>: &#123;
      <span class="hljs-comment">// 期望要的数据是 string类型</span>
      <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
      <span class="hljs-attr">value</span>: <span class="hljs-string">'default value'</span>,
   &#125;
 &#125;,
  <span class="hljs-attr">data</span>: &#123;
    <span class="hljs-comment">// 这里是一些组件内部数据</span>
    <span class="hljs-attr">someData</span>: &#123;&#125;
 &#125;,
  <span class="hljs-attr">methods</span>: &#123;
    <span class="hljs-comment">// 这里是一个自定义方法</span>
    <span class="hljs-attr">customMethod</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>&#123;&#125;
 &#125;
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-5">二、声明引⼊自定义组件</h1>
<p>⾸先要在⻚⾯的 json ⽂件中进⾏引⽤声明。还要提供对应的组件名和组件路径
index.wxml</p>
<pre><code class="hljs language-wxml copyable" lang="wxml">&#123;
 // 引用声明
  "usingComponents": &#123;
 // 要使用的组件的名称     // 组件的路径
    "my-header":"/components/myHeader/myHeader"
 &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-6">三、页面中使用自定义组件</h1>
<pre><code class="hljs language-java copyable" lang="java"><view>
  <!-- 以下是对一个自定义组件的引用 -->
  <my-header inner-text=<span class="hljs-string">"Some text"</span>>
    <view>用来替代slot的</view>
    </my-header>
</view>
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-7">四、其他属性</h1>
<h1 data-id="heading-8">五、定义段与示例方法</h1>
<p>Component 构造器可⽤于定义组件，调⽤ Component 构造器时可以指定组件的属性、数据、⽅法 等。</p>

































































<table><thead><tr><th>定义段</th><th>类型</th><th>是否必填</th><th>描述</th></tr></thead><tbody><tr><td>properties</td><td>Object Map</td><td>否</td><td>组件的对外属性，是属性名到属性设置的映射表，参⻅下⽂</td></tr><tr><td>data</td><td>Object</td><td>否</td><td>组件的内部数据，和 properties ⼀同⽤于组件的模板渲 染</td></tr><tr><td>observers</td><td>Object</td><td>否</td><td>组件数据字段监听器，⽤于监听 properties 和 data 的变 化，参⻅ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/observer.html" target="_blank" rel="nofollow noopener noreferrer">数据监听器</a></td></tr><tr><td>methods</td><td>Object</td><td>否</td><td>组件的⽅法，包括事件响应函数和任意的⾃定义⽅法，关于 事件响应函数的使⽤，参⻅ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/events.html" target="_blank" rel="nofollow noopener noreferrer">组件事件</a></td></tr><tr><td>created</td><td>Function</td><td>否</td><td>组件⽣命周期函数，在组件实例刚刚被创建时执⾏，注意此 时不能调⽤ setData ，参⻅<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="nofollow noopener noreferrer">组件⽣命周期</a></td></tr><tr><td>attached</td><td>Function</td><td>否</td><td>组件⽣命周期函数，在组件实例进⼊⻚⾯节点树时执⾏，参⻅<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="nofollow noopener noreferrer">组件⽣命周期</a></td></tr><tr><td>ready</td><td>Function</td><td>否</td><td>组件⽣命周期函数，在组件布局完成后执⾏，参⻅ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="nofollow noopener noreferrer">组件⽣命周期</a></td></tr><tr><td>moved</td><td>Function</td><td>否</td><td>组件⽣命周期函数，在组件实例被移动到节点树另⼀个位置 时执⾏，参⻅ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="nofollow noopener noreferrer">组件⽣命周期</a></td></tr><tr><td>detached</td><td>Function</td><td>否</td><td>组件⽣命周期函数，在组件实例被从⻚⾯节点树移除时执 ⾏，参⻅ <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html" target="_blank" rel="nofollow noopener noreferrer">组件⽣命周期</a></td></tr></tbody></table>
<h1 data-id="heading-9">六、组件-自定义组件传参</h1>
<ul>
<li>⽗组件通过属性的⽅式给⼦组件传递参数</li>
<li>⼦组件通过事件的⽅式向⽗组件传递参数</li>
</ul>
<h2 data-id="heading-10">过程</h2>
<ol>
<li>⽗组件 把数据 &#123;&#123;tabs&#125;&#125; 传递到 ⼦组件的 tabItems 属性中</li>
<li>⽗组件 监听 onMyTab 事件</li>
<li>⼦组件 触发 bindmytap 中的 mytap 事件 (⾃定义组件触发事件时，需要使⽤ triggerEvent ⽅法，指定 事件名 、 detail 对象)</li>
<li>⽗ -> ⼦ 动态传值 this.selectComponent("#tabs");</li>
</ol>
<p><strong>父组件代码</strong></p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-comment">// page.wxml</span>
<tabs tabItems=<span class="hljs-string">"&#123;&#123;tabs&#125;&#125;"</span> bindmytap=<span class="hljs-string">"onMyTab"</span> >
 内容-这里可以放插槽
</tabs>
<span class="hljs-comment">// page.js</span>
  data: &#123;
    tabs:[
     &#123;name:<span class="hljs-string">"体验问题"</span>&#125;,
     &#123;name:<span class="hljs-string">"商品、商家投诉"</span>&#125;
   ]
 &#125;,
  onMyTab(e)&#123;
    console.log(e.detail);
 &#125;,
<span class="copy-code-btn">复制代码</span></code></pre>
<p><strong>子组件代码</strong></p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-comment">// com.wxml</span>
<view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"tabs"</span>>
  <view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"tab_title"</span>  >
    <block  wx:<span class="hljs-keyword">for</span>=<span class="hljs-string">"&#123;&#123;tabItems&#125;&#125;"</span> wx:key=<span class="hljs-string">"&#123;&#123;item&#125;&#125;"</span>>
      <view bindtap=<span class="hljs-string">"handleItemActive"</span> data-index=<span class="hljs-string">"&#123;&#123;index&#125;&#125;"</span>>&#123;&#123;item.name&#125;&#125;</view>
    </block>
  </view>
  <view <span class="hljs-class"><span class="hljs-keyword">class</span></span>=<span class="hljs-string">"tab_content"</span>>
    <slot></slot>
  </view>
</view>
<span class="hljs-comment">// com.js</span>
Component(&#123;
  properties: &#123;
    tabItems:&#123;
      type:Array,
      value:[]
   &#125;
 &#125;,
  <span class="hljs-comment">/**
   * 组件的初始数据
   */</span>
  data: &#123;
 &#125;,
  <span class="hljs-comment">/**
   * 组件的方法列表
   */</span>
  methods: &#123;
    handleItemActive(e)&#123;
      <span class="hljs-keyword">this</span>.triggerEvent(<span class="hljs-string">'mytap'</span>,<span class="hljs-string">'haha'</span>);
   &#125;
 &#125;
&#125;)
<span class="copy-code-btn">复制代码</span></code></pre>
<hr color="#000000" size="1"">
<h1 data-id="heading-11">小结</h1>
<h3 data-id="heading-12">1. 标签名 是 中划线的⽅式、</h3>
<h3 data-id="heading-13">2. 属性的⽅式 也是要中划线的⽅式</h3>
<h3 data-id="heading-14">3. 其他情况可以使⽤驼峰命名</h3>
<h4 data-id="heading-15">(1). 组件的⽂件名如 <code>myHeader.js</code> 的等</h4>
<h4 data-id="heading-16">(2). 组件内的要接收的属性名 如 <code>innerText</code></h4>
<h3 data-id="heading-17">4. <a href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/component.html" target="_blank" rel="nofollow noopener noreferrer">更多..</a></h3>
<hr>
<p>相关内容:</p>
<ul>
<li><a href="https://juejin.cn/post/6964280083045416991" target="_blank">微信小程序从入门到入土教程(01)</a></li>
<li><a href="https://juejin.cn/post/6965734312943550478" target="_blank">微信小程序入门之模板语法(02)</a></li>
<li><a href="https://juejin.cn/post/6966057212447817735" target="_blank">微信小程序从入门到入土教程(03)</a></li>
<li><a href="https://juejin.cn/post/6967171988150288398" target="_blank">微信小程序入门之常用组件(04)</a></li>
<li><a href="https://juejin.cn/post/6968708745920512036" target="_blank">微信小程序入门之自定义组件(05)</a></li>
</ul>
<p>更多相关文章及我的联系方式我放在这里：<a href="https://gitee.com/haiyongcsdn/haiyong" target="_blank" rel="nofollow noopener noreferrer">gitee.com/haiyongcsdn…</a></p>
<p>最后，不要忘了❤或📑支持一下哦</p></div>  
</div>
            