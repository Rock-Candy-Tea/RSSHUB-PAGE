
---
title: '🔥「面试题」数组访问、指针与内存寻址原理'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0de635f12ffb40aa80817e35d0c528cc~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Thu, 03 Jun 2021 22:45:48 GMT
thumbnail: 'https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0de635f12ffb40aa80817e35d0c528cc~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>欢迎大家来到"面试"系列，Blue在这个系列中将带领大家<strong>探究热门面试题背后的知识和原理</strong>，欢迎大家关注我，精彩内容不错过，如果碰到感兴趣的题目想讨论，<strong>欢迎大家通过留言告诉我，谢谢</strong>，但请记住：</p>
<blockquote>
<p>面试或许可以应付，但不要糊弄自己，彻底掌握知识本身才是提升的关键
—— 我说的</p>
</blockquote>
<p>内存是所有计算设备的基础，同时也是程序存储数据的重要场所，我们每天都要接触，但是内存或者说随机存储（Random Access Memory-RAM）到底是怎么工作的，我们的程序究竟如何使用内存？这次Blue就带大家一起来研究一下，欢迎<strong>点赞、收藏、评论、转发</strong></p>
<p>内容大纲</p>
<ul>
<li>内存的原理，如何存放数据</li>
<li>内存如何进行寻址、门电路如何组成内存、内存位宽与容量的关系</li>
<li>地址是什么？指针是什么？</li>
<li>数组不同位置的访问速度一样吗？</li>
</ul>
<h1 data-id="heading-0">从面试题开始</h1>
<p>有一道很简单的面试题，从它开始今天的话题</p>
<pre><code class="hljs language-js copyable" lang="js">数组里面有<span class="hljs-number">10</span>万个数据，取第一个元素和第<span class="hljs-number">10</span>万个元素的时间相差多少
<span class="copy-code-btn">复制代码</span></code></pre>
<p>答案显而易见，因为<strong>数组中无论访问第几个元素，时间是一样的</strong>，所以答案是：一样的</p>
<p>问题是解决了，但数组在内存中究竟是如何存放的？数组究竟是什么？</p>
<h2 data-id="heading-1">RAM内存的原理</h2>
<p>我们平常说的"内存"其实应该叫"Random Access Memory"，即"随机访问存储"，它的名字其实已经说明一切了，你可以随机的访问任意一个位置，速度是一样的，但是，为什么？</p>
<h3 data-id="heading-2">想象中的内存?</h3>
<p>在想象内存时，很多人脑子里会蹦出这幅图：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0de635f12ffb40aa80817e35d0c528cc~tplv-k3u1fbpfcp-watermark.image" alt="1" loading="lazy" referrerpolicy="no-referrer"></p>
<p>其实上面的图错的最离谱，因为内存是一个一个小格子的感觉没错，<strong>但它不是二维的</strong>，硬要说的话，更接近一维的数组，长这样其实还准确一些</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bb084caba5b741c4b810875258e204be~tplv-k3u1fbpfcp-watermark.image" alt="2" loading="lazy" referrerpolicy="no-referrer"></p>
<p>上面这张图如果只是说明内存的一些特性其实倒也够了，不过既然今天咱们打算彻底弄明白内存的访问原理，那么，来看看这个</p>
<h3 data-id="heading-3">内存的原理?</h3>
<p>其实最接近实际情况的内存示意图，大概长得跟棵树似的，在内存中，存在很多"门"（不是俗称，还真就叫门），假如我们的内存只有2字节，那么它长这样：</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2b8199ed45bf4c668044479ed3af024e~tplv-k3u1fbpfcp-watermark.image" alt="3" loading="lazy" referrerpolicy="no-referrer"></p>
<p>这里有两个控制位</p>
<ul>
<li>a（address的简称）代表要访问哪个字节，0代表0号字节，1代表1号字节</li>
<li>w代表写入标志，0是读取，1是写入（当然，还涉及到寄存器操作，这里省略了）</li>
</ul>
<p>我们的内存当然不只2字节，那么稍微扩展一下，4字节内存长这样</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/bc79c79b65cc481eb82ec2e4b445e933~tplv-k3u1fbpfcp-watermark.image" alt="4" loading="lazy" referrerpolicy="no-referrer"></p>
<p>因为有4字节，所以一个a就不够了，这时我们需要2位，a0和a1</p>
<p>这也顺便带给我们2个有意思的现象</p>
<ul>
<li>内存的容量一定是2的n次方（寻址位数），比如1024（1K）、2048、……、1048576（1M）、……、1073741824（1G）、2147483648（2G）等，你无法让内存的容量是其他值</li>
<li>内存寻址能力（也就是存储上限）受限于主板和操作系统位宽，比如32位系统最大内存寻址上限为4294967296，也就是4GB，这就是为啥32位的Windows XP系统无法使用超过4G内存的根本原因</li>
</ul>
<h2 data-id="heading-4">真实的内存寻址过程</h2>
<p><strong>劝退警告</strong>，你可以完全忽略此节继续查看其它内容，如果对自己的头发有信心，那么让我们开始吧😂</p>
<p>目前人类的计算机使用了一种称为门的逻辑元件（其实就是三极管堆出来的啦），它能帮我们触发指定的操作，而这里，对我们最重要的是"与"(AND)和"非"(NOT)这两种门，先看个门，呸，看个图（图片引自nutsvolts）</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1faab9fac4924ee6864089205735a545~tplv-k3u1fbpfcp-watermark.image" alt="5" loading="lazy" referrerpolicy="no-referrer"></p>
<p>这个图简单到一眼就能看懂，那个黑点是输入/输出，圆圈是非操作（NOT），不过为了便于理解，我们来个例子试试</p>
<p>假设我的输入是A=0,B=1，那么A会经过非操作（NOT）变成1，也就是说，最后做的是1&1操作，结果是1</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd936b9ee4b648fc9f0abc9223169a0f~tplv-k3u1fbpfcp-watermark.image" alt="6" loading="lazy" referrerpolicy="no-referrer"></p>
<p>好的，门搞明白了（吗？），接下来继续搞内存，它到底怎么寻址的？很简单</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b232fb8016b04def88c17afff1dddb86~tplv-k3u1fbpfcp-watermark.image" alt="7" loading="lazy" referrerpolicy="no-referrer"></p>
<p>我们只需要多来几个门，看上图我们可以知道，第0字节在A=00时触发，也就是说，地址0触发了第0字节的操作；第1字节在A=01是触发，也就是说，地址1触发了第1字节的操作，是不是很简单？</p>
<p>顺便一说，门上的输入数量（A的数量）就是寻址宽度，一般俗称位宽，也就是我们内存的容量上限</p>
<h3 data-id="heading-5">这跟问题有什么关系？</h3>
<p>说了这么多，其实就是为了告诉大家，你访问哪个位置，仅仅跟你Address的值有关，而设置Address其实需要的时间是相同的，比如赋值操作，<code>a=12</code>和<code>a=9999</code>其实时间一样，那么，这跟数组有什么关系？</p>
<h2 data-id="heading-6">数组在内存中如何存储</h2>
<p>数组在内存中占用一段连续的空间（废话，不连续的那叫链表谢谢），而我们在变量中其实就会保存数组的首地址（也就是所占内存的起点），这个地址的值（比如这里的87）被称为<strong>指针</strong></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c42b394ed40d42c5bb5e327249798df2~tplv-k3u1fbpfcp-watermark.image" alt="8" loading="lazy" referrerpolicy="no-referrer"></p>
<p>那么，我们想要<code>arr[1]</code>是如何操作的？很简单：<code>arr[0]</code>是87号位置，那<code>arr[1]</code>呢？小学生，不对，幼儿园都能算出来是88对吧</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4c73731da8114eec9ff1cd868ce8194b~tplv-k3u1fbpfcp-watermark.image" alt="9" loading="lazy" referrerpolicy="no-referrer"></p>
<p>再试一个，<code>arr[99]</code>呢？这个有点难，<strong>得小学生才会了</strong>，87+99=...，186对吧？</p>
<p>那么问题来了，访问A=87和A=186的时间一样吗？上面就说过，都是给Address赋值，一样的</p>
<p>所以我们的结论是，<strong>访问数组的任何一位，时间完全相同</strong></p>
<h1 data-id="heading-7">结论</h1>
<p>是时候梳理一遍Blue讲过的东西了，那么首先</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/46cf8d2ada7a45f39af71ee6bb9c410f~tplv-k3u1fbpfcp-watermark.image" alt="footer" loading="lazy" referrerpolicy="no-referrer"></p>
<p>我们来总结一下，这次说到的内容：</p>
<ul>
<li>内存通过地址（Address）访问，不同的地址访问时间完全相同</li>
<li>进而，数组不论哪一位，访问时间都是相同的</li>
<li>指针就是存在变量里的内存地址（Address）</li>
<li>内存寻址宽度（位宽）限制了它的容量上限</li>
</ul>
<h1 data-id="heading-8">有bug？想补充？</h1>
<p>感谢大家观看这篇教程，有任何问题或想和我交流，请直接留言，发现文章有任何不妥之处，也请指出，提前感谢</p></div>  
</div>
            