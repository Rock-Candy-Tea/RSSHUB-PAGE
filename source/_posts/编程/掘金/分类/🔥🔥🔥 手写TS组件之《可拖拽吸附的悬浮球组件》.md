
---
title: 'ğŸ”¥ğŸ”¥ğŸ”¥ æ‰‹å†™TSç»„ä»¶ä¹‹ã€Šå¯æ‹–æ‹½å¸é™„çš„æ‚¬æµ®çƒç»„ä»¶ã€‹'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://picsum.photos/400/300?random=4269'
author: æ˜é‡‘
comments: false
date: Tue, 15 Jun 2021 05:46:50 GMT
thumbnail: 'https://picsum.photos/400/300?random=4269'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;color:#383838;font-size:15px;line-height:37.5px;letter-spacing:2px;word-break:break-word;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif;scroll-behavior:smooth;background-image:linear-gradient(0deg,transparent 24%,rgba(201,195,195,.329) 25%,hsla(0,8%,80.4%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent),linear-gradient(90deg,transparent 24%,rgba(204,196,196,.226) 25%,hsla(0,4%,66.1%,.05) 26%,transparent 27%,transparent 74%,hsla(0,5.2%,81%,.185) 75%,rgba(180,176,176,.05) 76%,transparent 77%,transparent);background-color:#fff;background-size:50px 50px;padding-bottom:120px&#125;.markdown-body ::selection&#123;color:#fff;background-color:#a862ea&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;margin:30px 0 15px;color:#a862ea&#125;.markdown-body h1&#123;line-height:2;font-size:1.4em&#125;.markdown-body h1~p:first-of-type:first-letter&#123;color:#a862ea;float:left;font-size:2em;margin-right:.4em;font-weight:bolder&#125;.markdown-body h2&#123;font-size:1.2em&#125;.markdown-body h3&#123;font-size:1.1em&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:2em&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;padding-left:.2em&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:10px&#125;.markdown-body li::marker&#123;color:#a862ea&#125;.markdown-body li,.markdown-body p&#123;opacity:.9;vertical-align:baseline;transition:all .1s ease&#125;.markdown-body li:hover,.markdown-body p:hover&#123;opacity:1&#125;.markdown-body a&#123;display:inline-block;color:#a862ea;cursor:pointer;padding-bottom:2px;text-decoration:none;position:relative&#125;.markdown-body a:after&#123;content:"";position:absolute;width:98%;height:2px;bottom:0;left:0;transform:scaleX(0);background-color:#a862ea;transform-origin:bottom right;transition:transform .3s ease-in-out&#125;.markdown-body a:hover:after&#123;transform:scaleX(1);transform-origin:bottom left&#125;.markdown-body a:active,.markdown-body a:link&#123;color:#a862ea&#125;.markdown-body img&#123;max-width:100%;user-select:none;margin:1em 0;box-shadow:0 0 20px 0 #e7daff;transition:transform .2s ease 0s;background-color:#f8f5ff&#125;.markdown-body img:hover&#123;opacity:1;transform:translateY(-2px)&#125;.markdown-body blockquote&#123;padding:.5em 1em;margin:15px 0;border-top-left-radius:2px;border-bottom-left-radius:2px;border-left:4px solid #a862ea;background-color:#f8f5ff&#125;.markdown-body blockquote>p&#123;margin:0&#125;.markdown-body code&#123;padding:2px .4em;overflow-x:auto;color:#a862ea;font-weight:700;word-break:break-word;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;background-color:#f8f5ff&#125;.markdown-body pre&#123;margin:2em 0;box-shadow:0 0 20px #e7daff&#125;.markdown-body pre>code&#123;display:block;padding:1.5em;word-break:normal;font-size:.9em;font-style:normal;font-weight:400;font-family:Operator Mono,Consolas,Monaco,Menlo,monospace;line-height:22.5px;color:#383838;border-radius:3px;scroll-behavior:smooth&#125;.markdown-body pre>code::-webkit-scrollbar&#123;height:6px;background-color:#f8f5ff&#125;.markdown-body pre>code::-webkit-scrollbar-thumb&#123;background-color:#e7daff;border-bottom-left-radius:3px;border-bottom-right-radius:3px&#125;.markdown-body hr&#123;margin:2em 0;border-top:1px solid #a862ea&#125;.markdown-body table&#123;font-size:12px;max-width:100%;overflow:auto;border-collapse:collapse;border:1px solid #e7daff&#125;.markdown-body thead&#123;color:#a862ea;background:#f8f5ff&#125;.markdown-body td,.markdown-body th&#123;padding:1em .5em&#125;.markdown-body tr&#123;background-color:#fcfcfc&#125;@media (max-width:720px)&#123;.markdown-body&#123;font-size:12px&#125;&#125;</style><h3 data-id="heading-0">ã€Šæ‰‹å†™å¯æ‹–æ‹½å¸é™„çš„æ‚¬æµ®çƒç»„ä»¶ã€‹æœ‰ç‚¹é•¿ï¼Œä½†æ”¶è·æ»¡æ»¡</h3>
<p>è¿™æ˜¯æˆ‘å‚ä¸æ›´æ–‡æŒ‘æˆ˜çš„ç¬¬1å¤©ï¼Œæ´»åŠ¨è¯¦æƒ…æŸ¥çœ‹ï¼š <a href="https://juejin.cn/post/6967194882926444557" target="_blank">æ›´æ–‡æŒ‘æˆ˜</a></p>
<h4 data-id="heading-1">å‰è¨€</h4>
<p>ç›®å‰ï¼Œå‰ç«¯ç”Ÿæ€åœˆä¸­å„ç§å„æ ·çš„UI framework è§¦ç›®çš†æ˜¯ï¼Œä½†æœ‰æ²¡æœ‰å‘ç°å¾ˆå¤šçš„UI framework éƒ½æ²¡æœ‰æ‚¬æµ®çƒè¿™ä¸ªç»„ä»¶ ï¼Œå…¶å®è¿™ä¸ªä¹Ÿä¸éš¾å®ç°ï¼Œæ‰€ä»¥æˆ‘å†³å®šè¦äº²æ‰‹å†™ä¸€ä¸ªå‡ºæ¥ï¼</p>
<h4 data-id="heading-2">å®ç°æ€è·¯</h4>
<ol>
<li>è·å–å±å¹•çš„<code>width</code> å’Œ<code>height</code>ï¼Œå³å¾—åˆ°æ‚¬æµ®çƒç§»åŠ¨çš„èŒƒå›´</li>
<li>åˆ©ç”¨CSSä¸­çš„<code>position</code>çš„<code>absolute</code>å±æ€§ï¼ŒåŒæ—¶æ­é…<code>left</code>å’Œ<code>top</code>å±æ€§æ¥å®ç°å…ƒç´ ä½ç½®</li>
</ol>
<h4 data-id="heading-3">æ‹–æ‹½äº‹ä»¶çš„è¿‡ç¨‹</h4>
<blockquote>
<p>é€‰ä¸­å…ƒç´  > æ‹–åŠ¨å…ƒç´  > æ‹–åŠ¨ç»“æŸ</p>
</blockquote>
<h4 data-id="heading-4">å¼€å§‹æˆ‘ä»¬çš„ä¸»é¢˜</h4>
<blockquote>
<p>å®ç°ä¸€ä¸ªç±»ï¼Œè®©ç”¨æˆ·ä¼ å…¥éœ€è¦æ‹–åŠ¨çš„DOMå…ƒç´ </p>
</blockquote>
<p>å…ˆå®šä¹‰ä¸€ä¸ªç±»å¹¶å¯¼å‡ºï¼Œè¿™ä¸ªç±»å‘½åä¸º<code>Drag</code>,å¹¶å…ˆå®šä¹‰ä¸€äº›å¿…è¦çš„å±æ€§</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Drag</span></span>&#123;
  <span class="hljs-comment">// å…ƒç´ </span>
  <span class="hljs-attr">element</span>: HTMLElement;

  <span class="hljs-comment">// å±å¹•å°ºå¯¸</span>
  screenWidth: <span class="hljs-built_in">number</span>;

  screenHeight: <span class="hljs-built_in">number</span>;

  <span class="hljs-comment">// å…ƒç´ å¤§å°</span>
  elementWidth: <span class="hljs-built_in">number</span>;

  elementHeight: <span class="hljs-built_in">number</span>;

  isPhone: <span class="hljs-built_in">boolean</span>;

  <span class="hljs-comment">// å½“å‰å…ƒç´ åæ ‡</span>
  elementX: <span class="hljs-built_in">number</span>;

  elementY: <span class="hljs-built_in">number</span>;

  <span class="hljs-comment">// å…ƒç´ offset</span>
  elementOffsetX: <span class="hljs-built_in">number</span>;

  elementOffsetY: <span class="hljs-built_in">number</span>;

  <span class="hljs-comment">// æ˜¯å¦å¤„äºæ‹–åŠ¨çŠ¶æ€</span>
  moving: <span class="hljs-built_in">boolean</span>;

  <span class="hljs-comment">// å¸é™„</span>
  autoAdsorbent: <span class="hljs-built_in">boolean</span>;

  <span class="hljs-comment">// éšè—</span>
  hideOffset: <span class="hljs-built_in">number</span>;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨<code>Drag</code>ç±»ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°ï¼Œå£°æ˜éœ€è¦ä¼ å…¥çš„å‚æ•°ï¼Œå…ƒç´ æ˜¯å¿…ä¸å¯å°‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯DOMå…ƒç´ äº†</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">element: HTMLElement</span>)</span> &#123;
<span class="hljs-comment">//  æˆ‘éœ€è¦ä¼ å…¥ä¸€ä¸ªDOMå…ƒç´ ï¼Œå®ƒæ˜¯è¢«ç”¨æˆ·æ‹–åŠ¨çš„å…ƒç´ </span>
 &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li>åˆå§‹åŒ–ä¸€äº›å‚æ•°
<ul>
<li>è·å–å±å¹•çš„å®½é«˜</li>
<li>è·å–å…ƒç´ çš„å®½é«˜</li>
<li>åˆ¤æ–­è®¾å¤‡ï¼Œå¦‚æœæ˜¯ç”µè„‘ç«¯è®¾å¤‡åˆ™æŠ›å‡ºä¸€ä¸ª<code>error</code></li>
<li>å°†å…ƒç´ <code>position</code>å±æ€§çš„å€¼è®¾å®šä¸º<code>absolute</code></li>
</ul>
</li>
</ul>
<pre><code class="hljs language-typescript copyable" lang="typescript">  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">element: HTMLElement</span>)</span> &#123;
    <span class="hljs-built_in">this</span>.element = element;
    <span class="hljs-built_in">this</span>.screenWidth = <span class="hljs-built_in">window</span>.innerWidth || <span class="hljs-built_in">window</span>.outerWidth || <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.screenHeight = <span class="hljs-built_in">window</span>.innerHeight || <span class="hljs-built_in">window</span>.outerHeight || <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.elementWidth = <span class="hljs-built_in">this</span>.element.offsetWidth || <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.elementHeight = <span class="hljs-built_in">this</span>.element.offsetHeight || <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.isPhone = <span class="hljs-regexp">/(iPhone|iPad|iPod|iOS|Android)/i</span>.test(navigator.userAgent);
    <span class="hljs-built_in">this</span>.element.style.position = <span class="hljs-string">'absolute'</span>;
    <span class="hljs-built_in">this</span>.elementX = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.elementY = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.elementOffsetX = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.elementOffsetY = <span class="hljs-number">0</span>;
    <span class="hljs-built_in">this</span>.moving = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.isPhone) &#123;
      <span class="hljs-built_in">console</span>.error(<span class="hljs-string">'è­¦å‘Šï¼ï¼å½“å‰æ’ä»¶ç‰ˆæœ¬åªå…¼å®¹ç§»åŠ¨ç«¯'</span>);
    &#125;
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li>å®šä¹‰ä¸€ä¸ª<code>watchTouch</code>æ–¹æ³•ï¼Œç”¨æ¥ç»™æ‹–æ‹½å…ƒç´ æ·»åŠ äº‹ä»¶
<ul>
<li>è¿™é‡Œè¿˜æœ‰ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼Œ<strong><code>touchEvent</code>æ˜¯ä¸èƒ½ç›´æ¥è·å–åˆ°å…ƒç´ çš„offsetå€¼çš„</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨äº†<code>touchObject.pageX / touchObject.pageY - DOMRect.left / DOMRect.top</code> æ¥è·å¾—å…ƒç´ <code>offset</code>å€¼</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">private</span> watchTouch(): <span class="hljs-built_in">void</span> &#123;
    <span class="hljs-built_in">this</span>.element.addEventListener(<span class="hljs-string">'touchstart'</span>, <span class="hljs-function">(<span class="hljs-params">event: TouchEvent</span>) =></span> &#123;
      <span class="hljs-keyword">const</span> rect = (event.target <span class="hljs-keyword">as</span> HTMLElement).getBoundingClientRect();
      <span class="hljs-comment">// é¡µé¢è¢«å·å»çš„é«˜åº¦</span>
      <span class="hljs-comment">// ä¸å…¼å®¹IE</span>
      <span class="hljs-keyword">const</span> docScrollTop = <span class="hljs-built_in">document</span>.documentElement.scrollTop;
      <span class="hljs-built_in">this</span>.elementOffsetX = event.targetTouches[<span class="hljs-number">0</span>].pageX - rect.left;
      <span class="hljs-built_in">this</span>.elementOffsetY = event.targetTouches[<span class="hljs-number">0</span>].pageY - rect.top - docScrollTop;
      <span class="hljs-built_in">this</span>.moving = <span class="hljs-literal">true</span>;
      <span class="hljs-built_in">this</span>.element.addEventListener(<span class="hljs-string">'touchmove'</span>, <span class="hljs-built_in">this</span>.move.bind(<span class="hljs-built_in">this</span>), &#123; <span class="hljs-attr">passive</span>: <span class="hljs-literal">false</span> &#125;);
    &#125;);
    <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'touchend'</span>, <span class="hljs-function">() =></span> &#123;
      <span class="hljs-built_in">this</span>.moving = <span class="hljs-literal">false</span>;
      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">'touchmove'</span>, <span class="hljs-built_in">this</span>.move);
    &#125;);
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li>å®šä¹‰ä¸€ä¸ªè®¾å®šå…ƒç´ ä½ç½®æ–¹æ³•ï¼Œä¼ å…¥<code>x</code>å’Œ<code>y</code>æ¥è®¾å®š<code>left</code>å’Œ<code>top</code>å€¼</li>
</ul>
<pre><code class="hljs language-typescript copyable" lang="typescript">  <span class="hljs-keyword">private</span> setElementPosition(x: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> &#123;
    <span class="hljs-comment">// æº¢å‡ºå¤„ç†</span>
    <span class="hljs-comment">// æº¢å‡ºèŒƒå›´</span>
    <span class="hljs-comment">// ä½†é¡µé¢è¶…å‡ºå±å¹•èŒƒå›´ï¼Œè®¡ç®—å½“å‰å±å¹•èŒƒå›´</span>
    <span class="hljs-keyword">const</span> leftScope = <span class="hljs-built_in">this</span>.moving ? <span class="hljs-number">0</span> : <span class="hljs-number">0</span> - <span class="hljs-built_in">this</span>.hideOffset;
    <span class="hljs-comment">// å½“å‰å±å¹•rightæœ€å¤§å€¼</span>
    <span class="hljs-keyword">const</span> rs = <span class="hljs-built_in">this</span>.screenWidth - <span class="hljs-built_in">this</span>.elementWidth;
    <span class="hljs-keyword">const</span> rightScope = <span class="hljs-built_in">this</span>.moving ? rs : rs + <span class="hljs-built_in">this</span>.hideOffset;
    <span class="hljs-keyword">const</span> bottomScope = <span class="hljs-built_in">this</span>.screenHeight - <span class="hljs-built_in">this</span>.elementHeight;
    <span class="hljs-keyword">if</span> (x <= leftScope && y <= <span class="hljs-number">0</span>) &#123;
      [x, y] = [leftScope, <span class="hljs-number">0</span>];
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x >= rightScope && y <= <span class="hljs-number">0</span>) &#123;
      [x, y] = [rightScope, <span class="hljs-number">0</span>];
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x <= leftScope && y >= bottomScope) &#123;
      [x, y] = [leftScope, bottomScope];
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x >= rightScope && y >= bottomScope) &#123;
      [x, y] = [rightScope, bottomScope];
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x > rightScope) &#123;
      x = rightScope;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (y > bottomScope) &#123;
      y = bottomScope;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (x <= leftScope) &#123;
      x = leftScope;
    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (y <= <span class="hljs-number">0</span>) &#123;
      y = <span class="hljs-number">0</span>;
    &#125;
    <span class="hljs-built_in">this</span>.elementX = x;
    <span class="hljs-built_in">this</span>.elementY = y;
    <span class="hljs-built_in">this</span>.element.style.top = <span class="hljs-string">`<span class="hljs-subst">$&#123;y&#125;</span>px`</span>;
    <span class="hljs-built_in">this</span>.element.style.left = <span class="hljs-string">`<span class="hljs-subst">$&#123;x&#125;</span>px`</span>;
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li>å®šä¹‰ä¸€ä¸ª<code>move</code>æ–¹æ³•ï¼Œå®ƒå°†è°ƒç”¨ä¸Šé¢è®¾å®šçš„<code>setElementPosition</code>æ–¹æ³•</li>
</ul>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">private</span> move(event: TouchEvent): <span class="hljs-built_in">void</span> &#123;
    event.preventDefault();
    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">this</span>.moving) <span class="hljs-keyword">return</span>;
    <span class="hljs-built_in">this</span>.elementY = (event.touches[<span class="hljs-number">0</span>].pageX - <span class="hljs-built_in">this</span>.elementOffsetX);
    <span class="hljs-built_in">this</span>.elementX = (event.touches[<span class="hljs-number">0</span>].pageY - <span class="hljs-built_in">this</span>.elementOffsetY);
    <span class="hljs-keyword">const</span> ex = (event.touches[<span class="hljs-number">0</span>].pageX - <span class="hljs-built_in">this</span>.elementOffsetX);
    <span class="hljs-keyword">const</span> ey = (event.touches[<span class="hljs-number">0</span>].pageY - <span class="hljs-built_in">this</span>.elementOffsetY);
    <span class="hljs-built_in">this</span>.setElementPosition(ex, ey);
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-5">åˆ°äº†è¿™é‡Œæˆ‘ä»¬çš„ç»„ä»¶å·²ç»å¯ä»¥å®ç°ç®€å•çš„æ‹–æ‹½äº†ï¼</h4>
<h4 data-id="heading-6">ä½†è¿™è¿˜è¾¾ä¸åˆ°æˆ‘ä»¬å‰é¢è¯´åˆ°çš„å¸é™„åŠŸèƒ½</h4>
<p>æˆ‘ä»¬ç»§ç»­ç»™<code>Drag</code>ç±»æ·»åŠ ä¸ªå¸é™„åŠŸèƒ½</p>
<ul>
<li>å¸é™„æ€è·¯
<ul>
<li>å½“<code>touchend</code>äº‹ä»¶è§¦å‘æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ¤æ–­å½“å‰å…ƒç´ ä¸å±å¹•ä¹‹é—´ï¼Œæ‚¬é åœ¨å“ªä¸€è¾¹æ›´è¿‘ä¸€äº›
<ul>
<li><code>const screenCenterY = Math.round(this.screenWidth / 2);</code></li>
<li><code>this.elementX < screenCenterY</code></li>
</ul>
</li>
<li>å®šä¹‰ä¸€ä¸ªåŠ¨ç”»å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯å…ƒç´ ä»Aç‚¹åˆ°Bç‚¹çš„è¿‡æ¸¡æ•ˆæœï¼ˆå¦‚æœæ²¡æœ‰è¿™ä¸€æ­¥ï¼Œå¾ˆç”Ÿç¡¬ï¼‰</li>
<li>å®šä¹‰å¸é™„åŠŸèƒ½å¼€å…³</li>
</ul>
</li>
</ul>
<pre><code class="hljs language-typescript copyable" lang="typescript">  <span class="hljs-keyword">private</span> animate(targetLeft: <span class="hljs-built_in">number</span>, <span class="hljs-attr">spd</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> &#123;
    <span class="hljs-keyword">const</span> timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =></span> &#123;
      <span class="hljs-keyword">let</span> step = (targetLeft - <span class="hljs-built_in">this</span>.elementX) / <span class="hljs-number">10</span>;
      <span class="hljs-comment">// å¯¹æ­¥é•¿è¿›è¡ŒäºŒæ¬¡åŠ å·¥(å¤§äº0å‘ä¸Šå–æ•´,å°äº0å‘ä¸‹å–æ•´)</span>
      step = step > <span class="hljs-number">0</span> ? <span class="hljs-built_in">Math</span>.ceil(step) : <span class="hljs-built_in">Math</span>.floor(step);
      <span class="hljs-comment">// åŠ¨ç”»åŸç†ï¼š ç›®æ ‡ä½ç½® = å½“å‰ä½ç½® + æ­¥é•¿</span>
      <span class="hljs-keyword">const</span> x = <span class="hljs-built_in">this</span>.elementX + step;
      <span class="hljs-built_in">this</span>.setElementPosition(x, <span class="hljs-built_in">this</span>.elementY);
      <span class="hljs-comment">// æ£€æµ‹ç¼“åŠ¨åŠ¨ç”»æœ‰æ²¡æœ‰åœæ­¢</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">Math</span>.abs(targetLeft - <span class="hljs-built_in">this</span>.elementX) <= <span class="hljs-built_in">Math</span>.abs(step)) &#123;
        <span class="hljs-comment">// å¤„ç†å°æ•°èµ‹å€¼</span>
        <span class="hljs-keyword">const</span> xt = targetLeft;
        <span class="hljs-built_in">this</span>.setElementPosition(xt, <span class="hljs-built_in">this</span>.elementY);
        <span class="hljs-built_in">clearInterval</span>(timer);
      &#125;
    &#125;, spd);
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">private</span> adsorbent():<span class="hljs-built_in">void</span> &#123;
    <span class="hljs-comment">// åˆ¤æ–­å¸é™„æ–¹å‘</span>
    <span class="hljs-comment">// å±å¹•ä¸­å¿ƒç‚¹</span>
    <span class="hljs-keyword">const</span> screenCenterY = <span class="hljs-built_in">Math</span>.round(<span class="hljs-built_in">this</span>.screenWidth / <span class="hljs-number">2</span>);
    <span class="hljs-comment">// left æœ€å¤§å€¼</span>
    <span class="hljs-keyword">const</span> rightScope = <span class="hljs-built_in">this</span>.screenWidth - <span class="hljs-built_in">this</span>.elementWidth;
    <span class="hljs-comment">// æ ¹æ®ä¸­å¿ƒç‚¹æ¥åˆ¤æ–­å¸é™„æ–¹å‘</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.elementX < screenCenterY) &#123;
      <span class="hljs-built_in">this</span>.animate(<span class="hljs-number">0</span> - (<span class="hljs-built_in">this</span>.hideOffset), <span class="hljs-number">10</span>);
    &#125; <span class="hljs-keyword">else</span> &#123;
      <span class="hljs-built_in">this</span>.animate(rightScope + (<span class="hljs-built_in">this</span>.hideOffset), <span class="hljs-number">10</span>);
    &#125;
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å®šä¹‰ä¸€ä¸ªæ¥å£<code>interface</code>ï¼Œä½œä¸º<code>Drag</code>çš„ç¬¬äºŒä¸ªå‚æ•°ï¼š</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">interface</span> Options &#123;
  autoAdsorbent?: <span class="hljs-built_in">boolean</span>;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å°†å‰é¢çš„<code>constructor</code>æ–¹æ³•å‚æ•°ä¿®æ”¹ä¸ºï¼š</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-title">constructor</span>(<span class="hljs-params">element: HTMLElement, dConfig: Options = &#123;&#125;</span>)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨<code>Drag</code>ç±»ä¸­æ·»åŠ ä¸€ä¸ª<code>autoAdsorbent</code>å±æ€§ï¼Œç”¨äºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦å¼€å¯äº†å¸é™„åŠŸèƒ½</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Drag</span></span>&#123;
  <span class="hljs-comment">// å¸é™„</span>
  <span class="hljs-attr">autoAdsorbent</span>: <span class="hljs-built_in">boolean</span>;
  <span class="hljs-comment">//...</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨<code>watchTouch</code>æ–¹æ³•ä¸­ï¼Œ<code>touchend</code>äº‹ä»¶åŠ å…¥</p>
<pre><code class="hljs language-typescript copyable" lang="typescript"> <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">'touchend'</span>, <span class="hljs-function">() =></span> &#123;
      <span class="hljs-comment">// ...</span>
      <span class="hljs-keyword">if</span> (<span class="hljs-built_in">this</span>.autoAdsorbent) <span class="hljs-built_in">this</span>.adsorbent();
    &#125;);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿™é‡Œè¿˜ä¼šæœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ä¼ å…¥<code>dConfig</code>å‘¢ï¼Ÿ</p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨<code>construction</code>æ–¹æ³•ä¸­è¡¥å……ä¸€å¥ï¼Œæ„æ€æ˜¯å¦‚æœ<code>dConfig</code>å‚æ•°ä¸­çš„<code>autoAdsorbent</code>ä¸å­˜åœ¨ï¼Œåˆ™å°†å®ƒè®¾ç½®ä¸º<code>false</code></p>
<pre><code class="hljs language-typescript copyable" lang="typescript">  <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">element: HTMLElement, dConfig: Options = &#123;&#125;</span>)</span> &#123;
  dConfig = &#123;<span class="hljs-attr">autoAdsorbent</span>: dConfig.autoAdsorbent || <span class="hljs-literal">false</span>&#125;
  &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-7">ä½¿ç”¨æˆ‘ä»¬çš„Dragç±»</h4>
<p>ç¬¬ä¸€æ­¥ï¼Œå¼•å…¥æˆ‘ä»¬å†™å¥½çš„<code>Drag</code></p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">import</span> Drag <span class="hljs-keyword">from</span> <span class="hljs-string">'Drag'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"root"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"BDrag"</span>></span><span class="hljs-tag"></<span class="hljs-name">div</span>></span>
<span class="hljs-tag"></<span class="hljs-name">div</span>></span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-selector-class">.drag</span>&#123;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">50px</span>;
    <span class="hljs-attribute">background-color</span>: <span class="hljs-built_in">rgb</span>(<span class="hljs-number">238</span>, <span class="hljs-number">238</span>, <span class="hljs-number">238</span>);
    <span class="hljs-attribute">border-radius</span>: <span class="hljs-number">50%</span>;
    <span class="hljs-attribute">border</span>: <span class="hljs-number">5px</span> solid <span class="hljs-built_in">rgb</span>(<span class="hljs-number">170</span>, <span class="hljs-number">170</span>, <span class="hljs-number">170</span>);
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>BetterGraggbleBall</code>æä¾›äº†ä¸€ä¸ªç±»ï¼Œå®ä¾‹åŒ–çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåŸç”ŸDOMå…ƒç´ </p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">const</span> BDragDom = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'BDrag'</span>);
<span class="hljs-keyword">const</span> BDrag = <span class="hljs-keyword">new</span> BDrag(BDragDom);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ’ä»¶  GITåœ°å€ï¼š<a href="https://github.com/QC2168/better-draggable-ball" target="_blank" rel="nofollow noopener noreferrer">github.com/QC2168/bettâ€¦</a></p>
<p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨npmç›´æ¥å®‰è£…å®ƒ</p>
<pre><code class="copyable">npm install better-draggable-ball --save
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-8">ç»“å°¾</h4>
<p>å¦‚æœä½ è§‰å¾—è¯¥æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œæ¬¢è¿ç‚¹ä¸ªèµğŸ‘å’Œå…³æ³¨ã€‚</p></div>  
</div>
            