
---
title: 'ã€JSã€‘ç®€ç®€å•å•çš„ä¸€æ¬¡babelå¤§æ‰«ç›²ï¼'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://picsum.photos/400/300?random=6049'
author: æ˜é‡‘
comments: false
date: Sun, 04 Apr 2021 19:39:58 GMT
thumbnail: 'https://picsum.photos/400/300?random=6049'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">ç¥–ä¼ å¼€å¤´</h2>
<blockquote>
<p>æ—©ç¡æ—©èµ·ä¿å¹³å®‰</p>
</blockquote>
<p>è¿™ç¯‡æ–‡ç« ç®—æ˜¯ä¸€æ¬¡å…³äºbabelçš„ä¸€æ¬¡æ‰«ç›²ã€‚æ•´ç†å‡ºä¸€ä»½babelçš„åŸºç¡€æ¦‚å¿µæ‰«ç›²ï¼Œå†™ç»™è‡ªå·±ï¼Œä¹Ÿå†™éœ€è¦è¿™ç§åŸºç¡€æ¢³ç†çš„å°ä¼™ä¼´å§ã€‚å¸Œæœ›å¤§å®¶éƒ½ä¸è¦å› ä¸ºéå¸¸åŸºç¡€çš„é—®é¢˜ï¼Œæ¯”å¦‚babelç‰ˆæœ¬ä¹‹ç±»çš„å°é—®é¢˜ç»Šä½äº†æ‰‹è„šå“ˆå“ˆå“ˆï¼å¦å¤–babelä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¥½çš„å­¦ä¹ å·¥å…·ï¼Œå¯ä»¥æŠŠes6çš„ä»£ç è½¬åŒ–æˆes5ï¼ŒæŠ›å¼€å„ç§è¯­æ³•ç³–ï¼Œæ¢ç©¶jsçš„æœ¬è´¨ã€‚æ€»è€Œè¨€ä¹‹ï¼Œå¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¯¹å„ä½æœ‰æ‰€åŠ©ç›Šå§~</p>
<h2 data-id="heading-1">ä¸€ã€BabelåŸºæœ¬æ¦‚å¿µ</h2>
<blockquote>
<p>Babel æ˜¯ä¸€ä¸ªé€šç”¨çš„å¤šåŠŸèƒ½çš„ JavaScript ç¼–è¯‘å™¨ã€‚å°†ECMAScript 2015+ çš„ä»£ç è½¬åŒ–æˆèƒ½é€‚é…å„ç§ä½ç«¯æ¸¸è§ˆå™¨æˆ–è€…å…¶ä»–ç¯å¢ƒï¼ˆNodeï¼‰çš„ä»£ç ã€‚</p>
</blockquote>
<p><strong>ç‰¹ç‚¹ï¼š</strong></p>
<ul>
<li>é™æ€åˆ†æï¼Œåœ¨ä¸éœ€è¦æ‰§è¡Œä»£ç çš„æƒ…å†µä¸‹ï¼Œå¯¹ä»£ç åˆ†æå¤„ç†ã€‚</li>
<li>é€šè¿‡ç»„åˆå„ç§æ¨¡å—ï¼Œç”Ÿä¸€ä¸ªèƒ½å®ç°ç‰¹å®šåŠŸèƒ½çš„é›†åˆã€‚</li>
<li>@babel/core åŒ…å«äº†æ‰€æœ‰babelçš„ æ ¸å¿ƒåŠŸèƒ½ï¼Œä½¿ç”¨babelå‰å¿…é¡»å…ˆå¼•å…¥ã€‚</li>
</ul>
<h2 data-id="heading-2">ğŸŒ°ä¸€ä¸ªç®€å•çš„ä¾‹å­</h2>
<p><br><strong>ç¬¬ä¸€æ­¥ï¼šåœ¨ <code>.babelrc</code> æ–‡ä»¶ä¸­è¿›è¡Œbabelçš„é…ç½®ã€‚</strong></p>
<blockquote>
<p>å½“ç„¶è¿˜æœ‰å…¶ä»–çš„é…ç½®æ–¹å¼ï¼Œæ¯”å¦‚åˆ›å»ºä¸€ä¸ªbabel.config.jsæ–‡ä»¶æˆ–è€…ç›´æ¥åœ¨package.jsonä¸­çš„babelå­—æ®µä¸‹è¿›è¡Œé…ç½®ã€‚</p>
</blockquote>
<pre><code class="hljs language-json copyable" lang="json">&#123;
    <span class="hljs-attr">"presets"</span>: [
        [
            <span class="hljs-string">"@babel/preset-env"</span>
        ]
    ]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>**ç¬¬äºŒæ­¥ï¼šå®‰è£… <code>@babel/core</code>Â ã€ <code>@babel/cli</code>Â å’Œ **<code>**@babel/preset-env**</code>Â <strong>ã€‚</strong><br>@babel/coreæ˜¯babelçš„å’Œæ ¸å¿ƒåº“ã€‚@babel/cliæ˜¯babelèƒ½åœ¨ç»ˆç«¯ç¯å¢ƒä¸­å¯ä»¥è¿è¡Œçš„å·¥å…·åº“ã€‚<br>
<br><strong>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºæºä»£ç æ–‡ä»¶å’Œbabelè¿è¡Œå‘½ä»¤ã€‚</strong><br>
<br>src/index.js</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">const</span> newArys = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>].map(<span class="hljs-function">(<span class="hljs-params">n</span>) =></span> n * n);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><br>package.json</p>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-string">"scripts"</span>: &#123;
    <span class="hljs-attr">"compiler"</span>: <span class="hljs-string">"babel src --out-dir lib"</span>,
    <span class="hljs-attr">"watch"</span>: <span class="hljs-string">"npm run compiler -- --watch"</span>
 &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å‘½ä»¤ <code>compiler</code>Â çš„ä½œç”¨å°±æ˜¯å°† <code>src</code>Â ç›®å½•ä¸‹æ‰€æœ‰çš„JavaScriptæ–‡ä»¶éƒ½è¿›è¡Œè§£æï¼Œæœ€åè¾“å‡ºåˆ° <code>lib</code>Â ç›®å½•ä¸‹ã€‚<br>å‘½ä»¤ <code>watch</code>Â çš„ä½œç”¨å°±æ˜¯ç›‘å¬ <code>src</code>Â ç›®å½•ä¸‹æ˜¯å¦æœ‰è¿›è¡Œæ”¹åŠ¨ï¼Œè‹¥æœ‰å°±é‡æ–°è¿›è¡Œç¼–è¯‘ã€‚</p>
<blockquote>
<p>tipsï¼šå‘ npm è„šæœ¬ä¼ å…¥å‚æ•°ï¼Œè¦ä½¿ç”¨--æ ‡æ˜ã€‚</p>
</blockquote>
<p>**<br><strong>æ›´å¤šbabel-cliå‘½ä»¤</strong><br>ä»¥ä¸‹åˆ—ä¸¾äº†å‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„é…ç½®å‘½ä»¤ã€‚</p>



































<table><thead><tr><th></th><th>è¯´æ˜</th><th>ä½¿ç”¨</th></tr></thead><tbody><tr><td>--out-file/-o</td><td>æŒ‡å®šè¾“å‡ºæ–‡ä»¶</td><td>babel src --out-file index.js</td></tr><tr><td>--out-dir/-o</td><td>æŒ‡å®šè¾“å‡ºç›®å½•</td><td>babel src --out-dir lib</td></tr><tr><td>--watch/-w</td><td>ç›‘å¬æ–‡ä»¶æ”¹åŠ¨å¹¶ä¸”è¿›è¡Œé‡æ–°ç¼–è¯‘</td><td>babel src --out-dir lib --watch</td></tr><tr><td>--source-maps/-s</td><td>ç”Ÿæˆæ˜ å°„ä»£ç </td><td>babel src --out-file script-compiled.js --source-maps</td></tr><tr><td>--ignore</td><td>æŒ‡å®šä¸éœ€è¦è½¬æ¢çš„æ–‡ä»¶</td><td>babel src --out-dir lib ---ignore "src/**/*.spec.js",</td></tr></tbody></table>
<p><a href="https://www.babeljs.cn/docs/babel-cli" target="_blank" rel="nofollow noopener noreferrer">www.babeljs.cn/docs/babel-â€¦</a></p>
<h2 data-id="heading-3">äºŒã€BabelåŸç†</h2>
<h4 data-id="heading-4">ä¸‰ä¸ªæ­¥éª¤</h4>
<p>babelçš„å¤„ç†æ­¥éª¤ä¸»è¦åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š</p>
<h4 data-id="heading-5">ç¬¬ä¸€æ­¥ï¼šè§£æï¼ˆparseï¼‰</h4>
<p>å°†åŸä»£ç è½¬æ¢æˆASTæ ‘ï¼Œä¹Ÿå°±æ˜¯æŠ½è±¡è¯­æ³•æ ‘ã€‚è¿™ä¸ªæ­¥éª¤åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li>è¯æ³•åˆ†æ</li>
<li>è¯­æ³•åˆ†æ</li>
</ul>
<p><br><code>è¯æ³•åˆ†æ</code>Â ç®€å•çš„æ¥ç†è§£ï¼Œå°±æ˜¯æŠŠåŸä»£ç ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰è¿›è¡Œåˆ†å‰²ï¼Œç”Ÿæˆä¸€ä¸ªä¸ªæœ€å°å•ä½â€”â€”ä»¤ç‰Œï¼ˆtokenï¼‰ï¼Œæ–¹ä¾¿åç»­çš„ç»„è£…ã€‚<br>ä¸€ä¸ªç®€å•çš„è¡¨è¾¾å¼ï¼š</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">a * b
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç»è¿‡è¯æ³•åˆ†æåï¼Œä»¥ä¸Šè¡¨è¾¾å¼åˆ†å‰²æˆ3ä¸ªéƒ¨åˆ†ã€‚å˜æˆä¸€ç»„ <code>ä»¤ç‰Œæµï¼ˆtokensï¼‰</code>Â ã€‚å½¢å¼å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">[
  &#123; <span class="hljs-attr">type</span>: &#123; ... &#125;, <span class="hljs-attr">value</span>: <span class="hljs-string">"a"</span>, <span class="hljs-attr">start</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">loc</span>: &#123; ... &#125; &#125;,
  &#123; <span class="hljs-attr">type</span>: &#123; ... &#125;, <span class="hljs-attr">value</span>: <span class="hljs-string">"*"</span>, <span class="hljs-attr">start</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">loc</span>: &#123; ... &#125; &#125;,
  &#123; <span class="hljs-attr">type</span>: &#123; ... &#125;, <span class="hljs-attr">value</span>: <span class="hljs-string">"b"</span>, <span class="hljs-attr">start</span>: <span class="hljs-number">4</span>, <span class="hljs-attr">end</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">loc</span>: &#123; ... &#125; &#125;,
  ...
]
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>è¯æ³•åˆ†æ</code>Â ï¼Œå°±æ˜¯æŠŠæ¯ä¸ªtokençš„å…³ç³»æè¿°æ¸…æ¥šï¼ŒæŠŠæœ‰å…³ç³»çš„tokenç»„åˆåœ¨ä¸€èµ·ã€‚æ¯”å¦‚ä¸Šè¿°ä¸‰ä¸ªtokenç»„åˆèµ·æ¥å°±æ˜¯ä¸ªè·å–ä¹˜ç§¯çš„è¡¨è¾¾å¼ã€‚ç»è¿‡è¯æ³•åˆ†æåï¼Œå°±ä¼šç”ŸæˆASTæ ‘ã€‚<br>
<br>ğŸ„å…ˆæ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ASTæ ‘ï¼šï¼ˆé€šè¿‡<a href="https://astexplorer.net/" target="_blank" rel="nofollow noopener noreferrer">AST Explorer</a>æ¨¡æ‹ŸASTæ ‘çš„ç”Ÿæˆï¼‰<br>æºç ï¼š</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">add</span>(<span class="hljs-params">a, b</span>) </span>&#123;
  <span class="hljs-keyword">return</span> a + b
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Program"</span>,
  <span class="hljs-attr">"start"</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">"end"</span>: <span class="hljs-number">37</span>,
  <span class="hljs-attr">"body"</span>: [
    &#123;
      <span class="hljs-attr">"type"</span>: <span class="hljs-string">"FunctionDeclaration"</span>,
      <span class="hljs-attr">"start"</span>: <span class="hljs-number">0</span>,
      <span class="hljs-attr">"end"</span>: <span class="hljs-number">37</span>,
      <span class="hljs-attr">"id"</span>: &#123;
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Identifier"</span>,
        <span class="hljs-attr">"start"</span>: <span class="hljs-number">9</span>,
        <span class="hljs-attr">"end"</span>: <span class="hljs-number">12</span>,
        <span class="hljs-attr">"name"</span>: <span class="hljs-string">"add"</span>
      &#125;,
      <span class="hljs-attr">"expression"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"generator"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"async"</span>: <span class="hljs-literal">false</span>,
      <span class="hljs-attr">"params"</span>: [
        &#123;
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Identifier"</span>,
          <span class="hljs-attr">"start"</span>: <span class="hljs-number">13</span>,
          <span class="hljs-attr">"end"</span>: <span class="hljs-number">14</span>,
          <span class="hljs-attr">"name"</span>: <span class="hljs-string">"a"</span>
        &#125;,
        &#123;
          <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Identifier"</span>,
          <span class="hljs-attr">"start"</span>: <span class="hljs-number">16</span>,
          <span class="hljs-attr">"end"</span>: <span class="hljs-number">17</span>,
          <span class="hljs-attr">"name"</span>: <span class="hljs-string">"b"</span>
        &#125;
      ],
      <span class="hljs-attr">"body"</span>: &#123;
        <span class="hljs-attr">"type"</span>: <span class="hljs-string">"BlockStatement"</span>,
        <span class="hljs-attr">"start"</span>: <span class="hljs-number">19</span>,
        <span class="hljs-attr">"end"</span>: <span class="hljs-number">37</span>,
        <span class="hljs-attr">"body"</span>: [
          &#123;
            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"ReturnStatement"</span>,
            <span class="hljs-attr">"start"</span>: <span class="hljs-number">23</span>,
            <span class="hljs-attr">"end"</span>: <span class="hljs-number">35</span>,
            <span class="hljs-attr">"argument"</span>: &#123;
              <span class="hljs-attr">"type"</span>: <span class="hljs-string">"BinaryExpression"</span>,
              <span class="hljs-attr">"start"</span>: <span class="hljs-number">30</span>,
              <span class="hljs-attr">"end"</span>: <span class="hljs-number">35</span>,
              <span class="hljs-attr">"left"</span>: &#123;
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Identifier"</span>,
                <span class="hljs-attr">"start"</span>: <span class="hljs-number">30</span>,
                <span class="hljs-attr">"end"</span>: <span class="hljs-number">31</span>,
                <span class="hljs-attr">"name"</span>: <span class="hljs-string">"a"</span>
              &#125;,
              <span class="hljs-attr">"operator"</span>: <span class="hljs-string">"+"</span>,
              <span class="hljs-attr">"right"</span>: &#123;
                <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Identifier"</span>,
                <span class="hljs-attr">"start"</span>: <span class="hljs-number">34</span>,
                <span class="hljs-attr">"end"</span>: <span class="hljs-number">35</span>,
                <span class="hljs-attr">"name"</span>: <span class="hljs-string">"b"</span>
              &#125;
            &#125;
          &#125;
        ]
      &#125;
    &#125;
  ],
  <span class="hljs-attr">"sourceType"</span>: <span class="hljs-string">"module"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ASTæ ‘çš„æ¯ä¸€å±‚ç»“æ„éƒ½æ¯”è¾ƒç›¸ä¼¼ï¼Œæ¯ä¸€å±‚æ ‘éƒ½ä¼šç”±ä¸€ä¸ªä¸ªèŠ‚ç‚¹ï¼ˆ<strong>Node</strong>ï¼‰æ„æˆã€‚æ¯ä¸ªèŠ‚ç‚¹çš„typeéƒ½ä¼šå¯¹è¿™ä¸ªèŠ‚ç‚¹çš„ç±»å‹è¿›è¡Œè¯´æ˜ï¼š</p>
<ul>
<li><code>Program</code>Â ï¼šä¸€ä¸ªç¨‹åºçš„æ ¹èŠ‚ç‚¹ç±»å‹</li>
<li><code>FunctionDeclaration</code>Â ï¼šå‡½æ•°å£°æ˜</li>
<li><code>Identifier</code>Â ï¼šå˜é‡å£°æ˜</li>
<li><code>BinaryExpression</code>Â ï¼šè¡¨è¾¾å¼</li>
<li>...</li>
</ul>
<pre><code class="hljs language-json copyable" lang="json">&#123;
   type:<span class="hljs-string">""</span>,
   id:<span class="hljs-string">""</span>,
   params:&#123;&#125;,
   body:&#123;&#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<blockquote>
<p>æ¯ä¸ªèŠ‚ç‚¹éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªæ ‘å½¢ç»“æ„ï¼Œæˆåƒä¸Šä¸‡çš„èŠ‚ç‚¹ç»„æˆçš„ä¸€ä¸ªASTæ ‘ã€‚è¿™æ ·å°±å®Œæˆäº†ä¸€æ¬¡å¯¹ä»£ç çš„é™æ€åˆ†æã€‚</p>
</blockquote>
<h4 data-id="heading-6"></h4>
<h4 data-id="heading-7">ç¬¬äºŒæ­¥ï¼šè½¬æ¢ï¼ˆtransformï¼‰</h4>
<p>è¿™ä¸ªæ­¥éª¤å°±æ˜¯æ¥æ”¶åˆ°ç¬¬ä¸€æ­¥ç”Ÿæˆçš„ASTæ ‘åè¿›è¡Œ<strong>éå†</strong>ï¼Œå¯¹ASTçš„èŠ‚ç‚¹è¿›è¡Œæ›´æ–°ã€æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œã€‚ä¹Ÿæ˜¯æ•´ä¸ªç¼–è¯‘è¿‡ç¨‹ä¸­æœ€å¤æ‚çš„éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯babelæ’ä»¶ä»‹å…¥å·¥ä½œå¹¶å®Œæˆä¸€äº›ç‰¹å®šåŠŸèƒ½çš„è¿‡ç¨‹ã€‚<br>
<br><strong>babelæ’ä»¶åŸç†ï¼š</strong></p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªè®¿é—®è€…ï¼Œè¿™ä¸ªè®¿é—®è€…å¯¹è±¡ä¼šæä¾›å…·ä½“çš„è·å–æ ‘èŠ‚ç‚¹ä¿¡æ¯çš„æ–¹æ³•</li>
<li>å®é™…è®¿é—®çš„æ˜¯ä¸€ä¸ª<strong>è·¯å¾„</strong></li>
</ul>
<p>**<br>ğŸŒ°çœ‹ä¸€ä¸ªç®€å•çš„babelæ’ä»¶ä¾‹å­</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-comment">// babel-plugins-mm</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-keyword">return</span> &#123;
        <span class="hljs-attr">visitor</span>:&#123;
            <span class="hljs-attr">Identifier</span>: &#123;
                <span class="hljs-function"><span class="hljs-title">enter</span>(<span class="hljs-params">path</span>)</span> &#123;
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Entered!"</span>+ path.node.name);
                &#125;,
                <span class="hljs-function"><span class="hljs-title">exit</span>(<span class="hljs-params">path</span>)</span> &#123;
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Exited!"</span>+ path.node.name);
                &#125;
            &#125;
        &#125;
    &#125;;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä½¿ç”¨æ’ä»¶ï¼šï¼ˆåªå†™æ’ä»¶åç§°ï¼Œé»˜è®¤ä¼šä»node-modulesé‡ŒæŸ¥æ‰¾ï¼‰<br><code>mm</code>Â æ˜¯ <code>babel-plugins-mm</code>Â çš„ç®€å†™ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
    <span class="hljs-attr">"presets"</span>: [
        [<span class="hljs-string">"@babel/preset-env"</span>]
    ],
    <span class="hljs-attr">"plugins"</span>: [
        [<span class="hljs-string">"mm"</span>]
    ]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-8">ç¬¬ä¸‰æ­¥ï¼šç”Ÿæˆï¼ˆgenerateï¼‰</h4>
<p>æœ€åä¸€æ­¥å°±æ˜¯å°±æ˜¯å°†å¤„ç†è¿‡åçš„ASTå†æ¬¡è½¬åŒ–åå­—ç¬¦ä¸²å½¢å¼çš„ä»£ç ã€‚ï¼ˆæ·±åº¦ä¼˜å…ˆçš„éå†ASTæ ‘ï¼Œå¹¶ç”Ÿæˆå­—ç¬¦ä¸²å½¢å¼çš„ä»£ç ã€‚ï¼‰</p>
<h2 data-id="heading-9">ä¸‰ã€Babelé…ç½®</h2>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-comment">// é¢„è®¾</span>
  <span class="hljs-attr">"presets"</span>:[...],
  <span class="hljs-comment">// æ’ä»¶</span>
  <span class="hljs-attr">"plugins"</span>:[...],
  <span class="hljs-comment">// ç¯å¢ƒé…ç½®</span>
  <span class="hljs-attr">"env"</span>: &#123;
     <span class="hljs-attr">"development"</span>: &#123;
       <span class="hljs-attr">"plugins"</span>: [...]
     &#125;,
     <span class="hljs-attr">"production"</span>: &#123;
       <span class="hljs-attr">"plugins"</span>: [...]
     &#125;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-10">4ã€Babelé¢„è®¾</h2>
<blockquote>
<p>å°±æ˜¯æŠŠé›¶é›¶æ•£æ•£çš„babelæ’ä»¶ç»„åˆèµ·æ¥ï¼Œåªè¦ç®€å•çš„å¼•å…¥ä¸€ä¸ªbabelé¢„è®¾ã€‚
æ¯ä¸ªé¢„è®¾éƒ½ä¼šæœ‰è‡ªå·±å¯¹åº”çš„é…ç½®é¡¹ï¼Œå…·ä½“å¯ä»¥æŸ¥é˜…babelå®˜ç½‘ã€‚</p>
</blockquote>
<p><br>ç›®å‰å®˜æ–¹çš„æ¨èçš„ä¸€äº›é¢„è®¾ï¼š</p>
<pre><code class="copyable">@babel/preset-env
@babel/preset-flow
@babel/preset-react
@babel/preset-typescript
...
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><br>æ³¨æ„ï¼šbabel @7.0.0ä¹‹åå¯¹æ ‡å‡†é˜¶æ®µææ¡ˆçš„ä¸€äº›é¢„è®¾éƒ½ä¼šåºŸå¼ƒï¼Œæ¯”å¦‚ä»¥ä¸‹é¢„è®¾ä¸æ¨èä½¿ç”¨äº†ã€‚</p>
<pre><code class="copyable">@babel/preset-stage-0
@babel/preset-stage-1
@babel/preset-stage-2
@babel/preset-stage-3
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-11">@babel/preset-env</h3>
<p>å¯¹ES2015å’ŒES2016è¿›è¡Œè½¬æ¢ï¼Œå¹¶ä¸”å¤„ç†polyfillã€‚<br>
<br>preset-envæœ‰ä»¥ä¸‹é…ç½®ï¼Œå…·ä½“å¯ä»¥è®¿é—®å®˜ç½‘æŸ¥çœ‹ã€‚</p>
<pre><code class="copyable">targets
spec
loose
modules
debug
include
exclude
useBuiltIns
corejs
forceAllTransforms
configPath
ignoreBrowserslistConfig
shippedProposals
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-12">tagets</h4>
<p>æŒ‡å®šé€‚é…æ¸¸è§ˆå™¨èŒƒå›´ï¼Œå¦‚æœè®¾ç½®äº†è¯¥å‚æ•°ï¼Œä¼˜å…ˆçº§ä¼šæ¯”<code>.browserslist</code> æˆ–è€… <code>package.json/browserslist</code>è®¾ç½®çš„é«˜ã€‚å¦‚æœä¸è®¾ç½®ï¼Œåˆ™é»˜è®¤ä¼šè·å– <code>.browserslist</code> æˆ–è€… <code>package.json/browserslist</code>æŒ‡å®šçš„æ¸¸è§ˆå™¨é€‚é…èŒƒå›´ã€‚<br>ä½†æ˜¯åœ¨é¡¹ç›®ä¸­ï¼Œè¿˜æ˜¯å»ºè®®ä½¿ç”¨ <code>.browserslistrc</code> Â æˆ–è€… <code>package.json/browserslist</code>æŒ‡å®šç›®æ ‡ã€‚<br></p>
<h4 data-id="heading-13">useBuiltIns</h4>
<p><code>"usage"</code>Â |Â <code>"entry"</code>Â |Â <code>false</code>, defaults toÂ <code>false</code>.<br>è¿™ä¸ªé…ç½®å‚æ•°ä¸»è¦çš„ä½œç”¨æ˜¯æ˜ç¡®å¦‚ä½•å¤„ç†polyfillã€‚<br>
<br>**polyfill<br>å…ˆç®€å•çš„äº†è§£ä¸€ä¸‹ <code>polyfill</code>Â ï¼Œä¸­æ–‡æˆä¸ºå«ç‰‡ï¼Œå½¢è±¡ä¸€ç‚¹æè¿°ç”¨ä¸€ä¸ªä¸ªå«ç‰‡é“ºå¹³ä½ç«¯æ¸¸è§ˆå™¨çš„å‘ï¼Œä½¿ä»£ç è¿è¡Œçš„å’Œåœ¨é«˜ç«¯æ¸¸è§ˆå™¨ä¸­ä¸€æ ·ã€‚å¯¹ES2015+çš„ä¸€äº›è¯­æ³•è¿›è¡Œè½¬åŒ–é€‚é…ï¼ˆé™¤äº†ä¸€äº›å®éªŒæ€§çš„Jsç‰¹æ€§ï¼‰ï¼Œæ¯”å¦‚ä¸€äº›æ–°çš„å†…ç½®å¯¹è±¡å’Œå®ä¾‹æ–¹æ³•ç­‰ï¼ˆPromiseã€Array.fromã€Object.assign...ï¼‰</p>
<blockquote>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ@babel/polyfillåœ¨babel v7.4.0ä¹‹åç‰ˆæœ¬ä¼šè¢«åºŸå¼ƒï¼Œå®˜æ–¹å»ºè®®ç›´æ¥å¼•å…¥corejsï¼Œå¹¶ä¸”åœ¨optionsä¸­æŒ‡å®šcorejsç‰ˆæœ¬ã€‚</p>
</blockquote>
<p><code>@babel/polyfill</code>  å…¶å®å°±æ˜¯ç”± <code>core-js/stable</code>Â  å’Œ <code>regenerator-runtime/runtime</code>Â  ç»„åˆè€Œæˆã€‚</p>
<ul>
<li><strong>core-jsï¼š</strong>@babel/polyfillçš„åº•å±‚ä¾èµ–åº“ï¼Œä¸ºES2015+çš„JSç‰¹æ€§æä¾›ç¼–è¯‘è½¬åŒ–åŠŸèƒ½ã€‚</li>
<li>**regenerator-runtime : **ä¸“é—¨ä¸º <code>Generator</code>Â å‡½æ•°æä¾›ç¼–è¯‘è½¬åŒ–åŠŸèƒ½ï¼Œæ¯”å¦‚åœ¨é¡¹ç›®ä¸­ä½¿ç”¨äº†async/awaitå°±éœ€è¦å¼•å…¥è¿™ä¸ªæ’ä»¶ã€‚</li>
</ul>
<p><br>ä»¥ä¸‹ä¸¤ç§å†™æ³•å…¶å®æ˜¯ä¸€æ ·ï¼Œè€Œä¸”åªèƒ½ä¸¤ç§æ–¹å¼å–ä¸€ç§ï¼Œå¦åˆ™ä¼šæŠ¥é‡å¤å¼•å…¥çš„æŠ¥é”™ã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">"@babel/polyfill"</span>;
<span class="hljs-comment">// ====ç­‰åŒäº====</span>
<span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/stable"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"regenerator-runtime/runtime"</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä½†æ˜¯ç”±äºpolyfillçš„ä½“ç§¯æ¯”è¾ƒå¤§ï¼Œé€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬ä¸éœ€è¦å¼•å…¥å®Œæˆçš„polyfillï¼Œè€Œä¸”å…¨éƒ¨å¼•å…¥ä¹Ÿä¼šå¯¼è‡´æ‰“åŒ…åä½“ç§¯å˜å¤§ã€‚æ‰€ä»¥æ­¤å¤„useBuiltInså°±å¼€å§‹å‘æŒ¥ä½œç”¨ã€‚</p>
<p><code>useBuiltIns:usage</code><br>ä¸éœ€è¦åœ¨æ–‡ä»¶å…¥å£å¤„å¼•å…¥polyfillï¼Œenvä¼šæä¾›ä¸€ä¸ªæ’ä»¶ï¼Œæ ¹æ®æ¯ä¸ªæ–‡ä»¶çš„éœ€æ±‚è¿›è¡Œç‰¹æ®Šå¼•å…¥å«ç‰‡ã€‚<br>
<br>æ­¤æ—¶éœ€è¦ä½ åœ¨babelé…ç½®ä¸­æŒ‡å®šcorejsçš„ç‰ˆæœ¬çš„ç‰ˆæœ¬ã€‚</p>
<pre><code class="hljs language-javascript copyable" lang="javascript">&#123;
    <span class="hljs-string">"presets"</span>: [
        [
            <span class="hljs-string">"@babel/preset-env"</span>,
            &#123;
                <span class="hljs-string">"useBuiltIns"</span>: <span class="hljs-string">"usage"</span>,
                <span class="hljs-string">"corejs"</span>: <span class="hljs-number">3</span>
            &#125;
        ]
    ]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ¯”å¦‚promise-a.jsæ–‡ä»¶åªä½¿ç”¨åˆ°promiseï¼Œå°±åªä¼šåœ¨è¯¥æ–‡ä»¶å…¥å£å¼•å…¥promiseç›¸å…³çš„å«ç‰‡ã€‚<br> src/promise-a.js</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-comment">// src/promise-a.js</span>
<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>)=></span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"promise A"</span>);
    resolve()
&#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>lib/promise-a.js</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-meta">"use strict"</span>;

<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.object.to-string"</span>);

<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.promise"</span>);

<span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">resolve</span>) </span>&#123;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"promise A"</span>);
  resolve();
&#125;);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>useBuiltIns: 'entry'</code><br>éœ€è¦åœ¨æ–‡ä»¶å…¥å£å¤„æ‰‹åŠ¨å¼•å…¥polyfillï¼Œç„¶åæ ¹æ®å½“å‰çš„ç¯å¢ƒå°½å¯èƒ½çš„å¼•å…¥éœ€è¦çš„åŠŸèƒ½ã€‚<br>æ¯”å¦‚å¼•å…¥ä¸€ä¸ªarrayç›¸å…³çš„å«ç‰‡ã€‚<br>src/entry.js</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">import</span> <span class="hljs-string">"core-js/es/array"</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>lib/entry.js</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-meta">"use strict"</span>;
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.concat"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.copy-within"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.every"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.fill"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.filter"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.find"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.find-index"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.flat"</span>);
<span class="hljs-built_in">require</span>(<span class="hljs-string">"core-js/modules/es.array.flat-map"</span>);
...
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><br><code>useBuiltIns: false</code><br>ä¸ä¸ºæ–‡ä»¶è‡ªåŠ¨æ·»åŠ å«ç‰‡ï¼Œä¹Ÿä¸ä¼šå¯¹äºè‡ªè¡Œå¼•å…¥çš„core-jsæˆ–è€…@babel/polyfillæœ‰ä»»ä½•è½¬åŒ–ã€‚</p>
<h4 data-id="heading-14">corejs</h4>
<p><code>2</code>,Â <code>3</code>Â orÂ <code>&#123; version: 2 | 3, proposals: boolean &#125;</code>, defaults toÂ <code>2</code>.<br>
<br>è¿™ä¸ªé€‰é¡¹éœ€è¦å’ŒuseBuiltInsç»“åˆèµ·æ¥ä½¿ç”¨ã€‚å½“useBuiltIns: usageæˆ–è€…useBuiltIns: entryæ—¶æ‰ä¼šèµ·æ•ˆã€‚<br>core-jsç›®å‰å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯coreJs2å’ŒcoreJs3ã€‚coreJs2ç›®å‰å·²ç»ä¸å†æ›´æ–°ï¼Œæ‰€ä»¥å¯¹äºä¸€äº›ç‰¹åˆ«æ–°çš„ç‰¹æ€§åªä¼šåœ¨coreJs3å»æ›´æ–°ã€‚</p>
<p>å¦‚æœä½¿ç”¨coreJs3æ—¶åªæƒ³æ³¨å…¥ç¨³å®šçš„ECMAScriptåŠŸèƒ½ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š<br><code>1.å¯¹äºuseBuiltIns: usage</code>Â <br>corejs:  <code>&#123; version: 3, proposals: true &#125;<br /></code><br><code>2.å¯¹äºuseBuiltIns: entry</code><br>corejsé…ç½®ä¸º <code>3</code>Â ï¼Œå¦å¤–åœ¨é¡¹ç›®å¼•å…¥<code>import "core-js/proposals/string-replace-all"</code></p>
<h2 data-id="heading-15">âœå…¶ä»–å°çŸ¥è¯†ç‚¹ï¼š</h2>
<p><strong><br>1.æ’ä»¶åç§°ç®€å†™</strong></p>
<pre><code class="copyable">@babel/plugin-XXX ç­‰åŒäº @babel/XXX
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>2.babelå‘½å</strong><br>@7.0.0ä»¥ä¸Šçš„åŒ…éƒ½æ˜¯ä»¥@å¼€å¤´å‘½åï¼Œç”¨äºåŒºåˆ†6.xç‰ˆæœ¬<br>
<br><strong>3.æ‰§è¡Œé¡ºåº</strong></p>
<ul>
<li>æ’ä»¶åœ¨ Presets å‰è¿è¡Œã€‚</li>
<li>æ’ä»¶é¡ºåºä»å‰å¾€åæ’åˆ—ã€‚</li>
<li>Preset é¡ºåºæ˜¯é¢ å€’çš„ï¼ˆä»åå¾€å‰ï¼‰ã€‚</li>
</ul>
<p><br>å‚è€ƒæ–‡æ¡£<br><a href="https://github.com/jamiebuilds/babel-handbook/blob/master/translations/zh-Hans/README.md" target="_blank" rel="nofollow noopener noreferrer">Babelç”¨æˆ·æ‰‹å†Œ</a><br></p></div> <div class="image-viewer-box" data-v-78c9b824><!----></div>  
</div>
            