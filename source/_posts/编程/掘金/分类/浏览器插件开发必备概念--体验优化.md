
---
title: '浏览器插件开发必备概念--体验优化'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee890cf7af0b49349d22746aa9841d3b~tplv-k3u1fbpfcp-watermark.image'
author: 掘金
comments: false
date: Sat, 21 Aug 2021 18:14:20 GMT
thumbnail: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee890cf7af0b49349d22746aa9841d3b~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>这是我参与8月更文挑战的第10天，活动详情查看：<a href="https://juejin.cn/post/6987962113788493831" target="_blank" title="https://juejin.cn/post/6987962113788493831">8月更文挑战</a></p>
<hr>
<p>系列文章:</p>
<ul>
<li><a href="https://juejin.cn/post/6996519317042888740" target="_blank" title="https://juejin.cn/post/6996519317042888740">浏览器插件简介</a></li>
<li><a href="https://juejin.cn/post/6997402976058867748" target="_blank" title="https://juejin.cn/post/6997402976058867748">浏览器插件开发必备概念--用户交互</a></li>
<li><a href="https://juejin.cn/post/6998864120611094564" target="_blank" title="https://juejin.cn/post/6998864120611094564">浏览器插件开发必备概念--通用技术</a></li>
<li><a href="https://juejin.cn/post/6999071633293967391" target="_blank" title="https://juejin.cn/post/6999071633293967391">浏览器插件开发必备概念--体验优化</a></li>
</ul>
<hr>
<h2 data-id="heading-0">Options Pages</h2>
<p>设置页面允许用户定制扩展程序，以更符合自己的使用习惯。</p>
<p>如果要为扩展程序添加设置页面，需要先在配置清单 <code>manifest.json</code> 的中进行声明注册，有两种类型的设置页面：</p>
<ul>
<li>
<p>Full page options 整页的设置页面，需要打开一个标签页。</p>
<p>在配置清单的选项 <code>options_page</code> 中声明注册作为设置页面的 HTML 文档的路径</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-comment">// ...</span>
  <span class="hljs-attr">"options_page"</span>: <span class="hljs-string">"options.html"</span>,
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>然后用户可以在浏览器工具栏的扩展程序图标右键点击选择「<strong>选项</strong>」打开设置页面</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ee890cf7af0b49349d22746aa9841d3b~tplv-k3u1fbpfcp-watermark.image" alt="打开设置页面-1" loading="lazy" referrerpolicy="no-referrer"></p>
<p>或者在扩展程序的「<strong>详情</strong>」页面中选择「<strong>扩展程序选项</strong>」打开设置页面
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aa8b0ee113864f87ab89381e1972fa5c~tplv-k3u1fbpfcp-watermark.image" alt="打开设置页面-2" loading="lazy" referrerpolicy="no-referrer"></p>
</li>
</ul>
<ul>
<li>
<p>Embedded Options 内嵌的设置页面，以模态框的形式展示设置页面。</p>
<p>💡 模态框的大小会根据页面内容自动调整，但有时候可能并不奏效，此时可以为设置页面先提供一个<strong>最小的尺寸</strong>，以保证布局正常显示。</p>
<p>在配置清单的选项 <code>options_ui.page</code> 中指向相应的 HTML 文档路径，并设置属性 <code>option_ui.open_in_tab</code> 为 <code>false</code>，表示采用内嵌设置页（如果设置为 <code>true</code> 就会打开新的标签页来展示设置页面）。</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-comment">// ...</span>
  <span class="hljs-attr">"options_ui"</span>: &#123;
    <span class="hljs-attr">"page"</span>: <span class="hljs-string">"options.html"</span>,
    <span class="hljs-attr">"open_in_tab"</span>: <span class="hljs-literal">false</span>
  &#125;,
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>然后用户就可以在在浏览器工具栏的扩展程序图标右键点击选择「<strong>选项</strong>」，会跳转到相应扩展程序的详情页，同时打开模态框展示设置页面；或者在扩展程序的「<strong>详情</strong>」页面中选择「<strong>扩展程序选项</strong>」，打开模态框展示设置页面。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/84fbb8fe74824ab0afc8a5985872fb41~tplv-k3u1fbpfcp-watermark.image" alt="打开设置页" loading="lazy" referrerpolicy="no-referrer"></p>
<p>💡 在扩展程序的页面中可以通过方法 <code>chrome.runtime.openOptionsPage()</code> 打开设置页面</p>
</li>
</ul>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"go-to-options"</span>></span>Go to options<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-built_in">document</span>.querySelector(<span class="hljs-string">'#go-to-options'</span>).addEventListener(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;
  <span class="hljs-comment">// 先判断浏览器是否支持该方法</span>
  <span class="hljs-keyword">if</span> (chrome.runtime.openOptionsPage) &#123;
    chrome.runtime.openOptionsPage();
  &#125; <span class="hljs-keyword">else</span> &#123;
    <span class="hljs-comment">// 如果不支持就手动基于页面路径打开设置页面</span>
    <span class="hljs-built_in">window</span>.open(chrome.runtime.getURL(<span class="hljs-string">'options.html'</span>));
  &#125;
&#125;);
<span class="copy-code-btn">复制代码</span></code></pre>
<p>虽然两种方式都可以供用户设置参数，但是有一些不同：</p>
<ul>
<li>
<p>对于内嵌型的设置页面，不支持部分 Tabs 相关的 API</p>
<ul>
<li>无法使用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Ftabs%23method-query" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/tabs#method-query" ref="nofollow noopener noreferrer">方法 <code>chrome.tabs.query()</code></a> 通过设置页面的 URL 找到对应的 tab</li>
<li>打开设置页面时，<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Ftabs%2F%23event-onCreated" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/tabs/#event-onCreated" ref="nofollow noopener noreferrer">事件 <code>chrome.tabs.onCreated.addListener()</code></a> 无法被监听到</li>
<li>当设置页面重载时，<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Ftabs%2F%23event-onUpdated" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/tabs/#event-onUpdated" ref="nofollow noopener noreferrer">事件 <code>chrome.tabs.onUpdated.addListener()</code></a> 无法被监听到</li>
</ul>
</li>
<li>
<p>无法使用<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Ftabs%2F%23method-connect" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/tabs/#method-connect" ref="nofollow noopener noreferrer">方法 <code>chrome.tabs.connect()</code></a> 和<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Ftabs%2F%23method-sendMessage" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/tabs/#method-sendMessage" ref="nofollow noopener noreferrer">方法 <code>chrome.tabs.sendMessage()</code></a> 发送信息，但<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fruntime%23method-connect" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/runtime#method-connect" ref="nofollow noopener noreferrer">方法 <code>chrome.runtime.connect()</code></a> 和<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fruntime%23method-sendMessage" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/runtime#method-sendMessage" ref="nofollow noopener noreferrer">方法 <code>chrome.runtime.sendMessage()</code></a> 并不受限制。</p>
<p>💡 如果设置页面使用<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fruntime%23method-connect" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/runtime#method-connect" ref="nofollow noopener noreferrer">方法 <code>chrome.runtime.connect()</code></a> 和<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fruntime%23method-sendMessage" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/runtime#method-sendMessage" ref="nofollow noopener noreferrer">方法 <code>chrome.runtime.sendMessage()</code></a> 传递信息，接收者并不能读取发送者 sender 的 tab 信息，只能读取到发送者的 url 信息（设置页面文档的路径）</p>
</li>
</ul>
<p>💡 为了可以让用户的设置数据持久化及跨设备同步，可以使用 Chrome 提供的 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fstorage%23property-sync" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/storage#property-sync" ref="nofollow noopener noreferrer"><code>storage.sync</code> API</a>，记得先在配置清单 <code>manifest.json</code> 中声明注册 <code>strage</code> 权限</p>
<h2 data-id="heading-1">Accessibility</h2>
<p>可及性，又称为 a11y，是指一系列的设计指南，以便残障人士更易于使用扩展程序，例如快捷键命令可以让视觉障碍人士更方便地使用扩展程序，字幕和翻译功能对视觉障碍人士和外语者有帮助。</p>
<p>开发者可以遵循以下建议，以提高扩展程序的可及性 accessible：</p>
<ul>
<li>
<p>使用正确的<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FLearn%2FAccessibility%2FHTML" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.mozilla.org/zh-CN/docs/Learn/Accessibility/HTML" ref="nofollow noopener noreferrer">语义化 HTML 元素</a>搭建 UI 控件，以便保障可及性。这些控件保证了可以通过键盘（Tab 键）访问操作，且它们的语义性让屏幕阅读器更容易理解。</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9b60bbce32846679f832d760dc6244a~tplv-k3u1fbpfcp-watermark.image" alt="语义化 HTML 元素" loading="lazy" referrerpolicy="no-referrer"></p>
</li>
</ul>
<ul>
<li>
<p>如果需要使用非语义化的 HTML 元素或 JavaScript 构建 UI 控件时，可以通过 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.w3.org%2FWAI%2Fstandards-guidelines%2Faria%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://www.w3.org/WAI/standards-guidelines/aria/" ref="nofollow noopener noreferrer">WAI-ARIA</a>，Web Accessibility Initiative - Accessible Rich Internet Applications，一个由 W3C 制定的规范，它通过给 DOM 元素添加一些规定的属性，让我们的开发的网页应用更具语义化。</p>
<p>💡 WAI-ARIA 属性<strong>不会</strong>对 web 页面有任何影响，只是让浏览器暴露更多的信息给无障碍 API，例如屏幕阅读器。</p>
<p>该规范中三个主要的特性：</p>
<ul>
<li>声明元素的角色和功能，例如 <code>role="navigation"</code> 表示该元素的作用是导航</li>
<li>为元素定义额外的属性，例如 <code>aria-require=true</code> 告知用户该表单是必添的</li>
<li>设定元素的状态，例如 <code>aria-disable="true"</code> 表示该表单禁止输入</li>
</ul>
<p>💡 状态和属性的差异之处就是：属性在应用的生命周期中不会改变，<strong>而状态可以</strong>，用编程的方法改变。</p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"toolbar"</span> <span class="hljs-attr">tabindex</span>=<span class="hljs-string">"0"</span> <span class="hljs-attr">aria-activedescendant</span>=<span class="hljs-string">"button1"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"buttoncut.png"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"cut"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button1"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"buttoncopy.png"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"copy"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button2"</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"buttonpaste.png"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"paste"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"button3"</span>></span>
<span class="hljs-tag"></<span class="hljs-name">div</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>以上示例中，<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FHTML%2FGlobal_attributes%2Ftabindex" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.mozilla.org/zh-CN/docs/Web/HTML/Global_attributes/tabindex" ref="nofollow noopener noreferrer">属性 <code>tabindex="0"</code></a> 让该元素可以聚焦，并且可以通过键盘来导航，其聚焦顺序由 DOM 结构决定；属性 <code>aria-activedescendant</code> 指定该元素聚焦时，其子代哪一个元素先进行聚焦。</p>
</li>
<li>
<p>元素可聚焦让用户仅通过键盘也能操作扩展程序页面，应该保证按钮、菜单栏等元素可以聚焦。默认情况下，只有锚标签、按钮、表单控件可以通过键盘聚焦，但是我们可以通过为元素添加属性 <code>tabIndex="0"</code> 让任意元素可以聚焦；也可以通过添加属性 <code>tabIndex="-1"</code> 让该元素无法通过键盘聚焦（但仍可以通过 JavaScript 编程聚焦 <code>elem.focus()</code>）。</p>
</li>
<li>
<p>与通过 Tab 键聚焦元素相比，快捷键可以让用户更方便地操作扩展程序页面的元素，可以参考<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fmv3%2Fa11y%2F%23shortcuts" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/mv3/a11y/#shortcuts" ref="nofollow noopener noreferrer">官方示例</a>如何用快捷键进行导航。如果在扩展程序的页面内提供了快捷键，应该在<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fmv3%2Foptions%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/mv3/options/" ref="nofollow noopener noreferrer">设置页面 options page</a> 中告知用户。</p>
</li>
<li>
<p>以下设置可以完善内容的可访问性</p>
<ul>
<li>
<p>文本：选择合适的字体和字号大小以确保文本内容的可读性，而且应该考虑视觉障碍者的使用体验，他们可能需要设置更大的字体，避免将自定义的快捷键与页面缩放的快捷键相冲突。为了确保版型的稳定，应该测试缩放至 200%，查看页面是否还显示正常。应该避免将文字嵌入到图片中，这样不仅无法调整字体，还无法让屏幕阅读器识别；如果必须将文字嵌入图片中，应该在图片的可替代文字（属性 <code>alt</code>）中包含这些文字内容，相关指南可以参考<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwebaim.org%2Ftechniques%2Falttext%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://webaim.org/techniques/alttext/" ref="nofollow noopener noreferrer">这里</a>。</p>
</li>
<li>
<p>颜色：背景和内容的颜色应该有足够的<strong>对比度</strong>，可以使用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fsnook.ca%2Ftechnical%2Fcolour_contrast%2Fcolour.html" target="_blank" rel="nofollow noopener noreferrer" title="https://snook.ca/technical/colour_contrast/colour.html" ref="nofollow noopener noreferrer">Colour Contrast Check</a> 工具检查。对于颜色丰富的图表，可以使用色弱模拟器  <a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.color-blindness.com%2Fcoblis-color-blindness-simulator%2F" target="_blank" rel="nofollow noopener noreferrer" title="http://www.color-blindness.com/coblis-color-blindness-simulator/" ref="nofollow noopener noreferrer">Coblis</a> 来查看它在不同程度的色弱症人士眼里的效果，调整图表的配色，以使扩展程序对于这些用户更友好。可以考虑为提供不同的色彩主题，或允许自定义配色方案，以便用户有更好的体验。</p>
</li>
<li>
<p>声音：如果扩展程序需要声音和视频传达信息，应该提供字幕和翻译功能，关于多媒体字幕的相关指南参考<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdcmp.org%2Flearn%2F213" target="_blank" rel="nofollow noopener noreferrer" title="https://dcmp.org/learn/213" ref="nofollow noopener noreferrer">这里</a>。</p>
</li>
<li>
<p>图片：为图片提供可替代文字，即属性 <code>alt</code>（文字内容应该用于阐明图像的目的，而不是描述图片的细节），而对于占位图和纯装饰作用的图片，应该将该属性值留空 <code>""</code>，或使用 CSS 来实现（而不是用 DOM）</p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"img.jpg"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"The logo for the extension"</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
</li>
</ul>
</li>
<li>
<p>更多相关资源：</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.chromium.org%2Fdevelopers%2Fdesign-documents%2Faccessibility" target="_blank" rel="nofollow noopener noreferrer" title="https://www.chromium.org/developers/design-documents/accessibility" ref="nofollow noopener noreferrer">Accessibility Technical Documentation</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fyoutube.com%2Fplaylist%3Flist%3DPLNYkxOF6rcICWx0C9LVWWVqvHlYJyqw7g" target="_blank" rel="nofollow noopener noreferrer" title="https://youtube.com/playlist?list=PLNYkxOF6rcICWx0C9LVWWVqvHlYJyqw7g" ref="nofollow noopener noreferrer">A11ycasts with Rob Dodson</a></li>
</ul>
</li>
</ul>
<h2 data-id="heading-2">Internationalization</h2>
<p>参考：</p>
<ul>
<li>
<p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fi18n%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/i18n/" ref="nofollow noopener noreferrer"><code>chrome.i18n</code> API</a></p>
</li>
<li>
<p>关于 Internationalization 官方示例：</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FGoogleChrome%2Fchrome-extensions-samples%2Ftree%2Fmain%2Fmv2-archive%2Fapi%2Fi18n" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/mv2-archive/api/i18n" ref="nofollow noopener noreferrer">i18n</a>（MV2 版本）</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FGoogleChrome%2Fchrome-extensions-samples%2Ftree%2Fmain%2Fmv2-archive%2Fextensions%2Fnews" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/GoogleChrome/chrome-extensions-samples/tree/main/mv2-archive/extensions/news" ref="nofollow noopener noreferrer">news</a>（MV2 版本）</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fi18n%2F%23examples" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/i18n/#examples" ref="nofollow noopener noreferrer">Examples</a></li>
</ul>
</li>
</ul>
<p>国际化 I18N 是指在开发扩展程序时，可以让用户按需切换语言。</p>
<p>💡 关于软件<a href="https://link.juejin.cn/?target=https%3A%2F%2Fzhuanlan.zhihu.com%2Fp%2F112277526" target="_blank" rel="nofollow noopener noreferrer" title="https://zhuanlan.zhihu.com/p/112277526" ref="nofollow noopener noreferrer">多语言版本的开发</a>：</p>
<ul>
<li>国际化 Internationalization，L18N：软件国际化是在软件设计和文档开发过程中，使得功能和代码设计能处理多种语言和文化传统，使创建不同语言版本时，不需要重新设计源程序代码的软件工程方法。</li>
<li>本地化 localization ，L10N：能够使网站、Web 应用或任何其他形式的内容适用于特定语言的范围和文化圈。</li>
</ul>
<p>为了让扩展程序更方便地实现国际化，需要遵循以下建议：</p>
<ul>
<li>
<p>将所有用户可见的内容（文本）放在一个 <code>messages.json</code> 文档中，并将该文档放在 <code>_locales/_localeCode_</code> 相应的目录下（其中 <code>_localeCode_</code> 是一个语言编码，例如英语就应该使用 <code>en</code> 表示）。</p>
<p>💡 如果项目中有 <code>_locales</code> 目录，需要在配置清单 <code>manifest.json</code> 的选项 <code>default_locale</code> 中声明默认语言，可以在这里查看具体的<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fwebstore%2Fi18n%2F%23choosing-locales-to-support" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/webstore/i18n/#choosing-locales-to-support" ref="nofollow noopener noreferrer">语言代码</a>。</p>
<p>在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Fmv2%2Fi18n-messages%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/mv2/i18n-messages/" ref="nofollow noopener noreferrer"><code>messages.json</code> 文档</a>中，它以键值对的形式来定义内容，每一个键都包含一个需要国际化的项（大小写敏感），值是一个对象，其中常用的属性如下：</p>
<ul>
<li>属性 <code>message</code> 是需要显示的内容</li>
<li>（可选）属性 <code>description</code> 是对该项的描述，便于告知翻译者该项的意义。</li>
</ul>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-comment">// messages.json</span>
&#123;
  <span class="hljs-attr">"search_string"</span>: &#123;
    <span class="hljs-attr">"message"</span>: <span class="hljs-string">"hello%20world"</span>,
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"The string we search for. Put %20 between words that go together."</span>
  &#125;,
  <span class="hljs-comment">//  ...</span>
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<p>💡 键名不能以 <code>@@</code> 开头，这一类的键名是<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fi18n%2F%23overview-predefined" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/i18n/#overview-predefined" ref="nofollow noopener noreferrer">保留预定义的项</a>，常用的预定义 message 项如下：</p>





















<table><thead><tr><th>Message 键名</th><th>解释</th></tr></thead><tbody><tr><td><code>@@extension_id</code></td><td>扩展程序的 ID，对于非国际化的扩展程序该 message 项也可用，💡 但不能用于 <code>manifest.json</code> 中</td></tr><tr><td><code>@@ui_locale</code></td><td>当前使用的语言</td></tr><tr><td><code>@@bidi_dir</code></td><td>当前的文字方向，<code>ltr</code> 表示从左往右书写的文字，<code>rtl</code> 表示从右往左书写的文字</td></tr></tbody></table>
<p>例如在 CSS 中使用扩展程序中的静态图片作为背景</p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-selector-tag">body</span> &#123;
  <span class="hljs-attribute">background-image</span>:<span class="hljs-built_in">url</span>(<span class="hljs-string">'chrome-extension://__MSG_@@extension_id__/background.png'</span>);
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
</li>
<li>
<p>然后就可以在项目的其他文档中，通过 message 项来使用相应的数据：</p>
<ul>
<li>在 <code>manifest.json</code> 或 CSS 文档中，通过 <code>__MEG_messagename__</code> 来使用 message 相应的项 <code>messagename</code></li>
<li>在扩展程序页面或 JavaScript 脚本中，通过方法 <code>chrome.i18n.getMessage("messagename")</code> 获取相应的项 <code>messagename</code></li>
</ul>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/364f5c602bdb40f49a5dd73a052484ff~tplv-k3u1fbpfcp-watermark.image" alt="i18n-1.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>💡 每次新增一种语言，就需要新增一个 message 文件到 <code>_locales/_localeCode_</code> 目录里。每一种语言中，<strong>不必</strong>包含与默认语言中定义的全部 message 项。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/effdb9d3250e40aebf596a5a325108e8~tplv-k3u1fbpfcp-watermark.image" alt="i18n file structure" loading="lazy" referrerpolicy="no-referrer"></p>
<p><em>以上示例是支持英语、西班牙语、韩语的扩展程序项目文件结构</em></p>
<p>💡 浏览器会基于用户的语言设置和扩展程序的 <code>default_locale</code> 设置来<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fi18n%2F%23searching-for-messages" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/i18n/#searching-for-messages" ref="nofollow noopener noreferrer">自动选择</a>采用哪一个 <code>messages.json</code> 文档</p>
</li>
</ul>
<h2 data-id="heading-3">Identity</h2>
<p>扩展程序可以基于 <a href="https://link.juejin.cn/?target=https%3A%2F%2Foauth.net%2F2%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://oauth.net/2/" ref="nofollow noopener noreferrer">OAuth 2.0</a> 获取授权，访问 Chrome 用户信息，具体参考 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fidentity%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/identity/" ref="nofollow noopener noreferrer"><code>chrome.identity</code> API</a>。</p>
<p>💡 关于该授权机制的介绍可以参考<a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F04%2Foauth_design.html" target="_blank" rel="nofollow noopener noreferrer" title="https://www.ruanyifeng.com/blog/2019/04/oauth_design.html" ref="nofollow noopener noreferrer">这里</a>。</p>
<h2 data-id="heading-4">Management</h2>
<p>管理已安装和正在运行的扩展程序，具体参考 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.chrome.com%2Fdocs%2Fextensions%2Freference%2Fmanagement%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://developer.chrome.com/docs/extensions/reference/management/" ref="nofollow noopener noreferrer"><code>chrome.management</code> API</a>。</p></div>  
</div>
            