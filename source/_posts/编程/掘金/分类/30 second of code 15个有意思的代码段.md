
---
title: '30 second of code 15个有意思的代码段'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://picsum.photos/400/300?random=7331'
author: 掘金
comments: false
date: Sat, 28 Aug 2021 17:49:28 GMT
thumbnail: 'https://picsum.photos/400/300?random=7331'
---

<div>   
<div class="markdown-body html cache"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">前言</h2>
<p><strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds" ref="nofollow noopener noreferrer">30-seconds</a></strong> 是一个学习系列，<strong>基本都是通过简短的代码实现某些功能</strong>， 包含</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code" ref="nofollow noopener noreferrer">30-seconds-of-code</a><br>
满足所有开发需求的简短JavaScript代码片段</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-css" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-css" ref="nofollow noopener noreferrer">30-seconds-of-css</a><br>
满足所有开发需求的简短CSS代码片段</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-react" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-react" ref="nofollow noopener noreferrer">30-seconds-of-react</a><br>
满足所有开发需求的简短React代码片段</li>
</ul>
<p>等等，还有很多系列， <strong>我们今天的主题是 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code" ref="nofollow noopener noreferrer">30-seconds-of-code</a>   ， 即简短的代码段。</strong></p>
<p>挑选了我觉得比较<strong>有意思或者有意义</strong>的15个代码，我们一起开始简短代码之旅吧！</p>
<h2 data-id="heading-1">精选</h2>
<h3 data-id="heading-2"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FURLJoin.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/URLJoin.md" ref="nofollow noopener noreferrer">URLJoin</a></h3>
<p>地址拼接。
除此之外，<code>URLSearchParams</code>或<code>URL</code>都可以很好的处理QueryString, 更多详情参见 <strong><a href="https://juejin.cn/post/6987166546502090788" target="_blank" title="https://juejin.cn/post/6987166546502090788">私藏的这些高级工具函数，你拥有几个?</a></strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> URLJoin = <span class="hljs-function">(<span class="hljs-params">...args</span>) =></span>
  args
    .join(<span class="hljs-string">'/'</span>)
    .replace(<span class="hljs-regexp">/[\/]+/g</span>, <span class="hljs-string">'/'</span>)
    .replace(<span class="hljs-regexp">/^(.+):\//</span>, <span class="hljs-string">'$1://'</span>)
    .replace(<span class="hljs-regexp">/^file:/</span>, <span class="hljs-string">'file:/'</span>)
    .replace(<span class="hljs-regexp">/\/(\?|&|#[^!])/g</span>, <span class="hljs-string">'$1'</span>)
    .replace(<span class="hljs-regexp">/\?/g</span>, <span class="hljs-string">'&'</span>)
    .replace(<span class="hljs-string">'&'</span>, <span class="hljs-string">'?'</span>);
<span class="copy-code-btn">复制代码</span></code></pre>
<p>示例</p>
<pre><code class="hljs language-js copyable" lang="js">URLJoin(<span class="hljs-string">'http://www.google.com'</span>, <span class="hljs-string">'a'</span>, <span class="hljs-string">'/b/cd'</span>, <span class="hljs-string">'?foo=123'</span>, <span class="hljs-string">'?bar=foo'</span>);
<span class="hljs-comment">// 'http://www.google.com/a/b/cd?foo=123&bar=foo'</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-3"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2Funcurry.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/uncurry.md" ref="nofollow noopener noreferrer">uncurry </a></h3>
<p>减少嵌套函数调用次数，改变函数的传参方式。 这是反柯里化吗？</p>
<p><strong>这个函数非常灵活，很有意思。</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> uncurry = <span class="hljs-function">(<span class="hljs-params">fn, n = <span class="hljs-number">1</span></span>) =></span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =></span> &#123;
  <span class="hljs-keyword">const</span> next = <span class="hljs-function"><span class="hljs-params">acc</span> =></span> <span class="hljs-function"><span class="hljs-params">args</span> =></span> args.reduce(<span class="hljs-function">(<span class="hljs-params">x, y</span>) =></span> x(y), acc);
  <span class="hljs-keyword">if</span> (n > args.length) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">RangeError</span>(<span class="hljs-string">'Arguments too few!'</span>);
  <span class="hljs-keyword">return</span> next(fn)(args.slice(<span class="hljs-number">0</span>, n));
&#125;;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> add = <span class="hljs-function"><span class="hljs-params">x</span> =></span> <span class="hljs-function"><span class="hljs-params">y</span> =></span> <span class="hljs-function"><span class="hljs-params">z</span> =></span> x + y + z;

<span class="hljs-keyword">const</span> uncurriedAdd1 = uncurry(add, <span class="hljs-number">1</span>);
uncurriedAdd1(<span class="hljs-number">1</span>)(<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>)  <span class="hljs-comment">// 6</span>

<span class="hljs-keyword">const</span> uncurriedAdd1 = uncurry(add, <span class="hljs-number">2</span>);
uncurriedAdd1(<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)(<span class="hljs-number">3</span>)  <span class="hljs-comment">// 6</span>

<span class="hljs-keyword">const</span> uncurriedAdd3 = uncurry(add, <span class="hljs-number">3</span>);
uncurriedAdd3(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>); <span class="hljs-comment">// 6</span>

<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-4"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FonScrollStop.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/onScrollStop.md" ref="nofollow noopener noreferrer">onScrollStop </a></h3>
<p>监听滚动停止事件，当停止滚动的时候，执行回调函数。</p>
<p>需要在停止滚动后，执行某些操作，还是很有用的。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> onScrollStop = <span class="hljs-function"><span class="hljs-params">callback</span> =></span> &#123;
  <span class="hljs-keyword">let</span> isScrolling;
  <span class="hljs-built_in">window</span>.addEventListener(
    <span class="hljs-string">'scroll'</span>,
    <span class="hljs-function"><span class="hljs-params">e</span> =></span> &#123;
      <span class="hljs-built_in">clearTimeout</span>(isScrolling);
      isScrolling = <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> &#123;
        callback();
      &#125;, <span class="hljs-number">150</span>);
    &#125;,
    <span class="hljs-literal">false</span>
  );
&#125;;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">onScrollStop(<span class="hljs-function">() =></span> &#123;
  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'The user has stopped scrolling'</span>);
&#125;);
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-5"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FbyteSize.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/byteSize.md" ref="nofollow noopener noreferrer">byteSize</a></h3>
<p>返回字符串字节数。</p>
<p>都知道，中文和英文所占的字节数是不一样的，有占两个的，三个的，四个的，一个的。</p>
<p><strong>英文一般一个字节，中文一般三个。</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> byteSize = <span class="hljs-function"><span class="hljs-params">str</span> =></span> <span class="hljs-keyword">new</span> Blob([str]).size;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">byteSize(<span class="hljs-string">'a'</span>) <span class="hljs-comment">// 1</span>
byteSize(<span class="hljs-string">'س'</span>) <span class="hljs-comment">// 2</span>
byteSize(<span class="hljs-string">'中'</span>) <span class="hljs-comment">// 3</span>
byteSize(<span class="hljs-string">'😀'</span>); <span class="hljs-comment">// 4</span>
byteSize(<span class="hljs-string">'Hello World'</span>); <span class="hljs-comment">// 11</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>这还涉及 Unicode编码的知识，为了验证更多字符，你可以查阅 <strong><a href="https://link.juejin.cn/?target=http%3A%2F%2Ftitus.uni-frankfurt.de%2Funicode%2Funitestx.htm" target="_blank" rel="nofollow noopener noreferrer" title="http://titus.uni-frankfurt.de/unicode/unitestx.htm" ref="nofollow noopener noreferrer">Unicode对应表</a></strong></p>
<h3 data-id="heading-6"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FrunPromisesInSeries.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/runPromisesInSeries.md" ref="nofollow noopener noreferrer">runPromisesInSeries </a></h3>
<p>顺序执行promise, 实际上应该生成Promise的函数。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> runPromisesInSeries = <span class="hljs-function"><span class="hljs-params">ps</span> =></span>
  ps.reduce(<span class="hljs-function">(<span class="hljs-params">p, next</span>) =></span> p.then(next), <span class="hljs-built_in">Promise</span>.resolve());
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> delay = <span class="hljs-function"><span class="hljs-params">d</span> =></span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">r</span> =></span> <span class="hljs-built_in">setTimeout</span>(r, d));
runPromisesInSeries([<span class="hljs-function">() =></span> delay(<span class="hljs-number">1000</span>), <span class="hljs-function">() =></span> delay(<span class="hljs-number">2000</span>)]);
<span class="hljs-comment">// Executes each promise sequentially, taking a total of 3 seconds to complete</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>这个版本，不能传参，我在 <strong><a href="https://juejin.cn/post/6987166546502090788" target="_blank" title="https://juejin.cn/post/6987166546502090788">私藏的这些高级工具函数，你拥有几个?</a></strong>,  实现了一个带参数版本。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">runPromises</span>(<span class="hljs-params">promiseCreators, initData</span>) </span>&#123;
    <span class="hljs-keyword">return</span> promiseCreators
        .reduce(<span class="hljs-function">(<span class="hljs-params">promise, next</span>) =></span> promise
                .then(<span class="hljs-function">(<span class="hljs-params">data</span>) =></span> next(data))
            , <span class="hljs-built_in">Promise</span>.resolve(initData));
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">var</span> promise1 = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data = <span class="hljs-number">0</span></span>) </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =></span> &#123;
        resolve(data + <span class="hljs-number">1000</span>);
    &#125;);
&#125;
<span class="hljs-keyword">var</span> promise2 = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =></span> &#123;
        resolve(data -<span class="hljs-number">500</span>);
    &#125;);
&#125;

runPromises([promise1, promise2], <span class="hljs-number">1</span>).then(<span class="hljs-function"><span class="hljs-params">res</span>=></span><span class="hljs-built_in">console</span>.log(res));  <span class="hljs-comment">// 501</span>

<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-7"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FstringifyCircularJSON.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/stringifyCircularJSON.md" ref="nofollow noopener noreferrer">stringifyCircularJSON</a></h3>
<p>将包含循环引用的 JSON 对象序列化为 JSON 格式。</p>
<p>其思路是使用<code>WeakSet</code> 保存数据进行对比。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> stringifyCircularJSON = <span class="hljs-function"><span class="hljs-params">obj</span> =></span> &#123;
  <span class="hljs-keyword">const</span> seen = <span class="hljs-keyword">new</span> <span class="hljs-built_in">WeakSet</span>();
  <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.stringify(obj, <span class="hljs-function">(<span class="hljs-params">k, v</span>) =></span> &#123;
    <span class="hljs-keyword">if</span> (v !== <span class="hljs-literal">null</span> && <span class="hljs-keyword">typeof</span> v === <span class="hljs-string">'object'</span>) &#123;
      <span class="hljs-keyword">if</span> (seen.has(v)) <span class="hljs-keyword">return</span>;
      seen.add(v);
    &#125;
    <span class="hljs-keyword">return</span> v;
  &#125;);
&#125;;

<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> obj = &#123; <span class="hljs-attr">n</span>: <span class="hljs-number">42</span> &#125;;
obj.obj = obj;
stringifyCircularJSON(obj); <span class="hljs-comment">// '&#123;"n": 42&#125;'</span>

<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-8"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FUUIDGeneratorBrowser.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/UUIDGeneratorBrowser.md" ref="nofollow noopener noreferrer">UUIDGeneratorBrowser</a></h3>
<p>UUID生成器，除此之外<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FURL%2FcreateObjectURL" title="https://link.juejin.cn?target=https%3A%2F%2Fdeveloper.mozilla.org%2Fzh-CN%2Fdocs%2FWeb%2FAPI%2FURL%2FcreateObjectURL" target="_blank">URL.createObjectURL</a>也可以生成UUID。这两种算是比较主流的方式。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> UUIDGeneratorBrowser = <span class="hljs-function">() =></span>
  ([<span class="hljs-number">1e7</span>] + -<span class="hljs-number">1e3</span> + -<span class="hljs-number">4e3</span> + -<span class="hljs-number">8e3</span> + -<span class="hljs-number">1e11</span>).replace(<span class="hljs-regexp">/[018]/g</span>, <span class="hljs-function"><span class="hljs-params">c</span> =></span>
    (
      c ^
      (crypto.getRandomValues(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Uint8Array</span>(<span class="hljs-number">1</span>))[<span class="hljs-number">0</span>] & (<span class="hljs-number">15</span> >> (c / <span class="hljs-number">4</span>)))
    ).toString(<span class="hljs-number">16</span>)
  );
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">UUIDGeneratorBrowser(); <span class="hljs-comment">// '7982fcfe-5721-4632-bede-6000885be57d'</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">genUUID</span>(<span class="hljs-params"></span>) </span>&#123;
    <span class="hljs-keyword">const</span> url = URL.createObjectURL(<span class="hljs-keyword">new</span> Blob([]));
    <span class="hljs-comment">// const uuid = url.split("/").pop();</span>
    <span class="hljs-keyword">const</span> uuid = url.substring(url.lastIndexOf(<span class="hljs-string">'/'</span>)+ <span class="hljs-number">1</span>);
    URL.revokeObjectURL(url);
    <span class="hljs-keyword">return</span> uuid;
&#125;

genUUID() <span class="hljs-comment">// cd205467-0120-47b0-9444-894736d873c7</span>


<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-9"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FaddDaysToDate.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/addDaysToDate.md" ref="nofollow noopener noreferrer">addDaysToDate</a></h3>
<p>时间添加天数，返回的是字符串。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> addDaysToDate = <span class="hljs-function">(<span class="hljs-params">date, n</span>) =></span> &#123;
  <span class="hljs-keyword">const</span> d = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(date);
  d.setDate(d.getDate() + n);
  <span class="hljs-keyword">return</span> d.toISOString().split(<span class="hljs-string">'T'</span>)[<span class="hljs-number">0</span>];
&#125;;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">addDaysToDate(<span class="hljs-string">'2020-10-15'</span>, <span class="hljs-number">10</span>); <span class="hljs-comment">// '2020-10-25'</span>
addDaysToDate(<span class="hljs-string">'2020-10-15'</span>, -<span class="hljs-number">10</span>); <span class="hljs-comment">// '2020-10-05'</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-10"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2Fcompose.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/compose.md" ref="nofollow noopener noreferrer">compose </a></h3>
<p>从右到左的复合函数。 没记错的话和 <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freduxjs%2Fredux%2Fblob%2Fmaster%2Fsrc%2Fcompose.ts" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/reduxjs/redux/blob/master/src/compose.ts" ref="nofollow noopener noreferrer">redux的compose</a></strong> 极其类似。</p>
<p>毕竟嘛，思路是一样的。</p>
<pre><code class="hljs language-js copyable" lang="js">onst compose = <span class="hljs-function">(<span class="hljs-params">...fns</span>) =></span>
  fns.reduce(<span class="hljs-function">(<span class="hljs-params">f, g</span>) =></span> <span class="hljs-function">(<span class="hljs-params">...args</span>) =></span> f(g(...args)));
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> add5 = <span class="hljs-function"><span class="hljs-params">x</span> =></span> x + <span class="hljs-number">5</span>;
<span class="hljs-keyword">const</span> multiply = <span class="hljs-function">(<span class="hljs-params">x, y</span>) =></span> x * y;
<span class="hljs-keyword">const</span> multiplyAndAdd5 = compose(
  add5,
  multiply
);
multiplyAndAdd5(<span class="hljs-number">5</span>, <span class="hljs-number">2</span>); <span class="hljs-comment">// 15</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-11"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FdeepGet.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/deepGet.md" ref="nofollow noopener noreferrer">deepGet </a></h3>
<p>获取对象的多级属性，属性参数是数组。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> deepGet = <span class="hljs-function">(<span class="hljs-params">obj, keys</span>) =></span>
  keys.reduce(
    <span class="hljs-function">(<span class="hljs-params">xs, x</span>) =></span> (xs && xs[x] !== <span class="hljs-literal">null</span> && xs[x] !== <span class="hljs-literal">undefined</span> ? xs[x] : <span class="hljs-literal">null</span>),
    obj
  );
<span class="hljs-keyword">let</span> index = <span class="hljs-number">2</span>;
<span class="hljs-keyword">const</span> data = &#123;
  <span class="hljs-attr">foo</span>: &#123;
    <span class="hljs-attr">foz</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>],
    <span class="hljs-attr">bar</span>: &#123;
      <span class="hljs-attr">baz</span>: [<span class="hljs-string">'a'</span>, <span class="hljs-string">'b'</span>, <span class="hljs-string">'c'</span>]
    &#125;
  &#125;
&#125;;
deepGet(data, [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'foz'</span>, index]); <span class="hljs-comment">// get 3</span>
deepGet(data, [<span class="hljs-string">'foo'</span>, <span class="hljs-string">'bar'</span>, <span class="hljs-string">'baz'</span>, <span class="hljs-number">8</span>, <span class="hljs-string">'foz'</span>]); <span class="hljs-comment">// null</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<p>当然 lodash 也提供了  <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Flodash.com%2Fdocs%2F4.17.15%23get" target="_blank" rel="nofollow noopener noreferrer" title="https://lodash.com/docs/4.17.15#get" ref="nofollow noopener noreferrer">.get</a></strong>, 当然实现的复杂度也高很对，其属性参数用的是字符串。</p>
<h3 data-id="heading-12"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FobjectToQueryString.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/objectToQueryString.md" ref="nofollow noopener noreferrer">objectToQueryString </a></h3>
<p>把对象转为 queryString，就这个queryString的转换，就有好几个牛气冲天的库。</p>
<p>下载量过 千万的 <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fquery-string" target="_blank" rel="nofollow noopener noreferrer" title="https://www.npmjs.com/package/query-string" ref="nofollow noopener noreferrer">query-string</a></strong>  和 500万的 <strong><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fqs" target="_blank" rel="nofollow noopener noreferrer" title="https://www.npmjs.com/package/qs" ref="nofollow noopener noreferrer">qs</a></strong>, 主要解决两个问题，其中一个就是 toQueryString。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> objectToQueryString = <span class="hljs-function"><span class="hljs-params">queryParameters</span> =></span> &#123;
  <span class="hljs-keyword">return</span> queryParameters
    ? <span class="hljs-built_in">Object</span>.entries(queryParameters).reduce(
        <span class="hljs-function">(<span class="hljs-params">queryString, [key, val], index</span>) =></span> &#123;
          <span class="hljs-keyword">const</span> symbol = queryString.length === <span class="hljs-number">0</span> ? <span class="hljs-string">'?'</span> : <span class="hljs-string">'&'</span>;
          queryString +=
            <span class="hljs-keyword">typeof</span> val === <span class="hljs-string">'string'</span> ? <span class="hljs-string">`<span class="hljs-subst">$&#123;symbol&#125;</span><span class="hljs-subst">$&#123;key&#125;</span>=<span class="hljs-subst">$&#123;val&#125;</span>`</span> : <span class="hljs-string">''</span>;
          <span class="hljs-keyword">return</span> queryString;
        &#125;,
        <span class="hljs-string">''</span>
      )
    : <span class="hljs-string">''</span>;
&#125;;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">objectToQueryString(&#123; <span class="hljs-attr">page</span>: <span class="hljs-string">'1'</span>, <span class="hljs-attr">size</span>: <span class="hljs-string">'2kg'</span>, <span class="hljs-attr">key</span>: <span class="hljs-literal">undefined</span> &#125;);
<span class="hljs-comment">// '?page=1&size=2kg'</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-13"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FparseCookie.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/parseCookie.md" ref="nofollow noopener noreferrer">parseCookie</a></h3>
<p>把cookie转为键值对。</p>
<p>作为一个操作前端，操作cookie是日常操作，我相信肯定有不少同志引入了第三方库，其实只需代几码就可以的。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> parseCookie = <span class="hljs-function"><span class="hljs-params">str</span> =></span>
  str
    .split(<span class="hljs-string">';'</span>)
    .map(<span class="hljs-function"><span class="hljs-params">v</span> =></span> v.split(<span class="hljs-string">'='</span>))
    .reduce(<span class="hljs-function">(<span class="hljs-params">acc, v</span>) =></span> &#123;
      acc[<span class="hljs-built_in">decodeURIComponent</span>(v[<span class="hljs-number">0</span>].trim())] = <span class="hljs-built_in">decodeURIComponent</span>(v[<span class="hljs-number">1</span>].trim());
      <span class="hljs-keyword">return</span> acc;
    &#125;, &#123;&#125;);
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">parseCookie(<span class="hljs-built_in">document</span>.cookie) 
<span class="hljs-comment">// &#123;_octo: "GH1.1.2059864283.1626332708", tz: "Asia/Shanghai"&#125;</span>

parseCookie(<span class="hljs-string">'foo=bar; equation=E%3Dmc%5E2'</span>);
<span class="hljs-comment">// &#123; foo: 'bar', equation: 'E=mc^2' &#125;</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-14"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2Funfold.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/unfold.md" ref="nofollow noopener noreferrer">unfold </a></h3>
<p>使用迭代器函数和初始种子值构建数组。</p>
<p>在造假数据或者随机数据的时候，比较有用。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> unfold = <span class="hljs-function">(<span class="hljs-params">fn, seed</span>) =></span> &#123;
  <span class="hljs-keyword">let</span> result = [],
    val = [<span class="hljs-literal">null</span>, seed];
  <span class="hljs-keyword">while</span> ((val = fn(val[<span class="hljs-number">1</span>]))) result.push(val[<span class="hljs-number">0</span>]);
  <span class="hljs-keyword">return</span> result;
&#125;;
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">var</span> f = <span class="hljs-function"><span class="hljs-params">n</span> =></span> (n > <span class="hljs-number">50</span> ? <span class="hljs-literal">false</span> : [-n, n + <span class="hljs-number">10</span>]);
unfold(f, <span class="hljs-number">10</span>); <span class="hljs-comment">// [-10, -20, -30, -40, -50]</span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-15"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FtriggerEvent.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/triggerEvent.md" ref="nofollow noopener noreferrer">triggerEvent </a></h3>
<p>触发给定元素上的特定事件，可以选择传递自定义数据。</p>
<p>这个在IE11以及一些低版本是有问题的，低版本使用的是 <code>document.createEvent</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> triggerEvent = <span class="hljs-function">(<span class="hljs-params">el, eventType, detail</span>) =></span>
  el.dispatchEvent(<span class="hljs-keyword">new</span> CustomEvent(eventType, &#123; detail &#125;));
<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js">triggerEvent(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'myId'</span>), <span class="hljs-string">'click'</span>);
triggerEvent(<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">'myId'</span>), <span class="hljs-string">'click'</span>, &#123; <span class="hljs-attr">username</span>: <span class="hljs-string">'bob'</span> &#125;);
<span class="copy-code-btn">复制代码</span></code></pre>
<h3 data-id="heading-16"><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code%2Fblob%2Fmaster%2Fsnippets%2FrepeatGenerator.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code/blob/master/snippets/repeatGenerator.md" ref="nofollow noopener noreferrer">repeatGenerator</a></h3>
<p>创建生成器，无限重复给定值。 有点意思，实用场景嘛，也许测试吧。</p>
<p>当然，中途你可以更新值。 这里想告诉大家的是 genetator有入参的概念。</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> repeatGenerator = <span class="hljs-function"><span class="hljs-keyword">function</span>* (<span class="hljs-params">val</span>) </span>&#123;
  <span class="hljs-keyword">let</span> v = val;
  <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) &#123;
    <span class="hljs-keyword">let</span> newV = <span class="hljs-keyword">yield</span> v;
    <span class="hljs-keyword">if</span> (newV !== <span class="hljs-literal">undefined</span>) v = newV;
  &#125;
&#125;;

<span class="copy-code-btn">复制代码</span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> repeater = repeatGenerator(<span class="hljs-number">5</span>);
repeater.next(); <span class="hljs-comment">// &#123; value: 5, done: false &#125;</span>
repeater.next(); <span class="hljs-comment">// &#123; value: 5, done: false &#125;</span>
repeater.next(<span class="hljs-number">4</span>); <span class="hljs-comment">// &#123; value: 4, done: false &#125;</span>
repeater.next(); <span class="hljs-comment">// &#123; value: 4, done: false &#125;</span>

<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-17">写在最后</h2>
<p>如果你觉得不错，你的一赞一评就是我前行的最大动力。</p>
<p><strong>技术交流群请到 <a href="https://juejin.cn/pin/6994350401550024741" title="https://juejin.cn/pin/6994350401550024741" target="_blank">这里来</a>。
或者添加我的微信 dirge-cloud，一起学习。</strong></p>
<h2 data-id="heading-18">参考引用</h2>
<blockquote>
<p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2F30-seconds%2F30-seconds-of-code" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/30-seconds/30-seconds-of-code" ref="nofollow noopener noreferrer">30-seconds-of-code</a></p>
</blockquote></div>  
</div>
            