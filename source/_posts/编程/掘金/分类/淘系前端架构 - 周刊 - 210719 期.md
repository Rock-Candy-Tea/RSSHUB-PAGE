
---
title: '淘系前端架构 - 周刊 - 210719 期'
categories: 
 - 编程
 - 掘金
 - 分类
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9170548663e4f76a9e39586d9f51cba~tplv-k3u1fbpfcp-zoom-1.image'
author: 掘金
comments: false
date: Sun, 18 Jul 2021 18:45:20 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9170548663e4f76a9e39586d9f51cba~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h2 data-id="heading-0">🗞 News</h2>
<h3 data-id="heading-1">React DevTools 4.14 发布</h3>
<p>React DevTools 4.14 发布，其中包含一项备受期待的功能，即可以显示被检查组件的 hooks 名称。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f9170548663e4f76a9e39586d9f51cba~tplv-k3u1fbpfcp-zoom-1.image" alt="Display Hook Names" loading="lazy" referrerpolicy="no-referrer"></p>
<p>Twitter：<a href="https://link.juejin.cn/?target=https%3A%2F%2Ftwitter.com%2Freactjs%2Fstatus%2F1416034083382169600" target="_blank" rel="nofollow noopener noreferrer" title="https://twitter.com/reactjs/status/1416034083382169600" ref="nofollow noopener noreferrer">React DevTools 4.14</a></p>
<h3 data-id="heading-2">@vuejs/composition-api 1.0.0 发布</h3>
<p>经历了一年多的 beta 和 rc，@vue/composition-api 1.0.0 正式发布，将其安装至 Vue 2 项目中即可使用 Vue Composition API，当项目升级至 Vue 3 后，仅需将 <code>import &#123; ref &#125; from '@vue/composition-api'</code> 中的 @vue/composition-api 替换为 vue 即可实现无缝迁移。</p>
<p>GitHub Repo：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fcomposition-api" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/vuejs/composition-api" ref="nofollow noopener noreferrer">vuejs/composition-api</a></p>
<h3 data-id="heading-3">Next.js Star 数超 70,000</h3>
<p>Next.js 在 GitHub 上已经超过 70,000 Star，按照目前的增长趋势，有望在未来超越 Node.js。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a71b054d7b0d4a4a8069b771f1ef5778~tplv-k3u1fbpfcp-zoom-1.image" alt="GitHub Stars" loading="lazy" referrerpolicy="no-referrer"></p>
<p>Twitter：<a href="https://link.juejin.cn/?target=https%3A%2F%2Ftwitter.com%2Fvercel%2Fstatus%2F1415049087922184196" target="_blank" rel="nofollow noopener noreferrer" title="https://twitter.com/vercel/status/1415049087922184196" ref="nofollow noopener noreferrer">Next.js has passed 70,000 stars on GitHub.</a></p>
<h3 data-id="heading-4">Visual Studio Code 1.58 发布</h3>
<p>编辑器中的终端——支持在代码编辑区域中创建和移动终端（Terminal）。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e79601199e242e68982d559c4b52c15~tplv-k3u1fbpfcp-zoom-1.image" alt="Terminal In Editor" loading="lazy" referrerpolicy="no-referrer"></p>
<p>自动记录调试环境——Visual Studio Code 现在会记住每个文件所选择的调试器，在下次开始调试时，就不会再出现选择调试器的提示了。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2f8ff3e6dcf842348b636fae06b40145~tplv-k3u1fbpfcp-zoom-1.image" alt="Remember Debug Env" loading="lazy" referrerpolicy="no-referrer"></p>
<p>Changelog：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fcode.visualstudio.com%2Fupdates%2Fv1_58" target="_blank" rel="nofollow noopener noreferrer" title="https://code.visualstudio.com/updates/v1_58" ref="nofollow noopener noreferrer">Version 1.58 is now available! Read about the new features and fixes from June.</a></p>
<h2 data-id="heading-5">📦 Open Source</h2>
<h3 data-id="heading-6">CSS Layout Generator</h3>
<p>一个快速生成 CSS 布局的工具，能够以可视化的方式简单快速地生成你想要的样式布局。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/21879d19ad41485fbf0da41c9d1022c4~tplv-k3u1fbpfcp-zoom-1.image" alt="Home Page" loading="lazy" referrerpolicy="no-referrer"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/faac2420853a4a0782e5de1458535552~tplv-k3u1fbpfcp-zoom-1.image" alt="Header Main Footer Template" loading="lazy" referrerpolicy="no-referrer"></p>
<p>Playground：<a href="https://link.juejin.cn/?target=https%3A%2F%2Flayout.bradwoods.io%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://layout.bradwoods.io/" ref="nofollow noopener noreferrer">CSS Layout Generator</a></p>
<h3 data-id="heading-7">Node.js Application Monitoring</h3>
<p>一个用于监控 Node.js 应用程序的工具，能够通过此工具查看内存使用情况、平均响应时间、CPU 使用情况等数据，可以用于发现应用运行时出现的问题。通过分析每个网络请求的得到相应的数据，能够帮助你找到性能瓶颈，以更好地优化代码。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ce9a12ee37d433db48a9ccbc95c0753~tplv-k3u1fbpfcp-zoom-1.image" alt="Node.js Application Monitoring" loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-8">@vue/web-component-wrapper</h3>
<p>一个让你使用 Vue 来开发 Web Components 的库，支持大部分常用的 Vue API。</p>
<p>GitHub Repo：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuejs%2Fvue-web-component-wrapper" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/vuejs/vue-web-component-wrapper" ref="nofollow noopener noreferrer">vuejs/vue-web-component-wrapper</a></p>
<p>当然，这个方案也有一定的缺陷，以这种方式构建的 Web Components 会依赖 Vue 的运行时，这意味着最少会有 16kb 的运行时代码被引入。</p>
<h3 data-id="heading-9">Nx Workspace</h3>
<p>如果说 Lerna 和 Yarn Workspace 提供了工程目录中的 Monorepo 方案，那么 Nx 则为你带来了业务项目中的 Monorepo 方案。你可以在一个 Nx Workspace 中同时开发 Angular/React/NestJS 等应用，从项目初始化到开发构建，再到 Lint/Unit Test/E2E Test，Nx 都已经为你安排得明明白白。如果要给它一个定义，那么它应该是 Angular 的工作流 + Monorepo + 插件体系 + 开发工具 + 几乎无限的定制能力 + ……</p>
<p>对于Angular工作流（即 schematic 和 builder），如果你使用过 Angular 或者 NestJS，应该深有体会。schematic（又称 generator）不仅能帮助你快速生成模板文件，还能让你根据自己的业务需求快速定制生成能力。而 builder（又称executor）则帮助团队项目统一 dev/build/lint/test/e2e/commit 等一系列命令的执行配置。</p>
<p>另外，在定制能力上 Nx 也实现了精细的插件机制，你可以很容易的实现 Framework 层面的插件，如 Vue/Electron，或者是 Compiler/Bundler 层面的插件，如 ESBuild/Vite，甚至是跨语言层面的插件，如 Dart/Golang。</p>
<p>如果上面的介绍已经引起了你的兴趣，可以使用 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Flinbudu599%2FNx-Todo-App" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/linbudu599/Nx-Todo-App" ref="nofollow noopener noreferrer">Nx-Todo-App</a> 这个入门项目，根据文档来快速上手 Nx。</p>
<p>Home Page：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fnx.dev%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://nx.dev/" ref="nofollow noopener noreferrer">Nx Workspace</a></p>
<h3 data-id="heading-10">require-ts</h3>
<p>一个允许使用 <code>require</code> 来处理 TypeScript 文件的库，原理其实是在 <code>require</code> 中注册了 <code>.ts</code> 的拓展名，然后使用 <code>tsc</code> 实时编译并缓存。</p>
<p>这一思路在 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuepress%2Fvuepress-next%2Fblob%2Ff91651c3c7248fdabfa19cb9bdcdba4c28622eec%2Fpackages%2F%2540vuepress%2Fcli%2Fsrc%2Futils%2FallowTs.ts" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/vuepress/vuepress-next/blob/f91651c3c7248fdabfa19cb9bdcdba4c28622eec/packages/%40vuepress/cli/src/utils/allowTs.ts" ref="nofollow noopener noreferrer">vuepress/vuepress-next</a> 中也得到了体现，但有几点区别：</p>
<ul>
<li>VuePress 中使用 ES Build 进行编译，速度明显更快</li>
<li>由于使用 ESBuild 进行编译，<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fvuepress%2Fvuepress-next%2Fblob%2Ff91651c3c7248fdabfa19cb9bdcdba4c28622eec%2Fpackages%2F%2540vuepress%2Fcli%2Fsrc%2Futils%2FesbuildUtils.ts%23L16" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/vuepress/vuepress-next/blob/f91651c3c7248fdabfa19cb9bdcdba4c28622eec/packages/%40vuepress/cli/src/utils/esbuildUtils.ts#L16" ref="nofollow noopener noreferrer">externals</a> 是被写死的，因此必须确保被 <code>require</code> 的文件中没有额外的 externals（当然，也可以对 AST 进行解析，收集所有的 external）</li>
</ul>
<p>GitHub Repo：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fadonisjs%2Frequire-ts" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/adonisjs/require-ts" ref="nofollow noopener noreferrer">adonisjs/require-ts</a></p>
<h3 data-id="heading-11">ts-transformer-keys</h3>
<p>一个能够从 TypeScript Interface 中获取到 Interface 成员（非类型信息）的库。</p>
<pre><code class="copyable">import &#123; keys &#125; from 'ts-transformer-keys';
​
interface Props &#123;
 id: string;
 name: string;
 age: number;
&#125;
const keysOfProps = keys<Props>();
​
console.log(keysOfProps); // ['id', 'name', 'age']
<span class="copy-code-btn">复制代码</span></code></pre>
<p>具体实现方法其实是使用 TypeScript 的 compiler 对代码进行 AST 解析，拿到成员信息。作者还写了一个类似的，从 Enum 中获得 Enum 成员：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fkimamula%2Fts-transformer-enumerate" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/kimamula/ts-transformer-enumerate" ref="nofollow noopener noreferrer">ts-transformer-enumerate</a></p>
<p>GitHub Repo：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fkimamula%2Fts-transformer-keys" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/kimamula/ts-transformer-keys" ref="nofollow noopener noreferrer">kimamula/ts-transformer-keys</a></p>
<h3 data-id="heading-12">PouchDB</h3>
<p>一个轻量且能够在浏览器环境下运行的数据库，师从 Apache 的 CouchDB（并且可以互相兼容）。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/53e4501e9b0c49cd9abffd4f814da28a~tplv-k3u1fbpfcp-zoom-1.image" alt="Intro" loading="lazy" referrerpolicy="no-referrer"></p>
<p>它的特点是获取数据不需要写任何 SQL，只需要两个字——“同步”。</p>
<pre><code class="copyable">const db = new PouchDB('dbname');
​
db.put(&#123;
 _id: 'dave@gmail.com',
 name: 'David',
 age: 69
&#125;);
​
db.changes().on('change', function() &#123;
 console.log('Ch-Ch-Changes');
&#125;);
​
db.replicate.to('http://example.com/mydb');
<span class="copy-code-btn">复制代码</span></code></pre>
<p>很适合于在线协同场景下的增量数据和原子化的行为数据的同步，建议搭配 ot.js 使用。</p>
<p>当然，它最适合 UI Framework 使用，比如 React：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FArnoSaine%2Freact-pouchdb" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ArnoSaine/react-pouchdb" ref="nofollow noopener noreferrer">ArnoSaine/react-pouchdb</a></p>
<p>react-pouchdb 提供了一些 hooks/HOC/组件，从开发体验上讲，相较传统 http/swr 更加舒适。</p>
<p>GitHub Repo：<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fpouchdb%2Fpouchdb" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/pouchdb/pouchdb" ref="nofollow noopener noreferrer">pouchdb/pouchdb</a></p>
<h2 data-id="heading-13">📑 Article</h2>
<h3 data-id="heading-14">React Fast Refresh 原理剖析</h3>
<p>从源码的角度，详细剖析了 React 实现 Fast Refresh 的方式，为 Rax 实现此能力提供了参考。</p>
<p>查看原文：<a href="https://link.juejin.cn/?target=http%3A%2F%2Fwww.ayqy.net%2Fblog%2Ffast-refresh-under-the-hood%2F" target="_blank" rel="nofollow noopener noreferrer" title="http://www.ayqy.net/blog/fast-refresh-under-the-hood/" ref="nofollow noopener noreferrer">React Fast Refresh 原理剖析</a></p></div>  
</div>
            