
---
title: 'Flowï¼šFacebook çš„ JavaScript é™æ€ç±»å‹æ£€æŸ¥å™¨'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - åˆ†ç±»
headimg: 'https://i.loli.net/2021/07/10/2vg9mucboQanZiW.jpg'
author: æ˜é‡‘
comments: false
date: Sat, 10 Jul 2021 07:38:49 GMT
thumbnail: 'https://i.loli.net/2021/07/10/2vg9mucboQanZiW.jpg'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><blockquote>
<p>è®°æŸå¹´çš„ä¸€æ¬¡å›¢é˜Ÿåˆ†äº«ï¼Œä¸»è¦ç›®çš„ï¼šä¼˜åŒ–åˆè‡­åˆé•¿ç»´æŠ¤å™©æ¢¦çš„JavaScriptè€é¡¹ç›®</p>
</blockquote>
<p><img src="https://i.loli.net/2021/07/10/2vg9mucboQanZiW.jpg" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>JavaScriptå†™èµ·æ¥ï¼Œ<code>è¡Œäº‘æµæ°´ã€æŒ¥æ´’è‡ªå¦‚ã€æ— æ‹˜æ— æŸã€ç¬”èµ°é¾™è›‡ã€ä¸ºæ‰€æ¬²ä¸º</code></p>
<p>é‡‘ä¸»ç²‘ç²‘ï¼Œæ¯å¤©æŠ“ç‹‚ï¼Œå°ä¿®å°è¡¥çš„<code>hotfixä»æœªåœæ­¢</code>ï¼Œ<code>è„†å¼±çš„ä»£ç </code>ç»ä¸ä½åŠç‚¹é£æµª</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9c0bd336de34431ab89ff28776404441~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>Flowæ˜¯JavaScriptä»£ç çš„<code>é™æ€ç±»å‹æ£€æŸ¥å™¨</code>ã€‚ å®ƒå¯ä»¥å¸®åŠ©æ‚¨<code>æé«˜å·¥ä½œæ•ˆç‡</code>ã€‚ è®©æ‚¨çš„ä»£ç <code>æ›´å¿«ï¼Œæ›´æ™ºèƒ½ï¼Œæ›´è‡ªä¿¡ï¼Œæ›´å¤§è§„æ¨¡</code>ã€‚</p>
<p>Flowé€šè¿‡é™æ€ç±»å‹æ³¨é‡Šæ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨é”™è¯¯ã€‚ è¿™äº›ç±»å‹å…è®¸æ‚¨å‘Šè¯‰Flowæ‚¨å¸Œæœ›ä»£ç å¦‚ä½•å·¥ä½œï¼ŒFlowå°†ç¡®ä¿å®ƒä»¥è¿™ç§æ–¹å¼å·¥ä½œã€‚</p>
<h3 data-id="heading-0">1.ä»demoå¼€å§‹è®¤è¯†flow</h3>
<h3 data-id="heading-1">2.å®‰è£…ï¼Œé…ç½®</h3>
<h3 data-id="heading-2">3.flowæ€»ç»“åŠä½¿ç”¨</h3>
<h3 data-id="heading-3">å‰è¨€</h3>
<p>æˆ‘ä»¬çŸ¥é“<code>react</code>æºç ç°åœ¨è¿˜æ˜¯é‡‡ç”¨<code>flow + js</code>çš„æ–¹å¼ï¼Œä¸‹å›¾æˆªå–ä¸€å°æ®µ<code>react Fiberæºç </code>ï¼Œå…ˆæ··ä¸ªè„¸ç†Ÿ</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/**
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 * <span class="hljs-doctag">@flow</span>
 */</span>
<span class="hljs-keyword">import</span> type &#123;ReactElement&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'shared/ReactElementType'</span>;
<span class="hljs-keyword">import</span> type &#123;ReactFragment, ReactPortal, ReactScope&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'shared/ReactTypes'</span>;
<span class="hljs-keyword">import</span> type &#123;Fiber&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactInternalTypes'</span>;
<span class="hljs-keyword">import</span> type &#123;RootTag&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactRootTags'</span>;
<span class="hljs-keyword">import</span> type &#123;WorkTag&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactWorkTags'</span>;
<span class="hljs-keyword">import</span> type &#123;TypeOfMode&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactTypeOfMode'</span>;
<span class="hljs-keyword">import</span> type &#123;Lanes&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactFiberLane.new'</span>;
<span class="hljs-keyword">import</span> type &#123;SuspenseInstance&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactFiberHostConfig'</span>;
<span class="hljs-keyword">import</span> type &#123;OffscreenProps&#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'./ReactFiberOffscreenComponent'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-4">1.ä»demoå¼€å§‹è®¤è¯†flow</h3>
<h4 data-id="heading-5">1.1 å‡ºå…¥å‚é™æ€ç±»å‹æ³¨é‡Š</h4>
<pre><code class="copyable">// @flow
function square(n: number): number &#123;
  return n * n;
&#125;

square("2"); // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æŠ¥é”™ä¿¡æ¯ï¼š</p>
<p>Error â”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆâ”ˆ common/globFile.js:26:8</p>
<p>Cannot call square with '2' bound to n because string [1] is incompatible with number [2].</p>
<h4 data-id="heading-6">1.2.è¿ç®—ç»“æœç±»å‹æ£€æŸ¥</h4>
<p>å› ä¸ºFlowå¾ˆå¥½åœ°ç†è§£JavaScriptï¼Œæ‰€ä»¥å®ƒä¸éœ€è¦å¾ˆå¤šè¿™äº›ç±»å‹ã€‚ ä½ åº”è¯¥åªéœ€è¦åšå¾ˆå°‘çš„å·¥ä½œæ¥æè¿°ä½ çš„Flowä»£ç ï¼Œå®ƒå°†æ¨æ–­å…¶ä½™éƒ¨åˆ†ã€‚ åœ¨å¾ˆå¤šæ—¶å€™ï¼ŒFlowå¯ä»¥å®Œå…¨ç†è§£æ‚¨çš„ä»£ç è€Œä¸éœ€è¦ä»»ä½•ç±»å‹</p>
<pre><code class="copyable">// @flow
function square(n) &#123;
  return n * n; // Error!
&#125;

square("2");
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æŠ¥é”™ä¿¡æ¯ï¼š
Cannot perform arithmetic operation because string [1] is not a number.</p>
<h3 data-id="heading-7">2.å®‰è£…</h3>
<h4 data-id="heading-8">2.1 å®‰è£…ç¼–è¯‘å™¨</h4>
<p>å®˜æ–¹æ¨è<code>babel</code>æˆ–<code>flow-remove-types</code></p>
<pre><code class="copyable">npm install --save-dev @babel/cli @babel/preset-flow
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>é¡¹ç›®å¢åŠ <code>babel.config.js</code>æ–‡ä»¶</p>
<pre><code class="copyable">module.exports = function() &#123;
  return &#123;
    presets: [
      "@babel/preset-flow"
    ]
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>package.json</code>ä¸­æ·»åŠ scripts</p>
<pre><code class="copyable">&#123;
  "devDependencies": &#123;
    "@babel/cli": "^7.4.4",
    "@babel/preset-flow": "^7.0.0",
  &#125;,
  "scripts": &#123;
    "build": "babel src/ -d lib/",
    "prepublish": "npm run build"
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-9">2.2 å®‰è£…flow</h4>
<pre><code class="copyable">npm install --save-dev flow-bin
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>package.json</code>ä¸­æ·»åŠ scripts</p>
<pre><code class="copyable">&#123;
  "devDependencies": &#123;
    "flow-bin": "^0.99.0"
  &#125;,
  "scripts": &#123;
    "flow": "flow"
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç”Ÿæˆ<code>flowconfig</code>é…ç½®æ–‡ä»¶</p>
<pre><code class="copyable">npm run flow init
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿è¡Œ<code>flow</code></p>
<pre><code class="copyable">npm run flow
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-10">3.flowæ€»ç»“åŠä½¿ç”¨</h3>
<ul>
<li>3.1 ä½¿ç”¨<a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org%2Fen%2Fdocs%2Fusage%2F%23toc-initialize-your-project" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org/en/docs/usage/#toc-initialize-your-project" ref="nofollow noopener noreferrer">flow initåˆå§‹åŒ–é¡¹ç›®</a></li>
<li>3.2 ä½¿ç”¨flowå¯åŠ¨Flowåå°è¿›ç¨‹<a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org%2Fen%2Fdocs%2Fusage%2F%23toc-run-the-flow-background-process" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org/en/docs/usage/#toc-run-the-flow-background-process" ref="nofollow noopener noreferrer">flow status</a></li>
<li>3.3 ä½¿ç”¨<a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org%2Fen%2Fdocs%2Fusage%2F%23toc-prepare-your-code-for-flow" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org/en/docs/usage/#toc-prepare-your-code-for-flow" ref="nofollow noopener noreferrer">// @flow</a>ç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶</li>
<li>3.4 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org%2Fen%2Fdocs%2Fusage%2F%23toc-write-flow-code" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org/en/docs/usage/#toc-write-flow-code" ref="nofollow noopener noreferrer">ç¼–å†™flowä»£ç </a></li>
<li>3.5 <a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org%2Fen%2Fdocs%2Fusage%2F%23toc-check-your-code" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org/en/docs/usage/#toc-check-your-code" ref="nofollow noopener noreferrer">æ£€æŸ¥ä»£ç </a>æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯</li>
<li>3.6 å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š</li>
</ul>
<h4 data-id="heading-11">3.1 ä½¿ç”¨ flow init åˆå§‹åŒ–é¡¹ç›®</h4>
<p>ç”Ÿæˆç±»ä¼¼INIæ ¼å¼ï¼Œé¡¹ç›®.flowconfigé…ç½®æ–‡ä»¶</p>
<p>3.1.1 <code>.flowconfig</code>ç”±6ä¸ªéƒ¨åˆ†ç»„æˆ</p>
<pre><code class="copyable">; å¿½ç•¥åŒ¹é…æ–‡ä»¶
[ignore]
<PROJECT_ROOT>/__tests__/.*
<PROJECT_ROOT>/lib/.*

; åŒ…å«æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•
[include]
<PROJECT_ROOT>/src/.*

; åœ¨ç±»å‹æ£€æŸ¥ä»£ç æ—¶åŒ…å«æŒ‡å®šçš„åº“å®šä¹‰
[libs]

; lint
[lints]
all=warn
untyped-type-import=error
sketchy-null-bool=off

; é€‰é¡¹
[options]
all=true
esproposal.decorators=ignore
experimental.const_params=true
module.file_ext=.bar
module.use_strict=true

; ä¸¥æ ¼
[strict]
nonstrict-import
unclear-type
unsafe-getters-setters
untyped-import
untyped-type-import


; none
; åœ¨å£°æ˜æ¨¡å¼ä¸‹ï¼Œä»£ç æ²¡æœ‰è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œä¼šæ£€æŸ¥æ–‡ä»¶å†…å®¹
[declarations]
<PROJECT_ROOT>/third_party/.*

; ä¸æ£€æŸ¥æ–‡ä»¶å†…å®¹ï¼Œä¸åŒ¹é…æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„ç±»å‹æ–‡ä»¶ï¼Œä¸¢å¼ƒç±»å‹å¹¶å°†æ¨¡å—è§†ä¸ºä»»ä½•æ¨¡å—
[untyped]
<PROJECT_ROOT>/third_party/.*

; æŒ‡å®šflowä½¿ç”¨çš„ç‰ˆæœ¬
[version]
0.98.1

<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>3.1.2 # or ; or ğŸ’© are ignored</p>
<pre><code class="copyable"># This is a comment
  # This is a comment
; This is a comment
  ; This is a comment
ğŸ’© This is a comment
  ğŸ’© This is a comment
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>3.1.3 .flowconfigæ”¾ç½®ä½ç½®</p>
<p>.flowconfigçš„ä½ç½®éå¸¸é‡è¦ã€‚Flowå°†åŒ…å«.flowconfigçš„ç›®å½•è§†ä¸ºé¡¹ç›®æ ¹ç›®å½•ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼ŒFlowåŒ…å«é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æºä»£ç </p>
<h4 data-id="heading-12">3.2 ä½¿ç”¨flowå¯åŠ¨flowåå°è¿›ç¨‹</h4>
<p><code>vscode</code>æ¨èå®‰è£…<code>Flow Language Support</code></p>
<pre><code class="copyable">flow status // å¯åŠ¨flowåå°è¿›ç¨‹
flow stop   // ç»ˆæ­¢flowåå°è¿›ç¨‹
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>webpack</code>çƒ­åŠ è½½ï¼Œä½¿ç”¨<code>flow-webpack-plugin</code></p>
<pre><code class="copyable">'use strict';

const HtmlWebpackPlugin = require('html-webpack-plugin');
const path = require('path');
const FlowWebpackPlugin = require('flow-webpack-plugin');

module.exports = &#123;
  mode: 'development',
  devtool: 'source-map',
  entry:  './example/app.js',
  output: &#123;
      filename: 'bundle.js',
      path: path.resolve(__dirname, './dist'),
  &#125;,
  devServer: &#123;
      hot: true,
      disableHostCheck: true,
      historyApiFallback: true
  &#125;,
  plugins: [
      new HtmlWebpackPlugin(&#123; template: 'example/index.html' &#125;),
      new FlowWebpackPlugin(&#123;
        flowArgs: ['check']
      &#125;)
  ],
&#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-13">3.3 ä½¿ç”¨// @flowç¡®å®šFlowå°†ç›‘è§†å“ªäº›æ–‡ä»¶</h4>
<p>Flowåå°è¿›ç¨‹ä½¿ç”¨æ­¤æ ‡å¿—æ”¶é›†æ‰€æœ‰æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨æ‰€æœ‰è¿™äº›æ–‡ä»¶ä¸­æä¾›çš„ç±»å‹ä¿¡æ¯æ¥ç¡®ä¿ä¸€è‡´æ€§å’Œæ— é”™è¯¯ç¼–ç¨‹</p>
<p>ä½¿ç”¨JavaScriptæ³¨é‡Šçš„å½¢å¼ï¼Œæ³¨é‡Š<code>@flow</code></p>
<pre><code class="copyable">// @flow

æˆ–

/* @flow */
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¿½ç•¥<code>//@flow</code>ï¼Œæ£€æŸ¥æ‰€æœ‰æ–‡ä»¶</p>
<pre><code class="copyable">flow check --all
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-14">3.4 ç¼–å†™flowä»£ç </h4>
<p>Flowåå°è¿›ç¨‹å°†ä¼šæ•è·æ­¤é”™è¯¯</p>
<pre><code class="copyable">// @flow

function foo(x: ?number): string &#123;
  if (x) &#123;
    return x;
  &#125;
  return "default string";
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-15">3.5 æ£€æŸ¥ä»£ç æ˜¯å¦å­˜åœ¨ç±»å‹é”™è¯¯</h4>
<pre><code class="copyable"># equivalent to `flow status`
flow
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿è¡Œflowæ£€æŸ¥</p>
<pre><code class="copyable">// @flow

function foo(x: ?number): string &#123;
  if (x) &#123;
    return x;  // Cannot return `x` because  number [1] is incompatible with  string [2].
  &#125;
  return "default string";
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-16">3.6 å¦‚ä½•åœ¨ä»£ç ä¸­æ·»åŠ ç±»å‹æ³¨é‡Š</h4>
<p>ç±»å‹æ³¨é‡Šç¬¦å·</p>
<pre><code class="copyable">|       // æˆ–
&       // ä¸” 
?       // å¯é€‰
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç±»å‹æ³¨é‡Šä¸­åŒ…æ‹¬çš„ç±»å‹</p>
<pre><code class="copyable">boolean                                 // true or new Boolean(false)
string                                  // "hello" or new String("world")
number                                  // 3.14 or new Number(42)
null                                    // null
undefined (void in Flow types)          // undefined
Array (å…¶ä¸­Tç”¨æ¥æè¿°æ•°ç»„ä¸­å€¼çš„ç±»å‹)     // Array<T>
Object                                  // &#123;&#125;
Function                                // function
class                                   // class
Symbols (not yet supported in Flow)     // Symbol("foo")
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å°å†™</p>
<pre><code class="copyable">// @flow
function method(x: number, y: string, z: boolean) &#123;
  // ...
&#125;

method(3.14, "hello", true);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¤§å†™</p>
<pre><code class="copyable">// @flow
function method(x: Number, y: String, z: Boolean) &#123;
  // ...
&#125;

method(new Number(42), new String("world"), new Boolean(false));
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>boolean</p>
<pre><code class="copyable">// @flow
function acceptsBoolean(value: boolean) &#123;
  // ...
&#125;

acceptsBoolean(true);  // Works!
acceptsBoolean(false); // Works!
acceptsBoolean("foo"); // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>JavaScriptå¯ä»¥éšå¼åœ°å°†å…¶ä»–ç±»å‹çš„å€¼è½¬æ¢ä¸ºå¸ƒå°”å€¼</p>
<pre><code class="copyable">if (42) &#123;&#125; // 42 => true
if ("") &#123;&#125; // "" => false
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>éå¸ƒå°”å€¼éœ€è¦æ˜¾å¼è½¬æ¢ä¸ºå¸ƒå°”ç±»å‹</p>
<pre><code class="copyable">// @flow
function acceptsBoolean(value: boolean) &#123;
  // ...
&#125;

acceptsBoolean(0);          // Error!
acceptsBoolean(Boolean(0)); // Works!
acceptsBoolean(!!0);        // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>string</p>
<pre><code class="copyable">// @flow
function acceptsString(value: string) &#123;
  // ...
&#125;

acceptsString("foo"); // Works!
acceptsString(false); // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>JavaScriptå¯ä»¥éšå¼åœ°å°†å…¶ä»–ç±»å‹çš„å€¼è½¬æ¢ä¸ºå­—ç¬¦</p>
<pre><code class="copyable">"foo" + 42; // "foo42"
"foo" + &#123;&#125;; // "foo[object Object]"
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Flowè¿æ¥åˆ°å­—ç¬¦ä¸²æ—¶åªæ¥å—å­—ç¬¦ä¸²å’Œæ•°å­—ã€‚</p>
<pre><code class="copyable">// @flow
"foo" + "foo"; // Works!
"foo" + 42;    // Works!
"foo" + &#123;&#125;;    // Error!
"foo" + [];    // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¿…é¡»æ˜ç¡®å¹¶å°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p>
<pre><code class="copyable">// @flow
"foo" + String(&#123;&#125;);     // Works!
"foo" + [].toString();  // Works!
"" + JSON.stringify(&#123;&#125;) // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>number</p>
<pre><code class="copyable">// @flow
function acceptsNumber(value: number) &#123;
  // ...
&#125;

acceptsNumber(42);       // Works!
acceptsNumber(3.14);     // Works!
acceptsNumber(NaN);      // Works!
acceptsNumber(Infinity); // Works!
acceptsNumber("foo");    // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>null and void</p>
<pre><code class="copyable">// @flow
function acceptsNull(value: null) &#123;
  /* ... */
&#125;

function acceptsUndefined(value: void) &#123;
  /* ... */
&#125;

acceptsNull(null);           // Works!
acceptsNull(undefined);      // Error!
acceptsUndefined(null);      // Error!
acceptsUndefined(undefined); // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Array</p>
<pre><code class="copyable">let arr: Array<number> = [1, 2, 3];
let arr1: Array<boolean> = [true, false, true];
let arr2: Array<string> = ["A", "B", "C"];
let arr3: Array<mixed> = [1, true, "three"]
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Object</p>
<pre><code class="copyable">// @flow
var obj1: &#123; foo: boolean &#125; = &#123; foo: true &#125;;
var obj2: &#123;
  foo: number,
  bar: boolean,
  baz: string,
&#125; = &#123;
  foo: 1,
  bar: true,
  baz: 'three',
&#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Function</p>
<pre><code class="copyable">// @flow
function concat(a: string, b: string): string &#123;
  return a + b;
&#125;

concat("foo", "bar"); // Works!
// $ExpectError
concat(true, false);  // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç®­å¤´Function</p>
<pre><code class="copyable">let method = (str, bool, ...nums) => &#123;
  // ...
&#125;;

let method = (str: string, bool?: boolean, ...nums: Array<number>): void => &#123;
  // ...
&#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å›è°ƒFunction</p>
<pre><code class="copyable">function method(callback: (error: Error | null, value: string | null) => void) &#123;
  // ...
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>class</p>
<pre><code class="copyable">// @flow
class MyClass<A, B, C> &#123;
  constructor(arg1: A, arg2: B, arg3: C) &#123;
    // ...
  &#125;
&#125;

var val: MyClass<number, boolean, string> = new MyClass(1, true, 'three');


class Foo &#123;
  serialize() &#123; return '[Foo]'; &#125;
&#125;

class Bar &#123;
  serialize() &#123; return '[Bar]'; &#125;
&#125;

// $ExpectError
const foo: Foo = new Bar(); // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Maybe Types</p>
<pre><code class="copyable">// @flow
function acceptsMaybeString(value: ?string) &#123;
  // ...
&#125;

acceptsMaybeString("bar");     // Works!
acceptsMaybeString(undefined); // Works!
acceptsMaybeString(null);      // Works!
acceptsMaybeString();          // Works!
acceptsMaybeString(12345);     // Error!

// value: string null or undefined
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¯¹è±¡å±æ€§å¯é€‰</p>
<pre><code class="copyable">// @flow
function acceptsObject(value: &#123; foo?: string &#125;) &#123;
  // ...
&#125;

acceptsObject(&#123; foo: "bar" &#125;);     // Works!
acceptsObject(&#123; foo: undefined &#125;); // Works!
acceptsObject(&#123; foo: null &#125;);      // Error!é—®å·æ”¾åœ¨stringå‰ä¸æŠ¥é”™
acceptsObject(&#123;&#125;);                 // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å‡½æ•°å‚æ•°å¯é€‰</p>
<pre><code class="copyable">// @flow
function acceptsOptionalString(value?: string) &#123;
  // ...
&#125;

acceptsOptionalString("bar");     // Works!
acceptsOptionalString(undefined); // Works!
acceptsOptionalString(null);      // Error!é—®å·æ”¾åœ¨stringå‰ä¸æŠ¥é”™
acceptsOptionalString();          // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¸¦é»˜è®¤å€¼çš„å‡½æ•°å‚æ•°</p>
<pre><code class="copyable">// @flow
function acceptsOptionalString(value: string = "foo") &#123;
  // ...
&#125;

acceptsOptionalString("bar");     // Works!
acceptsOptionalString(undefined); // Works!
acceptsOptionalString(null);      // Error!
acceptsOptionalString();          // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä½¿ç”¨å­—é¢æ–‡å­—ä½œä¸ºç±»å‹</p>
<pre><code class="copyable">// @flow
function acceptsTwo(value: 2) &#123;
  // ...
&#125;

acceptsTwo(2);   // Works!
// $ExpectError
acceptsTwo(3);   // Error!
// $ExpectError
acceptsTwo("2"); // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Union Types</p>
<pre><code class="copyable">// @flow
function getColor(name: "success" | "warning" | "danger") &#123;
  switch (name) &#123;
    case "success" : return "green";
    case "warning" : return "yellow";
    case "danger"  : return "red";
  &#125;
&#125;

getColor("success"); // Works!
getColor("danger");  // Works!
// $ExpectError
getColor("error");   // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Mixed Types</p>
<pre><code class="copyable">function stringifyBasicValue(value: string | number) &#123;
  return '' + value;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>A type based on another type</p>
<pre><code class="copyable">function identity<T>(value: T): T &#123;
  return value;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>An arbitrary type that could be anything</p>
<pre><code class="copyable">function getTypeOf(value: mixed): string &#123;
  return typeof value;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Any Types</p>
<pre><code class="copyable">// @flow
function add(one: any, two: any): number &#123;
  return one + two;
&#125;

add(1, 2);     // Works.
add("1", "2"); // Works.
add(&#123;&#125;, []);   // Works.
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å˜é‡ç±»å‹
å°†ç±»å‹æ·»åŠ åˆ°å˜é‡å£°æ˜
const let var</p>
<pre><code class="copyable">// @flow
const foo /* : number */ = 1;
const bar: number = 2;

var fooVar /* : number */ = 1;
let fooLet /* : number */ = 1;
var barVar: number = 2;
let barLet: number = 2;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>let</p>
<pre><code class="copyable">let foo: number = 1;
foo = 2;   // Works!
// $ExpectError
foo = "3"; // Error!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>é‡æ–°åˆ†é…å˜é‡</p>
<pre><code class="copyable">let foo = 42;

if (Math.random()) foo = true;
if (Math.random()) foo = "hello";

let isOneOf: number | boolean | string = foo; // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>é‡æ–°åˆ†é…å˜é‡ç¡®å®šå˜é‡ç±»å‹</p>
<pre><code class="copyable">// @flow
let foo = 42;
let isNumber: number = foo; // Works!

foo = true;
let isBoolean: boolean = foo; // Works!

foo = "hello";
let isString: string = foo; // Works!
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>react</p>
<pre><code class="copyable">import * as React from 'react';

type Props = &#123;
  foo: number,
  bar?: string,
&#125;;

type State = &#123;
  count: number,
&#125;;


class MyComponent extends React.Component<Props> &#123;
  state = &#123;
    count: 0,
  &#125;;
  render() &#123;
    this.props.doesNotExist; // Error! You did not define a `doesNotExist` prop.

    return <div>&#123;this.props.bar&#125;</div>;
  &#125;
&#125;

<MyComponent foo=&#123;42&#125; />;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æƒ³äº†è§£æ›´å¤šç”¨æ³•ï¼Œå¯ç§»æ­¥<code>flowå®˜æ–¹æ–‡æ¡£</code>ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fflow.org" target="_blank" rel="nofollow noopener noreferrer" title="https://flow.org" ref="nofollow noopener noreferrer">flow.org</a></p>
<p>æ­¤ç¯‡ç¬”è®°å·²æ”¶å½• <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fniexq%2Fniexq.github.io" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/niexq/niexq.github.io" ref="nofollow noopener noreferrer">ä¸ªäººç¬”è®°</a>ï¼Œæ„Ÿè°¢é˜…è¯»ï¼Œæ¬¢è¿<code>star</code>é¼“åŠ±</p></div>  
</div>
            