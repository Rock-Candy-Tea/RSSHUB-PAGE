
---
title: 'æ¯ä¸ªå‰ç«¯éƒ½å€¼å¾—æ‹¥æœ‰è‡ªå·±çš„ç»„ä»¶åº“ï¼Œå°±åƒæ¯ä¸ªå¤å¤©éƒ½æ‹¥æœ‰è¥¿ç“œğŸ‰'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - æ ‡ç­¾
headimg: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b3f6212f0124f4fab8b70dfeeb40c25~tplv-k3u1fbpfcp-watermark.image'
author: æ˜é‡‘
comments: false
date: Sun, 11 Jul 2021 18:02:28 GMT
thumbnail: 'https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b3f6212f0124f4fab8b70dfeeb40c25~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%&#125;.markdown-body p&#123;color:#595959;font-size:15px;line-height:2;font-weight:400&#125;.markdown-body p+p&#123;margin-top:16px&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;padding:30px 0;margin:0;color:#135ce0&#125;.markdown-body h1&#123;position:relative;text-align:center;font-size:22px;margin:50px 0&#125;.markdown-body h1:before&#123;position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)&#125;.markdown-body h2&#123;position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0&#125;.markdown-body h3&#123;font-size:16px&#125;.markdown-body ul&#123;list-style:disc outside;margin-left:2em;margin-top:1em&#125;.markdown-body li&#123;line-height:2;color:#595959&#125;.markdown-body img.loaded&#123;margin:0 auto;display:block&#125;.markdown-body blockquote&#123;background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5&#125;.markdown-body blockquote p&#123;color:#666;line-height:2&#125;.markdown-body a&#123;color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none&#125;.markdown-body em strong,.markdown-body strong&#123;color:#036aca&#125;.markdown-body hr&#123;border-top:1px solid #135ce0&#125;.markdown-body pre&#123;overflow:auto&#125;.markdown-body code,.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body table&#123;border-collapse:collapse;margin:1rem 0;overflow-x:auto&#125;.markdown-body table td,.markdown-body table th&#123;border:1px solid #dfe2e5;padding:.6em 1em&#125;.markdown-body table tr&#123;border-top:1px solid #dfe2e5&#125;.markdown-body table tr:nth-child(2n)&#123;background-color:#f6f8fa&#125;</style><blockquote>
<p>âš ï¸æœ¬æ–‡ä¸ºæ˜é‡‘ç¤¾åŒºé¦–å‘ç­¾çº¦æ–‡ç« ï¼Œæœªè·æˆæƒç¦æ­¢è½¬è½½</p>
</blockquote>
<blockquote>
<p>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯æ´›ç«¹ğŸ‹ï¼Œä¸€åªä½åœ¨æ­åŸçš„æœ¨ç³»ç å¦–ğŸ§šğŸ»â€â™€ï¸ï¼Œå¦‚æœä½ å–œæ¬¢æˆ‘çš„æ–‡ç« ğŸ“šï¼Œå¯ä»¥é€šè¿‡ç‚¹èµå¸®æˆ‘èšé›†çµåŠ›â­ï¸ã€‚</p>
</blockquote>
<p>æ´›ç«¹æœ‰ä¸€ä¸ªæœ‹å‹å°é»‘æœ€è¿‘åœ¨é¢è¯•æ—¶è¢«é—®åˆ°å¦‚ä½•è®¾è®¡ä¸€ä¸ªå‰ç«¯ç»„ä»¶åº“ã€‚æ²¡å•¥ç»éªŒçš„å°é»‘å›ç­”äº†ä¸šåŠ¡æå–å°è£…æˆåº“ä»¥åŠåŸºäº antd ç»“åˆä¸šåŠ¡äºŒæ¬¡å°è£…ã€‚æœ€åå°é»‘è¢« HR ä»¥çµåŠ›ä¸å¤ŸæŒ‚æ‰äº†ã€‚å…¶å®è¿™ä¸ªé—®é¢˜è€ƒå¯Ÿçš„å¹¶ä¸æ˜¯å‡å¤§ç©ºçš„æ¦‚å¿µï¼Œè€Œæ˜¯æœ‰å…³å¼€å‘è€…ä»“åº“ç®¡ç†ã€ç»„ä»¶è®¾è®¡ã€å•å…ƒæµ‹è¯•ã€æŒç»­é›†æˆã€åä½œç®¡ç†ç­‰ç­‰èƒ½åŠ›ã€‚é‚£ä¹ˆä¸ºäº†èµ‹èƒ½å°é»‘å®Œç¾å›ç­”è¿™ä¸ªé—®é¢˜å‘¢ï¼Œæˆ‘å†³å®šå¸¦é¢†å°é»‘ä¸€æ­¥ä¸€æ­¥å»ºè®¾ä¸€ä¸ª React Native ç»„ä»¶åº“ã€‚</p>
<p>è¿™æ˜¯ä¸€ç¯‡å¹²è´§æ¯”è¾ƒå¤šçš„ç»„ä»¶åº“æ­å»ºå®æˆ˜æ•™ç¨‹ï¼Œä¸ä»…æœ‰é€šç”¨çš„ä»£ç è§„èŒƒã€æäº¤è§„èŒƒã€æ–‡æ¡£ç»´æŠ¤ã€å•å…ƒæµ‹è¯•ã€GitHub Action é…ç½®çš„è®²è§£ï¼Œè¿˜æ¶‰åŠåŸºäº lerna çš„å¤šåŒ…ç®¡ç†æ¶æ„ã€React Native å›¾æ ‡åº“å»ºè®¾ã€React Native ç»„ä»¶åº“å¼€å‘è°ƒè¯•ã€æŒ‰éœ€åŠ è½½åŸç†åŠå®ç°ã€‚å·¥ç¨‹åŒ–çš„æ€æƒ³æ˜¯é€šç”¨çš„ï¼Œæ‰€ä»¥æ— è®ºæ˜¯ä½ ç”¨çš„æ¡†æ¶æ˜¯ä»€ä¹ˆï¼Œæœ¬æ–‡éƒ½å€¼å¾—ä¸€è¯»ã€‚</p>
<blockquote>
<p>å¦‚æœç”µè„‘å‰çš„æ˜å‹ä¹Ÿå¯¹ç»„ä»¶åº“å¼€å‘æ„Ÿå…´è¶£ï¼Œä¸å¦¨å…ˆç»™ä¸ªç‚¹èµï¼Œå†æŒç»­å…³æ³¨æ´›ç«¹å’Œå°é»‘çš„ç»„ä»¶åº“å¼€å‘ä¹‹æ—…ã€‚PSï¼šé…åˆ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fvant-react-native" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/vant-react-native" ref="nofollow noopener noreferrer">ä»“åº“</a>å’Œ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fvant-react-native.js.org%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://vant-react-native.js.org/" ref="nofollow noopener noreferrer">ç»„ä»¶åº“æ–‡æ¡£</a>é˜…è¯»æœ¬æ–‡æ•ˆæœæ›´ä½³å–²ï¼</p>
</blockquote>
<h2 data-id="heading-0">ç«™åœ¨ Vant Design çš„è‚©è†€ä¸Š</h2>
<p>ç»´æŠ¤å¼€å‘ä¸€ä¸ªç»„ä»¶åº“æ— ç–‘æ˜¯éœ€è¦æŠ•å…¥å¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›çš„ï¼ŒFlag ç«‹äº†å€’ï¼Œå€’äº†åˆç«‹ã€‚å¯è°“ä¸‡äº‹å¼€å¤´éš¾ï¼Œé¦–å…ˆæˆ‘ä»¬è¦æœ‰è‡ªçŸ¥ä¹‹æ˜ï¼Œåœ¨æ²¡æœ‰è®¾è®¡å¸ˆå’Œä¸šä½™å¼€å‘çš„æƒ…å†µä¸‹ï¼Œæˆ‘é€‰æ‹©äº†ç»™ç°æœ‰ UI Design å®ç° React Native ç‰ˆæœ¬çš„æ–¹å¼å¼€å¯ç»„ä»¶åº“å¼€å‘ä¹‹æ—…ã€‚åœ¨è°ƒç ”äº† <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyouzan%2Fvant" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youzan/vant" ref="nofollow noopener noreferrer">vant</a>ã€<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2FNSFI%2Ffishd-mobile%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/NSFI/fishd-mobile/" ref="nofollow noopener noreferrer">fishd-mobile</a> å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-mobile" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-mobile" ref="nofollow noopener noreferrer">antd-mobile</a> åæˆ‘é€‰æ‹©äº† vantã€‚è¿™æ˜¯å‡ ä¸ªä»“åº“çš„ç°çŠ¶å¯¹æ¯”ï¼š</p>

































<table><thead><tr><th>ç»„ä»¶åº“</th><th>å›¢é˜Ÿ</th><th>Github Star</th><th>Npm å‘¨ä¸‹è½½é‡</th><th>ç»´æŠ¤åº¦</th></tr></thead><tbody><tr><td>vant</td><td>æœ‰èµ</td><td>17.7K</td><td>27,789</td><td>ç»´é«˜åº¦é«˜ï¼Œæµè¡Œåº¦ä¹Ÿæ</td></tr><tr><td>antd-mobile</td><td>Ant Design Team</td><td>8.9K</td><td>31,470</td><td>å‡ ä¹ä¸ç»´æŠ¤ï¼Œæ®è¯´èš‚èšå†…éƒ¨ä¹Ÿä¸ç”¨äº†</td></tr><tr><td>fishd-mobile</td><td>ç½‘æ˜“äº‘å•†å‰ç«¯</td><td>29</td><td>22</td><td>çœ‹èµ·æ¥æ˜¯ä¸ª KPI é¡¹ç›®æ— ç–‘äº†</td></tr></tbody></table>
<p>ç¡®å®šäº†æ—…ç¨‹çš„æ–¹å‘ï¼Œå°±æ˜¯ç»™æˆ‘ä»¬çš„ç»„ä»¶åº“èµ·ä¸€ä¸ªåˆé€‚çš„åå­—å’Œå£å·ï¼Œç”¨å‰ç«¯å·¥ç¨‹å¸ˆçš„æ–¹å¼è¡¨è¿°å°±æ˜¯ <code>package.json</code> çš„ <code>name</code> å’Œ <code>description</code> å­—æ®µï¼š</p>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-comment">// package.json</span>
&#123;
    <span class="hljs-attr">"name"</span>: <span class="hljs-string">"vant-react-native"</span>,
    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Lightweight React Native UI Components inspired on Vant"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<blockquote>
<p>ç”±äºæˆ‘ä»¬çš„ç»„ä»¶åº“å®šä½æ˜¯ vant çš„ RN ç‰ˆï¼Œå‚ç…§ lottie-react-nativeã€styled-react-nativeã€jpush-react-native çš„å‘½åæ–¹å¼æˆ‘ä»¬å°†ç»„ä»¶åº“å‘½åä¸º vant-react-nativeï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¸Œæœ›ç»„ä»¶åº“å®Œæˆæ—¶èƒ½è·å¾— vant å®˜æ–¹çš„æ”¯æŒã€‚</p>
</blockquote>
<h2 data-id="heading-1">åŸºäº Lerna çš„å¤šåŒ…ç®¡ç†æ¶æ„</h2>
<p>Lerna æ˜¯ä¸€ä¸ªç®¡ç†å·¥å…·ï¼Œç”¨äºç®¡ç†åŒ…å«å¤šä¸ªè½¯ä»¶åŒ…ï¼ˆpackageï¼‰çš„ JavaScript é¡¹ç›®ã€‚ç”± Lerna ç®¡ç†çš„ä»“åº“æˆ‘ä»¬ä¸€èˆ¬ç§°ä¹‹ä¸ºå•ä½“ä»“åº“ï¼ˆmonorepoï¼‰ã€‚åŸºäº Lerna çš„å¤šåŒ…ç®¡ç†æ¶æ„çš„ä¼˜ç‚¹åœ¨äºï¼š</p>
<ul>
<li>ç»„ä»¶çº§åˆ«è§£è€¦ï¼Œç‹¬ç«‹ç‰ˆæœ¬æ§åˆ¶ï¼Œæ¯ä¸ªç»„ä»¶éƒ½æœ‰ç‰ˆæœ¬è®°å½•å¯è¿½æº¯</li>
<li>ç»„ä»¶å•ç‹¬å‘å¸ƒï¼Œæ”¯æŒç°åº¦ã€ç‰ˆæœ¬å›æ»šä»¥åŠå¹³æ»‘å‡é™çº§</li>
<li>æŒ‰éœ€å¼•ç”¨ï¼Œç”¨æˆ·å®‰è£…å…·ä½“æŸä¸ªç»„ä»¶åŒ…ï¼Œæ— éœ€é…ç½®å³å¯å®ç°æŒ‰éœ€åŠ è½½çš„æ•ˆæœã€‚</li>
<li>å…³æ³¨ç‚¹åˆ†ç¦»ï¼Œé™ä½å¤§å‹å¤æ‚åº¦ã€ç»„ä»¶ä¹‹é—´ä¾èµ–æ¸…æ™°ä¸”å¯æ§åˆ¶</li>
<li>å•ä¸€èŒè´£åŸåˆ™ï¼Œé™ä½å¼€æºåŸºå‹çš„å‚ä¸å’Œè´¡çŒ®éš¾åº¦</li>
</ul>
<pre><code class="hljs language-sh copyable" lang="sh">.
â””â”€â”€ packages
    â”œâ”€â”€ button <span class="hljs-comment"># @vant-react-native/button</span>
    â””â”€â”€ icons <span class="hljs-comment"># @vant-react-native/icon</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-2">åˆå§‹åŒ– lerna é¡¹ç›®</h3>
<pre><code class="hljs language-sh copyable" lang="sh">$ mkdir vant-react-native && lerna init --independent
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-3">yarn workspaces</h3>
<p>ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fyarnpkg.com%2Flang%2Fzh-Hans%2Fdocs%2Fworkspaces%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://yarnpkg.com/lang/zh-Hans/docs/workspaces/" ref="nofollow noopener noreferrer">yarn workspaces</a> ç»“åˆ Lerna <code>useWorkspaces</code> å¯ä»¥å®ç° <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Flerna%2Flerna%2Fblob%2Fmain%2Fdoc%2Fhoist.md" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/lerna/lerna/blob/main/doc/hoist.md" ref="nofollow noopener noreferrer">Lerna Hoisting</a>ã€‚è¿™å¹¶ä¸æ˜¯å¤šæ­¤ä¸€ä¸¾ï¼Œè¿™å¯ä»¥è®©ä½ åœ¨ç»Ÿä¸€çš„åœ°æ–¹ï¼ˆæ ¹ç›®å½•ï¼‰ç®¡ç†ä¾èµ–ï¼Œè¿™å³èŠ‚çœæ—¶é—´åˆèŠ‚çœç©ºé—´ã€‚</p>
<p>é…ç½® <code>lerna.json</code>:</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  ...
  <span class="hljs-attr">"npmClient"</span>: <span class="hljs-string">"yarn"</span>,
  <span class="hljs-attr">"useWorkspaces"</span>: <span class="hljs-literal">true</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ‰˜ç®¡ç»™ yarn wrokspace ä¹‹åï¼Œlerna çš„ <code>packages</code> å°†ä¼šè¢«é¡¶çº§ <code>package.json</code> çš„ <code>workspaces</code> è¦†ç›–:</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"private"</span>: <span class="hljs-literal">true</span>,
  ...
  <span class="hljs-attr">"workspaces"</span>: [
    <span class="hljs-string">"packages/*"</span>
  ],
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-4">lerna publish config</h3>
<p>å¦‚æœä½ ä¸æƒ³åœ¨æ‰€æœ‰ <code>package.json</code> æ–‡ä»¶ä¸­å•ç‹¬æ˜ç¡®è®¾ç½®ä½ çš„æ³¨å†Œè¡¨é…ç½®ï¼Œä¾‹å¦‚ä½¿ç”¨ç§æœ‰æ³¨å†Œè¡¨æ—¶ï¼Œè®¾ç½® <code>command.publish.registry</code> å¾ˆæœ‰ç”¨ã€‚é…ç½® <code>ignoreChanges</code> åˆ™æ˜¯ä¸ºäº†é¿å…ä¸å¿…è¦çš„ç‰ˆæœ¬å‡çº§ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-string">"ignoreChanges"</span>: [
  <span class="hljs-string">"ignored-file"</span>,
  <span class="hljs-string">"**/__tests__/**"</span>,
  <span class="hljs-string">"**/*.md"</span>
],
<span class="hljs-string">"command"</span>: &#123;
  <span class="hljs-attr">"publish"</span>: &#123;
    <span class="hljs-attr">"registry"</span>: <span class="hljs-string">"https://registry.npmjs.org"</span>
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<blockquote>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœä½ çš„åŒ…åæ˜¯å¸¦ scope çš„ï¼Œéœ€è¦åœ¨é‚£ä¸ªåŒ…çš„ <code>package.json</code> ä¸­è®¾ç½® <code>publishConfig.access</code> ä¸º <code>"public"</code>ã€‚</p>
</blockquote>
<h3 data-id="heading-5">lerna version config</h3>
<p>å½“é…ç½® <code>conventionalCommits</code> ä¸º <code>true</code> åï¼Œlerna ç‰ˆæœ¬å°†ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fconventionalcommits.org%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://conventionalcommits.org/" ref="nofollow noopener noreferrer">Conventional Commits Specification</a> æ¥ç¡®å®šç‰ˆæœ¬å‡çº§å¹¶ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fconventional-changelog%2Fconventional-changelog%2Ftree%2Fmaster%2Fpackages%2Fconventional-changelog-cli" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/conventional-changelog/conventional-changelog/tree/master/packages/conventional-changelog-cli" ref="nofollow noopener noreferrer">ç”Ÿæˆ CHANGELOG.md æ–‡ä»¶</a>ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-string">"command"</span>: &#123;
  <span class="hljs-attr">"version"</span>: &#123;
    <span class="hljs-attr">"conventionalCommits"</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">"message"</span>: <span class="hljs-string">"chore(release): publish"</span>
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-6">è§„èŒƒåŒ–æäº¤</h2>
<p>è§„èŒƒåŒ– <code>git commit</code> å¯¹äºæé«˜ <code>git log</code> å¯è¯»æ€§ã€å¯æ§çš„ç‰ˆæœ¬æ§åˆ¶å’Œ changelog ç”Ÿæˆéƒ½æœ‰ç€é‡è¦çš„ä½œç”¨ã€‚æ´›ç«¹ä¹‹å‰åœ¨ <a href="https://juejin.cn/post/6877462747631026190" target="_blank" title="https://juejin.cn/post/6877462747631026190">ä¸€æ–‡æå®šè§„èŒƒåŒ–Git Commit</a> ä¸­è¯¦ç»†è®²è¿°äº† Conventional Commits çš„æ¦‚å¿µä»¥åŠ commitizenã€cz-customizableã€@commitlint/cliã€yorkie å’Œ commitlint-config-cz ç­‰å·¥å…·çš„é…ç½®ã€‚</p>
<p>ç”±äºé…ç½®ç¹çï¼Œæˆ‘åœ¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fcli%23%25E4%25B8%2580%25E9%2594%25AE%25E9%2585%258D%25E7%25BD%25AE-conventional-commit" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/cli#%E4%B8%80%E9%94%AE%E9%85%8D%E7%BD%AE-conventional-commit" ref="nofollow noopener noreferrer">@youngjuning/cli</a> ä¸­æ·»åŠ äº† <code>init-commit</code> å‘½ä»¤ä¸€é”®é…ç½® conventional commitã€‚å¯ä»¥æ‰“å¼€è¿™ä¸ª <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fvant-react-native%2Fcommit%2Fd49f4203eacd37d3908306d309783ed5c11fb565" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/vant-react-native/commit/d49f4203eacd37d3908306d309783ed5c11fb565" ref="nofollow noopener noreferrer">commit</a> æŸ¥çœ‹é…ç½®ä¿¡æ¯ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼šhusky é«˜ç‰ˆæœ¬ç”¨æ³•ä¸å‘åå…¼å®¹ï¼Œæˆ‘åœ¨è¿™ä¸ª <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fvant-react-native%2Fcommit%2F174c7fd883dd5dc7a0c4f5d8fcb25ed605680b12" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/vant-react-native/commit/174c7fd883dd5dc7a0c4f5d8fcb25ed605680b12" ref="nofollow noopener noreferrer">commit</a> ä¸­ç”¨å°¤å¤§çš„ yorkie ä»£æ›¿äº† huskyã€‚</p>
</blockquote>
<h2 data-id="heading-7">ä»£ç è§„èŒƒåŒ–</h2>
<p>ä»£ç è§„èŒƒåŒ–çš„é‡è¦æ€§ä¸è¨€è€Œå–»ï¼Œä»£ç è§„èŒƒåŒ–æ¶‰åŠçš„å·¥å…·æœ‰ editorconfigã€eslintã€prettier ç­‰ï¼Œåœ¨ <a href="https://juejin.cn/post/6854573217320075278" target="_blank" title="https://juejin.cn/post/6854573217320075278">è£…å®ƒ|å†ä¹Ÿä¸ç”¨æ“å¿ƒESLinté…ç½®</a> ä¸€æ–‡ä¸­æˆ‘ä»‹ç»äº†å¦‚ä½•ä¸€æ­¥ä¸€æ­¥å»ºè®¾å±äºè‡ªå·±çš„ eslint config æ’ä»¶å¹¶äº§å‡ºäº† <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Feslint-config" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/eslint-config" ref="nofollow noopener noreferrer">@youngjuning/eslint-config</a> å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fprettier-config" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/prettier-config" ref="nofollow noopener noreferrer">@youngjuning/prettier-config</a>ã€‚</p>
<p>vant-react-native æš‚æ—¶ä½¿ç”¨ @youngjuning/eslint-configã€@youngjuning/prettier-config çº¦æŸé¡¹ç›®ä»£ç è§„èŒƒã€‚ç›¸å…³é…ç½®å¦‚ä¸‹æ–‡ã€‚</p>
<h3 data-id="heading-8">eslint</h3>
<p>é¦–å…ˆå®‰è£… react-native æ‰€éœ€çš„æ’ä»¶ã€‚</p>
<pre><code class="hljs language-sh copyable" lang="sh">yarn add -D eslint-plugin-react \
  eslint-plugin-react-hooks \
  eslint-plugin-jsx-a11y \
  eslint-plugin-import \
  eslint-plugin-react-native
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç„¶åé…ç½® <code>.eslintrc.js</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">// .eslintrc.js</span>
<span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">extends</span>: [<span class="hljs-string">'@youngjuning/eslint-config/react-native'</span>]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-9">prettier</h3>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">// .prettierrc.js</span>
<span class="hljs-built_in">module</span>.exports = <span class="hljs-built_in">require</span>(<span class="hljs-string">'@youngjuning/prettier-config'</span>);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<blockquote>
<p>@youngjuning/eslint-config è®¡åˆ’ä¹Ÿç”¨ lerna ç®¡ç†ï¼Œäº§å‡º @youngjuning/eslint-config-reactã€@youngjuning/eslint-config-react-nativeã€@youngjuning/eslint-config-vue è®©å¼€å‘è€…æ— éœ€è¿‡å¤šé…ç½®å¼€ç®±å³ç”¨ã€‚</p>
</blockquote>
<h3 data-id="heading-10">editorconfig</h3>
<pre><code class="copyable"># .editorconfig
# EditorConfig is awesome: http://EditorConfig.org

# top-most EditorConfig file
root = true

# Unix-style newlines with a newline ending every file
[*]
indent_style = space
indent_size = 2
end_of_line = lf
charset = utf-8
trim_trailing_whitespace = true
insert_final_newline = true

[*.md]
trim_trailing_whitespace = false

[*.gradle]
indent_size = 4

[BUCK]
indent_size = 4
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-11">yorkie & lint-staged</h3>
<pre><code class="hljs language-sh copyable" lang="sh">$ yarn add -D yorkie lint-staged
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"gitHooks"</span>: &#123;
    <span class="hljs-attr">"commit-msg"</span>: <span class="hljs-string">"commitlint -e -V"</span>,
    <span class="hljs-attr">"pre-commit"</span>: <span class="hljs-string">"lint-staged"</span>
  &#125;,
  <span class="hljs-attr">"lint-staged"</span>: &#123;
    <span class="hljs-attr">"**/*.&#123;js,jsx,ts,tsx&#125;"</span>: [
      <span class="hljs-string">"eslint --fix"</span>,
      <span class="hljs-string">"git add ."</span>
    ]
  &#125;,
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-12">ç¬¬ä¸€ä¸ªç»„ä»¶ä» Icon å¼€å§‹</h2>
<p>ä¸€ä¸ªæˆç†Ÿçš„ç»„ä»¶åº“éƒ½ä¼šæ‹¥æœ‰è‡ªå·±çš„ä¸€å¥— Iconï¼ŒIcon ä¸€èˆ¬ç”±è®¾è®¡å¸ˆé€šè¿‡ Sketch è®¾è®¡ï¼Œç„¶åå¯¼å‡º svg æ–‡ä»¶ã€‚</p>
<p>ant-design-icons çš„ svg æ–‡ä»¶æ˜¯ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-icons%2Ftree%2Fmaster%2Fpackages%2Ficons-svg%2Fsvg%2Ffilled" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-icons/tree/master/packages/icons-svg/svg/filled" ref="nofollow noopener noreferrer">ä¿å­˜åœ¨æœ¬åœ°</a>ï¼Œç„¶åé€šè¿‡è„šæœ¬ç”Ÿæˆ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-icons%2Ftree%2Fmaster%2Fpackages%2Ficons-react%2Fsrc%2Ficons" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-icons/tree/master/packages/icons-react/src/icons" ref="nofollow noopener noreferrer">react ç»„ä»¶</a>ã€<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-icons%2Ftree%2Fmaster%2Fpackages%2Ficons-vue" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-icons/tree/master/packages/icons-vue" ref="nofollow noopener noreferrer">vue ç»„ä»¶</a> å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-icons%2Ftree%2Fmaster%2Fpackages%2Ficons-react-native" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-icons/tree/master/packages/icons-react-native" ref="nofollow noopener noreferrer">icons-react-native</a> ç­‰ç»„ä»¶ï¼Œç”±äºæ”¯æŒçš„æ¡†æ¶æ¯”è¾ƒå®Œå¤‡æˆ‘ä»¬æ— éœ€è‡ªå·±å®ç°ï¼ŒRN æˆ‘ä»¬ç›´æ¥ä½¿ç”¨ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-icons%2Ftree%2Fmaster%2Fpackages%2Ficons-react-native" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-icons/tree/master/packages/icons-react-native" ref="nofollow noopener noreferrer">icons-react-native</a>ã€‚</p>
<p>vant ä»¥åŠ fishd-mobile åˆ™æ˜¯é€šè¿‡ Iconfont ç»´æŠ¤ svg æ–‡ä»¶ï¼Œç„¶åé€šè¿‡è®¾ç½® <code>@font-face</code> çš„æ–¹å¼å®ç° Icon ç»„ä»¶ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b3f6212f0124f4fab8b70dfeeb40c25~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>æœ‰äº† ttf æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥åƒ @ant-design/icons-react-native ä¸€æ ·åŸºäº ttf æ–‡ä»¶ä½¿ç”¨è„šæœ¬ç”Ÿæˆ Icon ç»„ä»¶ï¼Œä½†æ˜¯ä½¿ç”¨ ttf å­—ä½“æœ‰ä¸€ä¸ªå¼Šç«¯ï¼Œå°±æ˜¯æ¯æ¬¡æ›´æ–°å›¾æ ‡ï¼Œéƒ½è¦ç›¸åº”çš„æ›´æ–° ttf æ–‡ä»¶ï¼Œç„¶åå†æ¬¡æ‰“åŒ…å‘å¸ƒ APPã€‚è€Œä¸” ttf ä¸æ”¯æŒå¤šç§è‰²å½©çš„å›¾æ ‡ï¼Œå¯¼è‡´æ‰€æœ‰å›¾æ ‡éƒ½æ˜¯å•è‰²ã€‚å¦‚æœä½ æ˜¯å€ŸåŠ© react-native-vector-iconsï¼Œè¯¥åº“å†…ç½®äº† 10 å¤šå¥— ttf æ–‡ä»¶ï¼Œåˆèµ·æ¥æœ‰ 2M å·¦å³ï¼›ä½ å¯èƒ½ç”¨ä¸åˆ°å®ƒä»¬ï¼Œä½†æ˜¯å®ƒä»¬ä»ç„¶ä¼šè¢«æ‰“åŒ…è¿›ä½ çš„ APP é‡Œï¼Œè¿™ä¹Ÿæ˜¯æˆ‘è®¤ä¸º react-native-elements è¿™ä¸ªåº“å¤–å¼ºä¸­å¹²çš„ä¸€å¤§åŸå› ã€‚</p>
<p>é‚£ä¹ˆåªæœ‰ Iconfont é“¾æ¥æˆ‘ä»¬å¦‚ä½•å®ç° vant-icons çš„ React Native ç‰ˆæœ¬å‘¢ï¼Ÿè¿™é‡Œæ´›ç«¹æ²¡æœ‰è‡ªå·±å†™è„šæœ¬ï¼Œè€Œæ˜¯ä½¿ç”¨äº†ä¸€æ¬¾å« react-native-iconfont-cli çš„å·¥å…·ï¼Œ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffwh1990" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/fwh1990" ref="nofollow noopener noreferrer">fwh1990</a> å¤§ä½¬é’ˆå¯¹ä»¥ä¸Šç—›ç‚¹ç”¨çº¯ Javascript å®ç° iconfont åˆ° React ç»„ä»¶çš„è½¬æ¢æ“ä½œï¼Œä¸éœ€è¦ä¾èµ– ttf å­—ä½“æ–‡ä»¶ï¼Œä¸éœ€è¦æ‰‹åŠ¨ä¸‹è½½å›¾æ ‡åˆ°æœ¬åœ°ã€‚</p>
<h3 data-id="heading-13">åˆ›å»º lerna å­åŒ…</h3>
<pre><code class="hljs language-sh copyable" lang="sh"><span class="hljs-comment"># åˆ›å»ºä¸»åŒ…ï¼Œä¸»åŒ…ç”¨æ¥ç»Ÿä¸€å¯¼å‡ºæ‰€æœ‰çš„ç»„ä»¶</span>
$ lerna create vant-react-native -y
<span class="hljs-comment"># åˆ›å»º icons åŒ…ï¼Œæˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªç»„ä»¶ï¼</span>
$ lerna create @vant-react-native/icons -y
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æˆ‘ä»¬çš„ç›®å½•ç»“æ„çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="hljs language-sh copyable" lang="sh">.
â””â”€â”€ packages
    â”œâ”€â”€ icons
    â”‚Â Â  â”œâ”€â”€ README.md
    â”‚Â Â  â””â”€â”€ package.json
    â””â”€â”€ vant-react-native
        â”œâ”€â”€ README.md
        â””â”€â”€ package.json
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-14">ç”Ÿæˆ icons</h3>
<h4 data-id="heading-15">å®‰è£…æ’ä»¶</h4>
<pre><code class="hljs language-sh copyable" lang="sh">yarn workspace @vant-react-native/icons add -D react-native-svg react-native-iconfont-cli
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-16">ç”Ÿæˆé…ç½®æ–‡ä»¶</h4>
<p>æˆ‘ä»¬åœ¨ <code>packages/icons</code> ç›®å½•ä¸‹ä½¿ç”¨ <code>npx iconfont-init</code> å‘½ä»¤ä¼šç”Ÿæˆ <code>iconfont.json</code> æ–‡ä»¶ï¼Œè‡ªå®šä¹‰åå†…å®¹å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"symbol_url"</span>: <span class="hljs-string">"https://at.alicdn.com/t/font_2553510_7cds497uxwn.js"</span>,
  <span class="hljs-attr">"use_typescript"</span>: <span class="hljs-literal">false</span>,
  <span class="hljs-attr">"save_dir"</span>: <span class="hljs-string">"./lib"</span>,
  <span class="hljs-attr">"trim_icon_prefix"</span>: <span class="hljs-string">"van-icon"</span>,
  <span class="hljs-attr">"default_icon_size"</span>: <span class="hljs-number">18</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-17">ç”Ÿæˆ React Native æ ‡å‡†ç»„ä»¶</h4>
<p>æ‰§è¡Œ <code>npx iconfont-rn</code> å‘½ä»¤å³å¯ç”Ÿæˆæ ‡å‡† React Native ç»„ä»¶ã€‚ç”±äºå›¾æ ‡æ–‡ä»¶æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬ä¸å°†å›¾æ ‡äº§ç‰©åŠ å…¥ git ç®¡ç†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ npm å‘å¸ƒå‰æ‰§è¡Œæ„å»ºå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"build"</span>: <span class="hljs-string">"npx iconfont-rn"</span>,
  <span class="hljs-attr">"prepublishOnly"</span>: <span class="hljs-string">"yarn build"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-18">é…ç½® react-native-vant</h3>
<p>æˆ‘ä»¬å‰é¢æåˆ° <code>packages/vant-react-native</code> æ˜¯ä¸»åŒ…çš„ç›®å½•ï¼Œæˆ‘ä»¬éœ€è¦å°† <code>@vant-react-native/icons</code> åŒ…æ·»åŠ åˆ°ä¸»åŒ…çš„ä¾èµ–ä¸­å¹¶å¯¼å‡ºã€‚</p>
<h4 data-id="heading-19">æ·»åŠ ä¾èµ–</h4>
<pre><code class="hljs language-sh copyable" lang="sh">$ lerna add @vant-react-native/icons --scope vant-react-native
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-20">å¯¼å‡º Icon ç»„ä»¶</h4>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">// packages/vant-react-native/src/index.ts</span>
<span class="hljs-keyword">export</span> &#123; <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> Icon &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-21">tsconfig é…ç½®</h4>
<p>å¯¹ä¸æ¯ä¸ªå­åŒ…æˆ‘ä»¬æœŸæœ›ä½¿ç”¨ä¸€æ ·çš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå…ˆåœ¨æ•´ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•æ–°å»º <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fvant-react-native%2Fblob%2Fmain%2Ftsconfig.base.json" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/vant-react-native/blob/main/tsconfig.base.json" ref="nofollow noopener noreferrer">tsconfig. base.json</a>ï¼Œåœ¨å­åŒ…ç»§æ‰¿å³å¯ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"extends"</span>: <span class="hljs-string">"../../tsconfig.base.json"</span>,
  <span class="hljs-attr">"compilerOptions"</span>: &#123;
    <span class="hljs-attr">"outDir"</span>: <span class="hljs-string">"lib"</span>,
  &#125;,
  <span class="hljs-attr">"include"</span>: [<span class="hljs-string">"src/**/*"</span>]
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-22">é…ç½®å‘å¸ƒè„šæœ¬</h4>
<p>å’Œ <code>@vant-react-native/icons</code> å­åŒ…ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  <code>build</code> å’Œ <code>prepublishOnly</code> è„šæœ¬ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"build"</span>: <span class="hljs-string">"tsc"</span>,
  <span class="hljs-attr">"prepublishOnly"</span>: <span class="hljs-string">"yarn build"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-23">å‘å¸ƒåŒ…</h3>
<p>ç¬¬ä¸€æ¬¡å‘å¸ƒçš„è¯ï¼Œæ³¨æ„ä½¿ç”¨çš„æ˜¯ <code>lerna publish 0.0.1</code>ï¼Œå› ä¸º lerna çš„å‘å¸ƒå‘½ä»¤æ²¡æœ‰ç¬¬ä¸€æ¬¡å‘å¸ƒè¿™ä¸ªå‚æ•°ï¼Œæ‰€ä»¥éœ€è¦æ˜¾ç¤ºæŒ‡å®šåˆå§‹ç‰ˆæœ¬ã€‚æˆ–è€…å¯ä»¥å°†åˆå§‹ç‰ˆæœ¬è®¾ç½®ä¸º <code>0.0.0</code> ç„¶åæ‰§è¡Œ <code>lerna publish</code>ã€‚</p>
<blockquote>
<p>å°æŠ€å·§ï¼šå¦‚æœå‘å¸ƒåæƒ³æŸ¥çœ‹åŒ…å†…å®¹ï¼Œå¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.jsdelivr.com%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://www.jsdelivr.com/" ref="nofollow noopener noreferrer">jsdelivr</a> æŸ¥çœ‹ã€‚æ¯”å¦‚åˆšå‘å¸ƒçš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcdn.jsdelivr.net%2Fnpm%2Fvant-react-native%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://cdn.jsdelivr.net/npm/vant-react-native/" ref="nofollow noopener noreferrer">vant-react-native</a> å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fcdn.jsdelivr.net%2Fnpm%2F%40vant-react-native%2Ficons%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://cdn.jsdelivr.net/npm/@vant-react-native/icons/" ref="nofollow noopener noreferrer">@vant-react-native/icons</a></p>
</blockquote>
<h2 data-id="heading-24">å¼€å‘è°ƒè¯•</h2>
<p>ä¸€ä¸ªå®Œå–„ä¸”ä½“éªŒè‰¯å¥½çš„è°ƒè¯•æµç¨‹ä¸ä»…èƒ½å¤Ÿæ»¡è¶³åœ¨å¼€å‘é˜¶æ®µéªŒè¯ç»„ä»¶æ˜¯å¦ç¬¦åˆé¢„æœŸï¼Œè¿˜å¯ä»¥é™ä½å¼€æºç¤¾åŒºåŸºå‹çš„å‚ä¸éš¾åº¦ã€‚React Native ç»„ä»¶åº“çš„è°ƒè¯•å’Œå…¶ä»–æŠ€æœ¯æ ˆæµç¨‹å¤§ä½“æ²¡æœ‰åŒºåˆ«ï¼Œåªä¸è¿‡å› ä¸º <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Fmetro%2Fissues%2F1" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/facebook/metro/issues/1" ref="nofollow noopener noreferrer">Metro ä¸æ”¯æŒè½¯è¿æ¥</a> ä»¥åŠ vant-react-native æ˜¯åŸºäº lerna çš„å•ä½“ä»“åº“é¡¹ç›®ï¼Œæˆ‘ä»¬çš„é…ç½®ä¼šæœ‰ä¸åŒã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f3856a691a73409c8533fa9dd1966357~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-25">åˆå§‹åŒ– React Native App</h3>
<p>ç”±äºæ˜¯ React Native é¡¹ç›®ï¼Œæˆ‘ä»¬éœ€è¦åˆå§‹åŒ–ä¸€ä¸ª React Native é¡¹ç›®ã€‚é¦–å…ˆæ‰¾ä¸€ä¸ªåœ°æ–¹ä½¿ç”¨ <code>react-native init vantapp --template react-native-template-typescript</code> åˆ›å»ºä¸€ä¸ªæ–°çš„ React Native Appã€‚ç„¶åå°†ç”Ÿæˆçš„ App ä¸æˆ‘ä»¬çš„ä¸»é¡¹ç›®åˆå¹¶ã€‚åˆå¹¶åçš„é¡¹ç›®ç»“æ„å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-sh copyable" lang="sh">.
â”œâ”€â”€ App.tsx
â”œâ”€â”€ __tests__
â”‚   â””â”€â”€ App-test.tsx
â”œâ”€â”€ android
â”‚   â”œâ”€â”€ app
â”‚   â”œâ”€â”€ build.gradle
â”‚   â”œâ”€â”€ gradle
â”‚   â”œâ”€â”€ gradle.properties
â”‚   â”œâ”€â”€ gradlew
â”‚   â”œâ”€â”€ gradlew.bat
â”‚   â””â”€â”€ settings.gradle
â”œâ”€â”€ app.json
â”œâ”€â”€ babel.config.js
â”œâ”€â”€ commitlint.config.js
â”œâ”€â”€ index.js
â”œâ”€â”€ ios
â”‚   â”œâ”€â”€ Podfile
â”‚   â”œâ”€â”€ Podfile.lock
â”‚   â”œâ”€â”€ Pods
â”‚   â”œâ”€â”€ vantapp
â”‚   â”œâ”€â”€ vantapp.xcodeproj
â”‚   â”œâ”€â”€ vantapp.xcworkspace
â”‚   â””â”€â”€ vantappTests
â”œâ”€â”€ lerna.json
â”œâ”€â”€ metro.config.js
â”œâ”€â”€ package.json
â”œâ”€â”€ packages
â”‚   â”œâ”€â”€ icons
â”‚   â””â”€â”€ vant-react-native
â”œâ”€â”€ tsconfig.base.json
â”œâ”€â”€ tsconfig.json
â””â”€â”€ yarn.lock
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä¸»è¦å†²çªçš„æ˜¯ Prettierã€eslint ç­‰å·¥å…·çš„é…ç½®ï¼Œåˆå¹¶æ²¡é‚£ä¹ˆéš¾ã€‚åœ¨è¿è¡Œé¡¹ç›®ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸€èˆ¬éœ€è¦ç¼–è¯‘é¡¹ç›®ã€‚æˆ‘ä»¬å¯ä»¥å€ŸåŠ© <code>lerna run build</code> å‘½ä»¤æ‰¹é‡è¿è¡Œå­åŒ…é‡Œçš„ <code>build</code> npm scriptã€‚</p>
<blockquote>
<p>æ³¨æ„ğŸ“¢ï¼šç”±äºå­åŒ…ä¹‹é—´æœ‰ä¾èµ–å…³ç³»ï¼Œä¸è¦ä½¿ç”¨ <code>--parallel</code> å‚æ•°å¹¶è¡Œæ‰§è¡Œæ‰“åŒ…è„šæœ¬ã€‚</p>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªä¹å®«æ ¼ Demo éªŒè¯ä¸€ä¸‹ï¼š</p>
<pre><code class="hljs language-tsx copyable" lang="tsx"><span class="hljs-comment">// App.tsx</span>
<span class="hljs-keyword">import</span> React, &#123; Component &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> &#123; View, Text, SafeAreaView, ScrollView &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> &#123; Icon &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'vant-react-native'</span>;
<span class="hljs-comment">// æˆ‘ä»¬ä¹Ÿå¯ä»¥åªå®‰è£… @vant-react-native/icons åŒ…</span>
<span class="hljs-comment">// import &#123; VanIconAdd &#125; from '@vant-react-native/icons'</span>

<span class="hljs-keyword">type</span> IconNameType = React.ComponentProps<<span class="hljs-keyword">typeof</span> Icon>[<span class="hljs-string">'name'</span>];

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>&#123;
  <span class="hljs-function"><span class="hljs-title">render</span>(<span class="hljs-params"></span>)</span> &#123;
    <span class="hljs-keyword">return</span> (
      <span class="xml"><span class="hljs-tag"><<span class="hljs-name">SafeAreaView</span>></span>
        <span class="hljs-tag"><<span class="hljs-name">ScrollView</span>></span>
          <span class="hljs-tag"><<span class="hljs-name">Text</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">textAlign:</span> '<span class="hljs-attr">center</span>', <span class="hljs-attr">paddingVertical:</span> <span class="hljs-attr">20</span>, <span class="hljs-attr">fontSize:</span> <span class="hljs-attr">25</span>, <span class="hljs-attr">color:</span> '#<span class="hljs-attr">007fff</span>' &#125;&#125;
          ></span>
            vant-react-native
          <span class="hljs-tag"></<span class="hljs-name">Text</span>></span>
          <span class="hljs-tag"><<span class="hljs-name">View</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">flexWrap:</span> '<span class="hljs-attr">wrap</span>', <span class="hljs-attr">flexDirection:</span> '<span class="hljs-attr">row</span>' &#125;&#125;></span>
            &#123;data.map((item, index) => &#123;
              const lastLineLength = data.length % 4 || 4;
              return (
                <span class="hljs-tag"><<span class="hljs-name">View</span>
                  <span class="hljs-attr">key</span>=<span class="hljs-string">&#123;item&#125;</span>
                  <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span>
                    <span class="hljs-attr">width:</span> '<span class="hljs-attr">25</span>%',
                    <span class="hljs-attr">marginBottom:</span> <span class="hljs-attr">index</span> < <span class="hljs-attr">data.length</span> <span class="hljs-attr">-</span> <span class="hljs-attr">lastLineLength</span> ? <span class="hljs-attr">40</span> <span class="hljs-attr">:</span> <span class="hljs-attr">0</span>,
                    <span class="hljs-attr">alignItems:</span> '<span class="hljs-attr">center</span>',
                  &#125;&#125;
                ></span>
                  <span class="hljs-tag"><<span class="hljs-name">Icon</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&#123;item&#125;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&#123;40&#125;</span> /></span>
                  <span class="hljs-tag"><<span class="hljs-name">Text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">&#123;&#123;</span> <span class="hljs-attr">color:</span> '#<span class="hljs-attr">646566</span>', <span class="hljs-attr">marginTop:</span> <span class="hljs-attr">10</span> &#125;&#125;></span>&#123;item&#125;<span class="hljs-tag"></<span class="hljs-name">Text</span>></span>
                <span class="hljs-tag"></<span class="hljs-name">View</span>></span>
              );
            &#125;)&#125;
          <span class="hljs-tag"></<span class="hljs-name">View</span>></span>
        <span class="hljs-tag"></<span class="hljs-name">ScrollView</span>></span>
      <span class="hljs-tag"></<span class="hljs-name">SafeAreaView</span>></span></span>
    );
  &#125;
&#125;

<span class="hljs-keyword">const</span> data: IconNameType[] = [<span class="hljs-string">'location-o'</span>, <span class="hljs-string">'like-o'</span>, <span class="hljs-string">'star-o'</span>, <span class="hljs-string">'phone-o'</span>, <span class="hljs-string">'setting-o'</span>, <span class="hljs-string">'fire-o'</span>, <span class="hljs-string">'coupon-o'</span>, <span class="hljs-string">'cart-o'</span>, <span class="hljs-string">'shopping-cart-o'</span>, <span class="hljs-string">'cart-circle-o'</span>, <span class="hljs-string">'friends-o'</span>, <span class="hljs-string">'comment-o'</span>, <span class="hljs-string">'gem-o'</span>, <span class="hljs-string">'gift-o'</span>, <span class="hljs-string">'point-gift-o'</span>, <span class="hljs-string">'send-gift-o'</span>, <span class="hljs-string">'service-o'</span>, <span class="hljs-string">'bag-o'</span>, <span class="hljs-string">'todo-list-o'</span>, <span class="hljs-string">'balance-list-o'</span>, <span class="hljs-string">'close'</span>, <span class="hljs-string">'clock-o'</span>, <span class="hljs-string">'question-o'</span>, <span class="hljs-string">'passed'</span>];
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç„¶åæ‰§è¡Œ <code>yarn ios</code> æŸ¥çœ‹å®é™…æ•ˆæœï¼ˆä¹‹åæˆ‘ä»¬å°±å¯ä»¥æ‰§è¡Œ <code>yarn start --reset-cache</code> å¿«é€Ÿå¼€å§‹è°ƒè¯•ï¼‰ï¼š</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d2828ea83804d3bb53a0563eaf429bd~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ç›´æ¥ä½¿ç”¨äº† <code>import &#123; Icon &#125; from 'vant-react-native';</code> è€Œä¸æ˜¯ç›¸å¯¹è·¯å¾„å¼•ç”¨ packages ä¸‹çš„æ¨¡å—ã€‚å¯æ˜¯æˆ‘ä»¬çš„é¡¹ç›®å¹¶æ²¡ä¸å®‰è£…è¿™ä¸ªä¾èµ–ï¼Œç¼–è¯‘å™¨æ˜¯æ€ä¹ˆæ‰¾åˆ°çš„å‘¢ï¼Ÿè¿™é‡Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆé“¶å¼¹ï¼Œè¿™æ˜¯å› ä¸º lerna ä¼šæŠŠå­åŒ…è½¯é“¾æ¥åˆ° node_modules ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>ls -al</code> å‘ç°çœ‹åˆ°åŒ…çš„å®é™…æŒ‡å‘ï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7857ecd166a74331befe791dc677257b~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ç±»å‹æç¤ºä¸­çœ‹åˆ°å®é™…æŒ‡å‘çš„æ˜¯ packages ä¸‹çš„æ–‡ä»¶ï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ba82260550904406b4224734761c2f5e~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<blockquote>
<p>æ³¨æ„ğŸ“¢ï¼š<a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Fmetro%2Fissues%2F1" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/facebook/metro/issues/1" ref="nofollow noopener noreferrer">Metro ä¸æ”¯æŒç¬¦å·é“¾æ¥</a> æŒ‡çš„æ˜¯è½¯è¿æ¥çš„ç›®å½•ä¸åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼Œè¿™é‡Œæˆ‘ä»¬è½¯è¿æ¥æŒ‡å‘çš„ä½ç½®è¿˜åœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥å¯ä»¥æ­£ç¡®å·¥ä½œâœ…ã€‚è¿™ä¸ªç‰¹æ€§ä¿è¯äº†è°ƒè¯•ä¸ç”Ÿäº§å¼€å‘çš„ä¸€è‡´æ€§å’Œä¾¿åˆ©æ€§ã€‚</p>
</blockquote>
<h3 data-id="heading-26">å®æ—¶ç¼–è¯‘</h3>
<p>ç°åœ¨æˆ‘ä»¬çš„è°ƒè¯•æµç¨‹æ˜¯ï¼š</p>
<ol>
<li>ä¿®æ”¹ä»£ç </li>
<li>æ‰§è¡Œ <code>lerna run build</code> ç¼–è¯‘æ¯ä¸ªå­åŒ…</li>
<li>æ‰§è¡Œ <code>yarn ios</code> è°ƒè¯•é¡¹ç›®</li>
<li>ä¿®æ”¹ä»£ç </li>
<li>æ‰§è¡Œ <code>lerna run build</code> é‡æ–°ç¼–è¯‘</li>
<li>æ‰§è¡Œ <code>yarn start --reset-cache</code> è¿è¡Œé¡¹ç›®</li>
<li>å¾ªç¯ 4ã€5ã€6ã€‚</li>
</ol>
<p>å°½ç®¡ React Native æœ‰ Fast Refresh åŠŸèƒ½ï¼Œä½†æ˜¯ç”±äºæˆ‘ä»¬çš„ä»£ç æ˜¯éœ€è¦ç¼–è¯‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é‡å¤ç¼–è¯‘è¿è¡Œçš„åŠ¨ä½œã€‚</p>
<p>ä»»ä½•é‡å¤çš„å·¥ä½œéƒ½å¯ä»¥ç”¨è„šæœ¬ä»£æ›¿ã€‚é¦–å…ˆæˆ‘ä»¬éœ€è¦ç»™æ¯ä¸ªå­åŒ…æ·»åŠ å®æ—¶ç¼–è¯‘çš„ scriptï¼Œåƒ rollupã€babelã€webpackã€typescript éƒ½æœ‰å‚æ•°å¯ä»¥å®ç°å®æ—¶ç¼–è¯‘ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"dev"</span>: <span class="hljs-string">"tsc -w"</span>,
    <span class="hljs-attr">"build"</span>: <span class="hljs-string">"tsc"</span>,
    <span class="hljs-attr">"prepublishOnly"</span>: <span class="hljs-string">"yarn build"</span>
  &#125;,
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è€Œæˆ‘ä»¬çš„ @vant-react-native/icons åŒ…ä½¿ç”¨çš„ <code>npx iconfont</code> æ²¡æœ‰å®æ—¶ç¼–è¯‘é€‰é¡¹ï¼Œç»è¿‡è°ƒç ”ï¼Œæˆ‘å¼•å…¥äº† <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fonchange" target="_blank" rel="nofollow noopener noreferrer" title="https://www.npmjs.com/package/onchange" ref="nofollow noopener noreferrer">onchange</a> è¿™ä¸ªåº“å¯ä»¥åŸºäº glob æ¨¡å¼ç›‘å¬æ–‡ä»¶æ”¹åŠ¨åæ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"dev"</span>: <span class="hljs-string">"onchange -i 'iconfont.json' -- yarn build"</span>,
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç„¶åæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>lerna run dev --parallel</code> æ‰¹é‡æ‰§è¡Œå®æ—¶ç¼–è¯‘è„šæœ¬ï¼Œè¿™é‡ŒåŠ  <code>--parallel</code> æ˜¯å› ä¸ºå­åŒ…å¦‚æœæ˜¯å®æ—¶ç¼–è¯‘ï¼Œè¿›ç¨‹ä¼šå¡ä½ã€‚ä¸ºäº†è¡¥æ•‘ï¼Œæˆ‘ä»¬ä¸å¾—ä¸é¢„å…ˆç¼–è¯‘ <code>@vant-react-native/icons</code> åŒ…ï¼Œç„¶åå› ä¸ºåŒæ ·çš„åŸå› æˆ‘å¼•å…¥äº† <code>npm-run-all</code> æ¥å¹¶è¡Œæ‰§è¡Œ <code>lerna run dev</code> å’Œ <code>react-native start</code>ï¼Œå®Œæ•´è„šæœ¬å¦‚ä¸‹ï¼š</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"predev"</span>: <span class="hljs-string">"lerna run build --scope @vant-react-native/icons"</span>,
  <span class="hljs-attr">"dev"</span>: <span class="hljs-string">"lerna run dev --parallel"</span>,
  <span class="hljs-attr">"start"</span>: <span class="hljs-string">"react-native start"</span>,
  <span class="hljs-attr">"debug"</span>: <span class="hljs-string">"run-p dev start"</span>,
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h2 data-id="heading-27">æŒ‰éœ€åŠ è½½</h2>
<blockquote>
<p>å°é»‘ï¼šâ€œæ´›ç«¹å“¥å“¥ï¼Œæˆ‘ä¹‹å‰ä¸ºäº†ä½¿ç”¨ react-native-elements çš„å…¶ä¸­å‡ ä¸ªç»„ä»¶è€Œå¼•å…¥äº†æ•´ä¸ªç»„ä»¶åº“ã€‚å› ä¸ºè¿™ä¸ªç»„ä»¶åº“ä¾èµ–äº† react-native-vector-icons å¯¼è‡´ bundle åŒ…å˜å¤§ã€‚å¦‚æœæˆ‘å°±æ˜¯æƒ³ç”¨æ•´å¥— vant-react-nativeï¼Œå¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿâ€</p>
</blockquote>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼ŒReact Native çš„æ‰“åŒ…å·¥å…· Metro <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Ffacebook%2Fmetro%2Fissues%2F227%23issuecomment-583358386" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/facebook/metro/issues/227#issuecomment-583358386" ref="nofollow noopener noreferrer">ä¸æ”¯æŒ tree-shaking</a>ã€‚è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹å¼å…¶å®å¾ˆç®€å•ï¼Œæœºæ™ºçš„ä½ å¯èƒ½çŸ¥é“é…åˆ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.npmjs.com%2Fpackage%2Fbabel-plugin-import" target="_blank" rel="nofollow noopener noreferrer" title="https://www.npmjs.com/package/babel-plugin-import" ref="nofollow noopener noreferrer">babel-plugin-import</a> æ˜¯å¯ä»¥å®ç°æŒ‰éœ€åŠ è½½çš„éœ€æ±‚çš„ã€‚ä½†ç”±äºæˆ‘ä»¬æ˜¯å¤šåŒ…ç®¡ç†æ¶æ„ï¼Œéœ€è¦é’ˆå¯¹å¤šåŒ…çš„æ¶æ„è®¾è®¡ä¸€ä¸ªæ–¹æ¡ˆã€‚</p>
<h3 data-id="heading-28">react-naitve bundle åŒ…</h3>
<p>ä¸ºäº†æ¯”å¯¹ä¼˜åŒ–å‰ååŒ…å¤§å°ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>react-native bundle</code> å‘½ä»¤çœ‹ä¸€ä¸‹çº¯ JS åŒ…çš„å¤§å°ï¼Œæˆ‘ä»¬æ¥ç®€å•çœ‹ä¸‹è¿™ä¸ªå‘½ä»¤ï¼š</p>
<pre><code class="hljs language-sh copyable" lang="sh">react-native bundle --platform ios --entry-file index.js --bundle-output ./bundle/ios/index.ios.jsbundle --assets-dest ./bundle/ios --dev <span class="hljs-literal">false</span> --reset-cache
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li><code>--entry</code>ï¼šå…¥å£ js æ–‡ä»¶</li>
<li><code>--bundle-output</code>ï¼šç”Ÿæˆçš„ bundle æ–‡ä»¶è·¯å¾„</li>
<li><code>--platform</code>ï¼šå¹³å°</li>
<li><code>--assets-dest</code>ï¼šå›¾ç‰‡èµ„æºçš„è¾“å‡ºç›®å½•</li>
<li><code>--dev</code>ï¼šæ˜¯å¦ä¸ºå¼€å‘ç‰ˆæœ¬ï¼Œæ‰“æ­£å¼ç‰ˆçš„å®‰è£…åŒ…æ—¶æˆ‘ä»¬å°†å…¶èµ‹å€¼ä¸º false</li>
<li><code>--reset-cache</code>ï¼šé‡ç½®ç¼“å­˜ï¼Œé¿å…æ‰“åŒ…ä½¿ç”¨æ—§çš„ç¼“å­˜</li>
</ul>
<h3 data-id="heading-29">æŒ‰éœ€åŠ è½½åŸç†</h3>
<p>å‰é¢æˆ‘ä»¬æåˆ° <code>packages/vant-react-native</code> åªæœ‰ä¸€ä¸ªæ–‡ä»¶ <code>src/index.ts</code> ç”¨æ¥å¯¼å‡ºæ‰€æœ‰å­åŒ…ï¼Œç°åœ¨æˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–°çš„åŒ… Buttonï¼Œçœ‹ä¸Šå»å°±æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">export</span> &#123; <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> Icon &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="hljs-keyword">export</span> &#123; <span class="hljs-keyword">default</span> <span class="hljs-keyword">as</span> Button &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿™ç§å¯¼å‡ºæ–¹å¼ï¼Œç”¨æˆ·åªèƒ½é€šè¿‡ <code>import Button from '@vant-react-native/button';</code> æˆ– <code>import Button from 'vant-react-native/lib/button';</code> çš„æ–¹å¼æ‰‹åŠ¨å®ç°æŒ‰éœ€åŠ è½½ï¼Œè¿™ä¸ä»…ä¸æ–¹ä¾¿å¼€å‘è€…ä½¿ç”¨ï¼Œä»æ‰“åŒ…äº§ç‰©æ¥è¯´ä¹Ÿå¢åŠ äº†å¾ˆå¤šå­—èŠ‚ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆæ ·çš„ç»„ç»‡å½¢å¼æ‰èƒ½æ»¡è¶³æŒ‰éœ€åŠ è½½å‘¢ï¼Ÿç­”æ¡ˆå°±åœ¨ babel-plugin-import æ’ä»¶çš„æ–‡æ¡£ä¸­ï¼š</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3d8bd23d28b0413b8b3da8119d32dd35~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä»å›¾ä¸­æˆ‘ä»¬çœ‹å‡º babel-plugin-import æ’ä»¶æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå°†å¼•ç”¨æŒ‡å‘äº†æ¨¡å—æ‰€åœ¨æ–‡ä»¶å¤¹ã€‚ç”¨æˆ·ä½¿ç”¨æ—¶å®‰è£…æ’ä»¶å¹¶åšå¦‚ä¸‹é…ç½®å°±å®Œæˆäº†æŒ‰éœ€åŠ è½½ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json"><span class="hljs-string">"plugins"</span>: [
  [<span class="hljs-string">"import"</span>, &#123; libraryName: <span class="hljs-string">"antd"</span>, style: <span class="hljs-literal">true</span> &#125;]
]
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä¾ç„¶æ²¡æœ‰é“¶å¼¹ï¼Œæ’ä»¶åšçš„å·¥ä½œåªæ˜¯ä»£æ›¿äº†ä½ çš„å³æ‰‹ã€‚çŸ¥é“äº†åŸç†æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§æ–‡æ¡£è¦æ±‚çš„æ ¼å¼é‡æ–°ç»„ç»‡æˆ‘ä»¬çš„ vant-react-native åŒ…ï¼š</p>
<pre><code class="hljs language-sh copyable" lang="sh">.
â”œâ”€â”€ CHANGELOG.md
â”œâ”€â”€ lib                    <span class="hljs-comment"># ä¸Šä¼ åˆ° NPM çš„ç¼–è¯‘äº§ç‰© </span>
â”‚   â”œâ”€â”€ button             <span class="hljs-comment"># ç¬¦åˆ babel-plugin-import çš„é»˜è®¤é…ç½®è¦æ±‚</span>
â”‚   â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ icon
â”‚   â”‚   â”œâ”€â”€ index.d.ts
â”‚   â”‚   â””â”€â”€ index.js
â”‚   â”œâ”€â”€ index.d.ts
â”‚   â””â”€â”€ index.js          <span class="hljs-comment"># export * from './button';</span>
â”œâ”€â”€ package.json
â”œâ”€â”€ src                   <span class="hljs-comment"># æºç ç›®å½•</span>
â”‚   â”œâ”€â”€ button
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ icon
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ index.ts
â””â”€â”€ tsconfig.json         <span class="hljs-comment"># ç¼–è¯‘é…ç½®ï¼Œå°† ts æ–‡ä»¶ç¼–è¯‘åˆ° lib æ–‡ä»¶å¤¹ä¸‹</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>vant-react-native/src/button/index.tsï¼š</strong></p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">import</span> Button <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/button'</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Button;
<span class="hljs-keyword">export</span> &#123; Button &#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>vant-react-native/src/icon/index.tsï¼š</strong></p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">import</span> Icon <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Icon;
<span class="hljs-keyword">export</span> &#123; Icon &#125;;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>vant-react-native/src/index.tsï¼š</strong></p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./icon'</span>;
<span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'./button'</span>;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç„¶åé¡¹ç›®ä¸­ä¿®æ”¹ babel.config.jsï¼š</p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">presets</span>: [<span class="hljs-string">'module:metro-react-native-babel-preset'</span>],
  <span class="hljs-attr">plugins</span>: [
    [<span class="hljs-string">"import"</span>, &#123;<span class="hljs-attr">libraryName</span>: <span class="hljs-string">'vant-react-native'</span>&#125;]
  ],
&#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-30">ç¼–å†™ Babel æ’ä»¶ï¼Ÿ</h3>
<p>è™½ç„¶é€šè¿‡ä¿®æ”¹ä¸»åŒ…çš„å¯¼å‡ºæ–¹å¼å¯ä»¥å®Œæˆéœ€æ±‚ï¼Œä½†æ˜¯å´æå¤§åœ°å¢åŠ äº†é¡¹ç›®æœ¬èº«çš„å¤æ‚åº¦ã€‚å‰é¢æˆ‘ä»¬å·²ç»çŸ¥é“ babel-plugin-import çš„åŸç†æ˜¯è½¬æ¢å¼•ç”¨è·¯å¾„ã€‚é‚£ä¹ˆæˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥é€šè¿‡æ’ä»¶åŠ¨æ€æŠŠ <code>import &#123;Button&#125; from 'vant-react-native'</code> è½¬æˆ <code>import Button from '@vant-react-native/button'</code> å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œä¸‹é¢æ˜¯æˆ‘åŸºäº babel-plugin-import çš„ <code>customName</code> é…ç½®ç¼–å†™äº†ä¸€å¥—é…ç½®å¹¶å°è£…åœ¨ babel-plugin-import-vant åŒ…ä¸­ï¼š</p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">import</span> camelCase <span class="hljs-keyword">from</span> <span class="hljs-string">'camelcase'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> (): <span class="hljs-built_in">any</span>[] => [
  [
    <span class="hljs-string">'import'</span>,
    &#123;
      <span class="hljs-attr">libraryName</span>: <span class="hljs-string">'vant-react-native'</span>,
      <span class="hljs-attr">customName</span>: <span class="hljs-function">(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) =></span> &#123;
        <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'icon'</span>) &#123;
          <span class="hljs-keyword">return</span> <span class="hljs-string">'@vant-react-native/icons'</span>;
        &#125;
        <span class="hljs-keyword">if</span> (name.match(<span class="hljs-regexp">/^van-icon-/</span>)) &#123;
          <span class="hljs-keyword">return</span> <span class="hljs-string">`@vant-react-native/icons/lib/<span class="hljs-subst">$&#123;camelCase(name, &#123; pascalCase: <span class="hljs-literal">true</span> &#125;)&#125;</span>`</span>;
        &#125;
        <span class="hljs-keyword">return</span> <span class="hljs-string">`@vant-react-native/<span class="hljs-subst">$&#123;name&#125;</span>`</span>;
      &#125;,
    &#125;,
    <span class="hljs-string">'vant-react-native'</span>,
  ],
  [
    <span class="hljs-string">'import'</span>,
    &#123;
      <span class="hljs-attr">libraryName</span>: <span class="hljs-string">'@vant-react-native/icons'</span>,
      <span class="hljs-attr">customName</span>: <span class="hljs-function">(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) =></span> &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">`@vant-react-native/icons/lib/<span class="hljs-subst">$&#123;camelCase(name, &#123; pascalCase: <span class="hljs-literal">true</span> &#125;)&#125;</span>`</span>;
      &#125;,
    &#125;,
    <span class="hljs-string">'@vant-react-native/icons'</span>,
  ],
];
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨é¡¹ç›®çš„ <code>babel.config.js</code> é…ç½®ä¸­æ·»åŠ  <code>plugins: [...require('babel-plugin-import-vant').default()]</code> å³å¯å®ç°æŒ‰éœ€åŠ è½½ã€‚</p>
<p>è¿˜æœ‰å¯ä»¥ä¼˜åŒ–çš„åœ°æ–¹å—ï¼Ÿæœºæ™ºçš„ä½ å¯èƒ½åˆå‘ç°æˆ‘åªæ˜¯é€šè¿‡å‡½æ•°å¯¼å‡ºäº†ä¸€ä¸ªé…ç½®è€Œå·²ï¼Œå¹¶ä¸æ˜¯çœŸæ­£çš„æ’ä»¶ï¼Œæ‰€ä»¥æœªæ¥æˆ‘ä¼šå®šåˆ¶ä¸€ä¸ª vant-react-native è‡ªå·±çš„æŒ‰éœ€åŠ è½½ babel æ’ä»¶ã€‚</p>
<blockquote>
<p><code>name.match(/^van-icon-/)</code> è¿™ä¸ªåˆ¤æ–­æ¡ä»¶æ˜¯å› ä¸º <code>@vant-react-native/icons</code> åŒ…é™¤äº†åŒ…å«ä¸€ä¸ªé»˜è®¤å¯¼å‡ºçš„ Icon ç»„ä»¶ï¼Œè¿˜å¯¼å‡ºäº†å¾ˆå¤šå•ä¸ªå›¾æ ‡ç»„ä»¶ï¼Œä¸ºäº†è¿›ä¸€æ­¥å‡å°æ‰“åŒ…ä½“ç§¯ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸ªå­åŒ…ä¹Ÿè¿›è¡Œäº†æŒ‰éœ€åŠ è½½å¤„ç†ã€‚</p>
<p><strong>æˆ‘ä»¬å·²ç»çŸ¥é“æŒ‰éœ€åŠ è½½çš„åŸç†æ˜¯æ²¡æœ‰ä¸­é—´å•†èµšå·®ä»·ç›´æ¥å’Œå–å®¶è°ˆ</strong>ï¼Œæ‰€ä»¥åé¢æˆ‘ä»¬é‡è§ç±»ä¼¼çš„éœ€æ±‚é€šè¿‡è½¬æ¢è¿”å›å–å®¶åœ°å€å³å¯ã€‚ä¸éœ€è¦ç ´åæ€§åœ°æ”¹é¡¹ç›®ç»“æ„ã€‚</p>
</blockquote>
<h3 data-id="heading-31">æˆæœå±•ç¤º</h3>



















<table><thead><tr><th>åˆå§‹åŒ…å¤§å°</th><th>æœªé…ç½®æŒ‰éœ€åŠ è½½ï¼ˆå¼•å…¥ Buttonï¼‰</th><th>æŒ‰éœ€åŠ è½½ï¼ˆå¼•å…¥ Buttonï¼‰</th><th>æŒ‰éœ€åŠ è½½ï¼ˆå¼•å…¥ Iconï¼‰</th><th>æŒ‰éœ€åŠ è½½ï¼ˆå¼•å…¥ VanIconAddï¼‰</th></tr></thead><tbody><tr><td>723KB</td><td>1.8M</td><td>725KB</td><td>1.8M</td><td>1.22M</td></tr></tbody></table>
<p>ä¹‹æ‰€ä»¥ Icon åŒ…ä¼šå¤§ï¼Œæ˜¯å› ä¸º react-native-svg è¿™ä¸ªåº“å¤§ï¼Œæ‰€ä»¥ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ Icon ç»„ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨ VanIconAddã€VanIconEye è¿™ç§å•ç‹¬çš„å›¾æ ‡ç»„ä»¶ï¼Œå°‘äº† 593KB è¿˜æ˜¯æŒºé¦™çš„ã€‚</p>
<h2 data-id="heading-32">ç»„ä»¶åº“æ–‡æ¡£</h2>
<p>ç»„ä»¶åº“æ–‡æ¡£æ¯”è¾ƒé‡è¦çš„æ˜¯æœ‰å¯ä»¥äº¤äº’çš„ Demo æ¼”ç¤ºï¼Œæˆ‘æ˜¯ Dumi çš„èµ„æ·±ç”¨æˆ·ï¼Œå€ŸåŠ© dumi-theme-mobile å’Œ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fyoungjuning%2Fumi-plugin-react-native" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/youngjuning/umi-plugin-react-native" ref="nofollow noopener noreferrer">umi-plugin-react-native</a> æˆ‘ä»¬å¯ä»¥å¾ˆå¥½åœ°æ»¡è¶³ React Native ç»„ä»¶åº“æ–‡æ¡£çš„æ­å»ºã€‚</p>
<h3 data-id="heading-33">é›†æˆ Dumi åˆ°é¡¹ç›®ä¸­</h3>
<p><strong>å®‰è£…ä¾èµ–ï¼š</strong></p>
<pre><code class="hljs language-sh copyable" lang="sh">$ yarn add dumi dumi-theme-mobile umi-plugin-react-native -D
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>é…ç½®æ–‡ä»¶ï¼š</strong></p>
<p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ  <code>.umirc.ts</code></p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">import</span> &#123; defineConfig, IConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'dumi'</span>;

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> defineConfig(&#123;
  <span class="hljs-attr">title</span>: <span class="hljs-string">'vant-react-native'</span>,
  <span class="hljs-attr">mode</span>: <span class="hljs-string">'site'</span>,
  <span class="hljs-attr">logo</span>: <span class="hljs-string">'https://img01.yzcdn.cn/vant/logo.png'</span>,
  <span class="hljs-attr">favicon</span>: <span class="hljs-string">'https://img01.yzcdn.cn/vant/logo.png'</span>,
  <span class="hljs-attr">resolve</span>: &#123;
    <span class="hljs-attr">includes</span>: [<span class="hljs-string">'docs'</span>, <span class="hljs-string">'packages/button'</span>, <span class="hljs-string">'packages/icons'</span>],
  &#125;,
  <span class="hljs-comment">// more config: https://d.umijs.org/config</span>
&#125; <span class="hljs-keyword">as</span> IConfig);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒDumi æ˜¯æ”¯æŒ Lerna ä»“åº“çš„ï¼Œå®ƒé»˜è®¤ä¼šä»¥ <code>packages/[åŒ…å]/src</code> ä¸ºåŸºç¡€è·¯å¾„æœå¯»æ‰€æœ‰å­åŒ…çš„ Markdown æ–‡æ¡£å¹¶ç”Ÿæˆè·¯ç”±ã€‚é€šè¿‡ <code>resolve.includes</code> å¯ä»¥é…ç½® dumi å—…æ¢çš„æ–‡æ¡£ç›®å½•ï¼Œdumi ä¼šå°è¯•åœ¨é…ç½®çš„ç›®å½•ä¸­é€’å½’å¯»æ‰¾ markdown æ–‡ä»¶ã€‚</p>
<p><strong>æ·»åŠ  NPM è„šæœ¬ï¼š</strong></p>
<blockquote>
<p>æ³¨æ„ğŸ“¢ï¼šç”±äºå®é™…ä¾èµ–çš„æ˜¯ packages ä¸‹çš„åŒ…ï¼Œæˆ‘ä»¬å¿…é¡»å…ˆç¼–è¯‘æ‰€æœ‰çš„åŒ…ï¼Œå¦åˆ™éƒ¨ç½²çš„æ—¶å€™ä¼šæŠ¥ <code>This dependency was not found:</code> çš„é”™è¯¯ã€‚</p>
</blockquote>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"start:dumi"</span>: <span class="hljs-string">"dumi dev"</span>,
    <span class="hljs-attr">"build:dumi"</span>: <span class="hljs-string">"lerna run build && dumi build"</span>
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>å¿½ç•¥æ–‡ä»¶ï¼ˆ.gitignoreï¼‰ï¼š</strong></p>
<pre><code class="copyable"># umi
.umi
.umi-production
.env.local
dist/
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-34">éƒ¨ç½²åˆ° GitHub Pages</h3>
<p>åœ¨æ ¹ç›®å½•æ–°å»º <code>.github/workflows/gh-pages</code>ï¼š</p>
<pre><code class="hljs language-yml copyable" lang="yml"><span class="hljs-attr">name:</span> <span class="hljs-string">github</span> <span class="hljs-string">pages</span>
<span class="hljs-attr">on:</span>
  <span class="hljs-attr">push:</span>
    <span class="hljs-attr">branches:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">main</span> <span class="hljs-comment"># default branch</span>
<span class="hljs-attr">jobs:</span>
  <span class="hljs-attr">deploy:</span>
    <span class="hljs-attr">runs-on:</span> <span class="hljs-string">ubuntu-18.04</span>
    <span class="hljs-attr">steps:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">uses:</span> <span class="hljs-string">actions/checkout@v2</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">install</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">run:</span> <span class="hljs-string">yarn</span> <span class="hljs-string">build:dumi</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Deploy</span>
        <span class="hljs-attr">uses:</span> <span class="hljs-string">peaceiris/actions-gh-pages@v3</span>
        <span class="hljs-attr">with:</span>
          <span class="hljs-attr">github_token:</span> <span class="hljs-string">$&#123;&#123;</span> <span class="hljs-string">secrets.GITHUB_TOKEN</span> <span class="hljs-string">&#125;&#125;</span>
          <span class="hljs-attr">publish_dir:</span> <span class="hljs-string">./dist</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-35">é¢„è§ˆ</h3>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥è®¿é—® <a href="https://link.juejin.cn/?target=https%3A%2F%2Fyoungjuning.js.org%2Fvant-react-native%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://youngjuning.js.org/vant-react-native/" ref="nofollow noopener noreferrer">youngjuning.js.org/vant-react-â€¦</a> æŸ¥çœ‹æ•ˆæœäº†ï¼š</p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9faf0889b6d64238922bb02c51cf02ff~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a11e9ce535c54f8bb038599533f0ef9a~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/8bed86245d8f485894b0c5e3d9767e9c~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-36">é…ç½®ä¼˜åŒ–</h3>
<p>ç°åœ¨åŸºäº dumi çš„æ–‡æ¡£ç«™ç‚¹åªæ˜¯åˆå§‹åŒ–ï¼Œå¾ˆå¤šé…ç½®ï¼ˆ.umirc.tsï¼‰å¯ä»¥ä¼˜åŒ–ï¼Œæ¯”å¦‚ï¼š</p>
<ol>
<li>åŸºäº jsdeliver é…ç½® CDN åŠ é€Ÿ</li>
</ol>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">const</span> isProd = process.env.NODE_ENV === <span class="hljs-string">'production'</span>;
...
<span class="hljs-attr">publicPath</span>: isProd ? <span class="hljs-string">'https://cdn.jsdelivr.net/gh/youngjuning/vant-react-native@gh-pages/'</span>: <span class="hljs-string">'/'</span>,
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="2">
<li>å¢é‡å‘å¸ƒå’Œé¿å…æµè§ˆå™¨åŠ è½½ç¼“å­˜</li>
</ol>
<pre><code class="hljs language-ts copyable" lang="ts">&#123;
  <span class="hljs-attr">hash</span>: <span class="hljs-literal">true</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="3">
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fwww.umeng.com%2Fweb" target="_blank" rel="nofollow noopener noreferrer" title="https://www.umeng.com/web" ref="nofollow noopener noreferrer">å‹ç›Ÿç½‘ç«™ç»Ÿè®¡</a></li>
</ol>
<pre><code class="hljs language-ts copyable" lang="ts">&#123;
  <span class="hljs-attr">scripts</span>: [<span class="hljs-string">'https://s9.cnzz.com/z_stat.php?id=1280093214&web_id=1280093214'</span>],
  <span class="hljs-attr">styles</span>: [<span class="hljs-string">'a[title=ç«™é•¿ç»Ÿè®¡] &#123; display: none; &#125;'</span>],
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="4">
<li>é…ç½® <code>exportStatic: &#123;&#125;</code> å°†æ‰€æœ‰è·¯ç”±è¾“å‡ºä¸º HTML ç›®å½•ç»“æ„ï¼Œä»¥å…åˆ·æ–°é¡µé¢æ—¶ 404ã€‚</li>
</ol>
<h3 data-id="heading-37">Pull Request é¢„å‘é¢„è§ˆ</h3>
<p>è€ƒè™‘åˆ°åæœŸç¤¾åŒºä¼šè´¡çŒ®ä»£ç å’Œæ–‡æ¡£ã€‚åœ¨ pr åˆè¿›ä¸»åˆ†æ”¯ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦é¢„è§ˆæ–‡æ¡£æˆ–ç»„ä»¶ã€‚æ»¡è¶³è¿™ä¸€éœ€æ±‚çš„æ˜¯ä¸€ä¸ªå« surge.sh çš„é™æ€æ‰˜ç®¡æœåŠ¡ï¼Œsurge æ”¯æŒåœ¨å‘½ä»¤è¡Œé€šè¿‡ç®€å•çš„å‘½ä»¤å…è´¹å‘å¸ƒ HTMLã€CSS å’Œ JS æ–‡ä»¶åˆ° webã€‚</p>
<h4 data-id="heading-38">ç”³è¯· Surge Token</h4>
<p><strong>å®‰è£… surge cliï¼š</strong></p>
<pre><code class="hljs language-sh copyable" lang="sh">npm install --global surge
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>æ³¨å†Œ surge è´¦å·ï¼š</strong></p>
<pre><code class="hljs language-sh copyable" lang="sh">suerge login
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>è·å– tokenï¼š</strong></p>
<pre><code class="hljs language-sh copyable" lang="sh">suerge token
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-39">é…ç½® CI</h4>
<p>ç”±äº GitHub çš„å®‰å…¨é—®é¢˜ï¼Œsurge-preview Action æ’ä»¶æ— æ³•ä½¿ç”¨ï¼Œæˆ‘ä»¬å‚è€ƒ dumi å®˜æ–¹çš„é…ç½®è‡ªå®šä¹‰äº† CIï¼Œé¦–å…ˆæˆ‘ä»¬æ‹·è´ä¸‹å›¾ä¸­çš„ä¸‰ä¸ªæ–‡ä»¶åˆ°é¡¹ç›®ä¸­ã€‚</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9e3d3e61ac1c4019ac393b2d1b2c5719~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>ç„¶åä¿®æ”¹ <code>preview-build.yml</code> ä¸­çš„ <code>build step</code>ï¼š</p>
<pre><code class="hljs language-diff copyable" lang="diff"><span class="hljs-deletion">- NODE_OPTIONS='--max-old-space-size=4096' yarn build</span>
<span class="hljs-addition">+ NODE_OPTIONS='--max-old-space-size=4096' PREVIEW_PR=true yarn build:dumi</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ·»åŠ ç¯å¢ƒå˜é‡ <code>PREVIEW_PR=true</code> æ˜¯ä¸ºäº†è®© dumi æ‰“åŒ…æ—¶è¯†åˆ«å‡ºä¸æ˜¯ç”Ÿäº§ç¯å¢ƒæ‰“åŒ…ï¼Œ<code>.umirc.ts</code> éœ€è¦ç›¸åº”ä¿®æ”¹ä¸ºï¼š</p>
<pre><code class="hljs language-ts copyable" lang="ts"><span class="hljs-keyword">const</span> isProd =
  process.env.NODE_ENV === <span class="hljs-string">'production'</span> && process.env.PREVIEW_PR !== <span class="hljs-string">"true"</span>;
...
<span class="hljs-attr">publicPath</span>: isProd ? <span class="hljs-string">'https://cdn.jsdelivr.net/gh/youngjuning/vant-react-native@gh-pages/'</span>: <span class="hljs-string">'/'</span>,
...
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å†ç„¶åï¼Œä¿®æ”¹ <code>preview-deploy.yml</code> æ–‡ä»¶ä¸­çš„éƒ¨ç½²åŸŸå <code>dumi-preview</code> ä¸º <code>vant-react-native-preview</code>ã€‚</p>
<p>æœ€åæˆ‘ä»¬æŠŠå‰é¢è·å–çš„ Surge Token æ·»åŠ åˆ°ä»“åº“çš„ Secrets å³å¯ã€‚</p>
<h4 data-id="heading-40">æˆæœå±•ç¤º</h4>
<p><strong>æ­£åœ¨éƒ¨ç½² PR é¢„è§ˆçŠ¶æ€ï¼š</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/193ac9e16cca408383ca7ae2ec503613~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p><strong>éƒ¨ç½²æˆåŠŸçŠ¶æ€ï¼š</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1659de97aafd4f87a93993c35ef93195~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>è®¿é—® <a href="https://link.juejin.cn/?target=https%3A%2F%2Fvant-react-native-preview-pr-1.surge.sh%2F" target="_blank" rel="nofollow noopener noreferrer" title="https://vant-react-native-preview-pr-1.surge.sh/" ref="nofollow noopener noreferrer">vant-react-native-preview-pr-1.surge.sh/</a> å³å¯éªŒè¯æ–‡æ¡£çš„æ­£ç¡®æ€§âœ…ã€‚</p>
<h2 data-id="heading-41">å•å…ƒæµ‹è¯•</h2>
<p>æˆ‘åœ¨ <a href="https://juejin.cn/post/6937983077209604127" target="_blank" title="https://juejin.cn/post/6937983077209604127">ä½¿ç”¨ Jest å’Œ Enzyme è¿›è¡Œ React Native å•å…ƒæµ‹è¯•|æŠ€æœ¯ç‚¹è¯„</a> ä¸€æ–‡ä¸­æ›¾æäº¤å•å…ƒæµ‹è¯•å’Œæ–‡æ¡£ä¸€æ ·ï¼Œæ˜¯ä¿éšœç¨‹åºæœ€å°å•å…ƒè´¨é‡çš„é‡è¦ä¸€ç¯ã€‚è¯šç„¶ä¸€ä¸ªæˆç†Ÿçš„ç»„ä»¶åº“æ˜¯å¿…ç„¶æœ‰å•å…ƒæµ‹è¯•çš„èº«å½±ã€‚æœ¬ç« å°±ä¸å±•å¼€è®²å•å…ƒæµ‹è¯•äº†ï¼Œä¸»è¦è®² vant-react-native æ˜¯å¦‚ä½•é…ç½®å•å…ƒæµ‹è¯•çš„ã€‚</p>
<h3 data-id="heading-42">å®‰è£…ä¾èµ–</h3>
<p>jestã€babel-jestã€@types/jest è¿™äº›ä¾èµ–éƒ½å·²ç»å®‰è£…äº†ï¼Œæˆ‘ä»¬éœ€è¦å®‰è£…çš„æ˜¯ enzyme è¿™ä¸ªåŸºäº jest çš„å•å…ƒæµ‹è¯•æ¡†æ¶ã€‚</p>
<pre><code class="hljs language-sh copyable" lang="sh">$ yarn add enzyme jest-enzyme enzyme-adapter-react-16 enzyme-to-json @types/enzyme react-native-mock-render -DW
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<blockquote>
<p>Enzyme æ˜¯ç”¨äº React çš„ JavaScript æµ‹è¯•å®ç”¨ç¨‹åºï¼Œå¯ä»¥æ›´è½»æ¾åœ°æµ‹è¯• React ç»„ä»¶çš„è¾“å‡ºã€‚æ‚¨è¿˜å¯ä»¥æ ¹æ®ç»™å®šçš„è¾“å‡ºè¿›è¡Œæ“ä½œï¼Œéå†å¹¶ä»¥æŸç§æ–¹å¼æ¨¡æ‹Ÿè¿è¡Œæ—¶ã€‚</p>
</blockquote>
<h3 data-id="heading-43">é…ç½®</h3>
<p><strong>jest.config.jsï¼š</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-built_in">module</span>.exports = &#123;
  <span class="hljs-attr">preset</span>: <span class="hljs-string">'react-native'</span>,
  <span class="hljs-attr">verbose</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">collectCoverage</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">// ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</span>
  <span class="hljs-attr">moduleNameMapper</span>: &#123;
    <span class="hljs-comment">// for https://github.com/facebook/jest/issues/919</span>
    <span class="hljs-string">'^image![a-zA-Z0-9$_-]+$'</span>: <span class="hljs-string">'GlobalImageStub'</span>,
    <span class="hljs-string">'^[@./a-zA-Z0-9$_-]+\\.(png|gif)$'</span>: <span class="hljs-string">'RelativeImageStub'</span>,
  &#125;,
  <span class="hljs-attr">setupFilesAfterEnv</span>: [<span class="hljs-string">'<rootDir>/jest.setup.js'</span>], <span class="hljs-comment">// ä½¿ç”¨ Jest è¿è¡Œå®‰è£…æ–‡ä»¶ä»¥é…ç½® Enzyme å’Œé€‚é…å™¨ï¼ˆå¦‚ä¸‹æ–‡jest.setup.jsä¸­æ‰€ç¤ºï¼‰ï¼Œä¹‹å‰æ˜¯setupTestFrameworkScriptFileï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨setupFiles</span>
  <span class="hljs-attr">snapshotSerializers</span>: [<span class="hljs-string">'enzyme-to-json/serializer'</span>], <span class="hljs-comment">// æ¨èä½¿ç”¨åºåˆ—åŒ–ç¨‹åºä½¿ç”¨ enzyme-to-jsonï¼Œå®ƒçš„å®‰è£…å’Œä½¿ç”¨éå¸¸ç®€å•ï¼Œå¹¶å…è®¸æ‚¨ç¼–å†™ç®€æ´çš„å¿«ç…§æµ‹è¯•ã€‚</span>
&#125;;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>jest.setup.jsï¼š</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">import</span> <span class="hljs-string">'react-native'</span>;
<span class="hljs-keyword">import</span> Enzyme <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme'</span>;
<span class="hljs-keyword">import</span> Adapter <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme-adapter-react-16'</span>;

Enzyme.configure(&#123; <span class="hljs-attr">adapter</span>: <span class="hljs-keyword">new</span> Adapter() &#125;);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>ä¸€ä¸ªç®€å•çš„ç¤ºä¾‹ï¼š</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">// packages/button/__test__/index.tsx</span>
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> &#123; shallow &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">'enzyme'</span>;
<span class="hljs-keyword">import</span> Button <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/index'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setup</span>(<span class="hljs-params">props = &#123;&#125;</span>) </span>&#123;
  <span class="hljs-keyword">const</span> wrapper = shallow(<span class="xml"><span class="hljs-tag"><<span class="hljs-name">Button</span> /></span></span>);
  <span class="hljs-keyword">const</span> instance = wrapper.instance();
  <span class="hljs-keyword">return</span> &#123; wrapper, instance &#125;;
&#125;

describe(<span class="hljs-string">'Button Component'</span>, <span class="hljs-function">() =></span> &#123;
  it(<span class="hljs-string">'renders correctly'</span>, <span class="hljs-function">() =></span> &#123;
    <span class="hljs-keyword">const</span> &#123; wrapper &#125; = setup();
    expect(wrapper).toMatchSnapshot();
  &#125;);
&#125;);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ‰§è¡Œ <code>jest</code> å‘½ä»¤åå¯ä»¥æŸ¥çœ‹è¦†ç›–ç‡å¦‚ä¸‹ï¼š</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/358737fa32f549f4a9b06a9bcf8903d4~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-44">å†™ç»™å‹‡å£«</h2>
<p>èƒ½å†™é•¿æ–‡çš„ä¸ç®—å‹‡å£«ï¼Œèƒ½åšæŒçœ‹åˆ°è¿™é‡Œçš„æ‰æ˜¯å‹‡å£«ã€‚æ´›ç«¹åœ¨æ­¤æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚ç„¶è€Œç»„ä»¶åº“å·¥ç¨‹åŒ–è¿™åªæ˜¯ä¸€ä¸ªèµ·ç‚¹ï¼Œå¦‚æœæœ¬æ–‡åå“å¥½ï¼Œç»„ä»¶åº“å…·ä½“ç»„ä»¶çš„è®¾è®¡å®ç°ã€å®Œæ•´çš„ React Native å•å…ƒæµ‹è¯•æ•™ç¨‹ç­‰ç­‰æ´›ç«¹ä¼šåœ¨åç»­çš„æ–‡ç« ä¸­å±•å¼€è®²ã€‚</p>
<h2 data-id="heading-45">æ¨èçš„ UI åº“</h2>
<p>å½“ç„¶äº†ï¼Œvant-react-native å¹¶ä¸æ˜¯ä½ å”¯ä¸€çš„é€‰æ‹©ï¼Œä¸‹é¢çš„å‡ ä¸ª UI åº“éƒ½æ˜¯å¾ˆä¼˜ç§€çš„é¡¹ç›®ã€‚åœ¨å®ç° vant-react-native æ—¶æˆ‘ä¹Ÿå¤šå°‘å€Ÿé‰´äº†å‰äººä¼˜ç§€çš„è®¾è®¡ã€‚</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fant-design%2Fant-design-mobile-rn" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/ant-design/ant-design-mobile-rn" ref="nofollow noopener noreferrer">antd-mobile-rn</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Freact-native-elements%2Freact-native-elements" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/react-native-elements/react-native-elements" ref="nofollow noopener noreferrer">react-native-elements</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fakveo%2Freact-native-ui-kitten" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/akveo/react-native-ui-kitten" ref="nofollow noopener noreferrer">react-native-ui-kitten</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fgithub.com%2Fwix%2Freact-native-ui-lib" target="_blank" rel="nofollow noopener noreferrer" title="https://github.com/wix/react-native-ui-lib" ref="nofollow noopener noreferrer">react-native-ui-lib</a></li>
</ul></div>  
</div>
            