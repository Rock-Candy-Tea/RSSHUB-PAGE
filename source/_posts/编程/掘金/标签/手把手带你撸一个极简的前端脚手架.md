
---
title: 'æ‰‹æŠŠæ‰‹å¸¦ä½ æ’¸ä¸€ä¸ªæç®€çš„å‰ç«¯è„šæ‰‹æ¶'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - æ ‡ç­¾
headimg: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9133aea94394e8f976c1f48d5e53052~tplv-k3u1fbpfcp-watermark.image'
author: æ˜é‡‘
comments: false
date: Sun, 20 Jun 2021 18:18:39 GMT
thumbnail: 'https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9133aea94394e8f976c1f48d5e53052~tplv-k3u1fbpfcp-watermark.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><blockquote>
<p>æœ¬æ–‡æºç å·²ç»æ”¶å½•åˆ°<a href="https://github.com/Paulinho89/caoyp-cli" target="_blank" rel="nofollow noopener noreferrer">github</a>ï¼Œæ¬¢è¿å„ä½å°å“¥å“¥å°å§å§ä»¬starï¼ŒæŒç»­æ›´æ–°ä¸­ã€‚</p>
</blockquote>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>åœ¨å‰ä¸¤ç¯‡æ–‡ç« <a href="https://juejin.cn/post/6973607639502553095" target="_blank">10åˆ†é’Ÿå¸¦ä½ å‡çº§webpack5</a>ã€<a href="https://juejin.cn/post/6958977619723288590" target="_blank">ã€å»ºè®®ç»†è¯»ã€‘ä»0åˆ°1æ‰‹æŠŠæ‰‹å¸¦ä½ æ‹ä¸€å¥—webpack+vueé¡¹ç›®æ¨¡æ¿</a>ä¸­ï¼Œå¸¦å°ä¼™ä¼´ä»¬ä¸€èµ·å¦‚ä½•æ‰‹åŠ¨çš„ä»0åˆ°1æ­å»ºä¸€ä¸ªå‰ç«¯é¡¹ç›®æ¨¡æ¿ï¼Œä½†åœ¨æˆ‘ä»¬å®é™…çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå•çº¯çš„é æ‹·è´æ­å»ºå¥½çš„é¡¹ç›®æ¨¡æ¿ç”Ÿæˆæ–°çš„é¡¹ç›®ï¼Œæ˜¾ç„¶æ˜¯æ¯”è¾ƒä½æ•ˆçš„ï¼›å¦‚ä½•<code>è§„é¿è¿™ç§ä½æ•ˆçš„æ‹·è´æ“ä½œ</code>å‘¢ï¼Ÿç­”æ¡ˆæ˜¯<code>è„šæ‰‹æ¶/CLI</code>ã€‚é‚£æ¥ä¸‹æ¥æˆ‘ä»¬å°±å°†ä¸Šç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æ‰‹åŠ¨æ­å»ºå¥½çš„é¡¹ç›®æ¨¡æ¿çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡<code>è„šæ‰‹æ¶/CLI</code>çš„å½¢å¼<code>ä¸€é”®å¿«æ·ç”Ÿæˆ</code>æˆ‘ä»¬æƒ³è¦çš„é¡¹ç›®ã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆéœ€è¦è„šæ‰‹æ¶/CLI</h2>
<blockquote>
<p>CLIï¼Œå…¨ç§°æ˜¯ command-line interfaceï¼Œä¹Ÿå°±æ˜¯å‘½ä»¤è¡Œç•Œé¢ã€‚</p>
</blockquote>
<p>è„šæ‰‹æ¶çš„å¥½å¤„æœ‰å“ªäº›å‘¢ï¼Ÿ</p>
<ul>
<li>è§„é¿é€šè¿‡äººå·¥ä½æ•ˆçš„æ‹·è´é¡¹ç›®æ¨¡æ¿çš„æ“ä½œ</li>
<li>è§„èŒƒé¡¹ç›®å¼€å‘ç›®å½•ç»“æ„</li>
<li>ç»Ÿä¸€å›¢é˜Ÿç»Ÿä¸€å¼€å‘é£æ ¼ï¼Œä¾¿äºè·¨å›¢é˜Ÿåˆä½œï¼Œä»¥åŠåæœŸç»´æŠ¤ï¼Œé™ä½æ–°äººä¸Šæ‰‹æˆæœ¬</li>
<li>æä¾›ä¸€é”®å‰ç«¯é¡¹ç›®çš„åˆ›å»ºã€é…ç½®ã€æœ¬åœ°å¼€å‘ã€æ’ä»¶æ‰©å±•ç­‰åŠŸèƒ½ï¼Œè®©å¼€å‘è€…æ›´å¤šæ—¶é—´ä¸“æ³¨äºä¸šåŠ¡</li>
</ul>
<h2 data-id="heading-2">è„šæ‰‹æ¶/CLIçš„å·¥ä½œæµç¨‹</h2>
<ul>
<li>ä¸€ä¸ªå®Œæ•´çš„è„šæ‰‹æ¶é€šå¸¸åŒ…å«æœ‰è¿™äº›ï¼š<code>é¡¹ç›®çš„åˆ›å»º</code>ã€<code>é¡¹ç›®æ¨¡å—çš„æ–°å¢åˆ é™¤</code>ã€<code>é¡¹ç›®æ‰“åŒ…</code>ã€<code>é¡¹ç›®ç»Ÿä¸€æµ‹è¯•</code>ã€<code>é¡¹ç›®å‘å¸ƒ</code>ç­‰ï¼›</li>
<li>ä¸‹è¾¹é€šè¿‡è¿™ç§å›¾ç®€å•çš„é˜è¿°äº†è„šæ‰‹æ¶çš„å·¥ä½œæµç¨‹ï¼š<code>å„è‡ªä¸åŒçš„ç«¯</code> -> <code>æ‰§è¡Œä¸åŒçš„è„šæ‰‹æ¶å‘½ä»¤</code> -> <code>ä»è¿œç«¯æ‹‰å–ä¸åŒçš„é¡¹ç›®æ¨¡æ¿</code> -> <code>æ ¹æ®æ‹‰å–çš„ä¸åŒæ¨¡æ¿è¿›è¡Œé¡¹ç›®å¼€å‘</code> -> <code>å¼€å‘å®Œè‡ªæµ‹åæäº¤ä»£ç åˆ°è¿œç«¯ä»“åº“</code>ï¼›</li>
</ul>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a9133aea94394e8f976c1f48d5e53052~tplv-k3u1fbpfcp-watermark.image" alt="å‰ç«¯è„šæ‰‹æ¶å·¥ä½œæµç¨‹.png" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-3">è„šæ‰‹æ¶/CLIéœ€è¦ç”¨åˆ°çš„ä¾èµ–åˆ†æ</h2>









































<table><thead><tr><th>åŒ…å</th><th>åŠŸèƒ½æè¿°</th></tr></thead><tbody><tr><td>commander</td><td>å¤„ç†æ§åˆ¶å°å‘½ä»¤</td></tr><tr><td>chalk</td><td>ç¾åŒ–æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å‡ºå†…å®¹çš„æ ·å¼</td></tr><tr><td>fs-extra</td><td>æ–‡ä»¶æ“ä½œ</td></tr><tr><td>inquirer</td><td>æ§åˆ¶å°è¯¢é—®</td></tr><tr><td>handlebars</td><td>æ¨¡æ¿å¼•æ“æ¸²æŸ“</td></tr><tr><td>log-symbols</td><td>æ‰“å°æ—¥å¿—æé†’</td></tr><tr><td>ora</td><td>å‘½ä»¤è¡ŒloadingåŠ¨æ•ˆ</td></tr><tr><td>download-git-repo</td><td>è¿œç¨‹ä¸‹è½½æ¨¡æ¿</td></tr></tbody></table>
<h2 data-id="heading-4">å¦‚ä½•ç¼–å†™ä¸€ä¸ªæç®€çš„è„šæ‰‹æ¶/CLI</h2>
<p>æˆ‘ä»¬å…ˆæ¥ç»™è„šæ‰‹æ¶å–ä¸€ä¸ªåå­—å§ï¼Œ<code>caoyp-cli</code></p>
<p>å®Œæˆæ­¥éª¤æ‹†è§£ï¼š</p>
<ol>
<li>åˆ›å»ºé¡¹ç›®ï¼ˆ<code>create</code>ï¼‰</li>
<li>è‡ªå®šä¹‰è„šæ‰‹æ¶å¯åŠ¨å‘½ä»¤ï¼ˆ<code>commander</code>ï¼‰</li>
<li>è¯¢é—®ç”¨æˆ·è·å–åˆ›å»ºçš„ä¿¡æ¯ï¼ˆ<code>inquirer</code>ï¼‰</li>
<li>ä»githubä¸‹è½½ç”¨æˆ·éœ€è¦çš„æ¨¡æ¿ï¼ˆ<code>download-git-repo</code>ï¼‰</li>
<li>å‘å¸ƒé¡¹ç›®ï¼ˆ<code>npm</code>ï¼‰</li>
</ol>
<h3 data-id="heading-5">1. åˆ›å»ºé¡¹ç›®</h3>
<p>åˆ›å»ºé¡¹ç›®ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•çš„å®šä¹‰ä¸€ä¸‹æˆ‘ä»¬çš„é¡¹ç›®ç»“æ„</p>
<pre><code class="copyable">caoyp-cli           
â”œâ”€ bin                
â”‚  â””â”€ cli.js  # å¯åŠ¨æ–‡ä»¶ 
â”œâ”€ lib                
â”‚  â””â”€ create.js  # åˆ›å»ºé¡¹ç›®æ–‡ä»¶ 
â”‚  â””â”€ generator.js  # ä¸‹è½½é¡¹ç›®æ–‡ä»¶
â”œâ”€ .gitignore 
â”œâ”€ README.md  
â””â”€ package.json       

<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>githubä¸Šåˆ›å»ºé¡¹ç›®</p>
<pre><code class="copyable">git clone  https://github.com/Paulinho89/caoyp-cli
cd caoyp-cli
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨é¡¹ç›®æ›´ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>
<pre><code class="copyable">npm init -y
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¼šè‡ªåŠ¨å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆä¸€ä¸ª<code>package.json</code>æ–‡ä»¶</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"caoyp-cli"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"å‰ç«¯å•é¡µè„šæ‰‹æ¶"</span>,
  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" && exit 1"</span>
  &#125;,
  <span class="hljs-attr">"keywords"</span>: [
    <span class="hljs-string">"caoyp-cli"</span>,
    <span class="hljs-string">"caoyp"</span>,
    <span class="hljs-string">"è„šæ‰‹æ¶"</span>
  ],
  <span class="hljs-attr">"author"</span>: <span class="hljs-string">"caoyp"</span>,
  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>æ•²é»‘æ¿äº†ï¼Œè¿™é‡Œæ˜¯å…³é”®ï¼ï¼ï¼</strong></p>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/65c30848346d47ea9e013dcedd7ff893~tplv-k3u1fbpfcp-watermark.image" alt="images.jpeg" loading="lazy" referrerpolicy="no-referrer"></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦åœ¨<code>package.json</code>ä¸­æ·»åŠ ä¸€ä¸ª<code>bin</code>å­—æ®µï¼Œåœ¨å®‰è£…æ—¶<code>npm </code>ä¼šå°†æ–‡ä»¶ç¬¦å·é“¾æ¥åˆ° <code>prefix/bin</code> ä»¥è¿›è¡Œå…¨å±€å®‰è£…æˆ–<code>./node_modules/.bin/</code>æœ¬åœ°å®‰è£…ã€‚è¿™æ ·ï¼Œå°±å¯ä»¥å…¨å±€ä½¿ç”¨äº†ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢çš„å°†<code>caoyp-cli</code>ä½œä¸ºå‘½ä»¤åç§°ï¼Œæ‰§è¡Œæ–‡ä»¶æ˜¯æ ¹ç›®å½•çš„<code>index.js</code>ï¼›</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"caoyp-cli"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"å‰ç«¯å•é¡µè„šæ‰‹æ¶"</span>,
  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-attr">"bin"</span>: &#123;
    <span class="hljs-attr">"caoyp"</span>: <span class="hljs-string">"./bin/cli.js"</span>
  &#125;,
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" && exit 1"</span>
  &#125;,
  <span class="hljs-attr">"keywords"</span>: [
    <span class="hljs-string">"caoyp-cli"</span>,
    <span class="hljs-string">"caoyp"</span>,
    <span class="hljs-string">"è„šæ‰‹æ¶"</span>
  ],
  <span class="hljs-attr">"author"</span>: <span class="hljs-string">"caoyp"</span>,
  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç®€å•çš„ç¼–è¾‘ä¸€ä¸‹<code>./bin/cli.js</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-meta">#! /usr/bin/env node</span>

<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'caoyp-cli working ~~'</span>)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>#! /usr/bin/env node</code>è¿™æ®µè¯´æ˜ä¸€ä¸‹ï¼Œä¸æ˜¯æ³¨é‡Šï¼Œè¿™æ®µä»£ç æ˜¯å‘Šè¯‰ä½ çš„è„šæœ¬å·¥å…·(<code>bash/zsh</code>), ä¸‹é¢çš„å†…å®¹æ˜¯è¦åœ¨<code>nodeç¯å¢ƒ</code>ä¸‹è¿è¡Œçš„ä»£ç ï¼Œä¸èƒ½çœç•¥ï¼ï¼ï¼</p>
<p>ä¸ºäº†æ–¹ä¾¿è°ƒè¯•ï¼Œä½¿ç”¨<code>npm link</code>é“¾æ¥åˆ°å…¨å±€</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  caoyp-cli git:(main) npm link
npm WARN my-node-cli@1.0.0 No description
npm WARN my-node-cli@1.0.0 No repository field.

audited 51 packages <span class="hljs-keyword">in</span> 1.7s
found 0 vulnerabilities

/usr/<span class="hljs-built_in">local</span>/bin/caoyp-cli -> /usr/<span class="hljs-built_in">local</span>/lib/node_modules/caoyp-cli/cli.js
/usr/<span class="hljs-built_in">local</span>/lib/node_modules/caoyp-cli -> /Users/caoyp/study/caoyp-cli
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>caoyp</code>ï¼Œæµ‹è¯•ä¸€ä¸‹</p>
<pre><code class="hljs language-js copyable" lang="js">âœ  caoyp-cli git:(main) caoyp

caoyp-cli working ~~
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å®Œæˆæµ‹è¯•ï¼Œæ‰“å°å‡ºæˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p>
<h3 data-id="heading-6">2. è‡ªå®šä¹‰è„šæ‰‹æ¶å¯åŠ¨å‘½ä»¤</h3>
<p><strong>å…ˆæ¥åˆ†æä¸€ä¸‹æˆ‘ä»¬è¦æ€ä¹ˆåšï¼Ÿ</strong></p>
<ol>
<li>æˆ‘ä»¬è¦å€ŸåŠ©<code>commander</code>æ¥å®ç°</li>
<li>å‚è€ƒ<code>vue-cli</code>ï¼Œåˆå§‹åŒ–ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤<code>create</code>ã€<code>help</code>ç­‰ç­‰</li>
<li>å¦‚æœé¡¹ç›®å·²ç»å­˜åœ¨ï¼Œéœ€è¦ç»™ç”¨æˆ·æç¤ºæ˜¯å¦éœ€è¦<code>å¼ºåˆ¶è¦†ç›–</code></li>
</ol>
<h4 data-id="heading-7">2.1 å®‰è£…ä¾èµ–</h4>
<pre><code class="hljs language-js copyable" lang="js">npm i commander --save
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h4 data-id="heading-8">2.2 åˆ›å»ºå‘½ä»¤</h4>
<p>åœ¨<code>./bin/cli.js</code>ä¸­ç¼–è¾‘</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-meta">#! /usr/bin/env node</span>

<span class="hljs-keyword">const</span> program = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>)

program
  <span class="hljs-comment">// å®šä¹‰å‘½ä»¤å’Œå‚æ•°</span>
  .command(<span class="hljs-string">'create <app-name>'</span>)
  .description(<span class="hljs-string">'create a new project'</span>)
  <span class="hljs-comment">// -f or --force ä¸ºå¼ºåˆ¶åˆ›å»ºï¼Œå¦‚æœåˆ›å»ºçš„ç›®å½•å­˜åœ¨åˆ™ç›´æ¥è¦†ç›–</span>
  .option(<span class="hljs-string">'-f, --force'</span>, <span class="hljs-string">'overwrite target directory if it exist'</span>)
  .action(<span class="hljs-function">(<span class="hljs-params">name, options</span>) =></span> &#123;
    <span class="hljs-comment">// æ‰“å°æ‰§è¡Œç»“æœ</span>
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'name:'</span>, name, <span class="hljs-string">'options:'</span>, options)
  &#125;)
  
program
   <span class="hljs-comment">// é…ç½®ç‰ˆæœ¬å·ä¿¡æ¯</span>
  .version(<span class="hljs-string">`v<span class="hljs-subst">$&#123;<span class="hljs-built_in">require</span>(<span class="hljs-string">'../package.json'</span>).version&#125;</span>`</span>)
  .usage(<span class="hljs-string">'<command> [option]'</span>)
  
<span class="hljs-comment">// è§£æç”¨æˆ·æ‰§è¡Œå‘½ä»¤ä¼ å…¥å‚æ•°</span>
program.parse(process.argv);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥<code>caoyp</code>ï¼Œæµ‹è¯•ä¸€ä¸‹</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  caoyp-cli git:(main) caoyp
Usage: caoyp <<span class="hljs-built_in">command</span>> [option]

Options:
  -V, --version                output the version number
  -h, --<span class="hljs-built_in">help</span>                   display <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">command</span>

Commands:
  create [options] <app-name>  create a new project
  <span class="hljs-built_in">help</span> [<span class="hljs-built_in">command</span>]               display <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">command</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å‘ç°Commandsä¸­å·²ç»æœ‰äº†<code>create [options] <app-name></code>å‘½ä»¤ï¼Œé‚£æ¥ä¸‹æ¥æˆ‘ä»¬å†è¾“å…¥<code>caoyp create</code>è¯•è¯•ï¼Œçœ‹çœ‹ä¼šæ‰“å°ä»€ä¹ˆ</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  caoyp-cli git:(main) caoyp create
error: missing required argument <span class="hljs-string">'app-name'</span>

âœ  caoyp-cli git:(main) caoyp create my-project
æ‰§è¡Œç»“æœ >>> name: my-project options: &#123;&#125;

âœ  caoyp-cli git:(main) caoyp create my-project -f
æ‰§è¡Œç»“æœ >>> name: my-project options: &#123; force: <span class="hljs-literal">true</span> &#125;

âœ  caoyp-cli git:(main) caoyp create my-project --force
æ‰§è¡Œç»“æœ >>> name: my-project options: &#123; force: <span class="hljs-literal">true</span> &#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­æ‹¿åˆ°æˆ‘ä»¬çš„è¾“å…¥ä¿¡æ¯äº†ã€‚</p>
<h4 data-id="heading-9">2.3 æ‰§è¡Œå‘½ä»¤</h4>
<p>åˆ›å»ºä¸€ä¸ª<code>lib</code>æ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ª<code>create.js</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, options</span>) </span>&#123;
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'-----create.js'</span>, name, options);
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>./bin/cli.js</code>ä¸­å¼•å…¥<code>create.js</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> program = <span class="hljs-built_in">require</span>(<span class="hljs-string">'commander'</span>);

program.command(<span class="hljs-string">'create <app-name>'</span>)
    .description(<span class="hljs-string">'create a new project'</span>)
    <span class="hljs-comment">// -f or --force ä¸ºå¼ºåˆ¶åˆ›å»ºï¼Œå¦‚æœåˆ›å»ºçš„ç›®å½•å­˜åœ¨åˆ™ç›´æ¥è¦†ç›–</span>
    .option(<span class="hljs-string">'-f, --force'</span>, <span class="hljs-string">'overwrite target directory if it exist'</span>)
    .action(<span class="hljs-function">(<span class="hljs-params">name, options</span>) =></span> &#123;
        <span class="hljs-comment">// åœ¨ create.js ä¸­æ‰§è¡Œåˆ›å»ºä»»åŠ¡</span>
        <span class="hljs-built_in">require</span>(<span class="hljs-string">'../lib/create.js'</span>)(name, options)
    &#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å†æ¬¡æ‰§è¡Œ<code>caoyp create my-project</code>ï¼Œç»“æœæ‰“å°æ˜¾ç¤º</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  caoyp-cli git:(main) caoyp create my-project
-----create.js
my-project &#123;&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æŒ‰ç…§å¼€å¤´æè¿°çš„ï¼Œæˆ‘ä»¬è¿™ä¸ªæ—¶å€™éœ€è¦æ€è€ƒä¸€ä¸‹ï¼Œæˆ‘ä»¬åœ¨æ‰§è¡Œ<code>create</code>çš„æ—¶å€™ï¼Œé¡¹ç›®ç›®å½•åˆ°åº•æ˜¯å¦å­˜åœ¨ï¼›</p>
<ul>
<li>å¦‚æœå­˜åœ¨ï¼Œå‹æƒ…æç¤ºåˆ›å»ºé¡¹ç›®å·²ç»å­˜åœ¨ï¼›å¦‚æœå­˜åœ¨ç›¸åŒçš„é¡¹ç›®ç›®å½•ï¼Œä¸”åŠ ä¸Š-fï¼Œä»£è¡¨å¼ºåˆ¶æ‰§è¡Œï¼Œæ­¤æ—¶åˆ é™¤è€çš„ç›®å½•ï¼Œç›´æ¥åˆ›å»ºæ–°çš„ç›®å½•</li>
<li>å¦‚æœä¸å­˜åœ¨ï¼Œç›´æ¥åˆ›å»ºæ–°çš„ç›®å½•</li>
</ul>
<p>æˆ‘ä»¬éœ€è¦å€ŸåŠ©å¦å¤–ä¸€ä¸ªæ’ä»¶<a href="https://www.npmjs.com/package/fs-extra" target="_blank" rel="nofollow noopener noreferrer">fs-extra</a>æ¥è¾…åŠ©æˆ‘ä»¬åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼ŒåŒæ—¶å®‰è£…ä¸€ä¸‹<a href="https://www.npmjs.com/package/log-symbols" target="_blank" rel="nofollow noopener noreferrer">log-symbols</a>ï¼Œæ–¹ä¾¿æˆ‘ä»¬åœ¨æ—¥å¿—æ‰“å°çš„æ—¶å€™ï¼Œæ›´åŠ å‹å¥½çš„ç»™ç”¨æˆ·æç¤º</p>
<p>å®‰è£…ä¸€ä¸‹<code>fs-extra</code>ã€<code>log-symbols</code></p>
<pre><code class="copyable">npm i fs-extra log-symbols --save
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æˆ‘ä»¬æŒ‰ç…§ä¸Šè¾¹çš„æ€è·¯å†ç»§ç»­å®Œå–„ä¸€ä¸‹<code>create.js</code></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>);
<span class="hljs-keyword">const</span> symbols = <span class="hljs-built_in">require</span>(<span class="hljs-string">'log-symbols'</span>);

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, options</span>) </span>&#123;
    <span class="hljs-keyword">const</span> cwd = process.cwd();
    <span class="hljs-comment">// éœ€è¦åˆ›å»ºçš„ç›®å½•åœ°å€</span>
    <span class="hljs-keyword">const</span> targetAir = path.join(cwd, name);
    <span class="hljs-comment">// åˆ¤æ–­ç›®å½•æ˜¯å¦å·²ç»å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!fs.existsSync(targetAir)) &#123;
        <span class="hljs-comment">// TODOï¼šåˆ›å»ºæ–°çš„ç›®å½•</span>
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-built_in">console</span>.log(symbols.error, chalk.red(<span class="hljs-string">'é¡¹ç›®å·²å­˜åœ¨'</span>));
        <span class="hljs-comment">// æ˜¯å¦è¦å¼ºåˆ¶åˆ›å»º</span>
        <span class="hljs-keyword">if</span> (options.force) &#123;
            <span class="hljs-keyword">await</span> fs.remove(targetAir);
            <span class="hljs-comment">// TODOï¼šè¯¢é—®ç”¨æˆ·æ˜¯å¦ç¡®å®šè¦è¦†ç›–</span>
        &#125;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ ‡æ³¨<code>TODO</code>çš„é€»è¾‘ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹è¾¹å†è¯¦ç»†è®²è§£ã€‚</p>
<h4 data-id="heading-10">2.4 å®Œå–„å¸®åŠ©å‘½ä»¤</h4>
<p>ç»†å¿ƒçš„å°ä¼™ä¼´ä»¬åœ¨æˆ‘ä»¬ä½¿ç”¨<code>vue-cli</code>çš„æ—¶å€™ï¼Œ<code>--help</code>ä¼šå‘ç°æœ‰å¾ˆå¤šå¸®åŠ©å‘½ä»¤å¯ä»¥å¼•å¯¼æˆ‘ä»¬å¦‚ä½•âœ…çš„å§¿åŠ¿å»ä½¿ç”¨è„šæ‰‹æ¶ã€‚</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  ~ vue --<span class="hljs-built_in">help</span>
Usage: vue <<span class="hljs-built_in">command</span>> [options]

Options:
  -V, --version  output the version number
  -h, --<span class="hljs-built_in">help</span>     output usage information

Commands:
  init           generate a new project from a template
  list           list available official templates
  build          prototype a new project
  create         (<span class="hljs-keyword">for</span> v3 warning only)
  <span class="hljs-built_in">help</span> [cmd]     display <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> [cmd]
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ‰€ä»¥ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿæ¨¡ä»¿ä¸€ä¸‹<code>vue-cli</code>ï¼Œå®Œå–„ä¸€ä¸‹æˆ‘ä»¬çš„å¸®åŠ©å‘½ä»¤ï¼Œå…ˆå†å®‰è£…ä¸€ä¸‹<a href="https://www.npmjs.com/package/chalk" target="_blank" rel="nofollow noopener noreferrer">chalk</a>ï¼Œç”¨äºç¾åŒ–ä¸€ä¸‹å‘½ä»¤è¡Œï¼›<a href="https://www.npmjs.com/package/figlet" target="_blank" rel="nofollow noopener noreferrer">figlet</a>å¸®åŠ©æˆ‘ä»¬æ‰“å°ä¸€ä¸ªå±äºè‡ªå·±çš„logoã€‚</p>
<pre><code class="hljs language-sh copyable" lang="sh">const program = require(<span class="hljs-string">'commander'</span>);
const figlet = require(<span class="hljs-string">'figlet'</span>);
const chalk = require(<span class="hljs-string">'chalk'</span>);

program
  .on(<span class="hljs-string">'--help'</span>, () => &#123;
    console.log(<span class="hljs-string">'\r\n'</span> + figlet.textSync(<span class="hljs-string">'caoyp'</span>, &#123;
      font: <span class="hljs-string">'Ghost'</span>,
      horizontalLayout: <span class="hljs-string">'default'</span>,
      verticalLayout: <span class="hljs-string">'default'</span>,
      width: 80,
      whitespaceBreak: <span class="hljs-literal">true</span>
    &#125;));
    console.log(`\r\nRun <span class="hljs-variable">$&#123;chalk.cyan(`caoyp <command> --help`)&#125;</span> <span class="hljs-keyword">for</span> detailed usage of given <span class="hljs-built_in">command</span>\r\n`)
  &#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ‰§è¡Œ<code>caoyp --help</code>ï¼Œçœ‹çœ‹ä¼šæ‰“å°å‡ºä»€ä¹ˆ</p>
<pre><code class="hljs language-sh copyable" lang="sh">âœ  caoyp-cli git:(main) caoyp --<span class="hljs-built_in">help</span>
Usage: caoyp <<span class="hljs-built_in">command</span>> [option]

Options:
  -V, --version                output the version number
  -h, --<span class="hljs-built_in">help</span>                   display <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">command</span>

Commands:
  create [options] <app-name>  create a new project
  <span class="hljs-built_in">help</span> [<span class="hljs-built_in">command</span>]               display <span class="hljs-built_in">help</span> <span class="hljs-keyword">for</span> <span class="hljs-built_in">command</span>

             (<span class="hljs-string">'-.                                _ (`-.  
            ( OO ).-.                           ( (OO  ) 
   .-----.  / . --. / .-'</span>),-----.   ,--.   ,--._.`     \ 
  <span class="hljs-string">'  .--./  | \-.  \ ( OO'</span>  .-.  <span class="hljs-string">'   \  `.'</span>  /(__...--<span class="hljs-string">''</span> 
  |  |(<span class="hljs-string">'-..-'</span>-<span class="hljs-string">'  |  |/   |  | |  | .-'</span>)     /  |  /  | | 
 /_) |OO  )\| |_.<span class="hljs-string">'  |\_) |  |\|  |(OO  \   /   |  |_.'</span> | 
 ||  |`-<span class="hljs-string">'|  |  .-.  |  \ |  | |  | |   /  /\_  |  .___.'</span> 
(_<span class="hljs-string">'  '</span>--<span class="hljs-string">'\  |  | |  |   `'</span>  <span class="hljs-string">'-'</span>  <span class="hljs-string">' `-./  /.__) |  |      
   `-----'</span>  `--<span class="hljs-string">' `--'</span>     `-----<span class="hljs-string">'    `--'</span>      `--<span class="hljs-string">'      

Run caoyp <command> --help for detailed usage of given command
</span><span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<h3 data-id="heading-11">3. è¯¢é—®ç”¨æˆ·è·å–åˆ›å»ºçš„ä¿¡æ¯</h3>
<p>è¿˜æ˜¯è€è§„çŸ©ï¼ŒåŠ¨æ‰‹ä¹‹å‰æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹è¯¢é—®ç”¨æˆ·ä¿¡æ¯è¯¥å¦‚ä½•å»åšï¼Ÿ</p>
<ol>
<li>å®Œå–„ä¸Šä¸€æ­¥TODOï¼šè¯¢é—®ç”¨æˆ·å·²ç»å­˜åœ¨çš„ç›®å½•æ˜¯å¦è¦è¦†ç›–ä¸‹è½½æœ€æ–°çš„</li>
</ol>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>);
<span class="hljs-keyword">const</span> symbols = <span class="hljs-built_in">require</span>(<span class="hljs-string">'log-symbols'</span>);

<span class="hljs-built_in">module</span>.exports = <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name, options</span>) </span>&#123;
    <span class="hljs-keyword">const</span> cwd = process.cwd();
    <span class="hljs-comment">// éœ€è¦åˆ›å»ºçš„ç›®å½•åœ°å€</span>
    <span class="hljs-keyword">const</span> targetAir = path.join(cwd, name);
    <span class="hljs-comment">// åˆ¤æ–­ç›®å½•æ˜¯å¦å·²ç»å­˜åœ¨</span>
    <span class="hljs-keyword">if</span> (!fs.existsSync(targetAir)) &#123;
        <span class="hljs-comment">// åˆ›å»ºæ–°çš„ç›®å½•</span>
        fn(name, targetAir);
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-built_in">console</span>.log(symbols.error, chalk.red(<span class="hljs-string">'é¡¹ç›®å·²å­˜åœ¨'</span>));
        <span class="hljs-comment">// æ˜¯å¦è¦å¼ºåˆ¶åˆ›å»º</span>
        <span class="hljs-keyword">if</span> (options.force) &#123;
            <span class="hljs-keyword">await</span> fs.remove(targetAir);
            <span class="hljs-comment">// åˆ›å»ºæ–°çš„ç›®å½•</span>
            fn(name, targetAir);
        &#125;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="2">
<li>è‡ªå®šä¹‰æ¨¡æ¿ä¿¡æ¯</li>
</ol>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> fn = <span class="hljs-function">(<span class="hljs-params">name, targetAir</span>) =></span> &#123;
    <span class="hljs-comment">// è‡ªå®šä¹‰æ¨¡æ¿é¡¹ç›®ä¿¡æ¯</span>
    inquirer.prompt([
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'version'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®ç‰ˆæœ¬'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">'1.0.0'</span>
        &#125;,
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'description'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®æè¿°ä¿¡æ¯'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰è„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®'</span>
        &#125;,
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'author'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥ä½œè€…åç§°'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>
        &#125;
    ]).then(<span class="hljs-function"><span class="hljs-params">res</span> =></span> &#123;
        <span class="hljs-comment">// TODO ä¸‹è½½githubæ¨¡æ¿</span>
    &#125;)
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å†æ¬¡è¾“å…¥<code>caoyp create my-project</code>ï¼Œä¼šå‘ç°æœ‰å¯¹åº”çš„æ¨¡æ¿ä¿¡æ¯éœ€è¦æˆ‘ä»¬å¡«å†™ï¼Œåˆ›å»ºä¸€ä¸ªç©ºçš„<code>my-project</code>ç›®å½•ï¼›å¦‚æœè¾“å…¥<code>caoyp create my-project -f</code>ï¼Œå›è½¦åä¼šå‘ç°ä¸Šæ¬¡åˆ›å»ºçš„<code>my-project</code>ç›®å½•è¢«ç§»é™¤æ‰ï¼Œé‡æ–°è®©æˆ‘ä»¬è¾“å…¥å¯¹åº”çš„æ¨¡æ¿ä¿¡æ¯ï¼Œé‡æ–°åˆ›å»ºæ–°çš„æ¨¡æ¿é¡¹ç›®ï¼›</p>
<h3 data-id="heading-12">4. ä»githubä¸‹è½½ç”¨æˆ·éœ€è¦çš„æ¨¡æ¿</h3>
<p>è¿˜æ˜¯è€è§„çŸ©ï¼ŒåŠ¨æ‰‹ä¹‹å‰æˆ‘ä»¬å…ˆæ¥åˆ†æä¸€ä¸‹è¯¥å¦‚ä½•ä»<code>github</code>ä¸‹è½½ç”¨æˆ·éœ€è¦çš„æ¨¡æ¿ï¼Ÿ</p>
<ol>
<li><code>github</code>ä¸Šæˆ‘ä»¬æå‰å·²ç»ä¸Šä¼ å¥½é»˜è®¤çš„ä¸‹è½½ <a href="https://github.com/Paulinho89/webpack5-single-template" target="_blank" rel="nofollow noopener noreferrer">æ¨¡æ¿</a></li>
</ol>
<p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b29ee907ed494f6b8d102c1f73ba19eb~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<ol start="2">
<li>å€ŸåŠ©<code>download-git-repo</code>è¾…åŠ©ä¸‹è½½æ¨¡æ¿</li>
</ol>
<p>å…ˆå®‰è£…ä¸€ä¸‹ä¾èµ–<a href="https://www.npmjs.com/package/download-git-repo" target="_blank" rel="nofollow noopener noreferrer">download-git-repo</a>ç”¨äºä¸‹è½½githubä¸­çš„æ¨¡æ¿ï¼›<a href="https://www.npmjs.com/package/handlebars" target="_blank" rel="nofollow noopener noreferrer">handlebars</a>ç”¨æˆ·åŠ¨æ€çš„æ¸²æŸ“æ¨¡æ¿æç¤ºä¿¡æ¯ï¼›<a href="https://www.npmjs.com/package/ora" target="_blank" rel="nofollow noopener noreferrer">ora</a>ä¸‹è½½çš„æ—¶å€™ç»™ä¸€ä¸ª<code>loading</code>æ•ˆæœã€‚</p>
<pre><code class="copyable">npm i download-git-repo handlebars ora --save
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><code>./lib</code>ç›®å½•ä¸‹åˆ›å»º<code>generator.js</code>æ–‡ä»¶</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> ora = <span class="hljs-built_in">require</span>(<span class="hljs-string">'ora'</span>);
<span class="hljs-keyword">const</span> symbols = <span class="hljs-built_in">require</span>(<span class="hljs-string">'log-symbols'</span>);
<span class="hljs-keyword">const</span> inquirer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'inquirer'</span>);
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs-extra'</span>);
<span class="hljs-keyword">const</span> downloadGitRepo = <span class="hljs-built_in">require</span>(<span class="hljs-string">'download-git-repo'</span>);
<span class="hljs-keyword">const</span> chalk = <span class="hljs-built_in">require</span>(<span class="hljs-string">'chalk'</span>);
<span class="hljs-keyword">const</span> handlebar = <span class="hljs-built_in">require</span>(<span class="hljs-string">'handlebars'</span>);

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generator</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-title">constructor</span>(<span class="hljs-params">name, targetDir, res</span>)</span> &#123;
        <span class="hljs-built_in">this</span>.name = name;
        <span class="hljs-built_in">this</span>.targetDir = targetDir;
        <span class="hljs-built_in">this</span>.res = res;
    &#125;

    <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-title">download</span>(<span class="hljs-params"></span>)</span> &#123;
        <span class="hljs-comment">// 1ï¼‰æ‹¼æ¥ä¸‹è½½åœ°å€</span>
        <span class="hljs-keyword">const</span> requestUrl = <span class="hljs-string">`github.com:Paulinho89/webpack5-single-template#master`</span>;
        <span class="hljs-keyword">const</span> spinner = ora(<span class="hljs-string">`æ­£åœ¨ä¸‹è½½æ¨¡æ¿ï¼Œæºåœ°å€ï¼š<span class="hljs-subst">$&#123;requestUrl&#125;</span>`</span>);
        spinner.start();
        <span class="hljs-comment">// 2ï¼‰è°ƒç”¨ä¸‹è½½æ–¹æ³•</span>
        <span class="hljs-keyword">await</span> downloadGitRepo(
            <span class="hljs-comment">// ç›´è¿ä¸‹è½½ï¼Œé»˜è®¤ä¸‹è½½master</span>
            requestUrl,
            <span class="hljs-built_in">this</span>.targetDir,
            <span class="hljs-function">(<span class="hljs-params">error</span>) =></span> &#123;
                <span class="hljs-keyword">if</span> (error) &#123;
                    spinner.fail();
                   <span class="hljs-comment">// ä¸‹è½½å¤±è´¥ç»™å‡ºå‹æƒ…æç¤º console.log(symbols.error, chalk.red(error));</span>
                &#125; <span class="hljs-keyword">else</span> &#123;
                    spinner.succeed();
                    <span class="hljs-keyword">const</span> fileName =  <span class="hljs-string">`<span class="hljs-subst">$&#123;<span class="hljs-built_in">this</span>.name&#125;</span>/package.json`</span>;
                    <span class="hljs-comment">// ä¸‹è½½æˆåŠŸåè·å–å‘½ä»¤è¡Œè¾“å…¥çš„æç¤ºä¿¡æ¯</span>
                    <span class="hljs-keyword">const</span> meta = &#123;
                        <span class="hljs-attr">name</span>: <span class="hljs-built_in">this</span>.name,
                        <span class="hljs-attr">version</span>: <span class="hljs-built_in">this</span>.res.version,
                        <span class="hljs-attr">description</span>: <span class="hljs-built_in">this</span>.res.description,
                        <span class="hljs-attr">author</span>: <span class="hljs-built_in">this</span>.res.author
                    &#125;
                    <span class="hljs-comment">// &#123;&#123;name&#125;&#125;/package.jsonè·¯å¾„å­˜åœ¨æ—¶</span>
                    <span class="hljs-keyword">if</span> (fs.existsSync(fileName)) &#123;
                    <span class="hljs-comment">// è¯»å–æç¤ºä¿¡æ¯</span>
                    <span class="hljs-keyword">const</span> content = fs.readFileSync(fileName).toString();
                    <span class="hljs-keyword">const</span> resultContent = handlebar.compile(content)(meta); <span class="hljs-comment">//å†™å…¥æç¤ºä¿¡æ¯åˆ°æ¨¡æ¿é¡¹ç›®çš„package.jsonæ–‡ä¸­ </span>
                    fs.writeFileSync(fileName, resultContent);
                    &#125;
                    <span class="hljs-built_in">console</span>.log(symbols.success, chalk.green(<span class="hljs-string">'é¡¹ç›®åˆå§‹åŒ–æˆåŠŸ'</span>))
                    <span class="hljs-built_in">console</span>.log(symbols.info, <span class="hljs-string">`\r\n  cd <span class="hljs-subst">$&#123;chalk.cyan(<span class="hljs-built_in">this</span>.name)&#125;</span>`</span>)
                    <span class="hljs-built_in">console</span>.log(symbols.info, <span class="hljs-string">`\r\n  npm install`</span>)
                    <span class="hljs-built_in">console</span>.log(symbols.info, <span class="hljs-string">'npm run start\r\n'</span>)
                &#125;
            &#125;
        )
    &#125;
&#125;

<span class="hljs-built_in">module</span>.exports = Generator;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å…³äºä¸‹è½½<code>downloadGitRepo()</code>æ–¹æ³•ä½¿ç”¨æ—¶ä¼šç»å¸¸æŠ¥å‡ºè·¯å¾„é”™è¯¯å¯¼è‡´ä¸‹è½½æ¨¡æ¿å¤±è´¥<code>--git clone status 128</code></p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></p>
<p><strong>é”™è¯¯çš„å†™æ³•ï¼š</strong></p>
<ul>
<li>ç›´æ¥å»githubæ¨¡æ¿é“¾æ¥å½“åšç¬¬ä¸€ä¸ªå‚æ•°ç›´æ¥ä¼ é€’</li>
<li>ä½¿ç”¨&#123;clone: true&#125;</li>
</ul>
<pre><code class="hljs language-js copyable" lang="js">downloadGitRepo(<span class="hljs-string">'https://github.com/Paulinho89/webpack5-single-template'</span>, name, &#123;<span class="hljs-attr">clone</span>: <span class="hljs-literal">true</span>&#125;, <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> &#123;
    <span class="hljs-built_in">console</span>.log(err ? <span class="hljs-string">'Fail'</span> : <span class="hljs-string">'Success'</span>)
&#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>æ­£ç¡®çš„å†™æ³•ï¼š</strong></p>
<ul>
<li>ä½¿ç”¨github.com:ç”¨æˆ·å/æ¨¡æ¿åç§°#åˆ†æ”¯åç§°</li>
<li>å»æ‰&#123;clone: true&#125;</li>
</ul>
<pre><code class="hljs language-js copyable" lang="js">downloadGitRepo(<span class="hljs-string">'github.com:Paulinho89/webpack5-single-template#master'</span>, name, <span class="hljs-function">(<span class="hljs-params">err</span>) =></span> &#123;
    <span class="hljs-built_in">console</span>.log(err ? <span class="hljs-string">'Fail'</span> : <span class="hljs-string">'Success'</span>)
&#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="3">
<li>å®Œå–„ä¸Šä¸€æ­¥TODOï¼šä¸‹è½½æˆåŠŸä¹‹åï¼Œå°†æ¯æ¬¡è¾“å…¥è‡ªå®šä¹‰çš„æ¨¡æ¿ä¿¡æ¯å¡«å……åˆ°æ¨¡æ¿é¡¹ç›®çš„<code>package.json</code>ä¸­å»</li>
</ol>
<p>æ¨¡æ¿é¡¹ç›®çš„<code>package.json</code>ä¸­çš„<code>version</code>ã€ <code>description</code>ã€<code>author</code>è¿™å‡ ä¸ªå­—æ®µæˆ‘ä»¬å¯ä»¥å†™æˆåŠ¨æ€æ¸²æŸ“çš„æ¨¡å¼ã€‚</p>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"webpack-single-template"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"&#123;&#123;version&#125;&#125;"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"&#123;&#123;description&#125;&#125;"</span>,
  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"start"</span>: <span class="hljs-string">"webpack serve --config build/webpack.config.dev.js"</span>,
    <span class="hljs-attr">"build:test"</span>: <span class="hljs-string">"rimraf dist && webpack --config build/webpack.config.test.js"</span>,
    <span class="hljs-attr">"build:prod"</span>: <span class="hljs-string">"rimraf dist && webpack --config build/webpack.config.prod.js"</span>,
    <span class="hljs-attr">"lint"</span>: <span class="hljs-string">"eslint --fix --ext .vue,.js src build"</span>,
    <span class="hljs-attr">"lint-staged"</span>: <span class="hljs-string">"lint-staged"</span>,
    <span class="hljs-attr">"build:stats"</span>: <span class="hljs-string">"webpack --config build/webpack.config.prod.js --json > stats.json"</span>,
    <span class="hljs-attr">"analyz"</span>: <span class="hljs-string">"cross-env NODE_ENV=production ANALYZE=true npm_config_report=true npm run prod"</span>,
    <span class="hljs-attr">"dll"</span>: <span class="hljs-string">"webpack --config build/webpack.config.dll"</span>
  &#125;,
  <span class="hljs-attr">"pre-commit"</span>: [
    <span class="hljs-string">"lint-staged"</span>
  ],
  <span class="hljs-attr">"lint-staged"</span>: &#123;
    <span class="hljs-attr">"*.&#123;js, vue&#125;"</span>: [
      <span class="hljs-string">"eslint --fix"</span>,
      <span class="hljs-string">"git add"</span>
    ]
  &#125;,
  <span class="hljs-attr">"author"</span>: <span class="hljs-string">"&#123;&#123;author&#125;&#125;"</span>,
  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span>
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-keyword">const</span> Generator = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./generator'</span>);

<span class="hljs-keyword">const</span> fn = <span class="hljs-function">(<span class="hljs-params">name, targetAir</span>) =></span> &#123;
    <span class="hljs-comment">// è‡ªå®šä¹‰æ¨¡æ¿é¡¹ç›®ä¿¡æ¯</span>
    inquirer.prompt([
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'version'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®ç‰ˆæœ¬'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">'1.0.0'</span>
        &#125;,
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'description'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥é¡¹ç›®æè¿°ä¿¡æ¯'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">'è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰è„šæ‰‹æ¶ç”Ÿæˆçš„é¡¹ç›®'</span>
        &#125;,
        &#123;
            <span class="hljs-attr">name</span>: <span class="hljs-string">'author'</span>,
            <span class="hljs-attr">message</span>: <span class="hljs-string">'è¯·è¾“å…¥ä½œè€…åç§°'</span>,
            <span class="hljs-attr">default</span>: <span class="hljs-string">''</span>
        &#125;
    ]).then(<span class="hljs-function"><span class="hljs-params">res</span> =></span> &#123;
       <span class="hljs-comment">// åˆ›å»ºé¡¹ç›®</span>
        <span class="hljs-keyword">const</span> generator = <span class="hljs-keyword">new</span> Generator(name, targetAir, res);
        generator.download();
    &#125;)
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å½“ä¸‹è½½æ¨¡æ¿å®Œæˆä¹‹åä¼šå°†ç”¨æˆ·è¾“å…¥çš„ç­”æ¡ˆæ¸²æŸ“åˆ° <code>package.json </code>ä¸­ã€‚</p>
<h3 data-id="heading-13">5. å‘å¸ƒé¡¹ç›®</h3>
<p>ç»è¿‡ä¸Šè¾¹çš„é€»è¾‘æ¢³ç†åï¼Œæˆ‘ä»¬æ­å»ºçš„ç®€æ˜“è„šæ‰‹æ¶å·²ç»å®Œæˆäº†ï¼Œæˆ‘ä»¬åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™éƒ½æ˜¯éœ€è¦å‘å¸ƒåˆ°npmä»“åº“é‡Œçš„ã€‚</p>
<p>å‘å¸ƒæµç¨‹ï¼š</p>
<ol>
<li>æ³¨å†Œä¸€ä¸ª<code>npmè´¦å·</code></li>
</ol>
<p>å¦‚æœæ˜¯æ–°æ³¨å†Œçš„è´¦å·ï¼Œéœ€è¦å…ˆç™»å½•å¡«å†™çš„é‚®ç®±è¿›è¡ŒéªŒè¯ï¼Œå¦åˆ™ç›´æ¥å‘å¸ƒçš„è¯å‘å¸ƒå¤±è´¥ã€‚</p>
<ol start="2">
<li>å®Œå–„<code>package.json</code>ä¸­çš„é…ç½®ï¼Œç¡®å®šå‘å¸ƒçš„ç‰ˆæœ¬å·</li>
</ol>
<pre><code class="hljs language-json copyable" lang="json">&#123;
  <span class="hljs-attr">"name"</span>: <span class="hljs-string">"caoyp-cli"</span>,
  <span class="hljs-attr">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-attr">"description"</span>: <span class="hljs-string">"å‰ç«¯å•é¡µè„šæ‰‹æ¶"</span>,
  <span class="hljs-attr">"main"</span>: <span class="hljs-string">"index.js"</span>,
  <span class="hljs-attr">"bin"</span>: &#123;
    <span class="hljs-attr">"caoyp"</span>: <span class="hljs-string">"./bin/cli.js"</span>
  &#125;,
  <span class="hljs-attr">"directories"</span>: &#123;
    <span class="hljs-attr">"lib"</span>: <span class="hljs-string">"lib"</span>
  &#125;,
  <span class="hljs-attr">"scripts"</span>: &#123;
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"echo \"Error: no test specified\" && exit 1"</span>
  &#125;,
  <span class="hljs-attr">"repository"</span>: &#123;
    <span class="hljs-attr">"type"</span>: <span class="hljs-string">"git"</span>,
    <span class="hljs-attr">"url"</span>: <span class="hljs-string">"git+https://github.com/Paulinho89/caoyp-cli.git"</span>
  &#125;,
  <span class="hljs-attr">"author"</span>: <span class="hljs-string">"caoyp"</span>,
  <span class="hljs-attr">"keywords"</span>: [
    <span class="hljs-string">"caoyp-cli"</span>,
    <span class="hljs-string">"caoyp"</span>,
    <span class="hljs-string">"è„šæ‰‹æ¶"</span>
  ],
  <span class="hljs-attr">"license"</span>: <span class="hljs-string">"ISC"</span>,
  <span class="hljs-attr">"bugs"</span>: &#123;
    <span class="hljs-attr">"url"</span>: <span class="hljs-string">"https://github.com/Paulinho89/caoyp-cli/issues"</span>
  &#125;,
  <span class="hljs-attr">"homepage"</span>: <span class="hljs-string">"https://github.com/Paulinho89/caoyp-cli#readme"</span>,
  <span class="hljs-attr">"dependencies"</span>: &#123;
    <span class="hljs-attr">"axios"</span>: <span class="hljs-string">"^0.21.1"</span>,
    <span class="hljs-attr">"chalk"</span>: <span class="hljs-string">"^4.1.1"</span>,
    <span class="hljs-attr">"commander"</span>: <span class="hljs-string">"^7.2.0"</span>,
    <span class="hljs-attr">"download-git-repo"</span>: <span class="hljs-string">"^3.0.2"</span>,
    <span class="hljs-attr">"figlet"</span>: <span class="hljs-string">"^1.5.0"</span>,
    <span class="hljs-attr">"fs-extra"</span>: <span class="hljs-string">"^10.0.0"</span>,
    <span class="hljs-attr">"handlebars"</span>: <span class="hljs-string">"^4.7.7"</span>,
    <span class="hljs-attr">"inquirer"</span>: <span class="hljs-string">"^8.1.1"</span>,
    <span class="hljs-attr">"log-symbols"</span>: <span class="hljs-string">"^3.0.0"</span>,
    <span class="hljs-attr">"ora"</span>: <span class="hljs-string">"^5.4.1"</span>
  &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ol start="3">
<li>ä½¿ç”¨<code>npm publish</code>å‘å¸ƒ</li>
</ol>
<pre><code class="copyable">npm publish
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å‘å¸ƒæˆåŠŸä¹‹åï¼Œå¯ä»¥è¿›å…¥åˆ°npmä¸ªäººä»“åº“é‡Œï¼Œçœ‹åˆ°è‡ªå·±å‘å¸ƒçš„åŒ…ã€‚</p>
<p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/aef61ff2e23341fb955182c815082b5e~tplv-k3u1fbpfcp-watermark.image" alt="image.png" loading="lazy" referrerpolicy="no-referrer"></p>
<p>æŒ‰ç…§æˆ‘ä»¬<code>README.md</code>ä¸­å®šä¹‰å¥½çš„å®‰è£…å‘½ä»¤æŠŠè„šæ‰‹æ¶<code>install</code>åˆ°æˆ‘ä»¬çš„æœ¬åœ°ï¼Œç„¶ååˆ›å»ºï¼Œé‡å¯ï¼Œä¸€åˆ‡æ­£å¸¸ï¼›OKï¼Œè¿™æ—¶æˆ‘ä»¬çš„è„šæ‰‹æ¶ä»é¡¹ç›®æ­å»ºåˆ°å‘å¸ƒæ•´ä¸ªæµç¨‹å°±ç®—ç»“æŸäº†ã€‚</p>
<h2 data-id="heading-14">å†™åˆ°æœ€å</h2>
<ul>
<li>ç›®å‰ï¼Œè¿™ä¸ªè„šæ‰‹æ¶è¿˜æ˜¯åäºç®€å•ï¼Œæœ‰äº›æ­¥éª¤è¿˜éœ€è¦è¿›ä¸€æ­¥å®Œå–„ï¼Œåƒæˆ‘ä»¬åœ¨å‘è¿œç«¯ä»“åº“æ‹‰å–æ¨¡æ¿çš„æ—¶å€™ï¼Œé€šå¸¸æˆ‘ä»¬åœ¨å®é™…çš„å¼€å‘è¿‡ç¨‹ä¸­ä¼šæœ‰<code>å¤šä¸ªç‰ˆæœ¬çš„æ¨¡æ¿</code>ï¼Œä¸”æ¯ä¸ªæ¨¡æ¿éƒ½ä¼šæœ‰<code>ä¸åŒçš„tag</code>ï¼›æ¯æ¬¡æ‹‰å–å¯ä»¥é€šè¿‡é€‰æ‹©ä¸åŒçš„ç‰ˆæœ¬æ¨¡æ¿ã€ä¸åŒçš„tagã€æ·»åŠ æ›´å¤šçš„æ¨¡æ¿ã€åˆ é™¤æ¨¡æ¿ç­‰ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä¹Ÿä¼šå°†è¿™äº›åŠŸèƒ½æŒç»­å®Œå–„åˆ°è„šæ‰‹æ¶ä¸­ã€‚</li>
</ul>
<p>å¦‚æœæ‚¨è§‰å¾—è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æœ‰ä¸€ç‚¹ç‚¹å¸®åŠ©ï¼Œæ¬¢è¿æ‚¨çœ‹å®Œåç»™æˆ‘<code>ç‚¹èµ</code>ã€<code>è¯„è®º</code>ã€<code>å…³æ³¨</code>æ”¯æŒä¸€ä¸‹ï¼Œæ‚¨çš„æ”¯æŒæ˜¯æˆ‘å†™ä½œçš„åŠ¨åŠ›ï¼Œè°¢è°¢~~ğŸ˜</p>
<p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/055781290e2f4d8aae54695023ccf983~tplv-k3u1fbpfcp-watermark.image" alt="images.jpeg" loading="lazy" referrerpolicy="no-referrer"></p></div>  
</div>
            