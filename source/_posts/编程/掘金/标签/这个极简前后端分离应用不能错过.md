
---
title: '这个极简前后端分离应用不能错过'
categories: 
 - 编程
 - 掘金
 - 标签
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60f8017f8a2b4336b9c836151fffbf57~tplv-k3u1fbpfcp-zoom-1.image'
author: 掘金
comments: false
date: Fri, 11 Jun 2021 23:31:50 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60f8017f8a2b4336b9c836151fffbf57~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:15px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:30px;margin-bottom:5px&#125;.markdown-body h2&#123;padding-bottom:12px;font-size:24px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h4&#123;font-size:16px&#125;.markdown-body h5&#123;font-size:15px&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><h1 data-id="heading-0">这个极简前后端分离应用不能错过</h1>
<p>这是一个极简的代码展示，使用koa web服务渲染网站静态页面。</p>
<h1 data-id="heading-1">系统组件组成</h1>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/60f8017f8a2b4336b9c836151fffbf57~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer"></p>
<p>前端服务的文件列表：
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a7aabc561a59400180872604d7a0180d~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer">
读者可自行准备package.json, 本文使用以下版本：</p>
<pre><code class="copyable">"koa": "^2.13.1",
"koa-router": "^10.0.0",
"koa-static": "^5.0.0"
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-2">直接懒人复制 package.json</h1>
<pre><code class="hljs language-js copyable" lang="js">&#123;
  <span class="hljs-string">"name"</span>: <span class="hljs-string">"uiapp"</span>,
  <span class="hljs-string">"version"</span>: <span class="hljs-string">"1.0.0"</span>,
  <span class="hljs-string">"description"</span>: <span class="hljs-string">"uiapp by levin"</span>,
  <span class="hljs-string">"main"</span>: <span class="hljs-string">"app.js"</span>,
  <span class="hljs-string">"scripts"</span>: &#123;
    <span class="hljs-string">"start"</span>: <span class="hljs-string">"node app.js"</span>
  &#125;,
  <span class="hljs-string">"keywords"</span>: [],
  <span class="hljs-string">"author"</span>: <span class="hljs-string">"levin"</span>,
  <span class="hljs-string">"dependencies"</span>: &#123;
    <span class="hljs-string">"koa"</span>: <span class="hljs-string">"^2.13.1"</span>,
    <span class="hljs-string">"koa-router"</span>: <span class="hljs-string">"^10.0.0"</span>,
    <span class="hljs-string">"koa-static"</span>: <span class="hljs-string">"^5.0.0"</span>
  &#125;
&#125;
<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-3">app.js 应用入口代码</h1>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-keyword">const</span> koa = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa'</span>);  
<span class="hljs-keyword">const</span> serve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'koa-static'</span>); 
<span class="hljs-keyword">const</span> path=<span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);

<span class="hljs-comment">// 启动koa web服务</span>
<span class="hljs-keyword">const</span> app = <span class="hljs-keyword">new</span> koa()

<span class="hljs-comment">// 加载静态页面</span>
<span class="hljs-keyword">var</span> staticPath = path.join(__dirname + <span class="hljs-string">'/static'</span>);
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'static-path:'</span>, staticPath)
app.use(serve(staticPath))

<span class="hljs-built_in">console</span>.log(<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>())
<span class="hljs-keyword">const</span> PORT = <span class="hljs-number">8080</span>
<span class="hljs-built_in">console</span>.log(<span class="hljs-string">'start app at port %s'</span>, PORT)
app.listen(PORT);
<span class="copy-code-btn">复制代码</span></code></pre>
<p>思路：启动一个koa 服务，并使用koa-static中间件渲染当前应用下的static文件夹的静态文件，会默认加载index.html首页。</p>
<p>好，接下来。开发我们的UI站点。</p>
<h1 data-id="heading-4">UI站点</h1>
<h2 data-id="heading-5">先写index.html</h2>
<p>下面代码主要使用了axios和一个getProduct.js。
当首页加载的时候，getProduct.js 会获取后台产品服务展示产品。</p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">html</span>></span>
<span class="hljs-tag"><<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">title</span>></span>雷学委-UI FrontendSerivce<span class="hljs-tag"></<span class="hljs-name">title</span>></span>
<span class="hljs-tag"></<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">body</span>></span>
<span class="hljs-tag"><<span class="hljs-name">h1</span>></span>这是一个前后段分离的应用！<span class="hljs-tag"></<span class="hljs-name">h1</span>></span>
<span class="hljs-tag"><<span class="hljs-name">h2</span>></span>后端数据展示："http://localhost:8081"<span class="hljs-tag"></<span class="hljs-name">h2</span>></span>
<span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"result"</span> ></span><span class="hljs-tag"></<span class="hljs-name">div</span>></span>
<span class="hljs-tag"></<span class="hljs-name">body</span>></span>
<span class="hljs-tag"><<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"https://unpkg.com/axios/dist/axios.min.js"</span>></span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"><<span class="hljs-name">script</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"/getProducts.js"</span> ></span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"></<span class="hljs-name">html</span>></span>
<span class="copy-code-btn">复制代码</span></code></pre>
<h2 data-id="heading-6">接下来是getProducts.js</h2>
<p>这个内部使用了axios调用了产品服务（第三方服务）的接口（<a href="http://localhost:8081/products%EF%BC%89" target="_blank" rel="nofollow noopener noreferrer">http://localhost:8081/products）</a> ，然后分别针对请求成功和失败把状态写到id为“result” 的div上。</p>
<p>调用第三方服务成功显示绿色背景，失败显示红色背景。</p>
<p><strong>重点来了：
复杂的web 应用中会有很多getProducts这样的JS更后端多个接口进行交互，然后再把交互完的数据更新反馈到UI层，这个不管是Angular/React/Vue都是如此。</strong></p>
<pre><code class="hljs language-html copyable" lang="html">function $(id)&#123;
    return document.getElementById(id)
&#125;

function handleOnData(data)&#123;
    $('result').innerHTML = '<span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background:green"</span>></span>' 
         + JSON.stringify(data)
         + '<span class="hljs-tag"></<span class="hljs-name">div</span>></span>'
&#125;

function handleOnError(msg)&#123;
    $('result').innerHTML = '<span class="hljs-tag"><<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"background:red"</span>></span>' 
         + JSON.stringify(msg)
         + '<span class="hljs-tag"></<span class="hljs-name">div</span>></span>'
&#125;

// 第三方接口（产品服务接口）
// 代码实现：https://blog.csdn.net/geeklevin/article/details/109403172 
var api = 'http://localhost:8081/products'
console.log('will get products from api:' , api);
axios.get(api)
.then(function (response) &#123;
    handleOnData(response.data);
&#125;)
.catch(function (error) &#123;
    console.log(error);
    handleOnError('后端服务已下线！');
&#125;);

<span class="copy-code-btn">复制代码</span></code></pre>
<h1 data-id="heading-7">后端的产品服务实现代码</h1>
<p>请复制： <a href="https://blog.csdn.net/geeklevin/article/details/109403172" target="_blank" rel="nofollow noopener noreferrer">NodeJS 后端开发 03 使用Restify开发API 一个完整的CRUD
</a> ， 改一下端口为8081，并参考该文章启动。</p>
<h1 data-id="heading-8">效果演示</h1>
<p>UI启动命令如下，下面两个图左边为UI服务主页，右边为产品服务接口浏览器打开的状态。</p>
<pre><code class="copyable">node app.js #启动UI服务。
<span class="copy-code-btn">复制代码</span></code></pre>
<p>启动后台服务（右边已不可访问），左边的UI站点显示产品的JSON数据！</p>
<p>UI读者可以自行绘制更漂亮的，请尽情发挥想象。</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6cf2c3ee5ca942aba6e5d46f1bfd2a88~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer">
停止后台服务（右边已不可访问），左边的UI站点显示产品后台服务已下线！
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a11a29e0bffc4090a126c8997b0a946c~tplv-k3u1fbpfcp-zoom-1.image" alt="在这里插入图片描述" loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-9">思想总结</h2>
<p>前后端分离更多是解耦合大原则指导下在web应用上的呈现。</p>
<p>像过去有Swing, Qt或者C#UI，也能应用这个思想。
把界面/页面跟后端代码通过使用API（web API）来实现无缝整合。
这样还能实现技术上异构（web服务NodeJS，后端用Springboot/PythonDjango等），弹性很大又不会导致架构过度离散。</p>
<p>前后端分离是行业的标准做法！</p>
<p>看完本文，您学会了吗？
不妨试试使用熟悉的技术自己做一次，或者找一两个朋友按着本文分别开发一个服务并整合起来，互相讨论，这样技术进步很明显。</p>
<p>希望读者们都完全掌握理解，把握重点。</p>
<p>需要学习更多NodeJS知识可以关注： <a href="https://blog.csdn.net/geeklevin/category_10461966.html" target="_blank" rel="nofollow noopener noreferrer">雷学委的NodeJS专栏</a></p></div>  
</div>
            