
---
title: 'å¾®ä¿¡å°ç¨‹åºåº•å±‚æ¡†æ¶å®ç°åŸç†ï½œä¸‡å­—é•¿æ–‡'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - æ ‡ç­¾
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f59dd6330bbc47e9af27a2a7e64b9cbf~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image'
author: æ˜é‡‘
comments: false
date: Tue, 06 Sep 2022 21:44:21 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f59dd6330bbc47e9af27a2a7e64b9cbf~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image'
---

<div>   
<div class="markdown-body cache"><style>.markdown-body&#123;word-break:break-word;line-height:1.75;font-weight:400;font-size:16px;overflow-x:hidden;color:#333&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;line-height:1.5;margin-top:35px;margin-bottom:10px;padding-bottom:5px&#125;.markdown-body h1&#123;font-size:24px;margin-bottom:5px&#125;.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;font-size:20px&#125;.markdown-body h2&#123;padding-bottom:12px;border-bottom:1px solid #ececec&#125;.markdown-body h3&#123;font-size:18px;padding-bottom:0&#125;.markdown-body h6&#123;margin-top:5px&#125;.markdown-body p&#123;line-height:inherit;margin-top:22px;margin-bottom:22px&#125;.markdown-body img&#123;max-width:100%&#125;.markdown-body hr&#123;border:none;border-top:1px solid #ddd;margin-top:32px;margin-bottom:32px&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body code,.markdown-body pre&#123;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body a&#123;text-decoration:none;color:#0269c8;border-bottom:1px solid #d1e9ff&#125;.markdown-body a:active,.markdown-body a:hover&#123;color:#275b8c&#125;.markdown-body table&#123;display:inline-block!important;font-size:12px;width:auto;max-width:100%;overflow:auto;border:1px solid #f6f6f6&#125;.markdown-body thead&#123;background:#f6f6f6;color:#000;text-align:left&#125;.markdown-body tr:nth-child(2n)&#123;background-color:#fcfcfc&#125;.markdown-body td,.markdown-body th&#123;padding:12px 7px;line-height:24px&#125;.markdown-body td&#123;min-width:120px&#125;.markdown-body blockquote&#123;color:#666;padding:1px 23px;margin:22px 0;border-left:4px solid #cbcbcb;background-color:#f8f8f8&#125;.markdown-body blockquote:after&#123;display:block;content:""&#125;.markdown-body blockquote>p&#123;margin:10px 0&#125;.markdown-body ol,.markdown-body ul&#123;padding-left:28px&#125;.markdown-body ol li,.markdown-body ul li&#123;margin-bottom:0;list-style:inherit&#125;.markdown-body ol li .task-list-item,.markdown-body ul li .task-list-item&#123;list-style:none&#125;.markdown-body ol li .task-list-item ol,.markdown-body ol li .task-list-item ul,.markdown-body ul li .task-list-item ol,.markdown-body ul li .task-list-item ul&#123;margin-top:0&#125;.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul&#123;margin-top:3px&#125;.markdown-body ol li&#123;padding-left:6px&#125;.markdown-body .contains-task-list&#123;padding-left:0&#125;.markdown-body .task-list-item&#123;list-style:none&#125;@media (max-width:720px)&#123;.markdown-body h1&#123;font-size:24px&#125;.markdown-body h2&#123;font-size:20px&#125;.markdown-body h3&#123;font-size:18px&#125;&#125;</style><p>æˆ‘æŠ¥åå‚åŠ é‡‘çŸ³è®¡åˆ’1æœŸæŒ‘æˆ˜â€”â€”ç“œåˆ†10ä¸‡å¥–æ± ï¼Œè¿™æ˜¯æˆ‘çš„ç¬¬1ç¯‡æ–‡ç« ï¼Œ<a href="https://s.juejin.cn/ds/jooSN7t" title="https://s.juejin.cn/ds/jooSN7t" target="_blank">ç‚¹å‡»æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…</a></p>
<h2 data-id="heading-0">å‰è¨€</h2>
<p>æœ€è¿‘åœ¨æ˜é‡‘ä¸Šå­¦ä¹ äº†ä¸€æœ¬å°å†Œâ€”â€”<a href="https://juejin.cn/book/6982013809212784676" target="_blank" title="https://juejin.cn/book/6982013809212784676">ã€Šå¾®ä¿¡å°ç¨‹åºåº•å±‚æ¡†æ¶å®ç°åŸç†ã€‹</a>ï¼ŒåŠ ä¸Šä»¥å‰åšå¾®ä¿¡å°ç¨‹åºçš„ç»éªŒï¼Œç»“åˆè‡ªå·±çš„å·¥ä½œç»å†ï¼Œæ·±æœ‰æ„Ÿè§¦ï¼Œå€Ÿæ­¤æœºä¼šå’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹å­¦ä¹ å·¥ä½œå¿ƒå¾—ã€‚</p>
<p><strong>2017 å¹´ 1 æœˆå¾®ä¿¡å°ç¨‹åºæ­£å¼å‘å¸ƒ</strong> <strong>ã€‚</strong></p>
<p>æˆ‘ä»2018å¹´æ¥è§¦å­¦ä¹ å‰ç«¯æ—¶ï¼Œæ›¾ä»¿å†™è¿‡ä¸€ä¸ªæ€§æ ¼è¯„æµ‹ç±»å°ç¨‹åºdemoï¼Œåæ¥å®ä¹ æœŸé—´ï¼Œå®Œæˆäº†éƒ¨é—¨é¦–ä¸ªçœŸæ­£æ„ä¹‰ä¸Šå°ç¨‹åºã€‚åšæ¯•ä¸šè®¾è®¡æ—¶ï¼Œç»“åˆå¾®ä¿¡å°ç¨‹åºäº‘å¼€å‘èƒ½åŠ›ï¼Œåšäº†ä¸€ä¸ªé—®ç­”å°ç¨‹åºï¼ˆç±»ä¼¼ç™¾åº¦çŸ¥é“ï¼Œ360é—®ç­”ï¼‰ã€‚åæ¥ï¼Œåšè¿‡ä¸€ä¸ªå¤§å­¦ä¿¡æ¯èµ„è®¯ç±»å°ç¨‹åºã€‚æ­£å¼å·¥ä½œä¹‹åï¼Œåšè¿‡çš„å°ç¨‹åºå°±å¾ˆå¤šäº†ï¼Œå€Ÿæ¬¾ç±»å°ç¨‹åºï¼Œè´­ç‰©ç±»å°ç¨‹åºï¼Œæ¶ˆè´¹ç±»å°ç¨‹åºï¼Œå¯¼æµç±»å°ç¨‹åºã€‚</p>
<h2 data-id="heading-1">ä¸ºä»€ä¹ˆè¦æŒæ¡å°ç¨‹åº</h2>
<p>æœ‰æ‹›è˜éœ€æ±‚ï¼Œç°åœ¨éƒ¨åˆ†å›¢é˜Ÿä¼šæœ‰ä¸“é—¨æ‹›è˜å°ç¨‹åºå¼€å‘å·¥ç¨‹å¸ˆï¼ŒtoCçš„äº§å“æ‹›è˜å‰ç«¯ä¸€èˆ¬ä¹Ÿä¼šè¦æ±‚æŒæ¡å¾®ä¿¡å°ç¨‹åºï¼Œæœ‰ç›¸å…³å°ç¨‹åºå¼€å‘ç»éªŒã€‚</p>
<h3 data-id="heading-2">äºå¼€å‘è€…</h3>
<ul>
<li>ç›®å‰å¼€å‘çš„é¡¹ç›®æ˜¯å°ç¨‹åº</li>
<li>æƒ³è‡ªå·±ç‹¬ç«‹å¼€å‘ä¸€ä¸ªå°ç¨‹åº</li>
<li>å¤šæŒæ¡ä¸€é—¨æŠ€æœ¯æ˜¯å¥½çš„</li>
</ul>
<h3 data-id="heading-3">äºä¼ä¸š</h3>
<ul>
<li>app å¼€å‘è¿­ä»£æˆæœ¬è¾ƒé«˜ï¼Œå¯¹äºæ–°ä¸šåŠ¡å°ç¨‹åºå¯ä»¥å¿«é€Ÿè¯•é”™ï¼Œæ¢ç´¢æ¸ é“</li>
<li>webç«¯çš„ç”Ÿæ€ä¸å®Œæ•´ï¼Œæ”¶ç›Šå°ï¼ˆæ¸¸æˆï¼ŒæŠ–éŸ³å°ç¨‹åºï¼Œè™ç‰™å°ç¨‹åºï¼Œæ”¯ä»˜å®å°ç¨‹åºï¼‰</li>
</ul>
<h2 data-id="heading-4">åŒçº¿ç¨‹æ¶æ„</h2>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f59dd6330bbc47e9af27a2a7e64b9cbf~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å°ç¨‹åºä¸ä¼ ç»Ÿwebå•çº¿ç¨‹æ¶æ„ç›¸æ¯”ï¼Œæ˜¯<strong>åŒçº¿ç¨‹æ¶æ„</strong>ã€‚</p>
<p>æ¸²æŸ“å±‚å’Œé€»è¾‘å±‚ç”±ä¸¤ä¸ªçº¿ç¨‹ç®¡ç†ï¼Œé€»è¾‘å±‚é‡‡ç”¨JSCoreè¿è¡Œjsä»£ç ï¼Œæ¸²æŸ“å±‚ä½¿ç”¨ webview è¿›è¡Œæ¸²æŸ“ã€‚å°ç¨‹åºæœ‰å¤šä¸ªé¡µé¢ï¼Œæ‰€ä»¥æ¸²æŸ“å±‚å­˜åœ¨å¤šä¸ªwebviewã€‚</p>
<p>ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´ç”±Native å±‚ä¹‹é—´ç»Ÿä¸€å¤„ç†ï¼Œæ— è®ºæ˜¯çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œè¿˜æ˜¯æ•°æ®çš„ä¼ é€’ï¼Œç½‘ç»œè¯·æ±‚éƒ½æ˜¯ç”±Nativeå±‚åšè½¬å‘ã€‚</p>
<p>æ­¤å¤„æåˆ°çš„å°ç¨‹åºéƒ½ç‰¹æŒ‡å¾®ä¿¡å°ç¨‹åº</p>
<h3 data-id="heading-5">æ¸²æŸ“ä¸€ä¸ªhello worldé¡µé¢</h3>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-comment">// index.wxml</span>
<view>&#123;&#123; msg &#125;&#125;</view>

<span class="hljs-comment">// index.js</span>
<span class="hljs-title class_">Page</span>(&#123;
  <span class="hljs-attr">onLoad</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123;
    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">setData</span>(&#123; <span class="hljs-attr">msg</span>: <span class="hljs-string">'Hello World'</span> &#125;)
  &#125;
&#125;)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<ul>
<li>æ¸²æŸ“å±‚å’Œæ•°æ®ç›¸å…³ã€‚</li>
<li>é€»è¾‘å±‚è´Ÿè´£äº§ç”Ÿã€å¤„ç†æ•°æ®ã€‚</li>
<li>é€»è¾‘å±‚é€šè¿‡ Page å®ä¾‹çš„ setData æ–¹æ³•ä¼ é€’æ•°æ®åˆ°æ¸²æŸ“å±‚ã€‚</li>
</ul>
<h3 data-id="heading-6">æ•°æ®é©±åŠ¨</h3>
<p>WXMLå¯ä»¥å…ˆè½¬æˆJSå¯¹è±¡ï¼Œç„¶åå†æ¸²æŸ“å‡ºçœŸæ­£çš„Domæ ‘ï¼Œå›åˆ°â€œHello Worldâ€é‚£ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è½¬æ¢çš„è¿‡ç¨‹</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/20076817a0e64883b2582192ff4e41d3~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>é€šè¿‡setDataæŠŠmsgæ•°æ®ä»â€œHello Worldâ€å˜æˆâ€œGoodbyeâ€ï¼Œäº§ç”Ÿçš„JSå¯¹è±¡å¯¹åº”çš„èŠ‚ç‚¹å°±ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶å¯ä»¥å¯¹æ¯”å‰åä¸¤ä¸ªJSå¯¹è±¡å¾—åˆ°å˜åŒ–çš„éƒ¨åˆ†ï¼Œç„¶åæŠŠè¿™ä¸ªå·®å¼‚åº”ç”¨åˆ°åŸæ¥çš„Domæ ‘ä¸Šï¼Œä»è€Œè¾¾åˆ°æ›´æ–°UIçš„ç›®çš„ï¼Œè¿™å°±æ˜¯â€œ<strong>æ•°æ®é©±åŠ¨</strong>â€ã€‚</p>
<p>è¿™ä¸€ç‚¹å’Œvueå…¶å®æ˜¯ä¸€è‡´çš„</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0524866115ee4f9b88d3668cf958adcc~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>æ—¢ç„¶å°ç¨‹åºæ˜¯åŸºäºåŒçº¿ç¨‹æ¨¡å‹ï¼Œé‚£å°±æ„å‘³ç€ä»»ä½•æ•°æ®ä¼ é€’éƒ½æ˜¯çº¿ç¨‹é—´çš„é€šä¿¡ï¼Œä¹Ÿå°±æ˜¯éƒ½ä¼šæœ‰ä¸€å®šçš„å»¶æ—¶ã€‚</p>
<p><strong>ä¸€åˆ‡éƒ½æ˜¯å¼‚æ­¥ã€‚</strong></p>
<h2 data-id="heading-7">å¿«é€Ÿæ¸²æŸ“è®¾è®¡åŸç†</h2>
<p>å°ç¨‹åºé‡‡ç”¨å¤šä¸ªwebviewæ¸²æŸ“ï¼Œæ›´åŠ æ¥è¿‘åŸç”ŸAppçš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>å¦‚æœä¸ºå•é¡µé¢åº”ç”¨ï¼Œå•ç‹¬æ‰“å¼€ä¸€ä¸ªé¡µé¢ï¼Œéœ€è¦å…ˆå¸è½½å½“å‰é¡µé¢ç»“æ„ï¼Œå¹¶é‡æ–°æ¸²æŸ“ã€‚</p>
<p>å¤šé¡µé¢åº”ç”¨ï¼Œæ–°é¡µé¢ç›´æ¥æ»‘åŠ¨å‡ºæ¥å¹¶ä¸”è¦†ç›–åœ¨æ—§é¡µé¢ä¸Šå³å¯ã€‚è¿™æ ·ç”¨æˆ·ä½“éªŒéå¸¸å¥½ã€‚</p>
<h3 data-id="heading-8">æ•°é‡é™åˆ¶</h3>
<p>é¡µé¢å¾—è½½å…¥æ˜¯é€šè¿‡åˆ›å»ºå¹¶æ’å…¥webview æ¥å®ç°çš„ã€‚</p>
<p>å¾®ä¿¡å°ç¨‹åºåšäº†é™åˆ¶ï¼Œåœ¨å¾®ä¿¡å°ç¨‹åºä¸­æ‰“å¼€çš„é¡µé¢ä¸èƒ½è¶…è¿‡10ä¸ªï¼Œè¾¾åˆ°10ä¸ªé¡µé¢åï¼Œå°±ä¸èƒ½å†æ‰“å¼€æ–°çš„é¡µé¢ã€‚</p>
<p><strong>æ‰€ä»¥æˆ‘ä»¬åœ¨å¼€å‘ä¸­ï¼Œè¦é¿å…è·¯ç”±åµŒå¥—å¤ªæ·±ã€‚</strong></p>
<h3 data-id="heading-9">PageFrame</h3>
<p>æˆ‘ä»¬åœ¨å†™å°ç¨‹åºé¡µé¢æ—¶ï¼Œå¹¶ä¸å…³å¿ƒwebviewï¼Œåªéœ€è¦å†™é¡µé¢uiå’Œé€»è¾‘å³å¯ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡è°ƒè¯•<strong>å¾®ä¿¡å¼€å‘å·¥å…·</strong>ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œæœ‰ä¸¤ä¸ªwebviewã€‚</p>
<p>ä¸€ä¸ªåŠ è½½çš„çš„æ˜¯å½“å‰é¡µé¢ï¼ŒåŠ è½½åœ°å€å’Œå½“å‰é¡µé¢è·¯å¾„ä¸€è‡´ã€‚</p>
<p>ä¸€ä¸ªæ˜¯instanceframe.htmlã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7260d572fe7044a89e52f8a0667cb47c~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å¾®ä¿¡å°ç¨‹åºåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œé™¤äº†æ¸²æŸ“é¦–é¡µä¹‹åï¼Œä¼šå¸®æˆ‘ä»¬æå‰é¢å¤–çš„é¢„åŠ è½½ä¸€ä¸ªwebview,å¾®ä¿¡èµ·åä¸ºinstanceframe.htmlï¼Œç”¨æ¥æ–°æ¸²æŸ“webviewçš„æ¨¡æ¿ã€‚</p>
<p>æˆ‘ä»¬é€šè¿‡å¾®ä¿¡å¼€å‘è€…å·¥å…·æ‰“å¼€è°ƒè¯•ï¼Œæ‰“å¼€è¿™ä¸ª instanceframe.html</p>
<pre><code class="hljs language-javascript copyable" lang="javascript"><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">'webview'</span>)[<span class="hljs-number">1</span>].<span class="hljs-title function_">showDevTools</span>(<span class="hljs-literal">true</span>, <span class="hljs-literal">null</span>)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ä¸‹å›¾æ˜¯pageframe/instanceframe.htmlçš„æ¨¡æ¿</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/813ddf5c370347d3b401e4dc7b31de1b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-10">pageFrameçš„htmlç»“æ„ä¸­æ³¨å…¥çš„jsèµ„æº</h3>
<ul>
<li>./<strong>dev</strong>/wxconfig.js</li>
</ul>
<p>å°ç¨‹åºé»˜è®¤æ€»é…ç½®é¡¹ï¼ŒåŒ…æ‹¬ç”¨æˆ·è‡ªå®šä¹‰ä¸ç³»ç»Ÿé»˜è®¤çš„æ•´åˆç»“æœã€‚åœ¨æ§åˆ¶å°è¾“å…¥__wxConfigå¯ä»¥çœ‹å‡ºæ‰“å°ç»“æœ</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/15f303b37e4b4ea79c50e14335efe18b~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li>./<strong>dev</strong>/devtoolsconfig.js</li>
</ul>
<p>å°ç¨‹åºå¼€å‘è€…é…ç½®ï¼ŒåŒ…æ‹¬navigationBarHeight,æ ‡é¢˜æ çš„é«˜åº¦ï¼ŒçŠ¶æ€æ é«˜åº¦ï¼Œç­‰ç­‰ï¼Œæ§åˆ¶å°è¾“å…¥__devtoolsconfigå¯ä»¥çœ‹åˆ°å…¶å¯¹åº”çš„ä¿¡æ¯</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6ffc4cee9d9f4526bb4c79010837ae6e~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li>./<strong>dev</strong>/deviceinfo.js</li>
</ul>
<p>è®¾å¤‡ä¿¡æ¯ï¼ŒåŒ…å«å°ºå¯¸/åƒç´ ç‚¹pixelRatio</p>
<ul>
<li><strong>dev</strong>/jsdebug.js</li>
</ul>
<p>debugå·¥å…·</p>
<ul>
<li>./<strong>dev</strong>/WAWebview.js</li>
</ul>
<p>æ¸²æŸ“å±‚åº•å±‚åŸºç¡€åº“</p>
<ul>
<li>./<strong>dev</strong>/hls.js</li>
</ul>
<p>ä¼˜ç§€çš„è§†é¢‘æµå¤„ç†å·¥å…·</p>
<ul>
<li>./<strong>dev</strong>/WARemoteDebug.js</li>
</ul>
<p>åº•å±‚åŸºç¡€åº“è°ƒè¯•å·¥å…·</p>
<ul>
<li>

</li>
</ul>
<p>æ³¨é‡Šå ä½ç¬¦ï¼Œ æ•´ä¸ªé¡µé¢çš„json wxss wxmlç¼–è¯‘ä¹‹åéƒ½å­˜å‚¨åœ¨è¿™é‡Œï¼Œå½“å‰æ˜¯ä¸€ä¸ªé¢„è®¾çš„htmlæ¨¡ç‰ˆï¼Œæ‰€ä»¥æ˜¯ç©ºçš„</p>
<h3 data-id="heading-11">wxappcode.js</h3>
<p>æˆ‘ä»¬æŒ‰åŒæ ·çš„è°ƒè¯•æ–¹æ³•ï¼Œå»æ‰¾åˆ°é¦–é¡µçš„wxappcode.jsç»“æ„ï¼Œç®€å•è¯´æ˜ä¸‹</p>
<pre><code class="hljs language-scss copyable" lang="scss"><span class="hljs-selector-tag">var</span> decodeJsonPathName = <span class="hljs-built_in">decodeURI</span>("pages/index/index")
__wxAppCode__<span class="hljs-selector-attr">[decodeJsonPathName + <span class="hljs-string">".json"</span>]</span>=&#123;"usingComponents":&#123;&#125;&#125;
<span class="hljs-selector-tag">var</span> decodeWxmlPathName = <span class="hljs-built_in">decodeURI</span>("pages/index/index")
__wxAppCode__<span class="hljs-selector-attr">[decodeWxmlPathName + <span class="hljs-string">".wxml"</span>]</span>=<span class="hljs-variable">$gwx</span>("./" + decodeWxmlPathName + ".wxml")
<span class="hljs-selector-tag">var</span> decodeWxssPathName = <span class="hljs-built_in">decodeURI</span>("pages/index/index")
__wxAppCode__<span class="hljs-selector-attr">[decodeWxssPathName + <span class="hljs-string">".wxss"</span>]</span>=((window.eval || __global.__hackEval)('setCssToHead([\x22.\x22,[<span class="hljs-number">1</span>],\x22test&#123; height: calc(\x22,[<span class="hljs-number">0</span>,<span class="hljs-number">100</span>],\x22-<span class="hljs-number">2px</span>); ;wxcs_style_height : calc(<span class="hljs-number">100</span>rpx-<span class="hljs-number">2px</span>); <span class="hljs-attribute">width</span>: \x22,[<span class="hljs-number">0</span>,<span class="hljs-number">200</span>],\x22; ;wxcs_style_width : <span class="hljs-number">200</span>rpx; ;wxcs_originclass: .test;;wxcs_fileinfo: ./pages/index/index.wxss <span class="hljs-number">2</span> <span class="hljs-number">1</span>; &#125;\n\x22,],undefined,&#123;path:\x22./pages/index/index.wxss\x22&#125;)'));
window<span class="hljs-selector-class">.__mainPageFrameReady__</span> && window<span class="hljs-selector-class">.__mainPageFrameReady__</span>()
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æ–‡ä»¶åŒ…å«äº†æ‰€æœ‰æ–‡ä»¶çš„ç¼–è¯‘è·¯å¾„</p>
<p>ä¸»è¦å‡ ä¸ªé‡è¦çš„å‡½æ•°å’Œå±æ€§æœ‰</p>
<ul>
<li>decodeJsonPathName</li>
<li>.jsoné…ç½®</li>
<li>.wxmlç¼–è¯‘åçš„$gwxå‡½æ•°ã€‚</li>
<li>.wxssç¼–è¯‘åçš„evalå‡½æ•°ã€‚</li>
</ul>
<p>åä¸¤ä¸ªå‡½æ•°æˆ‘ä»¬ä¼šåœ¨åæ–‡å±•å¼€åˆ†æã€‚</p>
<p><strong>å½“å°ç¨‹åºéœ€è¦æ‰“å¼€æŸä¸ªé¡µé¢çš„æ—¶å€™ï¼Œåªéœ€è¦æå–é¡µé¢çš„è€…å‡ ä¸ªå±æ€§ï¼Œæ³¨å…¥åˆ°é¢„åŠ è½½çš„htmlæ¨¡ç‰ˆä¸­å°±å¯ä»¥å¿«é€Ÿç”Ÿæˆä¸€ä¸ªæ–°çš„webview</strong></p>
<h3 data-id="heading-12">å¿«é€Ÿå¯åŠ¨</h3>
<p>åœ¨è§†å›¾å±‚å†…ï¼Œæ¯ä¸ªé¡µé¢éƒ½æ˜¯ä¸€ä¸ªwebiewï¼Œå½“å°ç¨‹åºå¯åŠ¨æ—¶åªæœ‰é¦–é¡µä¸€ä¸ªwebview</p>
<p>æ‰§è¡Œwx.navigateToæ–°å¼€ä¸€ä¸ªé¡µé¢çš„æ—¶å€™ï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„webviewå¹¶æ’å…¥åˆ°è§†å›¾å±‚</p>
<p>wx.navigateBackåˆ™ä¸ºé”€æ¯webview</p>
<p>å°ç¨‹åºæ¯ä¸ªè§†å›¾å±‚é¡µé¢å†…å®¹éƒ½æ˜¯é€šè¿‡pageframe.htmlæ¨¡æ¿æ¥ç”Ÿæˆçš„ã€‚</p>
<ul>
<li>é¦–é¡µå¯åŠ¨æ—¶ï¼Œå³ç¬¬ä¸€æ¬¡é€šè¿‡pageframe.htmlç”Ÿæˆå†…å®¹åï¼Œåå°æœåŠ¡ä¼šç¼“å­˜pageframe.htmlæ¨¡æ¿é¦–æ¬¡ç”Ÿæˆçš„htmlå†…å®¹</li>
<li>éé¦–æ¬¡æ–°æ‰“å¼€é¡µé¢æ—¶ï¼Œé¡µé¢è¯·æ±‚çš„pageframe.htmlå†…å®¹ç›´æ¥èµ°åå°ç¼“å­˜</li>
<li>éé¦–æ¬¡æ–°æ‰“å¼€é¡µé¢æ—¶ï¼Œpageframe.htmlé¡µé¢å¼•å…¥çš„å¤–é“¾jsèµ„æºèµ°æœ¬åœ°ç¼“å­˜</li>
</ul>
<p>è¿™æ ·åœ¨åç»­æ–°æ‰“å¼€é¡µé¢æ—¶ï¼Œéƒ½ä¼šèµ°ç¼“å­˜çš„pageframeçš„å†…å®¹ï¼Œé¿å…é‡å¤ç”Ÿæˆï¼Œå¿«é€Ÿæ‰“å¼€ä¸€ä¸ªæ–°é¡µé¢ã€‚</p>
<h3 data-id="heading-13">é¦–æ¬¡æ‰“å¼€æ–°é¡µé¢</h3>
<ul>
<li>å¯åŠ¨ä¸€ä¸ªwebviewï¼Œsrcä¸ºç©ºåœ°å€<a href="https://link.juejin.cn/?target=http%3A%2F%2F127.0.0.1%3A%24%257Bglobal.proxyPort%257D%2Faboutblank%3F%24%257Bc%257D" target="_blank" rel="nofollow noopener noreferrer" title="http://127.0.0.1:$%7Bglobal.proxyPort%7D/aboutblank?$%7Bc%7D" ref="nofollow noopener noreferrer">http://127.0.0.1:$&#123;global.proxyPort&#125;/aboutblank?$&#123;c&#125;</a></li>
<li>webview åˆå§‹åŒ–å®Œæ¯•åï¼Œè®¾ç½®åœ°å€src ä¸ºpageframe.htmlï¼Œå¼€å§‹åŠ è½½æ³¨å…¥çš„é¢„è®¾æ ·å¼å’Œé¢„è®¾js ä»£ç </li>
<li>pageframe.htmlåœ¨dom readyä¹‹åï¼Œè§¦å‘æ³¨å…¥å¹¶æ‰§è¡Œå…·ä½“é¡µé¢çš„ç›¸å…³ä»£ç </li>
</ul>
<p>ä¸‹å›¾ä»£ç ä¸­å¯ä»¥çœ‹åˆ°domåŠ è½½å®Œæ¯•ä¹‹åï¼Œè§¦å‘alert é€šçŸ¥</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9d9c09c6ea2645f2b1f8aed9cc179701~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li>æ­¤æ—¶é€šè¿‡history.pushStateæ–¹æ³•ä¿®æ”¹webviewçš„srcä½†æ˜¯webviewå¹¶ä¸ä¼šå‘é€é¡µé¢è¯·æ±‚ã€‚</li>
<li>å› æ­¤webview è·¯å¾„å˜åŒ–ä¸º</li>
</ul>

<ul>
<li>
<ul>
<li><a href="https://link.juejin.cn/?target=http%3A%2F%2F127.0.0.1%3A%24%257Bglobal.proxyPort%257D%2Faboutblank%3F%24%257Bc%257D" target="_blank" rel="nofollow noopener noreferrer" title="http://127.0.0.1:$%7Bglobal.proxyPort%7D/aboutblank?$%7Bc%7D" ref="nofollow noopener noreferrer">http://127.0.0.1:$&#123;global.proxyPort&#125;/aboutblank?$&#123;c&#125;</a></li>
<li><a href="https://link.juejin.cn/?target=http%3A%2F%2F127.0.0.1%3A%3A63444%2F__pageframe__%2Finstanceframe.html" target="_blank" rel="nofollow noopener noreferrer" title="http://127.0.0.1::63444/__pageframe__/instanceframe.html" ref="nofollow noopener noreferrer">http://127.0.0.1::63444/__pageframe__/instanceframe.html</a></li>
<li><a href="https://link.juejin.cn/?target=http%3A%2F%2F127.0.0.1%3A63444%2F__pageframe__%2Fpages%2Findex%2Findex" target="_blank" rel="nofollow noopener noreferrer" title="http://127.0.0.1:63444/__pageframe__/pages/index/index" ref="nofollow noopener noreferrer">http://127.0.0.1:63444/__pageframe__/pages/index/index</a></li>
</ul>
</li>
</ul>

<ul>
<li>æ­£å¥½å¯¹åº”webview åŠ è½½è¿‡ç¨‹</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/672d25a841a140f39200dab9b2c7006f~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-14">wxml è®¾è®¡æ€è·¯</h2>
<p>ç½‘é¡µç¼–ç¨‹ä¸€èˆ¬é‡‡ç”¨çš„æ˜¯HTML + CSS + JSçš„ç»„åˆï¼Œå…¶ä¸­ HTML æ˜¯ç”¨æ¥æè¿°å½“å‰è¿™ä¸ªé¡µé¢çš„ç»“æ„ï¼ŒCSS ç”¨æ¥æè¿°é¡µé¢çš„æ ·å­ï¼ŒJS é€šå¸¸æ˜¯ç”¨æ¥å¤„ç†è¿™ä¸ªé¡µé¢å’Œç”¨æˆ·çš„äº¤äº’ã€‚</p>
<p>åŒæ ·é“ç†ï¼Œåœ¨å°ç¨‹åºä¸­ä¹Ÿæœ‰åŒæ ·çš„è§’è‰²ï¼Œå…¶ä¸­ WXML å……å½“çš„å°±æ˜¯ç±»ä¼¼ HTML çš„è§’è‰²ã€‚</p>
<p>å°ç¨‹åºè‡ªè¡Œæ­å»ºäº†ç»„ä»¶ç»„ç»‡æ¡†æ¶Exparseræ¡†æ¶</p>
<p><strong>Exparserçš„ç»„ä»¶æ¨¡å‹ä¸WebComponentsæ ‡å‡†ä¸­çš„ShadowDOMé«˜åº¦ç›¸ä¼¼</strong></p>
<p>å¦‚ä¸‹ä»£ç ï¼Œæˆ‘ä»¬å®šä¹‰åœ¨wxmlä¸­</p>
<pre><code class="hljs language-xml copyable" lang="xml"><span class="hljs-comment"><!--index.wxml--></span>
<span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>></span>
  Weixin
  <span class="hljs-tag"><<span class="hljs-name">text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"position:relative;"</span>></span>æ–‡æœ¬<span class="hljs-tag"></<span class="hljs-name">text</span>></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"test"</span>></span>æŒ‰é’®<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>Exparseræ¡†æ¶ä¼šå°†ä¸Šè¿°ç»“æ„è½¬æ¢ä¸ºä¸‹é¢è¿™ä¸ªæ ·å­</p>
<pre><code class="hljs language-xml copyable" lang="xml"><span class="hljs-tag"><<span class="hljs-name">wx-view</span> <span class="hljs-attr">exparser:info-class-prefix</span>=<span class="hljs-string">""</span> <span class="hljs-attr">exparser:info-component-id</span>=<span class="hljs-string">"2"</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>></span>
  Weixin
  <span class="hljs-tag"><<span class="hljs-name">wx-text</span> <span class="hljs-attr">exparser:info-class-prefix</span>=<span class="hljs-string">""</span> <span class="hljs-attr">exparser:info-component-id</span>=<span class="hljs-string">"3"</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"position:relative;"</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">span</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"display:none;"</span>></span>æ–‡æœ¬<span class="hljs-tag"></<span class="hljs-name">span</span>></span>
    <span class="hljs-tag"><<span class="hljs-name">span</span>></span>æ–‡æœ¬<span class="hljs-tag"></<span class="hljs-name">span</span>></span><span class="hljs-tag"></<span class="hljs-name">wx-text</span>></span>
<span class="hljs-tag"></<span class="hljs-name">wx-view</span>></span>
<span class="hljs-tag"><<span class="hljs-name">wx-button</span> <span class="hljs-attr">exparser:info-class-prefix</span>=<span class="hljs-string">""</span> <span class="hljs-attr">exparser:info-component-id</span>=<span class="hljs-string">"4"</span> <span class="hljs-attr">exparser:info-attr-bindtap</span>=<span class="hljs-string">"test"</span> <span class="hljs-attr">role</span>=<span class="hljs-string">"button"</span> <span class="hljs-attr">aria-disabled</span>=<span class="hljs-string">"false"</span>></span>
  æŒ‰é’®
<span class="hljs-tag"></<span class="hljs-name">wx-button</span>></span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿™æ ·çœ‹çš„è¯æ˜¯ä¸æ˜¯å’ŒWebComponentsä¸€æ ·äº†ï¼Œä½†æ˜¯å°ç¨‹åºå¹¶æ²¡æœ‰ç›´æ¥ä½¿ç”¨WebComponentsï¼Œè€Œæ˜¯è‡ªè¡Œæ­å»ºäº†ç»„ä»¶æ¡†æ¶Exparserã€‚</p>
<h3 data-id="heading-15">WebComponents</h3>
<p>Web Components æ˜¯ä¸€ä¸ªæµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ç»„ä»¶åŒ–æ–¹æ¡ˆï¼Œå…è®¸ä½ åˆ›å»ºæ–°çš„è‡ªå®šä¹‰ã€å¯å°è£…ã€å¯é‡ç”¨çš„HTML æ ‡è®°ã€‚ä¸ç”¨åŠ è½½ä»»ä½•å¤–éƒ¨æ¨¡å—ï¼Œç›´æ¥å°±å¯ä»¥åœ¨æµè§ˆå™¨ä¸­è·‘ã€‚</p>
<p>å¦‚ä¸‹ä»£ç ï¼Œæ ‡ç­¾å°±æ˜¯è‡ªå®šä¹‰ç»„ä»¶çš„æ ‡ç­¾äº†ï¼Œå®ƒä¸å±äºhtmlè¯­ä¹‰åŒ–æ ‡ç­¾ä¸­çš„ä»»ä½•ä¸€ä¸ªï¼Œæ˜¯è‡ªå®šä¹‰çš„ã€‚</p>
<pre><code class="hljs language-html copyable" lang="html"><span class="hljs-tag"><<span class="hljs-name">html</span>></span>
<span class="hljs-tag"><<span class="hljs-name">head</span>></span>
<span class="hljs-tag"></<span class="hljs-name">head</span>></span>
<span class="hljs-tag"><<span class="hljs-name">body</span>></span>
<span class="hljs-tag"><<span class="hljs-name">user-card</span>></span><span class="hljs-tag"></<span class="hljs-name">user-card</span>></span>
<span class="hljs-tag"><<span class="hljs-name">template</span> <span class="hljs-attr">id</span>=<span class="hljs-string">'userCardId'</span>></span>
  <span class="hljs-comment"><!--ç»„ä»¶çš„æ ·å¼ä¸ä»£ç å°è£…åœ¨ä¸€èµ·ï¼Œåªå¯¹è‡ªå®šä¹‰å…ƒç´ ç”Ÿæ•ˆï¼Œä¸ä¼šå½±å“å¤–éƒ¨çš„å…¨å±€æ ·å¼ã€‚--></span>
  <span class="hljs-tag"><<span class="hljs-name">style</span>></span><span class="css">
    <span class="hljs-selector-class">.name</span>&#123;
        <span class="hljs-attribute">color</span>:red;
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">50px</span>;
    &#125;
    <span class="hljs-selector-tag">button</span>&#123;
        <span class="hljs-attribute">width</span>:<span class="hljs-number">200px</span>;
    &#125;  
  </span><span class="hljs-tag"></<span class="hljs-name">style</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">'name'</span>></span>21312<span class="hljs-tag"></<span class="hljs-name">p</span>></span>
  <span class="hljs-tag"><<span class="hljs-name">button</span>></span>test<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="hljs-tag"></<span class="hljs-name">template</span>></span>
<span class="hljs-tag"><<span class="hljs-name">script</span>></span><span class="javascript">
  <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">HTMLElement</span> &#123;
    <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) &#123;
      <span class="hljs-variable language_">super</span>()
      <span class="hljs-keyword">var</span> shadow = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">attachShadow</span>(&#123; <span class="hljs-attr">mode</span>:<span class="hljs-string">'closed'</span>&#125;);
      
      <span class="hljs-keyword">var</span> templateElem = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'userCardId'</span>)
      <span class="hljs-keyword">var</span> content = templateElem.<span class="hljs-property">content</span>.<span class="hljs-title function_">cloneNode</span>(<span class="hljs-literal">true</span>)
      
      
      <span class="hljs-comment">// this.appendChild(content)</span>
      shadow.<span class="hljs-title function_">appendChild</span>(content)
    &#125;
  &#125;

  <span class="hljs-variable language_">window</span>.<span class="hljs-property">customElements</span>.<span class="hljs-title function_">define</span>(<span class="hljs-string">'user-card'</span>, <span class="hljs-title class_">UserCard</span>)
</span><span class="hljs-tag"></<span class="hljs-name">script</span>></span>
<span class="hljs-tag"></<span class="hljs-name">body</span>></span>
<span class="hljs-tag"></<span class="hljs-name">html</span>></span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>WebComponentä¸»è¦å°±æ˜¯ä¸‰ä¸ªè§„èŒƒï¼š</p>
<ul>
<li><strong>Custom Elementsè§„èŒƒ</strong></li>
</ul>
<p>å¯ä»¥åˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰æ ‡ç­¾ã€‚æ ¹æ®è§„èŒƒï¼Œè‡ªå®šä¹‰å…ƒç´ çš„åç§°å¿…é¡»åŒ…å«è¿è¯çº¿â€-â€œï¼Œç”¨ä¸åŒºåˆ«åŸç”Ÿçš„ HTML å…ƒç´ ã€‚</p>
<p>å¯ä»¥æŒ‡å®šå¤šä¸ªä¸åŒçš„å›è°ƒå‡½æ•°ï¼Œå®ƒä»¬å°†ä¼šåœ¨å…ƒç´ çš„ä¸åŒç”Ÿå‘½æ—¶æœŸè¢«è°ƒç”¨ã€‚</p>
<ul>
<li><strong>templates</strong> <strong>è§„èŒƒ</strong></li>
</ul>
<p>æä¾›äº†<code><template></code>æ ‡ç­¾ï¼Œå¯ä»¥åœ¨å®ƒé‡Œé¢ä½¿ç”¨HTMLå®šä¹‰DOMç»“æ„ã€‚</p>
<ul>
<li><strong>Shadow DOMè§„èŒƒ</strong></li>
</ul>
<p>ä¸‹å›¾ä¸­ï¼Œçœ‹ä¸€ä¸‹å³ä¾§çš„HTMLç»“æ„ï¼Œæˆ‘ä»¬å¯ä»¥å±•å¼€æ ‡è®°çœ‹åˆ°é‡Œé¢çš„ç»“æ„ã€‚æ˜¯ä¸æ˜¯æœ‰ç§ç™½å°è£…äº†çš„æ„Ÿè§‰ã€‚å¦‚æœåªæœ‰è¿™æ ·çš„æ•ˆæœçš„è¯ï¼Œè·Ÿæ¨¡æ¿å¼•æ“æ¸²æŸ“ç»„ä»¶çš„æ•ˆæœæ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥æˆ‘ä»¬ä¸å¸Œæœ›ç”¨æˆ·èƒ½å¤Ÿçœ‹åˆ°çš„å†…éƒ¨ä»£ç ï¼ŒWebComponent å…è®¸å†…éƒ¨ä»£ç éšè—èµ·æ¥ï¼Œè¿™å«åš Shadow DOMï¼Œå³è¿™éƒ¨åˆ† DOM é»˜è®¤ä¸å¤–éƒ¨ DOM éš”ç¦»ï¼Œå†…éƒ¨ä»»ä½•ä»£ç éƒ½æ— æ³•å½±å“å¤–éƒ¨ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e3ff85854c054b779b61101e68ec358f~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-16">ShadowDOM</h3>
<p>é¦–å…ˆå®ä¾‹åŒ–ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼ŒæŒ‚è½½åˆ°å®¿ä¸»ä¸Šï¼Œè¿™é‡Œçš„å®¿ä¸»æ˜¯thisã€‚ä¸Šé¢è¯´è¿‡ï¼ŒthisæŒ‡å‘user-cardã€‚</p>
<p>ç„¶åæˆ‘ä»¬æŠŠåˆ›å»ºçš„DOMç»“æ„ï¼Œæˆ–è€…<code><template></code>ç»“æ„æŒ‚è½½åˆ°å½±å­æ ¹ä¸Šå³å¯ã€‚çœ‹ä¸€ä¸‹HTMLç»“æ„å±•ç¤ºã€‚</p>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-selector-tag">var</span> shadow = this<span class="hljs-selector-class">.attachShadow</span>(&#123; mode:<span class="hljs-string">'closed'</span>&#125;);
shadow<span class="hljs-selector-class">.appendChild</span>(<span class="hljs-attribute">content</span>)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f164cb0120454daea6a4317d3604c0bc~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å†…ç½®çš„æ§ä»¶å…ƒç´ ä¸èƒ½æˆä¸ºå®¿ä¸»ï¼Œæ¯”å¦‚ï¼šimgã€buttonã€inputã€textareaã€selectã€radioã€checkboxï¼Œvideoç­‰ç­‰ï¼Œå› ä¸ºä»–ä»¬å·²ç»æ˜¯ #shadow-root</p>
<p>å¦‚æœæ„¿æ„çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒè¯•ä»–ä»¬çš„shadowï¼Œçœ‹çœ‹è¿™äº›æ ‡ç­¾çš„çœŸå®ç»“æ„</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/64e59d5cd1fd4f228af10338e12578c4~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-17">Exparseræ¡†æ¶åŸç†</h3>
<p>Exparseræ˜¯å¾®ä¿¡å°ç¨‹åºçš„ç»„ä»¶ç»„ç»‡æ¡†æ¶ï¼Œå†…ç½®åœ¨å°ç¨‹åºåŸºç¡€åº“ä¸­ï¼Œä¸ºå°ç¨‹åºæä¾›å„ç§å„æ ·çš„ç»„ä»¶æ”¯æ’‘ã€‚</p>
<p>å†…ç½®ç»„ä»¶å’Œè‡ªå®šä¹‰ç»„ä»¶éƒ½æœ‰Exparserç»„ç»‡ç®¡ç†ã€‚</p>
<p>Exparserçš„ç»„ä»¶æ¨¡å‹ä¸WebComponentsæ ‡å‡†ä¸­çš„Shadow DOMé«˜åº¦ç›¸ä¼¼ã€‚</p>
<p>Exparserä¼šç»´æŠ¤æ•´ä¸ªé¡µé¢çš„èŠ‚ç‚¹æ ‘ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹çš„å±æ€§ã€äº‹ä»¶ç»‘å®šç­‰ï¼Œç›¸å½“äºä¸€ä¸ªç®€åŒ–ç‰ˆçš„Shadow DOMå®ç°ã€‚Exparserçš„ä¸»è¦ç‰¹ç‚¹åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li><strong>åŸºäºShadow DOMæ¨¡å‹</strong>ï¼šæ¨¡å‹ä¸Šä¸WebComponentsçš„ShadowDOMé«˜åº¦ç›¸ä¼¼ï¼Œä½†ä¸ä¾èµ–æµè§ˆå™¨çš„åŸç”Ÿæ”¯æŒï¼Œä¹Ÿæ²¡æœ‰å…¶ä»–ä¾èµ–åº“ï¼›å®ç°æ—¶ï¼Œè¿˜é’ˆå¯¹æ€§åœ°å¢åŠ äº†å…¶ä»–APIä»¥æ”¯æŒå°ç¨‹åºç»„ä»¶ç¼–ç¨‹ã€‚</li>
<li><strong>å¯åœ¨çº¯JSç¯å¢ƒä¸­è¿è¡Œ</strong>ï¼šè¿™æ„å‘³ç€é€»è¾‘å±‚ä¹Ÿå…·æœ‰ä¸€å®šçš„ç»„ä»¶æ ‘ç»„ç»‡èƒ½åŠ›ã€‚</li>
<li><strong>é«˜æ•ˆè½»é‡</strong>ï¼šæ€§èƒ½è¡¨ç°å¥½ï¼Œåœ¨ç»„ä»¶å®ä¾‹æå¤šçš„ç¯å¢ƒä¸‹è¡¨ç°å°¤å…¶ä¼˜å¼‚ï¼ŒåŒæ—¶ä»£ç å°ºå¯¸ä¹Ÿè¾ƒå°ã€‚</li>
</ul>
<p>å°ç¨‹åºä¸­ï¼Œæ‰€æœ‰èŠ‚ç‚¹æ ‘ç›¸å…³çš„æ“ä½œéƒ½ä¾èµ–äºExparserï¼ŒåŒ…æ‹¬WXMLåˆ°é¡µé¢æœ€ç»ˆèŠ‚ç‚¹æ ‘çš„æ„å»ºå’Œè‡ªå®šä¹‰ç»„ä»¶ç‰¹æ€§ç­‰ã€‚</p>
<h3 data-id="heading-18">åŸç”Ÿç»„ä»¶</h3>
<p>å°ç¨‹åºä¸­çš„éƒ¨åˆ†ç»„ä»¶æ˜¯ç”±å®¢æˆ·ç«¯åˆ›å»ºçš„åŸç”Ÿç»„ä»¶ï¼Œå¹¶ä¸å®Œå…¨åœ¨Exparserçš„æ¸²æŸ“ä½“ç³»ä¸‹ï¼Œè¿™äº›ç»„ä»¶æœ‰ï¼š</p>
<ul>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Fcamera.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/camera.html" ref="nofollow noopener noreferrer">camera</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Fcanvas.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/canvas.html" ref="nofollow noopener noreferrer">canvas</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Finput.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/input.html" ref="nofollow noopener noreferrer">input</a>ï¼ˆä»…åœ¨ focus æ—¶è¡¨ç°ä¸ºåŸç”Ÿç»„ä»¶ï¼‰</li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Flive-player.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/live-player.html" ref="nofollow noopener noreferrer">live-player</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Flive-pusher.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/live-pusher.html" ref="nofollow noopener noreferrer">live-pusher</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Fmap.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/map.html" ref="nofollow noopener noreferrer">map</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Ftextarea.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/textarea.html" ref="nofollow noopener noreferrer">textarea</a></li>
<li><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fcomponent%2Fvideo.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/component/video.html" ref="nofollow noopener noreferrer">video</a></li>
</ul>
<p>å¼•å…¥åŸç”Ÿç»„ä»¶ä¸»è¦æœ‰3ä¸ªå¥½å¤„ï¼š</p>
<ul>
<li><strong>æ‰©å±•Webçš„èƒ½åŠ›</strong>ã€‚æ¯”å¦‚åƒè¾“å…¥æ¡†ç»„ä»¶ï¼ˆinput, textareaï¼‰æœ‰æ›´å¥½åœ°æ§åˆ¶é”®ç›˜çš„èƒ½åŠ›ã€‚</li>
<li><strong>ä½“éªŒæ›´å¥½ï¼ŒåŒæ—¶ä¹Ÿå‡è½»WebViewçš„æ¸²æŸ“å·¥ä½œ</strong>ã€‚æ¯”å¦‚åƒåœ°å›¾ç»„ä»¶ï¼ˆmapï¼‰è¿™ç±»è¾ƒå¤æ‚çš„ç»„ä»¶ï¼Œå…¶æ¸²æŸ“å·¥ä½œä¸å ç”¨WebViewçº¿ç¨‹ï¼Œè€Œäº¤ç»™æ›´é«˜æ•ˆçš„å®¢æˆ·ç«¯åŸç”Ÿå¤„ç†ã€‚</li>
<li><strong>ç»•è¿‡setDataã€æ•°æ®é€šä¿¡å’Œé‡æ¸²æŸ“æµç¨‹ï¼Œä½¿æ¸²æŸ“æ€§èƒ½æ›´å¥½</strong>ã€‚æ¯”å¦‚åƒç”»å¸ƒç»„ä»¶ï¼ˆcanvasï¼‰å¯ç›´æ¥ç”¨ä¸€å¥—ä¸°å¯Œçš„ç»˜å›¾æ¥å£è¿›è¡Œç»˜åˆ¶ã€‚</li>
</ul>
<h3 data-id="heading-19">ç‰¹æ®Šåœºæ™¯</h3>
<p>å¦‚æœä¸šåŠ¡åœºæ™¯ä¸ºæ‰‹åŠ¿è¯†åˆ«ä¹‹ç±»çš„ï¼Œç›‘å¬äº‹ä»¶ä¸æ–­çš„è§¦å‘ï¼Œæ•°æ®ä¸æ–­çš„æ”¹å˜ã€‚</p>
<p>è¿™æ ·çš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åƒï¼Œå¦‚æœåæ ‡å€¼ä¸æ–­æ”¹å˜çš„è¯ï¼Œåœ¨é€»è¾‘ä¸è§†å›¾åˆ†å¼€çš„åŒçº¿ç¨‹æ¶æ„ä¸­ï¼Œçº¿ç¨‹ä¸çº¿ç¨‹ä¹‹é—´çš„é€šè®¯æ˜¯éå¸¸é¢‘ç¹çš„ï¼Œä¼šæœ‰å¾ˆå¤§çš„æ€§èƒ½é—®é¢˜ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¾®ä¿¡å¼€æ”¾äº†ä¸€ä¸ªæ ‡è®°ï¼Œå¯ä»¥åœ¨æ¸²æŸ“å±‚å†™éƒ¨åˆ†jsé€»è¾‘ã€‚è¿™æ ·è¯å°±å¯ä»¥åœ¨æ¸²æŸ“å±‚å•ç‹¬å¤„ç†é¢‘ç¹æ”¹å˜çš„æ•°æ®ï¼Œå°±é¿å…äº†çº¿ç¨‹ä¸çº¿ç¨‹ä¹‹é—´é¢‘ç¹é€šè®¯å¯¼è‡´çš„æ€§èƒ½å’Œå»¶æ—¶é—®é¢˜ã€‚</p>
<h3 data-id="heading-20">ä¼˜åŠ¿</h3>
<p>WXMLæ¨¡ç‰ˆè¯­æ³•ç»è¿‡è½¬æ¢ä¹‹åï¼Œä¼šå·²è‡ªå®šä¹‰å…ƒç´ çš„å½¢å¼æ¥æ¸²æŸ“ã€‚è¿™é‡Œä¼šæœ‰ä¸ªç–‘é—®ğŸ¤”ï¸ï¼Œä¸ºä»€ä¹ˆä¸ç”¨HTMLè¯­æ³•å’ŒWebComponentsæ¥å®ç°æ¸²æŸ“ï¼Œè€Œæ˜¯é€‰æ‹©è‡ªå®šä¹‰ï¼Ÿ</p>
<ul>
<li>ç®¡æ§ä¸å®‰å…¨ï¼šwebæŠ€æœ¯å¯ä»¥é€šè¿‡è„šæœ¬è·å–ä¿®æ”¹é¡µé¢æ•æ„Ÿå†…å®¹æˆ–è€…éšæ„è·³è½¬å…¶å®ƒé¡µé¢</li>
<li>èƒ½åŠ›æœ‰é™ï¼šä¼šé™åˆ¶å°ç¨‹åºçš„è¡¨ç°å½¢å¼</li>
<li>æ ‡ç­¾ä¼—å¤šï¼šå¢åŠ ç†è§£æˆæœ¬</li>
</ul>
<h2 data-id="heading-21">wxss è®¾è®¡æ€è·¯</h2>
<p>WXSS å…·æœ‰ CSSçš„å¤§éƒ¨åˆ†ç‰¹æ€§ã€‚åŒæ—¶ä¸ºäº†æ›´é€‚åˆå¼€å‘å¾®ä¿¡å°ç¨‹åºï¼ŒWXSS å¯¹ CSS è¿›è¡Œäº†æ‰©å……ä»¥åŠä¿®æ”¹ã€‚é€šä¿—çš„å¯ä»¥ç†è§£æˆåŸºäºCSSæ”¹äº†ç‚¹ä¸œè¥¿ï¼ŒåˆåŠ äº†ç‚¹ä¸œè¥¿ã€‚</p>
<p>ä¸ CSS ç›¸æ¯”ï¼ŒWXSS æ‰©å±•çš„ç‰¹æ€§æœ‰ï¼š</p>
<ul>
<li>å°ºå¯¸å•ä½</li>
</ul>
<p><strong>rpxï¼ˆresponsive pixelï¼‰</strong> : å¯ä»¥æ ¹æ®å±å¹•å®½åº¦è¿›è¡Œè‡ªé€‚åº”ã€‚è§„å®šå±å¹•å®½ä¸º750rpxã€‚å¦‚åœ¨ iPhone6 ä¸Šï¼Œå±å¹•å®½åº¦ä¸º375pxï¼Œå…±æœ‰750ä¸ªç‰©ç†åƒç´ ï¼Œåˆ™750rpx = 375px = 750ç‰©ç†åƒç´ ï¼Œ1rpx = 0.5px = 1ç‰©ç†åƒç´ ã€‚</p>

























<table><thead><tr><th><strong>è®¾å¤‡</strong></th><th><strong>rpxæ¢ç®—px (å±å¹•å®½åº¦/750)</strong></th><th><strong>pxæ¢ç®—rpx (750/å±å¹•å®½åº¦)</strong></th></tr></thead><tbody><tr><td>iPhone5</td><td>1rpx = 0.42px</td><td>1px = 2.34rpx</td></tr><tr><td>iPhone6</td><td>1rpx = 0.5px</td><td>1px = 2rpx</td></tr><tr><td>iPhone6 Plus</td><td>1rpx = 0.552px</td><td>1px = 1.81rpx</td></tr></tbody></table>
<ul>
<li>æ ·å¼å¯¼å…¥<br>
ä½¿ç”¨ <strong>@import</strong>è¯­å¥å¯ä»¥å¯¼å…¥å¤–è”æ ·å¼è¡¨ï¼Œ <strong>@import</strong>åè·Ÿéœ€è¦å¯¼å…¥çš„å¤–è”æ ·å¼è¡¨çš„ç›¸å¯¹è·¯å¾„ï¼Œç”¨;è¡¨ç¤ºè¯­å¥ç»“æŸã€‚</li>
</ul>
<h3 data-id="heading-22">ç¼–è¯‘</h3>
<pre><code class="hljs language-css copyable" lang="css"><span class="hljs-comment">/**index.wxss**/</span>
<span class="hljs-selector-class">.test</span>&#123;
  <span class="hljs-attribute">height</span>: <span class="hljs-built_in">calc</span>(<span class="hljs-number">100</span>rpx-<span class="hljs-number">2px</span>);
  <span class="hljs-attribute">width</span>: <span class="hljs-number">200</span>rpx;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¦‚ä¸Šæˆ‘ä»¬å®šä¹‰çš„index.wxssï¼Œä¼šè¢«ç¼–è¯‘æˆjsï¼Œæ³¨å…¥webview</p>
<p>æˆ‘ä»¬æŠŠç¼–è¯‘åçš„jsåˆ†æˆä¸‰éƒ¨åˆ†ï¼Œå±•å¼€åˆ†æã€‚</p>
<p>ç¬¬ä¸€éƒ¨åˆ†ç”¨äºè·å–ä¸€å¥—åŸºæœ¬è®¾å¤‡ä¿¡æ¯ï¼ŒåŒ…å«è®¾å¤‡é«˜åº¦ã€è®¾å¤‡å®½åº¦ã€ç‰©ç†åƒç´ ä¸CSSåƒç´ æ¯”ä¾‹ã€è®¾å¤‡æ–¹å‘ã€‚</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/*********/</span>
<span class="hljs-comment">/*ç¬¬ä¸€éƒ¨åˆ†*/</span>
<span class="hljs-comment">/*è®¾å¤‡ä¿¡æ¯*/</span>
<span class="hljs-comment">/*********/</span>
<span class="hljs-keyword">var</span> <span class="hljs-variable constant_">BASE_DEVICE_WIDTH</span> = <span class="hljs-number">750</span>;<span class="hljs-comment">// åŸºç¡€è®¾å¤‡å®½åº¦750</span>
<span class="hljs-keyword">var</span> isIOS=navigator.<span class="hljs-property">userAgent</span>.<span class="hljs-title function_">match</span>(<span class="hljs-string">"iPhone"</span>); <span class="hljs-comment">// æ˜¯å¦ipheone æœºå‹</span>
<span class="hljs-keyword">var</span> deviceWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">width</span> || <span class="hljs-number">375</span>; <span class="hljs-comment">// è®¾å¤‡å®½åº¦ é»˜è®¤375</span>
<span class="hljs-keyword">var</span> deviceDPR = <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span> || <span class="hljs-number">2</span>; <span class="hljs-comment">// è·å–ç‰©ç†åƒç´ ä¸cssåƒç´ æ¯”ä¾‹ é»˜è®¤2</span>
<span class="hljs-keyword">var</span> checkDeviceWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__checkDeviceWidth__</span> || <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) &#123;
  <span class="hljs-keyword">var</span> newDeviceWidth = <span class="hljs-variable language_">window</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">width</span> || <span class="hljs-number">375</span>  <span class="hljs-comment">// åˆå§‹åŒ–è®¾å¤‡å®½åº¦</span>
  <span class="hljs-keyword">var</span> newDeviceDPR = <span class="hljs-variable language_">window</span>.<span class="hljs-property">devicePixelRatio</span> || <span class="hljs-number">2</span> <span class="hljs-comment">// åˆå§‹åŒ–è®¾å¤‡ åƒç´ æ¯”ä¾‹</span>
  <span class="hljs-keyword">var</span> newDeviceHeight = <span class="hljs-variable language_">window</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">height</span> || <span class="hljs-number">375</span> <span class="hljs-comment">// åˆå§‹åŒ–è®¾å¤‡é«˜åº¦</span>
  <span class="hljs-comment">// åˆ¤æ–­å±å¹•æ–¹å‘ landscape ä¸ºæ¨ªå‘ï¼Œå¦‚æœæ˜¯æ¨ªå‘ é«˜åº¦å€¼ç»™å®½åº¦</span>
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">window</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">orientation</span> && <span class="hljs-regexp">/^landscape/</span>.<span class="hljs-title function_">test</span>(<span class="hljs-variable language_">window</span>.<span class="hljs-property">screen</span>.<span class="hljs-property">orientation</span>.<span class="hljs-property">type</span> || <span class="hljs-string">''</span>)) newDeviceWidth = newDeviceHeight
  <span class="hljs-comment">// æ›´æ–°è®¾å¤‡ä¿¡æ¯</span>
  <span class="hljs-keyword">if</span> (newDeviceWidth !== deviceWidth || newDeviceDPR !== deviceDPR) &#123;
    deviceWidth = newDeviceWidth
    deviceDPR = newDeviceDPR
  &#125;
&#125;
<span class="hljs-comment">// æ£€æŸ¥è®¾å¤‡ä¿¡æ¯</span>
<span class="hljs-title function_">checkDeviceWidth</span>()
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç¬¬äºŒéƒ¨åˆ†ï¼šè½¬åŒ–rpx</p>
<p>æ ¸å¿ƒå°±æ˜¯ï¼šä¸‹é¢ä¸¤å¥ï¼Œåšäº†ä¸€ä¸ªç²¾åº¦æ”¶æ‹¢</p>
<p><strong>number = number /</strong> <strong>BASE_DEVICE_WIDTH</strong> *** (newDeviceWidth || deviceWidth);**</p>
<p><strong>number =</strong> <strong>Math</strong> <strong>.</strong> <strong>floor</strong> <strong>(number + eps);</strong></p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/*********/</span>
<span class="hljs-comment">/*ç¬¬äºŒéƒ¨åˆ†*/</span>
<span class="hljs-comment">/*è½¬åŒ–rpx*/</span>
<span class="hljs-comment">/*********/</span>
<span class="hljs-keyword">var</span> eps = <span class="hljs-number">1e-4</span>;<span class="hljs-comment">//0.0001</span>
<span class="hljs-keyword">var</span> transformRPX = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__transformRpx__</span> || <span class="hljs-keyword">function</span>(<span class="hljs-params">number, newDeviceWidth</span>) &#123;
  <span class="hljs-comment">// å¦‚æœ0 è¿”å› 0  0rpx = 0px</span>
  <span class="hljs-keyword">if</span> ( number === <span class="hljs-number">0</span> ) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
  <span class="hljs-comment">// px = rpxå€¼ / åŸºç¡€è®¾å¤‡å®½åº¦750 * è®¾å¤‡å®½åº¦</span>
  number = number / <span class="hljs-variable constant_">BASE_DEVICE_WIDTH</span> * ( newDeviceWidth || deviceWidth );
  <span class="hljs-comment">// è¿”å›å°äºç­‰äº number + 0.0001çš„å¤§æ•´æ•°ï¼Œç”¨æˆ·æ”¶æ‹¢ç²¾åº¦</span>
  number = <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">floor</span>(number + eps);
  <span class="hljs-keyword">if</span> (number === <span class="hljs-number">0</span>) &#123;<span class="hljs-comment">// å¦‚æœnumber == 0,è¯´æ˜è¾“å…¥ä¸º1rpx</span>
    <span class="hljs-keyword">if</span> (deviceDPR === <span class="hljs-number">1</span> || !isIOS) &#123;<span class="hljs-comment">// éIOS æˆ–è€… åƒç´ æ¯”ä¸º1ï¼Œè¿”å›1</span>
      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    &#125; <span class="hljs-keyword">else</span> &#123;
      <span class="hljs-keyword">return</span> <span class="hljs-number">0.5</span>; 
    &#125;
  &#125;
  <span class="hljs-keyword">return</span> number;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>ç¬¬ä¸‰éƒ¨åˆ†ä¸»è¦æ˜¯ setCssToHead é¡¾åæ€ä¹‰</p>
<pre><code class="hljs language-js copyable" lang="js"><span class="hljs-comment">/*********/</span>
<span class="hljs-comment">/*ç¬¬ä¸‰éƒ¨åˆ†*/</span>
<span class="hljs-comment">/*setCssToHead*/</span>
<span class="hljs-comment">/*********/</span>
<span class="hljs-variable language_">window</span>.<span class="hljs-property">__rpxRecalculatingFuncs__</span> = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__rpxRecalculatingFuncs__</span> || [];
<span class="hljs-keyword">var</span> __COMMON_STYLESHEETS__ = __COMMON_STYLESHEETS__ || &#123;&#125; % s
<span class="hljs-keyword">var</span> setCssToHead = <span class="hljs-keyword">function</span>(<span class="hljs-params">file, _xcInvalid, info</span>) &#123;
  <span class="hljs-keyword">var</span> <span class="hljs-title class_">Ca</span> = &#123;&#125;;
  <span class="hljs-keyword">var</span> css_id;
  <span class="hljs-keyword">var</span> info = info || &#123;&#125;;
  <span class="hljs-keyword">var</span> _C = __COMMON_STYLESHEETS__
  <span class="hljs-keyword">function</span> <span class="hljs-title function_">makeup</span>(<span class="hljs-params">file, opt</span>) &#123;
    <span class="hljs-keyword">var</span> _n = <span class="hljs-title function_">typeof</span>(file) === <span class="hljs-string">"string"</span>;
    <span class="hljs-keyword">if</span> (_n && <span class="hljs-title class_">Ca</span>.<span class="hljs-title function_">hasOwnProperty</span>(file)) <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span> (_n) <span class="hljs-title class_">Ca</span>[file] = <span class="hljs-number">1</span>;
    <span class="hljs-keyword">var</span> ex = _n ? _C[file] : file;
    <span class="hljs-keyword">var</span> res = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = ex.<span class="hljs-property">length</span> - <span class="hljs-number">1</span>; i >= <span class="hljs-number">0</span>; i--) &#123;
      <span class="hljs-keyword">var</span> content = ex[i];
      <span class="hljs-keyword">if</span> (<span class="hljs-title function_">typeof</span>(content) === <span class="hljs-string">"object"</span>) &#123;
        <span class="hljs-keyword">var</span> op = content[<span class="hljs-number">0</span>];
        <span class="hljs-keyword">if</span> (op == <span class="hljs-number">0</span>) res = <span class="hljs-title function_">transformRPX</span>(content[<span class="hljs-number">1</span>], opt.<span class="hljs-property">deviceWidth</span>) + <span class="hljs-string">"px"</span> + res;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">1</span>) res = opt.<span class="hljs-property">suffix</span> + res;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (op == <span class="hljs-number">2</span>) res = <span class="hljs-title function_">makeup</span>(content[<span class="hljs-number">1</span>], opt) + res;
      &#125; <span class="hljs-keyword">else</span> res = content + res
    &#125;
    <span class="hljs-keyword">return</span> res;
  &#125;
  <span class="hljs-keyword">var</span> styleSheetManager = <span class="hljs-variable language_">window</span>.<span class="hljs-property">__styleSheetManager2__</span>
  <span class="hljs-keyword">var</span> rewritor = <span class="hljs-keyword">function</span>(<span class="hljs-params">suffix, opt, style</span>) &#123;
    opt = opt || &#123;&#125;;
    suffix = suffix || <span class="hljs-string">""</span>;
    opt.<span class="hljs-property">suffix</span> = suffix;
    <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">allowIllegalSelector</span> != <span class="hljs-literal">undefined</span> && _xcInvalid != <span class="hljs-literal">undefined</span>) &#123;
      <span class="hljs-keyword">if</span> (opt.<span class="hljs-property">allowIllegalSelector</span>) <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">"For developer:"</span> + _xcInvalid);
      <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(_xcInvalid);
      &#125;
    &#125;
    <span class="hljs-title class_">Ca</span> = &#123;&#125;;
    css = <span class="hljs-title function_">makeup</span>(file, opt);
    <span class="hljs-keyword">if</span> (styleSheetManager) &#123;
      <span class="hljs-keyword">var</span> key = (info.<span class="hljs-property">path</span> || <span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>()) + <span class="hljs-string">':'</span> + suffix
      <span class="hljs-keyword">if</span> (!style) &#123;
        styleSheetManager.<span class="hljs-title function_">addItem</span>(key, info.<span class="hljs-property">path</span>);
        <span class="hljs-variable language_">window</span>.<span class="hljs-property">__rpxRecalculatingFuncs__</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">size</span>) &#123;
          opt.<span class="hljs-property">deviceWidth</span> = size.<span class="hljs-property">width</span>;
          <span class="hljs-title function_">rewritor</span>(suffix, opt, <span class="hljs-literal">true</span>);
        &#125;);
      &#125;
      styleSheetManager.<span class="hljs-title function_">setCss</span>(key, css);
      <span class="hljs-keyword">return</span>;
    &#125;
    <span class="hljs-keyword">if</span> (!style) &#123;
      <span class="hljs-keyword">var</span> head = <span class="hljs-variable language_">document</span>.<span class="hljs-property">head</span> || <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementsByTagName</span>(<span class="hljs-string">'head'</span>)[<span class="hljs-number">0</span>];
      style = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">'style'</span>);
      style.<span class="hljs-property">type</span> = <span class="hljs-string">'text/css'</span>;
      style.<span class="hljs-title function_">setAttribute</span>(<span class="hljs-string">"wxss:path"</span>, info.<span class="hljs-property">path</span>);
      head.<span class="hljs-title function_">appendChild</span>(style);
      <span class="hljs-variable language_">window</span>.<span class="hljs-property">__rpxRecalculatingFuncs__</span>.<span class="hljs-title function_">push</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">size</span>) &#123;
        opt.<span class="hljs-property">deviceWidth</span> = size.<span class="hljs-property">width</span>;
        <span class="hljs-title function_">rewritor</span>(suffix, opt, style);
      &#125;);
    &#125;
    <span class="hljs-keyword">if</span> (style.<span class="hljs-property">styleSheet</span>) &#123;
      style.<span class="hljs-property">styleSheet</span>.<span class="hljs-property">cssText</span> = css;
    &#125; <span class="hljs-keyword">else</span> &#123;
      <span class="hljs-keyword">if</span> (style.<span class="hljs-property">childNodes</span>.<span class="hljs-property">length</span> == <span class="hljs-number">0</span>) style.<span class="hljs-title function_">appendChild</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createTextNode</span>(css));
      <span class="hljs-keyword">else</span> style.<span class="hljs-property">childNodes</span>[<span class="hljs-number">0</span>].<span class="hljs-property">nodeValue</span> = css;
    &#125;
  &#125;
  <span class="hljs-keyword">return</span> rewritor;
&#125;
<span class="hljs-title function_">setCssToHead</span>([<span class="hljs-string">"."</span>, [<span class="hljs-number">1</span>], <span class="hljs-string">"test&#123; height: calc("</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">100</span>], <span class="hljs-string">"-2px); width: "</span>, [<span class="hljs-number">0</span>, <span class="hljs-number">200</span>], <span class="hljs-string">"; &#125;\n"</span>, ])(<span class="hljs-keyword">typeof</span> __wxAppSuffixCode__ == <span class="hljs-string">"undefined"</span> ? <span class="hljs-attr">undefined</span>: __wxAppSuffixCode__);
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>setCssToHead ä¼ çš„å‚æ•° æ˜¯æˆ‘ä»¬å®šä¹‰çš„wxcss,å˜æˆäº†ç»“æ„åŒ–æ•°æ®ï¼Œæ–¹ä¾¿éå†å¤„ç†</p>
<p>index.wxssä¸­å†™rpxå•ä½çš„å±æ€§éƒ½å˜æˆäº†åŒºé—´çš„æ ·å­[0, 100]ã€[0, 200]ã€‚å…¶ä»–å•ä½å¹¶æ²¡æœ‰è½¬æ¢ã€‚è¿™æ ·çš„è¯å°±å¯ä»¥æ–¹ä¾¿çš„è¯†åˆ«å“ªé‡Œå†™äº†rpxå•ä½</p>
<p><strong>[".", [1], "test&#123; height: calc(", [0, 100], "-2px); width: ", [0, 200], "; &#125;\n", ]</strong></p>
<h3 data-id="heading-23">æ³¨å…¥</h3>
<p>åœ¨æ¸²æŸ“å±‚çš„ä¸€ä¸ªçš„<code><script></code>æ ‡ç­¾ä¸­,æœ‰å¾ˆé•¿çš„ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”ç”¨evalæ–¹æ³•æ‰§è¡Œã€‚å¦‚æœä½ ä»”ç»†çœ‹çš„è¯ï¼Œè¿˜æ˜¯å¯ä»¥å‹‰å¼ºåˆ†è¾¨å‡ºï¼Œè¿™ä¸ªå­—ç¬¦ä¸²æ­£æ˜¯æˆ‘ä»¬å‰é¢ç¼–è¯‘å‡ºæ¥çš„jsè½¬æ¢æˆçš„ã€‚</p>
<p>è¿™æ ·å°±å¯ä»¥å¾—çŸ¥ï¼Œç¼–è¯‘åçš„ä»£ç æ˜¯é€šè¿‡evalæ–¹æ³•æ³¨å…¥æ‰§è¡Œçš„ã€‚è¿™æ ·çš„è¯å®Œæˆäº†WXSSçš„ä¸€æ•´å¥—æµç¨‹ã€‚</p>
<p><strong>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ˜¯åœ¨ä¿®æ”¹pageFrame çš„è·¯å¾„ä¹‹åï¼Œåˆå§‹åŒ–å°ç¨‹åºæ ·å¼é…ç½®æ–‡ä»¶ä¹‹åï¼Œæ‰å¼€å§‹æ³¨å…¥æ ·å¼æ–‡ä»¶</strong></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/57789d4b37ca48aa91e3990fdc86bc78~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-24">Virtual Dom æ¸²æŸ“æµç¨‹</h2>
<p>å¾®ä¿¡å¼€å‘è€…å·¥å…·å’Œå¾®ä¿¡å®¢æˆ·ç«¯éƒ½æ— æ³•ç›´æ¥è¿è¡Œå°ç¨‹åºçš„æºç ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å°ç¨‹åºçš„æºç è¿›è¡Œç¼–è¯‘ã€‚</p>
<p>ä»£ç ç¼–è¯‘è¿‡ç¨‹åŒ…æ‹¬æœ¬åœ°é¢„å¤„ç†ã€æœ¬åœ°ç¼–è¯‘å’ŒæœåŠ¡å™¨ç¼–è¯‘ã€‚</p>
<p>ä¸ºäº†å¿«é€Ÿé¢„è§ˆï¼Œå¾®ä¿¡å¼€å‘è€…å·¥å…·æ¨¡æ‹Ÿå™¨è¿è¡Œçš„ä»£ç åªç»è¿‡æœ¬åœ°é¢„å¤„ç†ã€æœ¬åœ°ç¼–è¯‘ï¼Œæ²¡æœ‰æœåŠ¡å™¨ç¼–è¯‘è¿‡ç¨‹ï¼Œè€Œå¾®ä¿¡å®¢æˆ·ç«¯è¿è¡Œçš„ä»£ç æ˜¯é¢å¤–ç»è¿‡æœåŠ¡å™¨ç¼–è¯‘çš„ã€‚</p>
<h3 data-id="heading-25">ç¼–è¯‘</h3>
<pre><code class="hljs language-xml copyable" lang="xml"><span class="hljs-comment"><!--index.wxml--></span>
<span class="hljs-tag"><<span class="hljs-name">view</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"container"</span>></span>
  Weixin
  <span class="hljs-tag"><<span class="hljs-name">text</span> <span class="hljs-attr">style</span>=<span class="hljs-string">"position:relative;"</span> ></span>æ–‡æœ¬<span class="hljs-tag"></<span class="hljs-name">text</span>></span>
<span class="hljs-tag"></<span class="hljs-name">view</span>></span>
<span class="hljs-tag"><<span class="hljs-name">button</span> <span class="hljs-attr">bindtap</span>=<span class="hljs-string">"test"</span>></span>æŒ‰é’®<span class="hljs-tag"></<span class="hljs-name">button</span>></span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å¦‚ä¸Šé¢è¿™æ®µç®€å•çš„wxmlæ–‡ä»¶ï¼Œç»è¿‡ç¼–è¯‘ä¹‹åï¼Œè¢«ç¼–è¯‘æˆäº† 1500 å¤šè¡Œ</p>
<p>å…¨éƒ¨ä»£ç éƒ½è¢«åŒ…è£¹åœ¨$gwxå‡½æ•°ä¸­ï¼Œç¼–è¯‘åçš„WXMLæ–‡ä»¶ï¼Œä»¥jsçš„å½¢å¼æ’å…¥åˆ°äº†æ¸²æŸ“å±‚çš„
</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7680ab3a2fc54c1292dd77dc29dec2c3~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä½†æ˜¯åœ¨è¿™ä¸ªscriptæ ‡ç­¾ä¸­æ’å…¥äº†$gwxå‡½æ•°ä¹‹åå¹¶æ²¡æœ‰ç«‹å³æ‰§è¡Œè¿™ä¸ªå‡½æ•°ã€‚</p>
<p>åœ¨æ¸²æŸ“å±‚çš„ä¸€ä¸ªçš„<code><script></code>æ ‡ç­¾ä¸­,æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™æ®µä»£ç </p>
<pre><code class="hljs language-ini copyable" lang="ini">var <span class="hljs-attr">decodeName</span> = decodeURI(<span class="hljs-string">"./pages/index/index.wxml"</span>)
var <span class="hljs-attr">generateFunc</span> = <span class="hljs-variable">$gwx</span>(decodeName)
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>æˆ‘ä»¬åœ¨æ§åˆ¶æŠ¬æ‰‹åŠ¨æ‰§è¡Œ$gwx()çš„è¿”å›å€¼ generateFunc()å‡½æ•°</p>
<p>è¿”å›çš„æ ‘å½¢ç»“æ„ï¼Œå°±æ˜¯è¯¥é¡µé¢wxmlå¯¹åº”çš„jså¯¹è±¡å½¢å¼è¡¨ç¤ºçš„domæ ‘</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/97f6df7d8fea4d57a9e07270daa69353~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼Virtual Domçš„å¯¹è±¡ï¼Œäº¤ç»™äº† WAWebview.js æ¥æ¸²æŸ“æˆçœŸå®DOM</p>
<h2 data-id="heading-26">äº‹ä»¶ç³»ç»Ÿè®¾è®¡</h2>
<p>æ ¸å¿ƒåœ¨äºï¼Œwxmlå’Œjsæ–‡ä»¶åœ¨ä¸¤ä¸ªçº¿ç¨‹æ¸²æŸ“ï¼Œè§£æã€‚äº‹ä»¶å¦‚ä½•ç»‘å®š?</p>
<p>æˆ‘ä»¬æœ€å¼€å§‹åœ¨wxmlæ–‡ä»¶ä¸­å®šä¹‰çš„äº‹ä»¶ç»‘å®šï¼Œå…¶å®è½¬åŒ–æˆè™šæ‹Ÿdomæ ‘ç»“æ„ä¹‹åï¼Œå…¶å®åªæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œè¡¨æ˜äº†æŸä¸ªdomä¸Šæœ‰ç»‘å®šæŸä¸ªäº‹ä»¶ï¼Œå¹¶æ²¡æœ‰å®Œæˆäº‹ä»¶ç»‘å®šã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ecf97563d1b24dfab643afeed4913c87~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>WAWebview.js å¤„ç†è™šæ‹Ÿdomæ ‘æ—¶ï¼Œä¼šå»å¾ªç¯éå†attrå±æ€§ï¼Œåˆ¤æ–­atträ¸­çš„å±æ€§åæ˜¯å¦ä¸ºäº‹ä»¶å±æ€§</p>
<p><code>if (n = e.match(/^(capture-)?(mut-)?(bind|catch):?(.+)$/))</code></p>
<p>å¦‚æœæ˜¯ï¼Œé€šè¿‡addListeneræ–¹æ³•è¿›è¡Œäº†äº‹ä»¶ç»‘å®šã€‚</p>
<p>å¯ä»¥ç†è§£æˆï¼Œé€šè¿‡addListneræ–¹æ³•ç›‘å¬tapäº‹ä»¶ï¼Œå°±ç›¸å½“äº window.addEventListenerå¯¹mouseupæ–¹æ³•çš„ç›‘å¬ã€‚</p>
<p>å›è°ƒå‡½æ•°ä¸­å¯¹å‡½æ•°çš„eventä¿¡æ¯è¿›è¡Œç»„è£…ï¼Œå¹¶è§¦å‘sendDataæ–¹æ³•ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/6fd3d02cec5c4f3f968d019fb11ab1ca~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>sendDataæ–¹æ³•å°±æ˜¯å‘é€»è¾‘çº¿ç¨‹å‘é€eventæ•°æ®çš„æ–¹æ³•ã€‚</p>
<p>ä¸‹å›¾æ˜¯æˆ‘ä»¬åœ¨é€»è¾‘å±‚æ¥æ”¶åˆ°çš„æ•°æ®å’Œå‡†å¤‡å‘é€çš„æ•°æ®ç»“æ„</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fe4f1fa92c4b4076a32505f57f34d73f~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å¯ä»¥çœ‹åˆ°æ•°æ®ç»“æ„æ˜¯ä¸€æ ·çš„ï¼Œ</p>
<p><strong>ç›®å‰åœ¨è§¦å‘sendDataæ–¹æ³•ä¹‹å‰è¿™äº›é€»è¾‘çš„è§£æåŒ…æ‹¬eventå‚æ•°çš„ç»„è£…éƒ½æ˜¯åœ¨æ¸²æŸ“å±‚çš„åº•å±‚åŸºç¡€åº“WAWebview.jsä¸­å®Œæˆçš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿˜åœ¨æ¸²æŸ“çº¿ç¨‹ä¸­ã€‚</strong></p>
<h3 data-id="heading-27">äº‹ä»¶</h3>
<p><strong>å¾®ä¿¡å°ç¨‹åºä¸­ä¸»è¦äº‹ä»¶ç»‘å®š:bind catch</strong></p>
<p>bind /catchåå¯ä»¥ç´§è·Ÿä¸€ä¸ªå†’å·ï¼Œå…¶å«ä¹‰ä¸å˜ï¼Œå¦‚ <code>bind:tap catch:tap</code>ã€‚</p>
<p>catch ä¼šé˜»æ­¢äº‹ä»¶å‘ä¸Šå†’æ³¡ã€‚</p>
<p>mut-bind æ¥ç»‘å®šäº‹ä»¶ã€‚ä¸€ä¸ª mut-bind è§¦å‘åï¼Œå¦‚æœäº‹ä»¶å†’æ³¡åˆ°å…¶ä»–èŠ‚ç‚¹ä¸Šï¼Œå…¶ä»–èŠ‚ç‚¹ä¸Šçš„ mut-bind ç»‘å®šå‡½æ•°ä¸ä¼šè¢«è§¦å‘ï¼Œä½† bind ç»‘å®šå‡½æ•°å’Œ catch ç»‘å®šå‡½æ•°ä¾æ—§ä¼šè¢«è§¦å‘ã€‚</p>
<p>éœ€è¦åœ¨æ•è·é˜¶æ®µç›‘å¬äº‹ä»¶æ—¶ï¼Œå¯ä»¥é‡‡ç”¨<strong>capture-bindã€capture-catch</strong>å…³é”®å­—ï¼Œåè€…å°†ä¸­æ–­æ•è·é˜¶æ®µå’Œå–æ¶ˆå†’æ³¡é˜¶æ®µã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c78d885de4bb41249fdafa7806b4f8ee~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-28">é€šè®¯ç³»ç»Ÿè®¾è®¡</h2>
<p>æœ€ä¸Šé¢æåˆ°ï¼Œè§†å›¾å±‚å’Œé€»è¾‘å±‚é€šè®¯æ˜¯é€šè¿‡Nativeå±‚ã€‚</p>
<p>å…·ä½“çš„æ‰‹æ®µå°±æ˜¯</p>
<ul>
<li>iosåˆ©ç”¨ WKWebView çš„æä¾› messageHandlers ç‰¹æ€§</li>
<li>android æ˜¯å¾€webviewçš„windowå¯¹è±¡æ³¨å…¥ä¸€ä¸ªåŸç”Ÿæ–¹æ³•</li>
</ul>
<p>è¿™ä¸¤ç§ä¼šç»Ÿä¸€å°è£…æˆweixinJSBridgeï¼Œè¿™å’Œæ­£å¸¸h5ä¸å®¢æˆ·ç«¯é€šè®¯æ‰‹æ®µä¸€è‡´</p>
<p>åˆå§‹åŒ–è¿‡ç¨‹ä¸­Nativeå±‚ç†è®ºä¸Šæ˜¯å¾®ä¿¡å®¢æˆ·ç«¯ï¼Œåˆ†åˆ«åœ¨è§†å›¾å±‚å’Œä¸šåŠ¡é€»è¾‘å±‚æ³¨å…¥äº†WeixinJSBridge</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17b966e9e23f4ac19942fb735e8042f5~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-29">ç”Ÿå‘½å‘¨æœŸè®¾è®¡</h2>
<h3 data-id="heading-30">data</h3>
<p>é€»è¾‘å±‚çš„dataä¸viewæ˜¯ç›¸äº’ç»‘å®šçš„ï¼Œdataæ˜¯é¡µé¢ç¬¬ä¸€æ¬¡æ¸²æŸ“ä½¿ç”¨çš„åˆå§‹æ•°æ®ã€‚é¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œdataå°†ä¼šä»¥JSONå­—ç¬¦ä¸²å½¢å¼ç”±é€»è¾‘å±‚ä¼ è‡³æ¸²æŸ“å±‚ã€‚å› æ­¤dataä¸­çš„æ•°æ®å¿…é¡»æ˜¯å¯ä»¥è½¬æˆJSONçš„ç±»å‹ï¼šå­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œå¸ƒå°”å€¼ï¼Œå¯¹è±¡ï¼Œæ•°ç»„ã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/78a14a5f4e4e4fbcb819af1dd5911d11~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å›¾ä¸­ï¼Œæ¸²æŸ“å±‚å’Œé€»è¾‘å±‚éƒ½ä»startå¼€å§‹å‡ºå‘ï¼Œè‡ªèº«åˆ†åˆ«è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œéƒ½åˆå§‹åŒ–å®Œæ¯•åè¦æ€ä¹ˆåšå‘¢ï¼Ÿä¸¤æ¡çº¿ç¨‹äº’ç›¸å¹¶ä¸çŸ¥é“å¯¹æ–¹åˆå§‹åŒ–æ€ä¹ˆæ ·äº†ã€‚</p>
<p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™ç”±æ¸²æŸ“å±‚å‘å‡ºä¿¡å·ï¼Œå‘å‡ºä¸€ä¸ªæˆ‘å·²ç»åˆå§‹åŒ–å®Œæ¯•çš„ä¿¡å·å‘ç»™é€»è¾‘å±‚ï¼Œå¹¶ä¸”è‡ªèº«çŠ¶æ€è¿›å…¥ç­‰å¾…ã€‚</p>
<p>é€»è¾‘å±‚æ”¶åˆ°è¿™ä¸ªä¿¡å·çš„æ—¶å€™æœ‰ä¸¤ç§æƒ…å†µã€‚</p>
<ul>
<li>ç¬¬ä¸€ç§å°±æ˜¯è‡ªèº«è¿˜æ²¡åˆå§‹åŒ–å®Œï¼Œé‚£ä¹ˆæ”¶åˆ°æ­¤ä¿¡å·ååªéœ€è¦åˆå§‹åŒ–å®Œæ¯•åå‘é€åˆå§‹æ•°æ®Dataåˆ°æ¸²æŸ“å±‚å³å¯ã€‚</li>
<li>ç¬¬äºŒç§æƒ…å†µå°±æ˜¯é€»è¾‘å±‚æ—©å·²ç»è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œé‚£ä¹ˆæ”¶åˆ°ä¿¡å·åç«‹å³å‘é€åˆå§‹æ•°æ®Dataåˆ°æ¸²æŸ“å±‚å³å¯ã€‚</li>
</ul>
<h3 data-id="heading-31">ç”Ÿå‘½å‘¨æœŸ</h3>
<ul>
<li><code>onLoad(Object query)</code> é¡µé¢åŠ è½½æ—¶è§¦å‘ï¼Œä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œå¯ä»¥åœ¨onLoadçš„å‚æ•°ä¸­è·å–æ‰“å¼€å½“å‰é¡µé¢è·¯å¾„ä¸­çš„å‚æ•°ã€‚</li>
<li><code>onShow()</code> é¡µé¢æ˜¾ç¤º/åˆ‡å…¥å‰å°æ—¶è§¦å‘</li>
<li><code>onHide()</code> é¡µé¢éšè—/åˆ‡å…¥åå°æ—¶è§¦å‘ã€‚ å¦‚ wx.navigateTo æˆ–åº•éƒ¨ tab åˆ‡æ¢åˆ°å…¶ä»–é¡µé¢ï¼Œå°ç¨‹åºåˆ‡å…¥åå°ç­‰ã€‚</li>
<li><code>onReady()</code> é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆæ—¶è§¦å‘ã€‚ä¸€ä¸ªé¡µé¢åªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œä»£è¡¨é¡µé¢å·²ç»å‡†å¤‡å¦¥å½“ï¼Œå¯ä»¥å’Œè§†å›¾å±‚è¿›è¡Œäº¤äº’ã€‚</li>
<li><code>onUnload()</code> é¡µé¢å¸è½½æ—¶è§¦å‘ã€‚å¦‚<code>wx.redirectToæˆ–wx.navigateBack</code>åˆ°å…¶ä»–é¡µé¢æ—¶ã€‚</li>
</ul>
<p><strong>æˆ‘ä»¬ç»“åˆè·¯ç”±è·³è½¬å’Œwebviewè®¾è®¡å»ç†è§£</strong></p>
<ul>
<li>wx.navigateToæ˜¯åˆ›å»ºäº†æ–°çš„webview,å½“å‰webview è¿›å…¥Hide()</li>
<li>wx.redirectToä»¥åŠwx.navigateBackæ˜¯é€šè¿‡æ›´æ–°è‡ªèº«webviewè¿›è¡Œé¡µé¢è½¬æ¢çš„ï¼Œæ‰€ä»¥å½“å‰é¡µé¢ä¼šè¿›è¡Œå¸è½½æ“ä½œï¼Œå¹¶ä¸”é‡æ–°ç”Ÿæˆæ–°é¡µé¢ã€‚æ‰€ä»¥ä¸¤ä¸ªé¡µé¢éƒ½ä¼šè¿›å…¥å®Œæ•´ç”Ÿå‘½å‘¨æœŸåºåˆ—ã€‚</li>
</ul>
<p>é…åˆæ•´ä½“æ¶æ„å›¾æ¥çœ‹ä¸€ä¸‹ç”Ÿå‘½å‘¨æœŸã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3732521a26e34229bd65497dba51f1fd~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-32">è·¯ç”±è®¾è®¡</h2>
<h3 data-id="heading-33">è·¯ç”±æ ˆ</h3>
<p>å°ç¨‹åºä¸­ä¸åƒå•é¡µé¢åº”ç”¨ï¼Œé‡‡ç”¨å¤šä¸ªwebviewç±»ä¼¼å¤šé¡µã€‚</p>
<p>è§¦å‘è·¯ç”±çš„è¡Œä¸ºå¯ä»¥æ˜¯é€»è¾‘å±‚è§¦å‘ï¼Œä¹Ÿå¯ä»¥ä»è§†å›¾å±‚è§¦å‘ã€‚åœ¨è§†å›¾å±‚ä¸­ç”¨æˆ·å¯ä»¥é€šè¿‡ç‚¹å‡»å›é€€æŒ‰é’®ï¼Œæˆ–è€…å›é€€ä¸Šä¸€é¡µçš„æ‰‹åŠ¿ç­‰æœºåˆ¶è§¦å‘ã€‚åœ¨é€»è¾‘å±‚ä¸­å‘å‡ºçš„ä¿¡å·æœ‰æ‰“å¼€æ–°é¡µé¢navigateToã€é‡å®šå‘redirectToã€é¡µé¢è¿”å›navigateBackç­‰ï¼Œå¼€å‘è€…é€šè¿‡å®˜ç½‘æä¾›çš„APIè§¦å‘ã€‚</p>
<p>æ— è®ºé€»è¾‘å±‚è¿˜æ˜¯è§†å›¾å±‚ï¼Œè¿™ä¸ªè¡Œä¸ºéƒ½ä¼šè¢«å‘é€åˆ°Nativeå±‚ï¼Œæœ‰Nativeå±‚ç»Ÿä¸€æ§åˆ¶è·¯ç”±ã€‚å¯¹äºwebviewçš„æ·»åŠ æˆ–åˆ é™¤éƒ½ä¼šæœ‰ä¸€ä¸ªè½½ä½“æ¥ç»´æŠ¤ï¼Œè¿™å°±æ˜¯è·¯ç”±æ ˆã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a4371188e73f42478a85694d685d47de~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä¸Šå›¾ä¸­ï¼Œé€»è¾‘å±‚ä¸­å‘å‡ºæ‰“å¼€é¡µé¢è¡Œä¸ºåˆ°Nativeå±‚ï¼ŒNativeå±‚æ”¶åˆ°è¡Œä¸ºåé€šè¿‡pageFrameå¿«é€Ÿåˆ›å»ºwebviewï¼Œå¹¶ä¸”æ¨å…¥è·¯ç”±æ ˆã€‚é¡µé¢åˆ›å»ºå®Œåï¼Œåº•å±‚åŸºç¡€åº“ä¼šç«‹åˆ»æ‰§è¡Œåˆå§‹åŒ–æ“ä½œï¼Œåˆå§‹åŒ–å®Œæ¯•åä¼šå‘é€ä¸€ä¸ªä¿¡å·é€šçŸ¥Nativeé¡µé¢å·²ç»åˆ›å»ºå¹¶åˆå§‹åŒ–å®Œæ¯•ï¼ŒéšåNativeå±‚å‘é€ä¿¡å·åˆ°é€»è¾‘å±‚ä¸­ã€‚</p>
<p>é€šçŸ¥çš„ç›®çš„æœ‰ä¸¤ä¸ªï¼š</p>
<p>éœ€è¦é€šçŸ¥å¼€å‘è€…é¡µé¢å·²ç»åˆ›å»ºæˆåŠŸã€‚</p>
<p>åœ¨æ²™ç®±ä¸­åˆ›å»ºæ–°é¡µé¢çš„â€œæ ¹ç»„ä»¶â€ï¼Œå¹¶æ­£å¼å¼€å¯æ–°é¡µé¢çš„ç”Ÿå‘½å‘¨æœŸä¸æ¸²æŸ“çš„æµç¨‹ã€‚</p>
<h2 data-id="heading-34">æ€§èƒ½ä¼˜åŒ–</h2>
<p>ç¨‹åºçš„æ€§èƒ½åˆå¯ä»¥åˆ†ä¸ºã€Œ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fperformance%2Ftips%2Fstart" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips/start" ref="nofollow noopener noreferrer">å¯åŠ¨æ€§èƒ½</a>ã€å’Œã€Œ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fperformance%2Ftips" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips" ref="nofollow noopener noreferrer">è¿è¡Œæ—¶æ€§èƒ½</a>ã€ä¸¤ä¸ªä¸»é¢˜ã€‚ã€Œå¯åŠ¨æ€§èƒ½ã€è®©ç”¨æˆ·èƒ½å¤Ÿæ›´å¿«çš„æ‰“å¼€å¹¶çœ‹åˆ°å°ç¨‹åºçš„å†…å®¹ï¼Œã€Œè¿è¡Œæ—¶æ€§èƒ½ã€ä¿éšœç”¨æˆ·èƒ½å¤Ÿæµç•…çš„ä½¿ç”¨å°ç¨‹åºçš„åŠŸèƒ½ã€‚</p>
<h3 data-id="heading-35">å°ç¨‹åºå¯åŠ¨æµç¨‹</h3>
<h4 data-id="heading-36">1.èµ„æºå‡†å¤‡</h4>
<h5 data-id="heading-37">1.1å°ç¨‹åºç›¸å…³ä¿¡æ¯å‡†å¤‡</h5>
<p>å¾®ä¿¡å®¢æˆ·ç«¯éœ€è¦ä»å¾®ä¿¡åå°è·å–å°ç¨‹åºçš„<strong>å¤´åƒã€æ˜µç§°ã€ç‰ˆæœ¬ã€é…ç½®ã€æƒé™</strong>ç­‰åŸºæœ¬ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯ä¼šåœ¨æœ¬åœ°ç¼“å­˜ï¼Œå¹¶é€šè¿‡ä¸€å®šçš„æœºåˆ¶è¿›è¡Œæ›´æ–°ã€‚</p>
<h5 data-id="heading-38">1.1ç¯å¢ƒé¢„åŠ è½½</h5>
<p>ä¸ºäº†å°½å¯èƒ½çš„é™ä½è¿è¡Œç¯å¢ƒå‡†å¤‡å¯¹å¯åŠ¨è€—æ—¶çš„å½±å“ï¼Œå¾®ä¿¡å®¢æˆ·ç«¯ä¼šæ ¹æ®ç”¨æˆ·çš„ä½¿ç”¨åœºæ™¯å’Œè®¾å¤‡èµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œä¾ç…§ä¸€å®šç­–ç•¥åœ¨å°ç¨‹åº<strong>å¯åŠ¨å‰</strong>å¯¹è¿è¡Œç¯å¢ƒè¿›è¡Œéƒ¨åˆ†åœ°<strong>é¢„åŠ è½½</strong>ï¼Œä»¥é™ä½å¯åŠ¨è€—æ—¶ã€‚</p>
<p><strong>ä½†ä¸ä¸€å®šå‘½ä¸­</strong><br>
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/2a2b19776cbe4eae94730bd292a13841~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h5 data-id="heading-39">1.2ä»£ç åŒ…å‡†å¤‡</h5>
<p>ä»å¾®ä¿¡åå°è·å–ä»£ç åŒ…åœ°å€ï¼Œä» CDN ä¸‹è½½å°ç¨‹åºä»£ç åŒ…</p>
<p>å°ç¨‹åºä»£ç åŒ…ä¼šåœ¨æœ¬åœ°ç¼“å­˜ï¼Œå¹¶é€šè¿‡<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fruntime%2Fupdate-mechanism.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/update-mechanism.html" ref="nofollow noopener noreferrer">æ›´æ–°æœºåˆ¶</a>è¿›è¡Œæ›´æ–°ã€‚</p>
<p>åŒæ­¥ä¸‹è½½/å¼‚æ­¥ä¸‹è½½ å¼ºåˆ¶æ›´æ–°/é™é»˜æ›´æ–°</p>
<p>ä¸ºä¾‹é™ä½ä»£ç åŒ…ä¸‹è½½çš„è€—æ—¶ï¼Œå¾®ä¿¡åšçš„ä¸€äº›ä¼˜åŒ–</p>
<ul>
<li>ä»£ç åŒ…å‹ç¼©</li>
<li>å¢é‡æ›´æ–°</li>
<li>ä¼˜å…ˆä½¿ç”¨QUIC å’ŒHTTP/2</li>
<li>é¢„å…ˆå»ºç«‹è¿æ¥ï¼šåœ¨ä¸‹è½½å‘ç”Ÿå‰ï¼Œæå‰å’Œ CDN å»ºç«‹è¿æ¥ï¼Œé™ä½ä¸‹è½½è¿‡ç¨‹ä¸­ DNS è¯·æ±‚å’Œè¿æ¥å»ºç«‹çš„è€—æ—¶</li>
<li>ä»£ç åŒ…å¤ç”¨ï¼šå¯¹æ¯ä¸ªä»£ç åŒ…éƒ½ä¼šè®¡ç®— MD5 ç­¾åã€‚å³ä½¿å‘ç”Ÿäº†ç‰ˆæœ¬æ›´æ–°ï¼Œå¦‚æœä»£ç åŒ…çš„ MD5 æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä¸éœ€è¦é‡æ–°è¿›è¡Œä¸‹è½½ã€‚</li>
</ul>
<h4 data-id="heading-40">2.ä»£ç æ³¨å…¥</h4>
<p>å°ç¨‹åºå¯åŠ¨æ—¶éœ€è¦ä»ä»£ç åŒ…å†…è¯»å–å°ç¨‹åºçš„é…ç½®å’Œä»£ç ï¼Œå¹¶æ³¨å…¥åˆ° JavaScript å¼•æ“ä¸­ã€‚</p>
<p>å¾®ä¿¡å®¢æˆ·ç«¯ä¼šä½¿ç”¨ V8 å¼•æ“çš„ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fv8.dev%2Fblog%2Fcode-caching-for-devs" target="_blank" rel="nofollow noopener noreferrer" title="https://v8.dev/blog/code-caching-for-devs" ref="nofollow noopener noreferrer">Code Caching</a> æŠ€æœ¯å¯¹ä»£ç ç¼–è¯‘ç»“æœè¿›è¡Œç¼“å­˜ï¼Œé™ä½éé¦–æ¬¡æ³¨å…¥æ—¶çš„ç¼–è¯‘è€—æ—¶</p>
<blockquote>
<p>code cache</p>
<p>V8 ä¼šæŠŠç¼–è¯‘å’Œè§£æçš„ç»“æœç¼“å­˜ä¸‹æ¥ï¼Œç­‰åˆ°ä¸‹æ¬¡é‡åˆ°ç›¸åŒçš„æ–‡ä»¶ï¼Œç›´æ¥è·³è¿‡è¿™ä¸ªè¿‡ç¨‹ï¼ŒæŠŠç›´æ¥ç¼“å­˜å¥½çš„æ•°æ®æ‹¿æ¥ä½¿ç”¨</p>
</blockquote>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c75f8d958f62464d990f28738b20f8d4~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h3 data-id="heading-41">å¯åŠ¨æ—¶æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-42">æ§åˆ¶ä»£ç åŒ…ä½“ç§¯</h4>
<ul>
<li>æ¨èæ‰€æœ‰å°ç¨‹åºä½¿ç”¨åˆ†åŒ…åŠ è½½</li>
<li>é¿å…éå¿…è¦ä½¿ç”¨å…¨å±€è‡ªå®šä¹‰ç»„ä»¶å’Œæ’ä»¶</li>
</ul>

<ul>
<li>
<ul>
<li>ä¼šå½±å“æŒ‰éœ€æ³¨å…¥çš„æ•ˆæœå’Œå°ç¨‹åºä»£ç æ³¨å…¥çš„è€—æ—¶</li>
</ul>
</li>
</ul>

<ul>
<li>æ§åˆ¶èµ„æºæ–‡ä»¶</li>
</ul>

<ul>
<li>
<ul>
<li>å»ºè®®å¼€å‘è€…åœ¨ä»£ç åŒ…å†…çš„å›¾ç‰‡ä¸€èˆ¬åº”åªåŒ…å«ä¸€äº›ä½“ç§¯è¾ƒå°çš„å›¾æ ‡ï¼Œé¿å…åœ¨ä»£ç åŒ…ä¸­åŒ…å«æˆ–åœ¨ WXSS ä¸­ä½¿ç”¨ base64 å†…è”è¿‡å¤šã€è¿‡å¤§çš„å›¾ç‰‡ç­‰èµ„æºæ–‡ä»¶ã€‚</li>
<li>è¿™ç±»æ–‡ä»¶åº”å°½å¯èƒ½éƒ¨ç½²åˆ° CDNï¼Œå¹¶ä½¿ç”¨ URL å¼•å…¥ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-43">ä»£ç æ³¨å…¥ä¼˜åŒ–</h4>
<ul>
<li>æ¨èæ‰€æœ‰å°ç¨‹åºä½¿ç”¨æŒ‰éœ€æ³¨å…¥</li>
<li>ç”¨æ—¶æ³¨å…¥</li>
</ul>

<ul>
<li>
<ul>
<li>ä¸ºè‡ªå®šä¹‰ç»„ä»¶é…ç½® <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fcustom-component%2Fplaceholder.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/placeholder.html" ref="nofollow noopener noreferrer">å ä½ç»„ä»¶</a>ï¼Œç»„ä»¶å°±ä¼šè‡ªåŠ¨è¢«è§†ä¸ºç”¨æ—¶æ³¨å…¥ç»„ä»¶</li>
</ul>
</li>
</ul>

<ul>
<li>å¯åŠ¨è¿‡ç¨‹ä¸­å‡å°‘åŒæ­¥ API çš„è°ƒç”¨</li>
</ul>

<ul>
<li>
<ul>
<li>å»ºè®®ä¼˜å…ˆä½¿ç”¨æ‹†åˆ†åçš„ getSystemSetting/getAppAuthorizeSetting/getDeviceInfo/getWindowInfo/getAppBaseInfo æŒ‰éœ€è·å–ä¿¡æ¯ï¼Œæˆ–ä½¿ç”¨ä½¿ç”¨å¼‚æ­¥ç‰ˆæœ¬ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fapi%2Fbase%2Fsystem%2Fwx.getSystemInfoAsync.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/api/base/system/wx.getSystemInfoAsync.html" ref="nofollow noopener noreferrer">getSystemInfoAsync</a></li>
<li>getStorageSync/setStorageSync åº”åªç”¨æ¥è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œä¸åº”ç”¨äºè¿è¡Œæ—¶çš„æ•°æ®ä¼ é€’æˆ–å…¨å±€çŠ¶æ€ç®¡ç†ã€‚</li>
</ul>
</li>
</ul>
<h4 data-id="heading-44">é¦–å±æ¸²æŸ“ä¼˜åŒ–</h4>
<ul>
<li>å¯ç”¨ã€Œ<a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Fframework%2Fview%2Finitial-rendering-cache.html" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/framework/view/initial-rendering-cache.html" ref="nofollow noopener noreferrer">åˆå§‹æ¸²æŸ“ç¼“å­˜</a>ã€</li>
</ul>

<ul>
<li>
<ul>
<li>å¯ç”¨åˆå§‹æ¸²æŸ“ç¼“å­˜ï¼Œå¯ä»¥ä½¿è§†å›¾å±‚ä¸éœ€è¦ç­‰å¾…é€»è¾‘å±‚åˆå§‹åŒ–å®Œæ¯•ï¼Œè€Œç›´æ¥æå‰å°†é¡µé¢åˆå§‹ data çš„æ¸²æŸ“ç»“æœå±•ç¤ºç»™ç”¨æˆ·ï¼Œè¿™å¯ä»¥ä½¿å¾—é¡µé¢å¯¹ç”¨æˆ·å¯è§çš„æ—¶é—´å¤§å¤§æå‰</li>
</ul>
</li>
</ul>

<ul>
<li>æå‰é¦–å±æ•°æ®è¯·æ±‚</li>
</ul>

<ul>
<li>
<ul>
<li>é¢„æ‹‰å–èƒ½å¤Ÿåœ¨å°ç¨‹åºå†·å¯åŠ¨çš„æ—¶å€™é€šè¿‡å¾®ä¿¡åå°æå‰å‘ç¬¬ä¸‰æ–¹æœåŠ¡å™¨æ‹‰å–ä¸šåŠ¡æ•°æ®ï¼Œå½“ä»£ç åŒ…åŠ è½½å®Œæ—¶å¯ä»¥æ›´å¿«åœ°æ¸²æŸ“é¡µé¢ï¼Œå‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼Œä»è€Œæå‡å°ç¨‹åºçš„æ‰“å¼€é€Ÿåº¦</li>
<li>å‘¨æœŸæ€§æ›´æ–°èƒ½å¤Ÿåœ¨ç”¨æˆ·æœªæ‰“å¼€å°ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œä¹Ÿèƒ½ä»æœåŠ¡å™¨æå‰æ‹‰å–æ•°æ®ï¼Œå½“ç”¨æˆ·æ‰“å¼€å°ç¨‹åºæ—¶å¯ä»¥æ›´å¿«åœ°æ¸²æŸ“é¡µé¢ï¼Œå‡å°‘ç”¨æˆ·ç­‰å¾…æ—¶é—´ï¼Œå¢å¼ºåœ¨å¼±ç½‘æ¡ä»¶ä¸‹çš„å¯ç”¨æ€§ã€‚</li>
</ul>
</li>
</ul>

<ul>
<li>ç¼“å­˜è¯·æ±‚æ•°æ®</li>
<li>éª¨æ¶å±</li>
</ul>
<h3 data-id="heading-45">è¿è¡Œæ—¶æ€§èƒ½ä¼˜åŒ–</h3>
<h4 data-id="heading-46">åˆç†ä½¿ç”¨setData</h4>
<p>æ§åˆ¶é¢‘ç‡ï¼ŒèŒƒå›´ï¼Œå†…å®¹</p>
<h4 data-id="heading-47">é¡µé¢æ¸²æŸ“ä¼˜åŒ–</h4>
<ul>
<li>é€‚å½“ç›‘å¬scroll äº‹ä»¶</li>
<li>æ§åˆ¶ WXML èŠ‚ç‚¹æ•°é‡å’Œå±‚çº§</li>
</ul>

<ul>
<li>
<ul>
<li>æºç ä¸­ä¸€ä¸ªé¡µé¢dom æ•°ç›®è¶…è¿‡16000ï¼Œè‚¯å®šä¼šæŠ¥é”™</li>
</ul>
</li>
</ul>

<ul>
<li>dataå±‚çº§ä¸è¦è¿‡æ·±ï¼Œå› ä¸ºéœ€è¦æ·±åº¦éå†</li>
<li>ä½¿ç”¨ IntersectionObserver ç›‘å¬å…ƒç´ æ›å…‰</li>
</ul>
<h4 data-id="heading-48">é¡µé¢åˆ‡æ¢ä¼˜åŒ–</h4>
<ul>
<li>é¿å…åœ¨ onHide/onUnload æ‰§è¡Œè€—æ—¶æ“ä½œ</li>
</ul>

<ul>
<li>
<ul>
<li>é¡µé¢åˆ‡æ¢æ—¶ï¼Œä¼šå…ˆè°ƒç”¨å‰ä¸€ä¸ªé¡µé¢çš„ onHide æˆ– onUnload ç”Ÿå‘½å‘¨æœŸï¼Œç„¶åå†è¿›è¡Œæ–°é¡µé¢çš„åˆ›å»ºå’Œæ¸²æŸ“</li>
</ul>
</li>
</ul>

<ul>
<li>æå‰å‘èµ·æ•°æ®è¯·æ±‚</li>
</ul>

<ul>
<li>
<ul>
<li>è¿›è¡Œé¡µé¢è·³è½¬æ—¶ï¼ˆä¾‹å¦‚ wx.navigateToï¼‰ï¼Œå¯ä»¥æå‰ä¸ºä¸‹ä¸€ä¸ªé¡µé¢åšä¸€äº›å‡†å¤‡å·¥ä½œã€‚é¡µé¢ä¹‹é—´å¯ä»¥é€šè¿‡ <a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Fminiprogram%2Fdev%2Freference%2Fapi%2FPage.html%23%25E9%25A1%25B5%25E9%259D%25A2%25E9%2597%25B4%25E9%2580%259A%25E4%25BF%25A1" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#%E9%A1%B5%E9%9D%A2%E9%97%B4%E9%80%9A%E4%BF%A1" ref="nofollow noopener noreferrer">EventChannel</a> è¿›è¡Œé€šä¿¡ã€‚ç±»ä¼¼postMessage</li>
<li>ä¾‹å¦‚ï¼Œåœ¨é¡µé¢è·³è½¬æ—¶ï¼Œå¯ä»¥åŒæ—¶å‘èµ·ä¸‹ä¸€ä¸ªé¡µé¢çš„æ•°æ®è¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰åˆ°é¡µé¢ onLoad æ—¶å†è¿›è¡Œï¼Œä»è€Œå¯ä»¥è®©ç”¨æˆ·æ›´æ—©çš„çœ‹åˆ°é¡µé¢å†…å®¹ã€‚</li>
</ul>
</li>
</ul>

<ul>
<li>æ§åˆ¶é¢„åŠ è½½ä¸‹ä¸ªé¡µé¢çš„æ—¶æœº</li>
</ul>

<ul>
<li>
<ul>
<li>ç¨‹åºé¡µé¢åŠ è½½å®Œæˆåï¼Œä¼šé¢„åŠ è½½ä¸‹ä¸€ä¸ªé¡µé¢ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå°ç¨‹åºæ¡†æ¶ä¼šåœ¨å½“å‰é¡µé¢ onReady è§¦å‘ 200ms åè§¦å‘é¢„åŠ è½½ã€‚</li>
<li>é¢„åŠ è½½ä¼šé˜»å¡å½“å‰é¡µé¢setDataï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å•ä¸ªé¡µé¢çš„é…ç½®å¢åŠ ï¼Œ handleWebviewPreload é€‰é¡¹ï¼Œæ¥æ§åˆ¶é¢„åŠ è½½ä¸‹ä¸ªé¡µé¢çš„æ—¶æœºã€‚</li>
</ul>
</li>
</ul>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c01044264a0c4c7e8a763bf75b5544f7~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h4 data-id="heading-49">èµ„æºåŠ è½½ä¼˜åŒ–</h4>
<p>æ§åˆ¶å›¾ç‰‡å¤§å°</p>
<h4 data-id="heading-50">å†…å­˜ä¼˜åŒ–</h4>
<ul>
<li>åˆç†åˆ†åŒ…ï¼Œæ—¢èƒ½å‡å°‘è€—æ—¶ï¼Œä¹Ÿèƒ½é™ä½å†…å­˜å ç”¨</li>
<li>äº‹ä»¶ç›‘å¬ï¼Œå®šæ—¶å™¨è®°å¾—æ¸…é™¤</li>
</ul>
<h2 data-id="heading-51">ä¸‰æ–¹åº“æ¡†æ¶è®¾è®¡</h2>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cd850b9dc89749f0a94f4102ad97fdc1~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/faa5d53784a546ceb7e5d0c961544ff9~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/13fc83982505428585c91df3fe685379~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>\</p>
<h2 data-id="heading-52">å°ç¨‹åºä¸ºä»€ä¹ˆå¿«ï¼ˆä¸æ™®é€šh5ç›¸æ¯”ï¼‰</h2>
<p>æˆ‘ä»¬åœ¨å¯¹å°ç¨‹åºçš„æ¶æ„è®¾è®¡æ—¶çš„è¦æ±‚åªæœ‰ä¸€ä¸ªï¼Œå°±æ˜¯è¦å¿«ï¼ŒåŒ…æ‹¬è¦æ¸²æŸ“å¿«ã€åŠ è½½å¿«ç­‰ã€‚å½“ç”¨æˆ·ç‚¹å¼€æŸä¸ªå°ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬æœŸæœ›ä½“éªŒåˆ°çš„æ˜¯åªæœ‰å¾ˆçŸ­æš‚çš„åŠ è½½ç•Œé¢ï¼Œåœ¨ä¸€ä¸ªè¿‡æ¸¡åŠ¨ç”»ä¹‹åå¯ä»¥é©¬ä¸Šçœ‹åˆ°å°ç¨‹åºçš„ä¸»ç•Œé¢ã€‚</p>
<ul>
<li>åŒçº¿ç¨‹ï¼Œæ¸²æŸ“å±‚å’Œé€»è¾‘å±‚å¹¶è¡Œä¸é˜»å¡</li>
<li>å¤šä¸ªwebviewï¼Œé¡µé¢åˆ‡æ¢æ›´æµç•…</li>
<li>webview é¢„åŠ è½½</li>
<li>å®‰è£…åŒ…ç¼“å­˜</li>
<li>ä»¥åŠå¾®ä¿¡åšäº†å¤§é‡çš„ä¼˜åŒ–å’Œçœ‹ä¸è§çš„æ“ä½œ</li>
</ul>
<h2 data-id="heading-53">æ€»ç»“ä¸å±•æœ›</h2>
<ul>
<li>å°ç¨‹åºæ‹¥æœ‰æ¥è¿‘åŸç”Ÿ App çš„ä½“éªŒã€‚</li>
<li>å°ç¨‹åºå¹¶ä¸æ˜¯çœŸæ­£çš„ â€œæ— éœ€ä¸‹è½½â€ï¼Œåªæ˜¯å°ç¨‹åºçš„ä½“ç§¯å¾ˆå°ï¼Œåœ¨å½“ä»Šé«˜é€Ÿçš„ç½‘ç»œç¯å¢ƒä¸‹èƒ½å¤Ÿå¿«é€Ÿä¸‹è½½ï¼Œç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°ï¼Œæ›´ç¡®åˆ‡çš„æ¥è¯´æ˜¯ â€œæ— æ„Ÿä¸‹è½½â€ã€‚</li>
<li>åŸºäºç§»åŠ¨ç«¯å¸ƒå±€çš„å±€é™æ€§ï¼Œå¯ä»¥é«˜æ•ˆä¸”ç®€å•çš„å¼€å‘ï¼Œè¿­ä»£å¿«é€Ÿã€‚</li>
<li>å°ç¨‹åºæ˜¯åŒçº¿ç¨‹æ¨¡å‹ï¼Œé€»è¾‘å±‚å’Œæ¸²æŸ“å±‚åˆ†åˆ«è¿è¡Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¸­ï¼Œé€šè¿‡ JSBridge è¿›è¡Œé€šä¿¡ã€‚</li>
</ul>
<p>ç°åœ¨å·²çŸ¥çš„å°ç¨‹åºæœ‰ å¾®ä¿¡ï¼Œæ”¯ä»˜å®ï¼ŒæŠ–éŸ³ï¼Œqqï¼Œè™ç‰™ï¼Œæ–—é±¼ï¼Œé¥¿äº†ä¹ˆï¼Œç™¾åº¦ï¼Œäº¬ä¸œç­‰ç­‰</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/edc67553de7245c1b3d9381bbc60a71d~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å·²çŸ¥çš„è¿™äº›éƒ½æ˜¯è¶…çº§appï¼Œå¯¹ç”¨æˆ·æ¥è¯´ï¼Œä¸€èˆ¬æ‰‹æœºåªæŒ‰ç…§å¸¸ç”¨å’Œå¿…è¦çš„appï¼Œå¯¹äºä¸€èˆ¬çš„appå…¶å®å¾ˆéš¾æ¨å¹¿ã€‚å¼€å‘h5åˆå¤©ç”Ÿéœ€è¦å€ŸåŠ©å¹³å°ç»™äºˆæµé‡ï¼Œä½“éªŒæ— è®ºæ€ä¹ˆä¼˜åŒ–ï¼Œä»æ—§æ¯”ä¸ä¸ŠåŸç”Ÿã€‚ä½†æ˜¯å°ç¨‹åºåœ¨å¯ä»¥å€ŸåŠ©å¹³å°æµé‡çš„åŒæ—¶ï¼Œæœ‰è¾ƒå¥½çš„ç”¨æˆ·ä½“éªŒã€‚</p>
<p>ç›®å‰å·²ç»å‡ºäº†ä¸‰æ–¹æ¡†æ¶ï¼ŒFinClip æŠŠå°ç¨‹åºæ¬è¿›appã€‚</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/61ac9f9b7b9c4d0986fe9d16846d08fe~tplv-k3u1fbpfcp-zoom-in-crop-mark:4536:0:0:0.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<h2 data-id="heading-54">å‚è€ƒé“¾æ¥</h2>
<p><a href="https://link.juejin.cn/?target=https%3A%2F%2Fdevelopers.weixin.qq.com%2Febook%3Faction%3Dget_post_info%26docid%3D0000286f908988db00866b85f5640a" target="_blank" rel="nofollow noopener noreferrer" title="https://developers.weixin.qq.com/ebook?action=get_post_info&docid=0000286f908988db00866b85f5640a" ref="nofollow noopener noreferrer">developers.weixin.qq.com/ebook?actioâ€¦</a></p></div>  
</div>
            