
---
title: 'æŠŠä¹¦è¯»è–„ _ ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¾ã€‹è®¾è®¡æ¨¡å¼ä¸èŒƒå¼ï¼ˆç»“æ„å‹-äº«å…ƒæ¨¡å¼ï¼‰'
categories: 
 - ç¼–ç¨‹
 - æ˜é‡‘
 - æ ‡ç­¾
headimg: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c99d16ff46d94fce887ed085a8d47008~tplv-k3u1fbpfcp-zoom-1.image'
author: æ˜é‡‘
comments: false
date: Tue, 29 Jun 2021 22:51:21 GMT
thumbnail: 'https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c99d16ff46d94fce887ed085a8d47008~tplv-k3u1fbpfcp-zoom-1.image'
---

<div>   
<div class="markdown-body"><style>.markdown-body&#123;color:#595959;font-size:15px;font-family:-apple-system,system-ui,BlinkMacSystemFont,Helvetica Neue,PingFang SC,Hiragino Sans GB,Microsoft YaHei,Arial,sans-serif;background-image:linear-gradient(90deg,rgba(60,10,30,.04) 3%,transparent 0),linear-gradient(1turn,rgba(60,10,30,.04) 3%,transparent 0);background-size:20px 20px;background-position:50%&#125;.markdown-body p&#123;color:#595959;font-size:15px;line-height:2;font-weight:400&#125;.markdown-body p+p&#123;margin-top:16px&#125;.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6&#123;padding:30px 0;margin:0;color:#135ce0&#125;.markdown-body h1&#123;position:relative;text-align:center;font-size:22px;margin:50px 0&#125;.markdown-body h1:before&#123;position:absolute;content:"";top:-10px;left:50%;width:32px;height:32px;transform:translateX(-50%);background-size:100% 100%;opacity:.36;background-repeat:no-repeat;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAABfVBMVEX///8Ad/8AgP8AgP8AgP8Aff8AgP8Af/8AgP8AVf8Af/8Af/8AgP8AgP8Af/8Afv8AAP8Afv8Afv8Aef8AgP8AdP8Afv8AgP8AgP8Acf8Ae/8AgP8Af/8AgP8Af/8Af/8AfP8Afv8AgP8Af/8Af/8Afv8Afv8AgP8Afv8AgP8Af/8Af/8AgP8AgP8Afv8AgP8Af/8AgP8AgP8AgP8Ae/8Afv8Af/8AgP8Af/8AgP8Af/8Af/8Aff8Af/8Abf8AgP8Af/8AgP8Af/8Af/8Afv8AgP8AgP8Afv8Afv8AgP8Af/8Aff8AgP8Afv8AgP8Aff8AgP8AfP8AgP8Ae/8AgP8Af/8AgP8AgP8AgP8Afv8AgP8AgP8AgP8Afv8AgP8AgP8AgP8AgP8AgP8Af/8AgP8Af/8Af/8Aev8Af/8AgP8Aff8Afv8AgP8AgP8AgP8Af/8AgP8Af/8Af/8AgP8Afv8AgP8AgP8AgP8AgP8Af/8AeP8Af/8Af/8Af//////rzEHnAAAAfXRSTlMAD7CCAivatxIDx5EMrP19AXdLEwgLR+6iCR/M0yLRzyFF7JupSXn8cw6v60Q0QeqzKtgeG237HMne850/6Qeq7QaZ+WdydHtj+OM3qENCMRYl1B3K2U7wnlWE/mhlirjkODa9FN/BF7/iNV/2kASNZpX1Wlf03C4stRGxgUPclqoAAAABYktHRACIBR1IAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4gEaBzgZ4yeM3AAAAT9JREFUOMvNUldbwkAQvCAqsSBoABE7asSOBRUVVBQNNuy9996789+9cMFAMHnVebmdm+/bmdtbQv4dOFOW2UjPzgFyLfo6nweKfIMOBYWwFtmMPGz2Yj2pJI0JDq3udJW6VVbmKa9I192VQFV1ktXUAl5NB0cd4KpnORqsEO2ZIRpF9gJfE9Dckqq0KuZt7UAH5+8EPF3spjsRpCeQNO/tA/qDwIDA+OCQbBoKA8NOdjMySgcZGVM6jwcgRuUiSs0nlPFNSrEpJfU0jTLD6llqbvKxei7OzvkFNQohi0vAsj81+MoqsCaoPOQFgus/1LyxichW+hS2JWCHZ7VlF9jb187pIAYcHiViHAMnp5mTjJ8B5xeEXF4B1ze/fTh/C0h398DDI9HB07O8ci+vRBdvdGnfP4gBuM8vw7X/G3wDmFhFZEdxzjMAAAAldEVYdGRhdGU6Y3JlYXRlADIwMTgtMDEtMjZUMDc6NTY6MjUrMDE6MDA67pVWAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDE4LTAxLTI2VDA3OjU2OjI1KzAxOjAwS7Mt6gAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAWdEVYdFRpdGxlAGp1ZWppbl9sb2dvIGNvcHlxapmKAAAAV3pUWHRSYXcgcHJvZmlsZSB0eXBlIGlwdGMAAHic4/IMCHFWKCjKT8vMSeVSAAMjCy5jCxMjE0uTFAMTIESANMNkAyOzVCDL2NTIxMzEHMQHy4BIoEouAOoXEXTyQjWVAAAAAElFTkSuQmCC)&#125;.markdown-body h2&#123;position:relative;font-size:20px;border-left:4px solid;padding:0 0 0 10px;margin:30px 0&#125;.markdown-body h3&#123;font-size:16px&#125;.markdown-body ul&#123;list-style:disc outside;margin-left:2em;margin-top:1em&#125;.markdown-body li&#123;line-height:2;color:#595959&#125;.markdown-body img.loaded&#123;margin:0 auto;display:block&#125;.markdown-body blockquote&#123;background:#fff9f9;margin:2em 0;padding:2px 20px;border-left:4px solid #b2aec5&#125;.markdown-body blockquote p&#123;color:#666;line-height:2&#125;.markdown-body a&#123;color:#036aca;border-bottom:1px solid rgba(3,106,202,.8);font-weight:400;text-decoration:none&#125;.markdown-body em strong,.markdown-body strong&#123;color:#036aca&#125;.markdown-body hr&#123;border-top:1px solid #135ce0&#125;.markdown-body pre&#123;overflow:auto&#125;.markdown-body code,.markdown-body pre&#123;overflow:auto;position:relative;line-height:1.75;font-family:Menlo,Monaco,Consolas,Courier New,monospace&#125;.markdown-body pre>code&#123;font-size:12px;padding:15px 12px;margin:0;word-break:normal;display:block;overflow-x:auto;color:#333;background:#f8f8f8&#125;.markdown-body code&#123;word-break:break-word;border-radius:2px;overflow-x:auto;background-color:#fff5f5;color:#ff502c;font-size:.87em;padding:.065em .4em&#125;.markdown-body table&#123;border-collapse:collapse;margin:1rem 0;overflow-x:auto&#125;.markdown-body table td,.markdown-body table th&#123;border:1px solid #dfe2e5;padding:.6em 1em&#125;.markdown-body table tr&#123;border-top:1px solid #dfe2e5&#125;.markdown-body table tr:nth-child(2n)&#123;background-color:#f6f8fa&#125;</style><h2 data-id="heading-0">0x0ã€å¼•è¨€</h2>
<p>ğŸ¤¡ææµ‹äº†ç­‰æ”¹BUGï¼Œæ‘¸é±¼æ—¶å•ƒä¸‹ã€Šè®¾è®¡æ¨¡å¼ä¹‹ç¾ã€‹ï¼Œæœ¬æ–‡å¯¹åº”è®¾è®¡æ¨¡å¼ä¸èŒƒå¼ï¼šç»“æ„å‹(54-55)ï¼Œ<strong><code>äº«å…ƒæ¨¡å¼</code></strong> (Flyweight Pattern)ï¼Œç»“æ„å‹è®¾è®¡æ¨¡å¼æœ€åä¸€ä¸ª~</p>
<ul>
<li>å¾ˆå¥½ç†è§£ â†’ <strong><code>äº«å…ƒï¼Œè¢«å…±äº«çš„å•å…ƒ</code></strong></li>
<li>æ„å›¾ â†’ <strong><code>èŠ‚çœå†…å­˜ï¼Œå¤ç”¨ä¸å¯å˜å¯¹è±¡</code></strong></li>
<li>æ¢å¥è¯è¯´ â†’ <strong><code>æ‰¾å‡ºç›¸ä¼¼å¯¹è±¡é—´çš„å…±æœ‰ç‰¹å¾ï¼Œç„¶åå¤ç”¨è¿™äº›ç‰¹å¾</code></strong>ã€‚</li>
</ul>
<p>ä¸€ä¸ªå½¢è±¡çš„ä¾‹å­ï¼šæ¸¸æˆå¼€å‘ä¸­ï¼Œä¸€ä¸ªæ£®æ—åœºæ™¯ï¼Œæˆåƒä¸Šä¸‡ç§æ ‘ï¼Œæ¯æ£µæ ‘éƒ½å®ä¾‹åŒ–ä¸åŒçš„æ¨¡å‹ï¼Œå†…å­˜ç›´æ¥çˆ†ç‚¸ï¼Œå¯ä»¥æŠ½å–å‡ºæ‰€æœ‰æ ‘å¯¹è±¡çš„å…±æœ‰å±æ€§ï¼Œè½¬ç§»åˆ°ä¸€ä¸ªå•ç‹¬çš„ç±»ä¸­ï¼Œç„¶ååªéœ€è¦ä¸€ä¸ªç±»å®ä¾‹ï¼Œç„¶åæ£®æ—é‡Œçš„æ¯ä¸€é¢—æ ‘å¯¹è¿™ä¸ªå®ä¾‹åšä¸€æ¬¡å¼•ç”¨(å›¾æ‘˜è‡ªï¼š<a href="http://gameprogrammingpatterns.com/flyweight.html" target="_blank" rel="nofollow noopener noreferrer">Flyweight</a>)ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c99d16ff46d94fce887ed085a8d47008~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<blockquote>
<p>Tipsï¼šäºŒæ‰‹çŸ¥è¯†åŠ å·¥éš¾å…æœ‰æ‰€çº°æ¼ï¼Œæ„Ÿå…´è¶£æœ‰æ—¶é—´çš„å¯è‡ªè¡ŒæŸ¥é˜…åŸæ–‡ï¼Œè°¢è°¢ã€‚</p>
</blockquote>
<hr>
<h2 data-id="heading-1">0x1ã€å†™ä¸ªç®€å•çš„æ‰‘å…‹ç‰Œä¾‹å­</h2>
<p>å¦‚æœè®©ä½ å®ç°ä¸€ä¸ªç®€å•çš„æ‰‘å…‹ç‰Œç¨‹åºï¼Œä»£ç å¯èƒ½æ˜¯è¿™æ ·çš„(æ­¤å¤„å‡å®šæ²¡æœ‰ç‹ï¼Œåªæœ‰52å¼ ç‰Œï¼Œ4ç§èŠ±è‰²)ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-comment">// ç‰Œç±»ï¼Œæœ‰èŠ±è‰²å’Œå¤§å°ä¸¤ä¸ªå±æ€§</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Card</span> </span>&#123;
    <span class="hljs-keyword">private</span> String color;
    <span class="hljs-keyword">private</span> String num;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Card</span><span class="hljs-params">(String color, String num)</span> </span>&#123;
        <span class="hljs-keyword">this</span>.color = color;
        <span class="hljs-keyword">this</span>.num = num;
    &#125;

    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">printMsg</span><span class="hljs-params">()</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"æ‰‘å…‹ç‰Œã€"</span> + color + num +<span class="hljs-string">"ã€‘"</span>; &#125;
&#125;

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Player</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        String[] colors = <span class="hljs-keyword">new</span> String[]&#123;<span class="hljs-string">"é»‘æ¡ƒ"</span>, <span class="hljs-string">"çº¢å¿ƒ"</span>, <span class="hljs-string">"æ¢…èŠ±"</span>, <span class="hljs-string">"æ–¹å—"</span>&#125;;
        List<Card> cards = <span class="hljs-keyword">new</span> ArrayList<>();
        <span class="hljs-keyword">for</span> (String color : colors) &#123;
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">1</span>; i <= <span class="hljs-number">13</span>; i++) &#123;
                <span class="hljs-keyword">switch</span> (i) &#123;
                    <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>: cards.add(<span class="hljs-keyword">new</span> Card(color, <span class="hljs-string">"J"</span>)); <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>: cards.add(<span class="hljs-keyword">new</span> Card(color, <span class="hljs-string">"Q"</span>)); <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> <span class="hljs-number">13</span>: cards.add(<span class="hljs-keyword">new</span> Card(color, <span class="hljs-string">"K"</span>)); <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">default</span>: cards.add(<span class="hljs-keyword">new</span> Card(color, i + <span class="hljs-string">""</span>)); <span class="hljs-keyword">break</span>;
                &#125;
            &#125;
        &#125;
        System.out.println(<span class="hljs-string">"æ‰‘å…‹ç‰Œåˆå§‹å®Œæ¯•ï¼Œå…±"</span> + cards.size() + <span class="hljs-string">"å¼ "</span>);
        System.out.println(<span class="hljs-string">"éšæœºæ´¾äº”å¼ ç‰Œï¼š"</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i < <span class="hljs-number">5</span>; i++) System.out.println(cards.get((<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">52</span>)).printMsg());
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>è¿è¡Œè¾“å‡ºç»“æœå¦‚ä¸‹</strong>ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5fbb6f579aca4e0cb719b9ab863bf33c~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>æ­£å¸¸è¾“å‡ºï¼Œä½†å´åˆå§‹åŒ–äº†52ä¸ªCardå¯¹è±¡ï¼Œ<strong>ï¼Œ</strong>ï¼Ÿå¦‚æœç”¨äº«å…ƒæ¨¡å¼éœ€è¦åˆ›å»ºå‡ ä¸ªå‘¢ï¼Ÿ</p>
<p>æŠ½å–ä¸‹æ‰‘å…‹ç‰Œçš„å…±æœ‰å±æ€§ï¼š<strong>èŠ±è‰²å’Œå¤§å°</strong>ï¼ŒèŠ±è‰²å›ºå®šå››ç§ï¼Œå¤§å°å˜åŒ–ï¼Œå†™ä¸€ä¸ªå¡ç‰Œçš„çˆ¶ç±»ï¼Œå†™å››ä¸ªèŠ±è‰²å­ç±»ç»§æ‰¿ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-comment">// äº«å…ƒç±»(æŠ½è±¡ç±»æˆ–æ¥å£)</span>
<span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AbstractCard</span> </span>&#123;
    <span class="hljs-comment">// å…±äº«å¯¹è±¡éœ€å®ç°çš„å…¬å…±æ“ä½œæ–¹æ³•ï¼Œä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çŠ¶æ€ä½œä¸ºè¾“å…¥å‚æ•°(å®¢æˆ·ç«¯ä¿å­˜ï¼Œè¿è¡Œæ—¶æ”¹å˜)</span>
    <span class="hljs-function"><span class="hljs-keyword">abstract</span> String <span class="hljs-title">printMsg</span><span class="hljs-params">(String num)</span></span>;
&#125;

<span class="hljs-comment">// å…·ä½“äº«å…ƒç±»</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpadeCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractCard</span> </span>&#123;
    <span class="hljs-meta">@Override</span> <span class="hljs-function">String <span class="hljs-title">printMsg</span><span class="hljs-params">(String num)</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"é»‘æ¡ƒ"</span> + num; &#125;
&#125;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HeartCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractCard</span> </span>&#123;
    <span class="hljs-meta">@Override</span> <span class="hljs-function">String <span class="hljs-title">printMsg</span><span class="hljs-params">(String num)</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"çº¢å¿ƒ"</span> + num; &#125;
&#125;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SpadeCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractCard</span> </span>&#123;
    <span class="hljs-meta">@Override</span> <span class="hljs-function">String <span class="hljs-title">printMsg</span><span class="hljs-params">(String num)</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"é»‘æ¡ƒ"</span> + num; &#125;
&#125;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DiamondCard</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractCard</span> </span>&#123;
    <span class="hljs-meta">@Override</span> <span class="hljs-function">String <span class="hljs-title">printMsg</span><span class="hljs-params">(String num)</span> </span>&#123; <span class="hljs-keyword">return</span> <span class="hljs-string">"æ–¹å—"</span> + num; &#125;
&#125;

<span class="hljs-comment">// äº«å…ƒå·¥å‚</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PokerFactory</span> </span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> SPADE = <span class="hljs-number">0</span>;    <span class="hljs-comment">// é»‘æ¡ƒ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> HEART = <span class="hljs-number">1</span>;    <span class="hljs-comment">// çº¢å¿ƒ</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> CLUB = <span class="hljs-number">2</span>;     <span class="hljs-comment">// æ¢…èŠ±</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-keyword">int</span> DIAMOND = <span class="hljs-number">3</span>;  <span class="hljs-comment">// æ–¹å—</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Map<Integer, AbstractCard> pokers = <span class="hljs-keyword">new</span> HashMap<>();

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> AbstractCard <span class="hljs-title">getPoker</span><span class="hljs-params">(<span class="hljs-keyword">int</span> color)</span> </span>&#123;
        <span class="hljs-comment">// ç›´æ¥æ‹¿ï¼Œä¸ç”¨å†è°ƒä¸€æ¬¡containsKey</span>
        AbstractCard card = pokers.get(color);
        <span class="hljs-keyword">if</span>(card == <span class="hljs-keyword">null</span>) &#123;
            System.out.println(<span class="hljs-string">"èŠ±è‰²å¯¹è±¡ä¸å­˜åœ¨ï¼Œæ–°å»ºå¯¹è±¡..."</span>);
            <span class="hljs-keyword">switch</span> (color) &#123;
                <span class="hljs-keyword">case</span> SPADE: card = <span class="hljs-keyword">new</span> SpadeCard(); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> HEART: card = <span class="hljs-keyword">new</span> HeartCard(); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> CLUB: card = <span class="hljs-keyword">new</span> ClubCard(); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>: card = <span class="hljs-keyword">new</span> DiamondCard(); <span class="hljs-keyword">break</span>;
            &#125;
            pokers.put(color, card);
        &#125; <span class="hljs-keyword">else</span> &#123;
            System.out.println(<span class="hljs-string">"èŠ±è‰²å¯¹è±¡å·²å­˜åœ¨ï¼Œå¤ç”¨å¯¹è±¡..."</span>);
        &#125;
        <span class="hljs-keyword">return</span> card;
    &#125;
&#125;

<span class="hljs-comment">// æµ‹è¯•ç”¨ä¾‹</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Player</span> </span>&#123;
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>&#123;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i < <span class="hljs-number">5</span>; i++) &#123;
            AbstractCard card;
            <span class="hljs-comment">// éšæœºèŠ±è‰²</span>
            <span class="hljs-keyword">switch</span> ((<span class="hljs-keyword">int</span>) (Math.random() * <span class="hljs-number">4</span>)) &#123;
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>: card = PokerFactory.getPoker(PokerFactory.SPADE); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: card = PokerFactory.getPoker(PokerFactory.HEART); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: card = PokerFactory.getPoker(PokerFactory.CLUB); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>: card = PokerFactory.getPoker(PokerFactory.DIAMOND); <span class="hljs-keyword">break</span>;
            &#125;
            <span class="hljs-comment">// éšæœºå¤§å°</span>
            <span class="hljs-keyword">int</span> num = (<span class="hljs-keyword">int</span>)(Math.random() * <span class="hljs-number">13</span> + <span class="hljs-number">1</span>);
            <span class="hljs-keyword">switch</span> (num) &#123;
                <span class="hljs-keyword">case</span> <span class="hljs-number">11</span>: System.out.println(card.printMsg(<span class="hljs-string">"J"</span>)); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">12</span>: System.out.println(card.printMsg(<span class="hljs-string">"Q"</span>)); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">13</span>: System.out.println(card.printMsg(<span class="hljs-string">"K"</span>)); <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">default</span>: System.out.println(card.printMsg(num + <span class="hljs-string">""</span>)); <span class="hljs-keyword">break</span>;
            &#125;
        &#125;
    &#125;
&#125;
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p><strong>è¿è¡Œç»“æœè¾“å‡ºå¦‚ä¸‹</strong>ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dee358e948ed4184a1cffcc33c5b01ee~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>ä½¿ç”¨äº«å…ƒæ¨¡å¼åªåˆ›å»ºäº†4ä¸ªå¡ç‰Œå¯¹è±¡ï¼Œææå†…éƒ¨çŠ¶æ€å’Œå¤–éƒ¨çŠ¶æ€çš„æ¦‚å¿µï¼š</p>
<ul>
<li><strong>å†…éƒ¨çŠ¶æ€</strong>ï¼š<strong>å›ºå®šä¸å˜å¯å…±äº«</strong> çš„éƒ¨åˆ†ï¼Œå­˜å‚¨åœ¨äº«å…ƒå¯¹è±¡å†…éƒ¨ï¼Œæ¯”å¦‚è¿™é‡Œçš„èŠ±è‰²ï¼›</li>
<li><strong>å¤–éƒ¨çŠ¶æ€</strong>ï¼š<strong>å¯å˜ä¸å¯å…±äº«</strong> çš„éƒ¨åˆ†ï¼Œä¸€èˆ¬ç”±å®¢æˆ·ç«¯ä¼ å…¥äº«å…ƒå¯¹è±¡å†…éƒ¨ï¼Œæ¯”å¦‚è¿™é‡Œçš„å¤§å°ï¼›</li>
</ul>
<p>å½“ç„¶ï¼ŒçŠ¶æ€çš„åŒºåˆ†ä¹Ÿä¸æ˜¯ç»å¯¹çš„ï¼Œè¦çœ‹åœºæ™¯ï¼Œæ¯”å¦‚æ‰©å±•åˆ°æ–—åœ°ä¸»çš„å¯¹å±€ï¼Œå†…éƒ¨çŠ¶æ€å°±å˜æˆäº†54å¼ ç‰Œ(æ€ä¹ˆå‘éƒ½ä¸ä¼šè¶…è¿‡54å¼ )ï¼Œå¤–éƒ¨çŠ¶æ€å˜æˆäº†ç‰Œçš„æŒæœ‰äººã€‚æ‰©å±•åˆ°è±¡æ£‹æ£‹å±€ï¼Œå†…éƒ¨çŠ¶æ€(é¢œè‰²ã€æ–‡å­—)ï¼Œå¤–éƒ¨çŠ¶æ€(ä½ç½®ä¿¡æ¯ç­‰)ã€‚</p>
<p>é¡ºå¸¦å¸¦å‡ºUMLç±»å›¾å’Œç»„æˆè§’è‰²ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/af30a7e668dc4d5486d0ac06a71d19cb~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<ul>
<li><strong>Flyweight</strong> (äº«å…ƒç±») â†’ æŠ½è±¡ç±»æˆ–æ¥å£ï¼Œå®šä¹‰äº«å…ƒå¯¹è±¡è¦å®ç°çš„å…¬å…±æ“ä½œæ–¹æ³•ï¼Œæ–¹æ³•ä¼šä¼ å…¥å¤–éƒ¨çŠ¶æ€å‚æ•°ï¼›</li>
<li><strong>ConcreteFlyweight</strong> (å…·ä½“äº«å…ƒç±») â†’ å®ç°äº«å…ƒæ¥å£ï¼Œå¹¶ä¸ºå†…éƒ¨çŠ¶æ€æ·»åŠ å­˜å‚¨ç©ºé—´ï¼›</li>
<li><strong>FlyweightFactory</strong> (äº«å…ƒå·¥å‚) â†’ åˆ›å»ºå¹¶ç®¡ç†å…±äº«çš„äº«å…ƒå¯¹è±¡ï¼Œå¯¹å¤–æä¾›è®¿é—®æ¥å£ï¼›</li>
</ul>
<p><strong>äº«å…ƒæ¨¡å¼çš„æœ¬è´¨</strong>ï¼š</p>
<blockquote>
<p>é€šè¿‡åˆ›å»ºæ›´å¤šçš„å¯å¤ç”¨å¯¹è±¡çš„å…±æœ‰ç‰¹å¾ï¼Œæ¥å°½å¯èƒ½å‡å°‘åˆ›å»ºé‡å¤å¯¹è±¡çš„å†…å­˜æ¶ˆè€—ã€‚</p>
</blockquote>
<p><strong>ç¼ºç‚¹</strong>ï¼š</p>
<blockquote>
<p>æ—¶é—´æ¢ç©ºé—´ï¼Œå¯¹äºéœ€è¦å¿«é€Ÿå“åº”çš„ç³»ç»Ÿå¹¶ä¸åˆé€‚ï¼Œéœ€åˆ†ç¦»å‡ºå†…éƒ¨å’Œå¤–éƒ¨çŠ¶æ€ï¼Œéš¾ç»Ÿä¸€ï¼Œå¢åŠ äº†ç³»ç»Ÿè®¾è®¡å®ç°çš„å¤æ‚åº¦ï¼›</p>
</blockquote>
<hr>
<h2 data-id="heading-2">0x2ã€äº«å…ƒæ¨¡å¼ VS å¤šä¾‹ã€ç¼“å­˜ã€å¯¹è±¡æ± </h2>
<p>ä»ä»£ç å®ç°ä¸Šçœ‹ï¼Œäº«å…ƒæ¨¡å¼å’Œå‰é¢å­¦çš„ <strong>å•ä¾‹ä¸­çš„å¤šä¾‹</strong> å¾ˆç›¸ä¼¼ï¼Œä½†ä»è®¾è®¡æ„å›¾ä¸Šçœ‹ï¼Œæ˜¯å®Œå…¨ä¸åŒçš„ã€‚</p>
<blockquote>
<p>å¤šä¾‹æ˜¯ä¸ºäº†é™åˆ¶å¯¹è±¡çš„ä¸ªæ•°ï¼Œäº«å…ƒæ¨¡å¼åˆ™æ˜¯ä¸ºäº†å¯¹è±¡å¤ç”¨ï¼ŒèŠ‚çœå†…å­˜ã€‚</p>
</blockquote>
<p>åœ¨æ¥çœ‹çœ‹ä¸ç¼“å­˜çš„åŒºåˆ«ï¼š</p>
<blockquote>
<p><strong>äº«å…ƒæ¨¡å¼</strong>å¼ºè°ƒçš„æ˜¯<strong>ç©ºé—´æ•ˆç‡</strong>(å¤§æ•°æ®æ¨¡å‹å¯¹è±¡å¤ç”¨)ï¼Œè€Œç¼“å­˜æ¨¡å¼å¼ºè°ƒçš„æ˜¯ <strong>æ—¶é—´æ•ˆç‡</strong>(å¦‚ç¼“å­˜ç§’æ€çš„æ´»åŠ¨æ•°æ®å’Œåº“å­˜æ•°æ®ç­‰ï¼Œæ•°æ®å¯èƒ½ä¼šå ç”¨å¤§é‡ç©ºé—´ï¼Œç›®çš„æ˜¯ä¸ºäº†åŠæ—¶å“åº”)ã€‚</p>
</blockquote>
<p>è¿˜æœ‰å¯¹è±¡æ± ï¼š</p>
<blockquote>
<p>ä¸ºäº†é¿å…å¯¹è±¡é¢‘ç¹åˆ›å»ºå’Œé‡Šæ”¾å¯¼è‡´å†…å­˜ç¢ç‰‡ï¼Œé¢„å…ˆç”³è¯·ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ¯æ¬¡åˆ›å»ºå¯¹è±¡æ—¶ï¼Œç›´æ¥ä»å¯¹è±¡æ± é‡Œå–å‡ºä¸€ä¸ªç©ºé—²å¯¹è±¡æ¥ä½¿ç”¨ï¼Œä½¿ç”¨å®Œå†é‡æ–°æ”¾å›å¯¹è±¡æ± ä¸­ä»¥ååç»­ä½¿ç”¨ï¼Œè€Œéç›´æ¥é‡Šæ”¾ã€‚</p>
<p>æ± åŒ–æŠ€æœ¯é‡Œçš„å¤ç”¨ï¼Œå¯ä»¥ç†è§£ä¸º<strong>é‡å¤ä½¿ç”¨</strong>ï¼Œä¸»è¦ç›®çš„æ˜¯<strong>èŠ‚çœæ—¶é—´</strong>ï¼Œä»»æ„æ—¶åˆ»ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æ˜¯è¢«ä¸€ä¸ªä½¿ç”¨è€…<strong>ç‹¬å ã€‚</strong>
è€Œäº«å…ƒæ¨¡å¼çš„å¤ç”¨ï¼Œå¯ä»¥ç†è§£ä¸º<strong>å…±äº«ä½¿ç”¨</strong>ï¼Œä¸»è¦ç›®çš„æ˜¯<strong>èŠ‚çœç©ºé—´</strong>ï¼Œåœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼Œéƒ½æ˜¯è¢«æ‰€æœ‰ä½¿ç”¨è€…<strong>å…±äº«</strong>ã€‚</p>
</blockquote>
<hr>
<h2 data-id="heading-3">0x3ã€äº«å…ƒæ¨¡å¼åœ¨Java Integerã€Stringä¸­çš„åº”ç”¨</h2>
<p>å…ˆè¯´ä¸‹Integerçš„ï¼Œä¸‹é¢çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java">Integer i1 = <span class="hljs-number">12</span>;
Integer i2 = <span class="hljs-number">12</span>;
Integer i3 = <span class="hljs-number">128</span>;
Integer i4 = <span class="hljs-number">128</span>;
System.out.println(i1 == i2);   <span class="hljs-comment">// è¾“å‡ºï¼štrue</span>
System.out.println(i3 == i4);   <span class="hljs-comment">// è¾“å‡º: false</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å­¦è¿‡Javaçš„éƒ½çŸ¥é“ï¼š**åŒç­‰å·(==)**åŒºåˆ«å¯¹å¾…ä¸¤ç±»æ•°æ®ç±»å‹ï¼š</p>
<ul>
<li><strong>åŸºæœ¬æ•°æ®ç±»å‹</strong>(byteã€charã€intç­‰) â†’ æ¯”è¾ƒå€¼æ˜¯å¦ç›¸åŒï¼›</li>
<li><strong>å¼•ç”¨æ•°æ®ç±»å‹</strong>(å¯¹è±¡å®ä¾‹) â†’ æ¯”è¾ƒå˜é‡æŒ‡å‘çš„å¯¹è±¡å†…å­˜åœ°å€æ˜¯å¦ç›¸åŒï¼›</li>
</ul>
<p>æ—¢ç„¶i1å’Œi2ç›¸ç­‰ï¼Œè¯´æ˜æŒ‡å‘åŒä¸€å¯¹è±¡å†…å­˜åœ°å€ï¼Œå­˜åœ¨å¯¹è±¡é‡ç”¨ï¼ŒæŒ‰ç†æ¥è¯´ï¼Œi3å’Œi4åº”è¯¥ä¹Ÿç›¸ç­‰å•Šï¼Ÿä¸”å¬æˆ‘å¨“å¨“é“æ¥ï¼š</p>
<p>æ‰§è¡Œåˆ°è¿™æ ·çš„è¯­å¥ï¼šInteger i1 = 12ï¼Œ12æ˜¯åŸºæœ¬æ•°æ®ç±»å‹intï¼Œèµ‹å€¼ç»™åŒ…è£…å™¨ç±»å‹Integeræ—¶ï¼Œä¼šè§¦å‘è‡ªåŠ¨è£…ç®±æœºåˆ¶ï¼Œåº•å±‚ç›¸å½“äºæ‰§è¡Œäº†è¿™æ ·çš„è¯­å¥ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java"><span class="hljs-comment">// åˆ›å»ºIntegerç±»å‹çš„å®ä¾‹ï¼Œå¹¶èµ‹å€¼</span>
Integer i1 = Integer.valueOf(<span class="hljs-number">12</span>);

<span class="hljs-comment">// é™„ï¼šè‡ªåŠ¨æ‹†ç®± int j = i1 åº•å±‚æ‰§è¡Œçš„æ˜¯ï¼š</span>
<span class="hljs-keyword">int</span> j = i1.intValue();
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¡Œï¼Œé‚£å°±æ¥è·Ÿä¸‹ <strong><code>valueOf()</code></strong> æ–¹æ³•éƒ½åšäº†å•¥ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7975e7423e414e2c8ce192e533e691bb~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>åˆ¤æ–­æ˜¯å¦å¤§äºlowå°äºhighï¼Œæ˜¯è¿”å›ç¼“å­˜ä¸­çš„Integerå®ä¾‹ï¼Œå¦åˆ™è¿”å›æ–°çš„Integerå®ä¾‹ï¼Œçœ‹ä¸‹ <strong>IntegerCache</strong>ï¼š</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9b91120699514195a131ca4400c69344~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<p>å‘•å¼ï¼Œå½“IntegerCacheç±»è¢«åŠ è½½æ˜¯ï¼Œåˆå§‹åŒ–äº†å€¼åœ¨ <strong>-128-127</strong> é—´çš„Integerå®ä¾‹ï¼Œå¹¶åŠ å…¥åˆ°ç¼“å­˜æ•°ç»„ä¸­ã€‚è€Œåªç¼“å­˜è¿™ä¸ªèŒƒå›´çš„åŸå› ï¼š</p>
<blockquote>
<p>ä¸å¯èƒ½é¢„å…ˆç¼“å­˜å¥½æ‰€æœ‰çš„æ•´å‹å€¼ï¼Œåªèƒ½é€‰æ‹©å¯¹äºå¤§éƒ¨åˆ†åº”ç”¨æ¥è¯´æˆ–æœ€å¸¸ç”¨çš„æ•´å½¢å€¼ï¼Œå³ä¸€ä¸ªå­—èŠ‚çš„å¤§å°ã€‚</p>
</blockquote>
<p>æœ€å¤§å€¼ä¹Ÿå¯ä»¥é€šè¿‡ä¿®æ”¹JVMé…ç½®è¿›è¡Œä¿®æ”¹ (äºŒé€‰ä¸€)ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java">-Djava.lang.Integer.IntegerCache.high=<span class="hljs-number">255</span>
-XX:AutoBoxCacheMax=<span class="hljs-number">255</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>è¿™å°±æ˜¯ä¸Šé¢çš„ä»£ç è¾“å‡ºtrueå’Œfalseçš„åŸå› äº†(-128-127èŒƒå›´å†…å¤ç”¨ï¼Œä¸åœ¨èŒƒå›´å¤–çš„ç›´æ¥new)ï¼Œè¿™é‡Œçš„IntegerCacheå°±æ˜¯äº«å…ƒæ¨¡å¼ä¸­çš„äº«å…ƒå·¥å‚ã€‚</p>
<p>å†æ¥ç€çœ‹ä¸‹Stringï¼Œä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p>
<pre><code class="hljs language-java copyable" lang="java">String s1 = <span class="hljs-string">"æ°å“¥"</span>;
String s2 = <span class="hljs-string">"æ°å“¥"</span>;
String s3 = <span class="hljs-string">"æ°"</span> + <span class="hljs-string">"å“¥"</span>;
String s4 = <span class="hljs-keyword">new</span> String(<span class="hljs-string">"æ°å“¥"</span>);
System.out.println(s1 == s2);   <span class="hljs-comment">// è¾“å‡º: true</span>
System.out.println(s1 == s3);   <span class="hljs-comment">// è¾“å‡º: true</span>
System.out.println(s1 == s4);   <span class="hljs-comment">// è¾“å‡º: false</span>
<span class="copy-code-btn">å¤åˆ¶ä»£ç </span></code></pre>
<p>å’ŒIntegerç±»çš„è®¾è®¡æ€æƒ³ç›¸ä¼¼ï¼ŒJVMä¼šä¸“é—¨å¼€è¾Ÿä¸€å—å­˜å‚¨åŒºæ¥å­˜å‚¨å­—ç¬¦ä¸²å¸¸é‡(å­—ç¬¦ä¸²å¸¸é‡æ± )ï¼Œè·ŸIntegerä¸åŒï¼Œæ— æ³•äº‹å…ˆçŸ¥é“è¦å…±äº«å“ªäº›å­—ç¬¦ä¸²å¸¸é‡ï¼Œåªèƒ½ç¬¬ä¸€æ¬¡ç”¨åˆ°çš„æ—¶å€™å­˜å‚¨åˆ°å¸¸é‡æ± ä¸­ï¼Œåç»­ç”¨åˆ°ç›´æ¥å¼•ç”¨ï¼Œå°±æ— éœ€é‡æ–°åˆ›å»ºäº†ã€‚è§£é‡Šä¸‹ä¸Šè¿°ä»£ç ï¼š</p>
<ul>
<li>s1 == s2 â†’ ç¼–è¯‘æ—¶ï¼Œ"æ°å“¥"è¢«å­˜å‚¨åœ¨å¸¸é‡æ± ä¸­ï¼Œs1å’Œs2çš„å¼•ç”¨éƒ½æŒ‡å‘å¸¸é‡æ± é‡Œçš„"æ°å“¥"ï¼›</li>
<li>s1 == s3 â†’ ç¼–è¯‘å™¨ä¼˜åŒ–ï¼Œå…ˆæŠŠå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œå†å»å¸¸é‡æ± é‡ŒæŸ¥æ‰¾å­—ç¬¦ä¸²æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è®©s3ç›´æ¥æŒ‡å‘è¯¥å­—ç¬¦ä¸²ï¼›</li>
<li>s1 != s4 â†’ ä¸æ˜¯æ˜¾å¼èµ‹å€¼ï¼Œç¼–è¯‘å™¨ä¼šåœ¨å †ä¸­é‡æ–°åˆ†é…ä¸€ä¸ªåŒºåŸŸæ¥å­˜å‚¨å®ƒçš„å¯¹è±¡æ•°æ®ï¼›</li>
</ul>
<hr>
<p>ä»¥ä¸Šå°±æ˜¯æœ¬èŠ‚çš„å…¨éƒ¨å†…å®¹ï¼Œä¸‹èŠ‚å¼€å§‹å•ƒ11ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œè°¢è°¢~</p>
<p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/95695b598151468497de4703d16846bd~tplv-k3u1fbpfcp-zoom-1.image" alt loading="lazy" referrerpolicy="no-referrer"></p>
<hr></div>  
</div>
            