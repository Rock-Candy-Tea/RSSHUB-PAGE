
---
title: 'Jetpack Glance Alpha 版现已推出'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://devrel.andfun.cn/devrel/posts/2021/12/IMZsGR.png'
author: 开源中国
comments: false
date: Mon, 27 Dec 2021 14:20:00 GMT
thumbnail: 'https://devrel.andfun.cn/devrel/posts/2021/12/IMZsGR.png'
---

<div>   
<div class="content">
                                                                                            <p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt src="https://devrel.andfun.cn/devrel/posts/2021/12/IMZsGR.png" referrerpolicy="no-referrer"></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><em>作者 / 开发者关系工程师 Marcel Pintó Biescas，@marxallski</em></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">Android 12<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fabout%2Fversions%2F12%2Ffeatures%2Fwidgets" target="_blank">改进</a><span> </span>了一项被许多 Android 用户视为关键的功能 -<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fguide%2Ftopics%2Fappwidgets%2Foverview" target="_blank">App Widgets</a>，改进后的 Widgets 更加实用、美观，且更易于被用户发现 (84% 的用户至少使用一个 Widgets)。现在，我们发布了<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fandroidx%2Freleases%2Fglance" target="_blank">Jetpack Glance</a><span> </span>的第一个 Alpha 版，让 Widgets 的构建过程变得更加轻松，该版本是建立在<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fandroidx%2Freleases%2Fcompose-runtime" target="_blank">Jetpack Compose 运行时 (Runtime)</a><span> </span>之上的新框架，旨在实现更快、更轻松的为主屏幕或其他界面构建 App Widgets。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">欢迎您开始尝试并<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fissuetracker.google.com%2Fissues%2Fnew%3Fcomponent%3D1097239%26template%3D1611667" target="_blank">分享反馈意见</a>。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">Glance 提供了新式声明性 Kotlin API，其类似于您在<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fcompose" target="_blank">Jetpack Compose</a><span> </span>中使用的 API，能够帮助您用更少的代码构建更美观的自适应 App Widgets。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="△ Glance "Hello World" Widgets 示例" src="https://devrel.andfun.cn/devrel/posts/2021/12/uXRjhk.png" referrerpolicy="no-referrer"></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">△ Glance "Hello World" Widgets 示例</p> 
<pre style="margin-left:0; margin-right:0; text-align:left"><code class="language-Kotlin"><span><span style="color:#d73a49">class</span> <span style="color:#6f42c1">GreetingsWidget</span></span>(<span style="color:#d73a49">private</span> <span style="color:#d73a49">val</span> name: String): GlanceAppWidget() &#123;
    <span style="color:#6a737d">@Composable</span>
    <span style="color:#d73a49">override</span> <span><span style="color:#d73a49">fun</span> <span style="color:#6f42c1">Content</span><span>()</span></span> &#123;
        Text(text = <span style="color:#032f62">"Hello <span style="color:#032f62">$name</span>"</span>)
    &#125;
&#125;

<span><span style="color:#d73a49">class</span> <span style="color:#6f42c1">GreetingsWidgetReceiver</span> : <span style="color:#d73a49">GlanceAppWidgetReceiver</span></span>() &#123;

    <span style="color:#d73a49">override</span> <span style="color:#d73a49">val</span> glanceAppWidget = GreetingsWidget(<span style="color:#032f62">"Glance"</span>)
&#125;
</code></pre> 
<h2 style="margin-left:0; margin-right:0; text-align:left"><strong>工作原理</strong></h2> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">Glance 提供了可组合项的基础组件集，助您打造 "一目了然" 的体验。现在，我们将提供更多的 App Widgets。Glance 利用 Jetpack Compose 运行时 (Runtime)，可以将<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fcompose%2Fruntime%2FComposable" target="_blank">可组合项</a><span> </span>转化为实际的<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fandroid%2Fwidget%2FRemoteViews" target="_blank">RemoteViews</a>，并在 App Widgets 中显示。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt="△ Glance 结构示意图" src="https://devrel.andfun.cn/devrel/posts/2021/12/kevpNe.png" referrerpolicy="no-referrer"></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">△ Glance 结构示意图</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">这意味着 Glance 需要<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fcompose%2Finterop%2Fadding%23anchor" target="_blank">启用 Compose</a>，且依赖于运行时 (Runtime)、图形 (Graphics) 和单元界面<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fcompose%2Flayering" target="_blank">Compose 层</a>，但它与其他现有的 Jetpack Compose 界面元素之间<strong>不具备直接互操作性</strong>。但是，您可以分享应用中的状态或任何其他逻辑，以此来打造一目了然的界面。</p> 
<h2 style="margin-left:0; margin-right:0; text-align:left"><strong>Alpha 版介绍</strong></h2> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">此初始版本引入了主要的 API，不仅能够实现与现有 RemoteViews 之间的互操作性，还能帮助您构建 App Widgets。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">以下是该开发库提供的内容概览:</p> 
<ul style="list-style-type:disc; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0">通过<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2FGlanceAppWidget" target="_blank">GlanceAppWidget</a><span> </span>和<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2FGlanceAppWidgetReceiver" target="_blank">GlanceAppWidgetReceiver</a><span> </span>声明您的 App Widgets。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">利用 Glance 可组合项的初始集组合您的界面:<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Flayout%2Fpackage-summary%23top-level-functions" target="_blank">Box、Row、Column</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Ftext%2Fpackage-summary%23text" target="_blank">Text</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fpackage-summary%23button" target="_blank">Button</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Flazy%2Fpackage-summary%23lazycolumn" target="_blank">LazyColumn</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fpackage-summary%23image" target="_blank">Image</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Flayout%2Fpackage-summary%23top-level-functions" target="_blank">Spacer</a>。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">利用<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2FGlanceModifier.html" target="_blank">GlanceModifier</a><span> </span>方法将修饰符应用于可组合项。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">利用预定义的<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Faction%2Fpackage-summary" target="_blank">Action</a><span> </span>处理用户交互:</p> 
  <ul style="list-style-type:circle; margin-left:0; margin-right:0"> 
   <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Faction%2Fpackage-summary%23actionstartactivity" target="_blank">actionStartActivity</a></li> 
   <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Faction%2Fpackage-summary%23actionruncallback" target="_blank">actionRunCallback</a></li> 
   <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Faction%2Fpackage-summary%23actionstartservice" target="_blank">actionStartService</a></li> 
   <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Faction%2Fpackage-summary%23actionstartbroadcastreceiver" target="_blank">actionStartBroadcastReceiver</a></li> 
  </ul> </li> 
 <li> <p style="margin-left:0; margin-right:0">通过<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Faction%2FActionParameters" target="_blank">ActionParameters</a><span> </span>为 Action 提供参数。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">通过定义<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2FSizeMode.Single" target="_blank">SizeMode.Single</a>、<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2FSizeMode.Exact" target="_blank">SizeMode.Exact</a><span> </span>或<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2FSizeMode.Responsive" target="_blank">SizeMode.Responsive</a><span> </span>来处理<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fguide%2Ftopics%2Fappwidgets%2Flayouts" target="_blank">不同的 Widgets 布局</a>。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">提供<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fstate%2FGlanceStateDefinition.html" target="_blank">GlanceStateDefinition</a>，以保留<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Fstate%2Fpackage-summary" target="_blank">GlanceAppWidget</a><span> </span>状态。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">提供本地组合，例如<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fpackage-summary%23top-level-properties" target="_blank">LocalContext、LocalState、LocalGlanceId、LocalSize</a>。</p> </li> 
 <li> <p style="margin-left:0; margin-right:0">通过<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fkotlin%2Fandroidx%2Fglance%2Fappwidget%2Fpackage-summary%23androidremoteviews" target="_blank">AndroidRemoteViews</a><span> </span>可组合项实现与您现有<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Freference%2Fandroid%2Fwidget%2FRemoteViews.html" target="_blank">RemoteViews</a><span> </span>之间的互操作。</p> </li> 
</ul> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">我们还将推出更多功能，例如默认主题，更完善的 Android Studio 支持等等。敬请期待<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fandroidx%2Freleases%2Fglance" target="_blank">新版本</a>。</p> 
<blockquote> 
 <p style="margin-left:0; margin-right:0"><em>注意: 虽然 SDK 的最低版本是 21，但 Alpha 版目前支持兼容的最低版本为 SDK v23。</em></p> 
</blockquote> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">可以查看<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdevrel.andfun.cn%2Fdevrel%2Fposts%2F2021%2F12%2F0zEp0d.mp4" target="_blank">在 Android 12 中构建新式 Android App Widgets</a><span> </span>视频了解更多详细信息。</p> 
<h2 style="margin-left:0; margin-right:0; text-align:left"><strong>Glance 使用入门</strong></h2> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">您可以在 GitHub 上查看<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fandroid%2Fuser-interface-samples%2Ftree%2Fglance%2FAppWidget%2Fglance-widget" target="_blank">示例</a>，以便快速入门。也可以在最新的<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fstudio" target="_blank">稳定版 Android Studio</a><span> </span>中使用 Glance，但首先需要按照<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.google.cn%2Fjetpack%2Fcompose%2Finterop%2Fadding%23setup" target="_blank">Jetpack Compose 文档</a><span> </span>中的步骤进行设置，因为 Glance 依赖于 Compose 运行时 (Runtime)。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">此外，您还可以查看<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fcs.android.com%2Fandroidx%2Fplatform%2Fframeworks%2Fsupport%2F%2B%2Fandroidx-main%3Aglance%2Fglance-appwidget%2Fintegration-tests%2Fdemos%2Fsrc%2Fmain%2Fjava%2Fandroidx%2Fglance%2Fappwidget%2Fdemos%2F" target="_blank">AndroidX 代码库中的进阶示例</a>。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">编写您自己的插件，您可以扩展 Android Gradle Plugin 并根据您的项目需求自定义您的构建！</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left"><img alt src="https://devrel.andfun.cn/devrel/posts/2021/12/3PomeD.gif" referrerpolicy="no-referrer"></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">△<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fcs.android.com%2Fandroidx%2Fplatform%2Fframeworks%2Fsupport%2F%2B%2Fandroidx-main%3Aglance%2Fglance-appwidget%2Fintegration-tests%2Fdemos%2Fsrc%2Fmain%2Fjava%2Fandroidx%2Fglance%2Fappwidget%2Fdemos%2FResponsiveAppWidget.kt" target="_blank">ResponsiveAppWidget.kt</a><span> </span>演示</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">Alpha 版本是您参与开发 API 的重要机会，因此，欢迎<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fissuetracker.google.com%2Fissues%2Fnew%3Fcomponent%3D1097239%26template%3D1611667" target="_blank">分享您的反馈</a>，帮助我们了解并进一步提升您的体验！也欢迎您持续关注我们了解更多最新内容。</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">期待您的体验！</p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">欢迎您<span> </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fservices.google.cn%2Ffb%2Fforms%2Fandroiddevswechat2%2F" target="_blank">点击这里</a><span> </span>向我们提交反馈，或分享您喜欢的内容、发现的问题。您的反馈对我们非常重要，感谢您的支持！</p>
                                        </div>
                                      
</div>
            