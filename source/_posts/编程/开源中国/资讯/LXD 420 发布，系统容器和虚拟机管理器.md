
---
title: 'LXD 4.20 发布，系统容器和虚拟机管理器'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=6958'
author: 开源中国
comments: false
date: Sun, 14 Nov 2021 07:10:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=6958'
---

<div>   
<div class="content">
                                                                                            <p>LXD 是下一代的系统容器和虚拟机管理器。它为在容器或虚拟机内运行的完整 Linux 系统提供了统一的用户体验。它为各种使用情况提供了灵活性和可扩展性，支持不同的存储后端和网络类型。</p> 
<p>LXD 4.20 正式发布，部分更新内容如下：</p> 
<h3>虚拟机的实时迁移</h3> 
<p>LXD 现在已经初步支持虚拟机的实时迁移。通过使用 <code>lxc move</code> 在两个独立的 LXD 服务器之间移动，或使用 <code>lxc move --target</code> 在一个集群内移动。假设虚拟机当前正在运行，将尝试进行实时迁移。</p> 
<p>使用这个方法需要在虚拟机上启用 <code>migration.stateful</code>，这将阻止它使用 GPU、USB、主机 PCI 设备，以及禁用 virtiofs。</p> 
<p>目前的实现将有效地执行实例的有状态停止，然后迁移整个数据（将包含运行时状态）并在目标上恢复。</p> 
<p>当使用 Ceph 时，这应该只需要 2-3 秒，但在其他存储后端可能需要更长的时间。</p> 
<h3>网络区域 (DNS)</h3> 
<p>那些在许多项目中管理大量实例的人常常希望所有实例在整个网络中都有有效的正向和反向 DNS 记录。</p> 
<p>到目前为止，唯一的选择是使用内置的 dnsmasq DNS 服务器及其自动生成的 DNS 区域，但这只适用于一个项目中的一个网络，不容易集成到一个更大的基础设施中。另一个选择是在侧面运行一个完全手动配置的 DNS 服务器。</p> 
<p>在这个版本中，LXD 引入了网络区域的概念。这些是与 LXD 网络绑定的 DNS 区域，可用于正向 DNS 记录、反向 IPv4 或反向 IPv6 的 DNS 记录。</p> 
<h3>OVN 网络的 SR-IOV 加速</h3> 
<p>为了进一步提高 LXD 上基于 OVN 的网络性能，我们现在增加了对 SR-IOV 加速的支持。</p> 
<p>其工作方式是通过使用可以在 <code>switchdev</code> 模式下运行的物理网卡。这样的网卡将同时提供一个面向客户的VF和一个面向主机的代表端口。当拥有合适网卡的系统在 <code>switchdev</code>模式下，将 PF 添加到 OVS 网桥，并将 OVS 配置为 SR-IOV 卸载时，LXD 可以自动分配 VF 供容器或 VM 使用。</p> 
<h3>容器上的 Linux sysctl 配置</h3> 
<p>引入了一套新的 <code>linux.sysctl.*</code> 配置键。这允许在容器启动时直接将特定的 sysctl 设置为特定值。这比在容器内设置 sysctl.d 条目更灵活。</p> 
<h3>虚拟机的核心调度</h3> 
<p>在LXD 4.19 中，我们对容器进行了核心调度，现在我们将其扩展到了虚拟机。在支持核心调度的内核上运行 LXD 时，LXD 会自动确保特定虚拟机的所有 vCPU 线程都属于同一个核心调度组。</p> 
<p>核心调度的目的是允许在 CPU 上使用 SMT，否则会因 Spectre 漏洞而有被攻击的风险。核心调度确保客户将使用一个核心/线程对，或者当客户使用相关的核心时，线程将保持不使用。</p> 
<p>更多详情可查看：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdiscuss.linuxcontainers.org%2Ft%2Flxd-4-20-has-been-released%2F12540" target="_blank">https://discuss.linuxcontainers.org/t/lxd-4-20-has-been-released/12540</a></p> 
<h3>下载</h3> 
<ul> 
 <li><strong>Linux:</strong> snap install lxd</li> 
 <li><strong>MacOS:</strong> brew install lxc</li> 
 <li><strong>Windows:</strong> choco install lxc</li> 
</ul>
                                        </div>
                                      
</div>
            