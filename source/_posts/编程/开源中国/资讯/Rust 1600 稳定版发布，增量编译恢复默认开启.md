
---
title: 'Rust 1.60.0 稳定版发布，增量编译恢复默认开启'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=6665'
author: 开源中国
comments: false
date: Fri, 08 Apr 2022 07:37:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=6665'
---

<div>   
<div class="content">
                                                                    
                                                        <p>Rust 1.60.0 稳定版已正式<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.rust-lang.org%2F2022%2F04%2F07%2FRust-1.60.0.html" target="_blank">发布</a>。</p> 
<p><strong>主要新变化</strong></p> 
<p><strong>增量编译恢复默认开启</strong></p> 
<p>1.60 版本重新启用了增量编译。Rust 团队继续致力于修复增量编译中的错误，目前还没有发现会导致大范围破坏的问题，因此重新启用了增量编译。此外，编译器团队正在继续研究长期策略，以避免未来出现这类问题。</p> 
<p><strong>基于源的代码覆盖率</strong></p> 
<p>rustc 中对基于 LLVM 的覆盖率分析的支持已到达稳定状态，现在可使用<code>-Cinstrument-coverage</code><span style="background-color:#ffffff; color:#000000"><span>来重新构建代码，例如：</span></span></p> 
<pre><code>RUSTFLAGS="-C instrument-coverage" cargo build</code></pre> 
<p>之后，开发者可以运行生成的二进制文件，它将在当前目录下产生一个<code>default.profraw</code>文件(路径和文件名可以被环境变量覆盖，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Frustc%2Finstrument-coverage.html%23running-the-instrumented-binary-to-generate-raw-coverage-profiling-data" target="_blank">详见文档</a>）。</p> 
<pre><code>rustup component add llvm-tools-preview
$(rustc --print sysroot)/lib/rustlib/x86_64-unknown-linux-gnu/bin/llvm-profdata merge -sparse default.profraw -o default.profdata
$(rustc --print sysroot)/lib/rustlib/x86_64-unknown-linux-gnu/bin/llvm-cov show -Xdemangler=rustfilt target/debug/coverage-testing \
    -instr-profile=default.profdata \
    -show-line-counts-or-regions \
    -show-instantiations</code></pre> 
<h3 style="text-align:start"><code>cargo --timings</code></h3> 
<p style="color:#000000; text-align:start">Cargo<span> 使用</span><code>--timings</code><span style="background-color:#ffffff; color:#000000"><span> </span>flag</span>收集构建信息的功能已到达稳定状态。</p> 
<pre><code>$ cargo build --timings
   Compiling hello-world v0.1.0 (hello-world)
      Timing report saved to target/cargo-timings/cargo-timing-20220318T174818Z.html
    Finished dev [unoptimized + debuginfo] target(s) in 0.98s</code></pre> 
<p><strong>面向 Cargo 的新语法</strong></p> 
<p>此版本引入了两项新的变更以改进对 Cargo 的支持，以及它们如何与可选依赖项交互：</p> 
<ul> 
 <li><span style="background-color:#ffffff; color:#000000">命名空间依赖项 (Namespaced dependencies</span><span style="background-color:#ffffff; color:#000000">)</span></li> 
 <li><span style="background-color:#ffffff; color:#000000">弱依赖项 (weak dependency</span><span style="background-color:#ffffff; color:#000000">)</span></li> 
</ul> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><strong>稳定的 API 列表</strong></p> 
<p style="color:#121212; margin-left:0; margin-right:0; text-align:start">部分方法和 <span style="background-color:#ffffff; color:#000000">trait<span> 实现已稳定化，<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.rust-lang.org%2F2022%2F04%2F07%2FRust-1.60.0.html%23stabilized-apis" target="_blank">点此查看详情</a>。</span></span></p> 
<p style="color:#333333; margin-left:0; margin-right:0; text-align:left">下载地址：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Freleases%2Ftag%2F1.60.0" target="_blank">https://github.com/rust-lang/rust/releases/tag/1.60.0</a></p>
                                        </div>
                                      
</div>
            