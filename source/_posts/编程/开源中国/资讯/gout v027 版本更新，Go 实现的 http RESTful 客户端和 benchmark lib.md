
---
title: 'gout v0.2.7 版本更新，Go 实现的 http RESTful 客户端和 benchmark lib'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=8420'
author: 开源中国
comments: false
date: Fri, 10 Sep 2021 12:00:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=8420'
---

<div>   
<div class="content">
                                                                                            <h3 style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">项目地址</h3> 
<p style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fguonaihong%2Fgout" style="box-sizing: inherit; background-color: transparent; color: rgb(52, 111, 182); text-decoration: none;" target="_blank">https://github.com/guonaihong/gout</a></p> 
<p style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><a href="https://gitee.com/guonaihong/gout" style="box-sizing: inherit; background-color: transparent; color: rgb(52, 111, 182); text-decoration: none;">https://gitee.com/guonaihong/gout</a></p> 
<h3 style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">本次更新</h3> 
<div> 
 <ul> 
  <li style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">支持响应中间件</li> 
  <li style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">修复host写全url, 内容不对的问题</li> 
 </ul> 
 <p style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"> </p> 
 <h3 style="box-sizing: inherit; margin: 0px 0px 20px; line-height: inherit; color: rgb(51, 51, 51); font-family: -apple-system, system-ui, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">响应中间件例子</h3> 
 <div> 
  <pre style="box-sizing: border-box; font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, "Liberation Mono", monospace; font-size: 13.6px; margin-top: 0px; margin-bottom: 0px; overflow-wrap: normal; padding: 16px; overflow: auto; line-height: 1.45; background-color: var(--color-bg-tertiary); border-radius: 6px; word-break: normal; color: rgb(36, 41, 47); font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"><span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">import</span> (
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"bytes"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"encoding/json"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"errors"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"fmt"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"github.com/gin-gonic/gin"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"github.com/guonaihong/gout"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"io/ioutil"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"log"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"net/http"</span>
<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"time"</span>
)

<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">// response拦截器修改示例</span>
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">type</span> <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);"><span class="pl-token" data-hydro-click="&#123;"event_type":"code_navigation.click_on_symbol","payload":&#123;"action":"click_on_symbol","repository_id":190199903,"ref":"master","language":"Markdown","originating_url":"https://github.com/guonaihong/gout","user_id":5006959&#125;&#125;" data-hydro-click-hmac="a7b75e19da606ee528bde41969880223fb00a4e129fdc29d3b509b5660e86b40" style="box-sizing: border-box;">demoResponseMiddler</span></span> <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">struct</span>&#123;&#125;

<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span> (<span class="pl-s1" style="box-sizing: border-box;">d</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span><span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);"><span class="pl-token" data-hydro-click="&#123;"event_type":"code_navigation.click_on_symbol","payload":&#123;"action":"click_on_symbol","repository_id":190199903,"ref":"master","language":"Markdown","originating_url":"https://github.com/guonaihong/gout","user_id":5006959&#125;&#125;" data-hydro-click-hmac="a7b75e19da606ee528bde41969880223fb00a4e129fdc29d3b509b5660e86b40" style="box-sizing: border-box;">demoResponseMiddler</span></span>) <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">ModifyResponse</span>(<span class="pl-s1" style="box-sizing: border-box;">response</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span>http.<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Response</span>) <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">error</span> &#123;
<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">// 修改responseBody。 因为返回值大概率会有 &#123; code, data,msg&#125; 等字段,希望进行统一处理</span>
<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">//这里想验证code. 如果不对就返回error。 对的话将 data中的内容写入body,这样后面BindJson的时候就可以直接处理业务了</span>
<span class="pl-s1" style="box-sizing: border-box;">all</span>, <span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">ioutil</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">ReadAll</span>(<span class="pl-s1" style="box-sizing: border-box;">response</span>.<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Body</span>)
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">if</span> <span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">!=</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">nil</span> &#123;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">return</span> <span class="pl-s1" style="box-sizing: border-box;">err</span>
&#125;
<span class="pl-s1" style="box-sizing: border-box;">obj</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">make</span>(<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">map</span>[<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span>]<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">interface</span>&#123;&#125;)
<span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">=</span> <span class="pl-s1" style="box-sizing: border-box;">json</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Unmarshal</span>(<span class="pl-s1" style="box-sizing: border-box;">all</span>, <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">&</span><span class="pl-s1" style="box-sizing: border-box;">obj</span>)
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">if</span> <span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">!=</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">nil</span> &#123;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">return</span> <span class="pl-s1" style="box-sizing: border-box;">err</span>
&#125;
<span class="pl-s1" style="box-sizing: border-box;">code</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">obj</span>[<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"code"</span>]
<span class="pl-s1" style="box-sizing: border-box;">msg</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">obj</span>[<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"msg"</span>]
<span class="pl-s1" style="box-sizing: border-box;">data</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">obj</span>[<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"data"</span>]

<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">// Go中json中的数字经过反序列化会成为float64类型</span>
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">if</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">float64</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">200</span>) <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">!=</span> <span class="pl-s1" style="box-sizing: border-box;">code</span> &#123;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">return</span> <span class="pl-s1" style="box-sizing: border-box;">errors</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">New</span>(<span class="pl-s1" style="box-sizing: border-box;">fmt</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Sprintf</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"请求失败, code %d msg %s"</span>, <span class="pl-s1" style="box-sizing: border-box;">code</span>, <span class="pl-s1" style="box-sizing: border-box;">msg</span>))
&#125; <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">else</span> &#123;
<span class="pl-s1" style="box-sizing: border-box;">byt</span>, <span class="pl-s1" style="box-sizing: border-box;">_</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">json</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Marshal</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">&</span><span class="pl-s1" style="box-sizing: border-box;">data</span>)
<span class="pl-s1" style="box-sizing: border-box;">response</span>.<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Body</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">=</span> <span class="pl-s1" style="box-sizing: border-box;">ioutil</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">NopCloser</span>(<span class="pl-s1" style="box-sizing: border-box;">bytes</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">NewReader</span>(<span class="pl-s1" style="box-sizing: border-box;">byt</span>))
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">return</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">nil</span>
&#125;
&#125;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">demoResponse</span>() <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span><span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">demoResponseMiddler</span> &#123;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">return</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">&</span><span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">demoResponseMiddler</span>&#123;&#125;
&#125;

<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">main</span>() &#123;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">go</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">server</span>()                        <span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">//等会起测试服务</span>
<span class="pl-s1" style="box-sizing: border-box;">time</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Sleep</span>(<span class="pl-s1" style="box-sizing: border-box;">time</span>.<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Millisecond</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">500</span>) <span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">//用时间做个等待同步</span>
<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">responseUseExample</span>()
&#125;

<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">responseUseExample</span>() &#123;
<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">//成功请求</span>
<span class="pl-s1" style="box-sizing: border-box;">successRes</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">new</span>(<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">map</span>[<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span>]<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">interface</span>&#123;&#125;)
<span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">gout</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">GET</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">":8080/success"</span>).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">ResponseUse</span>(<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">demoResponse</span>()).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">BindJSON</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">&</span><span class="pl-s1" style="box-sizing: border-box;">successRes</span>).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Do</span>()
<span class="pl-s1" style="box-sizing: border-box;">log</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Printf</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"success请求  -->   响应 %s  <span class="pl-cce" style="box-sizing: border-box;">\n</span>  err  %s <span class="pl-cce" style="box-sizing: border-box;">\n</span> "</span>, <span class="pl-s1" style="box-sizing: border-box;">successRes</span>, <span class="pl-s1" style="box-sizing: border-box;">err</span>)

<span class="pl-c" style="box-sizing: border-box; color: var(--color-prettylights-syntax-comment);">//fail请求</span>
<span class="pl-s1" style="box-sizing: border-box;">failRes</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">new</span>(<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">map</span>[<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span>]<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">interface</span>&#123;&#125;)
<span class="pl-s1" style="box-sizing: border-box;">err</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">=</span> <span class="pl-s1" style="box-sizing: border-box;">gout</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">GET</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">":8080/fail"</span>).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">ResponseUse</span>(<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">demoResponse</span>()).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">BindJSON</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">&</span><span class="pl-s1" style="box-sizing: border-box;">failRes</span>).<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Do</span>()
<span class="pl-s1" style="box-sizing: border-box;">log</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Printf</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"fail请求  -->   响应 %s  <span class="pl-cce" style="box-sizing: border-box;">\n</span>  err  %s <span class="pl-cce" style="box-sizing: border-box;">\n</span> "</span>, <span class="pl-s1" style="box-sizing: border-box;">successRes</span>, <span class="pl-s1" style="box-sizing: border-box;">err</span>)
&#125;

<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">type</span> <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Result</span> <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">struct</span> &#123;
<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Code</span> <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">int</span>         <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">`json:"code"`</span>
<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Msg</span>  <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span>      <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">`json:"msg"`</span>
<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Data</span> <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">interface</span>&#123;&#125; <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">`json:"data"`</span>
&#125;
<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">type</span> <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Item</span> <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">struct</span> &#123;
<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Id</span>   <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span> <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">`json:"id"`</span>
<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">Name</span> <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">string</span> <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">`json:"name"`</span>
&#125;

<span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span> <span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">server</span>() &#123;
<span class="pl-s1" style="box-sizing: border-box;">router</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">:=</span> <span class="pl-s1" style="box-sizing: border-box;">gin</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">New</span>()
<span class="pl-s1" style="box-sizing: border-box;">router</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">GET</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"/success"</span>, <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span>(<span class="pl-s1" style="box-sizing: border-box;">c</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span>gin.<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Context</span>) &#123;
<span class="pl-s1" style="box-sizing: border-box;">c</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">JSON</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">200</span>, <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Result</span>&#123;<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">200</span>, <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"请求成功了"</span>, <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Item</span>&#123;<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"001"</span>, <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"张三"</span>&#125;&#125;)
&#125;)
<span class="pl-s1" style="box-sizing: border-box;">router</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">GET</span>(<span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"/fail"</span>, <span class="pl-k" style="box-sizing: border-box; color: var(--color-prettylights-syntax-keyword);">func</span>(<span class="pl-s1" style="box-sizing: border-box;">c</span> <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">*</span>gin.<span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Context</span>) &#123;
<span class="pl-s1" style="box-sizing: border-box;">c</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">JSON</span>(<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">200</span>, <span class="pl-smi" style="box-sizing: border-box; color: var(--color-prettylights-syntax-storage-modifier-import);">Result</span>&#123;<span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">500</span>, <span class="pl-s" style="box-sizing: border-box; color: var(--color-prettylights-syntax-string);">"查询数据库出错了"</span>, <span class="pl-c1" style="box-sizing: border-box; color: var(--color-prettylights-syntax-constant);">nil</span>&#125;)
&#125;)
<span class="pl-s1" style="box-sizing: border-box;">router</span>.<span class="pl-en" style="box-sizing: border-box; color: var(--color-prettylights-syntax-entity);">Run</span>()
&#125;</pre> 
 </div> 
 <div> 
  <h2 style="box-sizing: border-box; margin-top: 24px; margin-bottom: 16px; font-size: 1.5em; font-weight: 600; line-height: 1.25; padding-bottom: 0.3em; border-bottom: 1px solid var(--color-border-secondary); color: rgb(36, 41, 47); font-family: -apple-system, system-ui, "Segoe UI Variable", "Segoe UI", system-ui, ui-sans-serif, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;">feature</h2> 
  <ul style="box-sizing: border-box; padding-left: 2em; margin-top: 0px; margin-bottom: 16px; color: rgb(36, 41, 47); font-family: -apple-system, system-ui, "Segoe UI Variable", "Segoe UI", system-ui, ui-sans-serif, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji"; font-size: 16px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-thickness: initial; text-decoration-style: initial; text-decoration-color: initial;"> 
   <li style="box-sizing: border-box;">支持设置 GET/PUT/DELETE/PATH/HEAD/OPTIONS</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置请求 http header(可传 struct,map,array,slice 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 URL query(可传 struct,map,array,slice,string 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 json 编码到请求 body 里面(可传struct, map, string, []byte 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 xml 编码到请求 body 里面(可传struct, string, []byte 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 yaml 编码到请求 body 里面(可传struct, map, string, []byte 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 protobuf 编码到请求 body里面(可传struct)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 form-data(可传 struct, map, array, slice 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 x-www-form-urlencoded(可传 struct,map,array,slice 等类型)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置 io.Reader，uint/uint8/uint16...int/int8...string...[]byte...float32,float64 至请求 body 里面</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持解析响应body里面的json,xml,yaml至结构体里(BindJSON/BindXML/BindYAML)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持解析响应body的内容至io.Writer, uint/uint8...int/int8...string...[]byte...float32,float64</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持解析响应header至结构体里</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持接口性能benchmark，可控制压测一定次数还是时间，可控制压测频率</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持retry-backoff，可以指定重试条件</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持发送裸http数据包</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持导出curl命令</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">传入自定义*http.Client</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持请求中间件(<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fantlabs%2Fgout-middleware" style="box-sizing: border-box; background-color: transparent; color: var(--color-text-link); text-decoration: none;" target="_blank">https://github.com/antlabs/gout-middleware</a>)</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持响应中间件ResponseUse</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持设置chunked数据格式发送</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">支持body, header的数据校验</li> 
   <li style="box-sizing: border-box; margin-top: 0.25em;">等等更多</li> 
  </ul> 
 </div> 
</div>
                                        </div>
                                      
</div>
            