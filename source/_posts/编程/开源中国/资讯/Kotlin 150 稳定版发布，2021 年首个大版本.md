
---
title: 'Kotlin 1.5.0 稳定版发布，2021 年首个大版本'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=9168'
author: 开源中国
comments: false
date: Fri, 07 May 2021 08:27:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=9168'
---

<div>   
<div class="content">
                                                                    
                                                        <p style="text-align: start;"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F" target="_blank">Kotlin 1.5.0</a> 稳定版已发布，此版本提供了<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23stable-language-features" target="_blank">稳定的语言特性，</a>例如 <span style="background-color:#ffffff"><span style="color:#27282c">JVM records、</span></span>密封接口 (<span style="background-color:#ffffff"><span style="color:#27282c">sealed interface</span></span>)、内联类 (<span style="background-color:#ffffff"><span style="color:#27282c">inline class</span></span>)，并引入了<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23kotlin-jvm" target="_blank">新的默认 JVM IR 编译器</a>。据介绍，新的编译器与 <span style="background-color:#f1f6fe"><span style="color:#27282c">Kotlin/Native 和 Kotlin/JS</span></span> 编译器共享<em>统一的管道和业务逻辑</em>，因此 Kotlin 团队可同时为所有平台实现大多数功能、优化和错误修复。新的编译器还将允许开发者<em>添加自定义处理和转换，这些处理和转换将自动在所有平台上运行</em>。</p> 
<p style="text-align:left"><span style="color:#333333">Kotlin 1.5 主要变化</span></p> 
<ul> 
 <li style="text-align:left"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23stable-language-features" target="_blank">新增稳定的语言特性</a> - JVM records、密封接口 (<span style="background-color:#ffffff"><span style="color:#27282c">sealed interface</span></span>)、内联类 (<span style="background-color:#ffffff"><span style="color:#27282c">inline class</span></span>)</li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23library-improvements" target="_blank">标准和测试库改进</a> - 稳定的无符号整数类型、E<span style="background-color:#ffffff"><span style="color:#27282c">xtensions for</span></span><code>java.nio.file.Path</code>，以及针对 String、Char 和 Duration API 的改进</li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23kotlin-jvm" target="_blank">Kotlin/JVM 改进</a><span style="color:#27282c"> - </span>新的默认 JVM IR 编译器</li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23kotlin-native" target="_blank">Kotlin/Native 改进</a> - 针对 Linux 和 iOS 应用程序的更快的调试编译</li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released%2F%23kotlin-js" target="_blank">Kotlin/JS 的改进</a> - 将更多 JS 库迁移到新的 <span style="background-color:#ffffff"><span style="color:#27282c">Kotlin/JS IR </span></span>编译器</li> 
</ul> 
<p>下面简单介绍新增的语言特性。</p> 
<p><strong>支持 JVM records</strong></p> 
<p>JVM records 是 <span style="background-color:#ffffff"><span style="color:#27282c">JVM 生态将要推出的重要更新，其类似于 Kotlin data 类，主要用作简单的数据持有者。</span></span> <span style="background-color:#ffffff"><span style="color:#27282c">与 Java 的互操作性一直以来都是并且将永远作为 Kotlin 的优先考虑事项。 因此，Kotlin 代码可以“理解”新的 Java records，并将其视为具有 Kotlin 属性的类。 这类似于遵循 JavaBeans 惯例的常规 Java 类：</span></span></p> 
<pre><code class="language-java">// Java
record Point(int x, int y) &#123; &#125;
// Kotlin
fun foo(point: Point) &#123;
    point.x // seen as property
    point.x() // also works
&#125;</code></pre> 
<p style="text-align:left"><span style="color:#333333"><span style="background-color:#ffffff"><span style="color:#27282c">出于互操作性，可以用</span></span><code>@JvmRecord</code><span style="background-color:#ffffff"><span style="color:#27282c">注解</span></span><code>data</code><span style="background-color:#ffffff"><span style="color:#27282c">类，生成新的 JVM records 方法：</span></span></span></p> 
<pre><code class="language-java">@JvmRecord
data class Point(val x: Int, val y: Int)</code></pre> 
<p style="text-align:start"><strong>密封接口和密封类的改进</strong></p> 
<p style="text-align:start"><span style="color:#27282c">使密封类时，它会将层次结构限制为已定义的子类，从而允许在<code>when</code>分支中进行详尽的检查。在 Kotlin 1.4 中，密封类层次结构具有两个约束。 首先，顶层类不能是一个密封接口，应该是一个类。 其次，所有子类均应当位于同一文件中。</span></p> 
<p style="text-align:start"><span style="color:#27282c">Kotlin 1.5 去除了这两个约束：您现在可以使一个接口密封。子类（包括密封类和密封接口）应与 super 类位于同一编译单元和同一软件包中，但现在可以位于不同文件中。</span></p> 
<pre><code class="language-java">sealed interface Expr
data class Const(val number: Double) : Expr
data class Sum(val e1: Expr, val e2: Expr) : Expr
object NotANumber : Expr

fun eval(expr: Expr): Double = when(expr) &#123;
    is Const -> expr.number
    is Sum -> eval(expr.e1) + eval(expr.e2)
    NotANumber -> Double.NaN
&#125;</code></pre> 
<p><span style="background-color:#ffffff"><span style="color:#27282c">密封类以及现在的密封接口对于定义抽象数据类型 (ADT) 层次结构非常实用。</span></span></p> 
<p><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fkotlin%2F2021%2F05%2Fkotlin-1-5-0-released" target="_blank">详细更新说明查看发布公告</a>。</p> 
<p>下载地址：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2FJetBrains%2Fkotlin%2Freleases%2Ftag%2Fv1.5.0" target="_blank">https://github.com/JetBrains/kotlin/releases/tag/v1.5.0</a><br> 参考：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.jetbrains.com%2Fzh-hans%2Fkotlin%2F2021%2F04%2Fkotlin-1-4-30%2F" target="_blank">https://blog.jetbrains.com/zh-hans/kotlin/2021/04/kotlin-1-4-30/</a></p>
                                        </div>
                                      
</div>
            