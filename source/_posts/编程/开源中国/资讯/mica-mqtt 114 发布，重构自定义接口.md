
---
title: 'mica-mqtt 1.1.4 å‘å¸ƒï¼Œé‡æ„è‡ªå®šä¹‰æ¥å£'
categories: 
 - ç¼–ç¨‹
 - å¼€æºä¸­å›½
 - èµ„è®¯
headimg: 'https://oscimg.oschina.net/oscnet/up-5805d01baf336f1081505d0e0d39c7790de.png'
author: å¼€æºä¸­å›½
comments: false
date: Mon, 18 Oct 2021 09:05:00 GMT
thumbnail: 'https://oscimg.oschina.net/oscnet/up-5805d01baf336f1081505d0e0d39c7790de.png'
---

<div>   
<div class="content">
                                                                    
                                                        <h2 style="margin-left:0; margin-right:0"><span>ä¸€ã€ç®€ä»‹</span></h2> 
<p style="margin-left:0; margin-right:0"><strong><span>mica-mqtt</span></strong><span> åŸºäº </span><strong><span>t-io</span></strong><span> å®ç°çš„</span><strong><span>ç®€å•</span></strong><span>ã€</span><strong><span>ä½å»¶è¿Ÿ</span></strong><span>ã€</span><strong><span>é«˜æ€§èƒ½</span></strong><span> çš„ mqtt ç‰©è”ç½‘å¼€æºç»„ä»¶ã€‚</span><strong><span>ä½¿ç”¨è¯¦è§ mica-mqtt gitee æºç </span></strong><span> </span><a href="https://gitee.com/596392912/mica-mqtt/tree/master/mica-mqtt-example" target="_blank"><span>mica-mqtt-example æ¨¡å—</span></a><span>ã€‚</span></p> 
<p style="margin-left:0; margin-right:0"><strong><span>mica-mqtt</span></strong><span> æ›´åŠ æ˜“äºé›†æˆåˆ°å·²æœ‰æœåŠ¡å’ŒäºŒæ¬¡å¼€å‘ï¼Œé™ä½è‡ªç ”ç‰©è”ç½‘å¹³å°å¼€å‘æˆæœ¬ã€‚</span></p> 
<h2 style="margin-left:0; margin-right:0"><span>äºŒã€åŠŸèƒ½</span></h2> 
<ul style="margin-left:0; margin-right:0"> 
 <li><span>âœ…</span><span>æ”¯æŒ MQTT v3.1ã€v3.1.1 ä»¥åŠ v5.0 åè®®ã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒ websocket mqtt å­åè®®ï¼ˆæ”¯æŒ mqtt.jsï¼‰ã€‚</span>Â </li> 
 <li><span>âœ…</span><span>æ”¯æŒ http rest apiï¼Œ</span><a href="https://gitee.com/596392912/mica-mqtt/blob/master/docs/http-api.md" target="_blank"><span>http api æ–‡æ¡£è¯¦è§</span></a><span>ã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒ MQTT client å®¢æˆ·ç«¯ã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒ MQTT server æœåŠ¡ç«¯ã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒ MQTT é—å˜±æ¶ˆæ¯ã€‚</span>Â </li> 
 <li><span>âœ…</span><span>æ”¯æŒ MQTT ä¿ç•™æ¶ˆæ¯ã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒè‡ªå®šä¹‰æ¶ˆæ¯ï¼ˆmqï¼‰å¤„ç†è½¬å‘å®ç°é›†ç¾¤ã€‚</span></li> 
 <li><span>âœ…</span><span>MQTT å®¢æˆ·ç«¯ é˜¿é‡Œäº‘ mqtt è¿æ¥ demoã€‚</span></li> 
 <li><span>âœ…</span><span>æ”¯æŒ GraalVM ç¼–è¯‘æˆæœ¬æœºå¯æ‰§è¡Œç¨‹åºã€‚</span>Â </li> 
 <li><span>âœ…</span><span>æ”¯æŒ Spring boot é¡¹ç›®å¿«é€Ÿæ¥å…¥ï¼ˆmica-mqtt-spring-boot-starterï¼‰ã€‚</span></li> 
 <li><span>âœ…</span><span>mica-mqtt-spring-boot-starter æ”¯æŒå¯¹æ¥ Prometheus + Grafanaã€‚</span></li> 
 <li><span>âœ…</span><span>åŸºäº redis pub/sub å®ç°é›†ç¾¤ï¼Œè¯¦è§ </span><a href="https://gitee.com/596392912/mica-mqtt/blob/master/mica-mqtt-broker" target="_blank"><span>mica-mqtt-broker æ¨¡å—</span></a><span>ã€‚</span></li> 
</ul> 
<h2 style="margin-left:0; margin-right:0"><span>ä¸‰ã€å¾…åŠ</span></h2> 
<ul style="margin-left:0; margin-right:0"> 
 <li><span>ğŸ”²</span><span>ä¼˜åŒ–å¤„ç† mqtt sessionï¼Œä»¥åŠæ”¯æŒéƒ¨åˆ† mqtt v5.0 æ–°ç‰¹æ€§ã€‚</span></li> 
</ul> 
<h2 style="margin-left:0; margin-right:0"><span>å››ã€æ›´æ–°è®°å½•</span></h2> 
<h3 style="margin-left:0; margin-right:0"><span>1.1.4</span></h3> 
<ul style="margin-left:0; margin-right:0"> 
 <li><span>âœ¨ æ·»åŠ  IMqttServerUniqueIdService æ¥å£ï¼Œç”¨æ¥å¤„ç† clientId ä¸å”¯ä¸€çš„åœºæ™¯ã€‚è¯¦è§ï¼šgitee </span><a href="https://gitee.com/596392912/mica-mqtt/issues/I4DXQU" target="_blank"><span>#I4DXQU</span></a></li> 
 <li><span>âœ¨ å¾®è°ƒ IMqttServerAuthHandler è®¤è¯ï¼Œæ·»åŠ  uniqueId å‚æ•°ã€‚</span></li> 
</ul> 
<h3 style="margin-left:0; margin-right:0"><span>1.1.3</span></h3> 
<ul style="margin-left:0; margin-right:0"> 
 <li><span>âœ¨ çŠ¶æ€äº‹ä»¶æ¥å£ IMqttConnectStatusListener æ·»åŠ  ChannelContext å‚æ•°ã€‚</span></li> 
 <li><span>âœ¨ ä»è®¤è¯ä¸­æ‹†åˆ† IMqttServerSubscribeValidator è®¢é˜…æ ¡éªŒæ¥å£ï¼Œæ·»åŠ  ChannelContextã€clientId å‚æ•°ã€‚</span>Â </li> 
 <li><span>âœ¨ è®¤è¯ IMqttServerAuthHandler è°ƒæ•´åŒ…ã€æ·»åŠ  ChannelContext å‚æ•°ã€‚</span></li> 
 <li><span>âœ¨ å®Œå–„æ–‡æ¡£å’Œç¤ºä¾‹ï¼Œæ·»åŠ é»˜è®¤ç«¯å£å·è¯´æ˜ã€‚</span></li> 
 <li><span>â¬†ï¸ ä¾èµ–å‡çº§ã€‚</span></li> 
</ul> 
<h2 style="margin-left:0; margin-right:0"><span>äº”ã€Spring boot å¿«é€Ÿæ¥å…¥</span></h2> 
<p style="margin-left:0; margin-right:0"><span>5.1 æ·»åŠ ä¾èµ–</span></p> 
<pre><dependency>
    <groupId>net.dreamlu</groupId>
    <artifactId>mica-mqtt-spring-boot-starter</artifactId>
    <version>1.1.4</version>
</dependency></pre> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h3 style="margin-left:0; margin-right:0"><span>5.2 æœåŠ¡ç«¯é…ç½®ç¤ºä¾‹</span></h3> 
<pre>mqtt:
  server:
    enabled: true               # æ˜¯å¦å¼€å¯ï¼Œé»˜è®¤ï¼štrue
    ip: 127.0.0.1               # æœåŠ¡ç«¯ ip é»˜è®¤ï¼š127.0.0.1
    port: 5883                  # ç«¯å£ï¼Œé»˜è®¤ï¼š1883
    name: Mica-Mqtt-Server      # åç§°ï¼Œé»˜è®¤ï¼šMica-Mqtt-Server
    buffer-allocator: HEAP      # å †å†…å­˜å’Œå †å¤–å†…å­˜ï¼Œé»˜è®¤ï¼šå †å†…å­˜
    heartbeat-timeout: 120000   # å¿ƒè·³è¶…æ—¶ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤: 1000 * 120
    read-buffer-size: 8092      # æ¥æ”¶æ•°æ®çš„ buffer sizeï¼Œé»˜è®¤ï¼š8092
    max-bytes-in-message: 8092  # æ¶ˆæ¯è§£ææœ€å¤§ bytes é•¿åº¦ï¼Œé»˜è®¤ï¼š8092
    debug: true                 # å¦‚æœå¼€å¯ prometheus æŒ‡æ ‡æ”¶é›†å»ºè®®å…³é—­
    websocket-enable: true      # å¼€å¯ websocket å­åè®®ï¼Œé»˜è®¤å¼€å¯
    websocket-port: 8083        # websocket ç«¯å£ï¼Œé»˜è®¤ï¼š8083</pre> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h3 style="margin-left:0; margin-right:0"><span>5.3 æœåŠ¡ç«¯å¯å®ç°æ¥å£ï¼ˆæ³¨å†Œæˆ Spring Bean å³å¯ï¼‰</span></h3> 
<table border="1" cellspacing="0" class="ne-table" id="aa6e808f" style="border-collapse:collapse; border:1px solid #d9d9d9; table-layout:fixed; width:750px"> 
 <tbody> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ¥å£</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ˜¯å¦å¿…é¡»</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>è¯´æ˜</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttServerUniqueIdService</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å¦</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>1.1.4 æ–°å¢ï¼Œç”¨äº clientId ä¸å”¯ä¸€æ—¶ï¼Œè‡ªå®šä¹‰å®ç°å”¯ä¸€æ ‡è¯†ï¼Œåç»­æ¥å£ä½¿ç”¨å®ƒæ›¿ä»£ clientId</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttServerAuthHandler</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ˜¯</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>ç”¨äºæœåŠ¡ç«¯è®¤è¯</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttServerSubscribeValidator</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ˜¯</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>1.1.3 æ–°å¢ï¼Œç”¨äºæœåŠ¡ç«¯è®¢é˜…æ ¡éªŒ</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttMessageListener</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ˜¯</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ¶ˆæ¯ç›‘å¬</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttConnectStatusListener</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ˜¯</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>è¿æ¥çŠ¶æ€ç›‘å¬</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttSessionManager</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å¦</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>session ç®¡ç†</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IMqttMessageStore</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>é›†ç¾¤æ˜¯ï¼Œå•æœºå¦</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>é—å˜±å’Œä¿ç•™æ¶ˆæ¯å­˜å‚¨</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>AbstractMqttMessageDispatcher</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>é›†ç¾¤æ˜¯ï¼Œå•æœºå¦</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ¶ˆæ¯è½¬å‘ï¼Œï¼ˆé—å˜±ã€ä¿ç•™æ¶ˆæ¯è½¬å‘ï¼‰</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>IpStatListener</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å¦</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>t-io ip çŠ¶æ€ç›‘å¬</span></p> </td> 
  </tr> 
 </tbody> 
</table> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h3 style="margin-left:0; margin-right:0"><span>5.4 Prometheus + Grafana ç›‘æ§å¯¹æ¥</span></h3> 
<p style="margin-left:0; margin-right:0"><span>å¾—ç›Šäº </span><strong><span>t-io</span></strong><span> è‰¯å¥½çš„è®¾è®¡ï¼Œç›‘æ§æŒ‡æ ‡ç›´æ¥å¯¹æ¥çš„ </span><strong><span>t-iostat</span></strong><span>ï¼Œç›®å‰æ”¯æŒä¸‹åˆ—æŒ‡æ ‡ï¼ŒåæœŸä¼šä¸æ–­å®Œå–„ã€‚</span></p> 
<table border="1" cellspacing="0" class="ne-table" id="d7d0695f" style="border-collapse:collapse; border:1px solid #d9d9d9; table-layout:fixed; width:750px"> 
 <tbody> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>æ”¯æŒå¾—æŒ‡æ ‡</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>è¯´æ˜</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_connections_accepted</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å…±æ¥å—è¿‡è¿æ¥æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_connections_closed</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å…³é—­è¿‡çš„è¿æ¥æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_connections_size</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å½“å‰è¿æ¥æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_handled_packets</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²å¤„ç†æ¶ˆæ¯æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_handled_bytes</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²å¤„ç†æ¶ˆæ¯å­—èŠ‚æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_received_packets</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²æ¥æ”¶æ¶ˆæ¯æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_received_bytes</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²å¤„ç†æ¶ˆæ¯å­—èŠ‚æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_send_packets</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²å‘é€æ¶ˆæ¯æ•°</span></p> </td> 
  </tr> 
  <tr> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>mqtt_messages_send_bytes</span></p> </td> 
   <td style="border-color:#d9d9d9; border-style:solid; border-width:1px; height:33px"> <p style="margin-left:0; margin-right:0"><span>å·²å‘é€æ¶ˆæ¯å­—èŠ‚æ•°</span></p> </td> 
  </tr> 
 </tbody> 
</table> 
<p><img height="977" src="https://oscimg.oschina.net/oscnet/up-5805d01baf336f1081505d0e0d39c7790de.png" width="959" referrerpolicy="no-referrer"></p> 
<p style="margin-left:0; margin-right:0"><span>å…³äº </span><strong><span>mica-mqtt-spring-boot-starter</span></strong><span> æ›´å¤šè¯·æŸ¥çœ‹æ–‡æ¡£ï¼š</span><a href="https://gitee.com/596392912/mica-mqtt/tree/master/mica-mqtt-spring-boot-starter" target="_blank"><span>https://gitee.com/596392912/mica-mqtt/tree/master/mica-mqtt-spring-boot-starter</span></a></p> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h2 style="margin-left:0; margin-right:0"><span>å…­ã€æ™®é€š java é¡¹ç›®æ¥å…¥</span></h2> 
<h3 style="margin-left:0; margin-right:0"><span>6.1 maven ä¾èµ–</span></h3> 
<pre> <dependency>
   <groupId>net.dreamlu</groupId>
   <artifactId>mica-mqtt-core</artifactId>
   <version>1.1.4</version>
 </dependency></pre> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h3 style="margin-left:0; margin-right:0"><span>6.2 mica-mqtt å®¢æˆ·ç«¯</span></h3> 
<pre> // åˆå§‹åŒ– mqtt å®¢æˆ·ç«¯
 MqttClient client = MqttClient.create()
     .ip("127.0.0.1")
     .port(1883)                     // é»˜è®¤ï¼š1883
     .username("admin")
     .password("123456")
     .version(MqttVersion.MQTT_5)    // é»˜è®¤ï¼š3_1_1
     .clientId("xxxxxx")             // é»˜è®¤ï¼šMICA-MQTT- å‰ç¼€å’Œ 36è¿›åˆ¶çš„çº³ç§’æ•°
     .connect();                     // è¿æ¥
 
     // æ¶ˆæ¯è®¢é˜…ï¼ŒåŒç±»æ–¹æ³• subxxx
     client.subQos0("/test/#", (topic, payload) -> &#123;
         logger.info(topic + '\t' + ByteBufferUtil.toString(payload));
     &#125;);
     // å–æ¶ˆè®¢é˜…
     client.unSubscribe("/test/#");
 
     // å‘é€æ¶ˆæ¯
     client.publish("/test/client", ByteBuffer.wrap("micaæœ€ç‰›çš®".getBytes(StandardCharsets.UTF_8)));
 
     // æ–­å¼€è¿æ¥
     client.disconnect();
     // é‡è¿
     client.reconnect();
     // åœæ­¢
     client.stop();</pre> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h3 style="margin-left:0; margin-right:0"><span>6.3 mica-mqtt æœåŠ¡ç«¯</span></h3> 
<pre> // æ³¨æ„ï¼šä¸ºäº†èƒ½æ¥å—æ›´å¤šé“¾æ¥ï¼ˆé™ä½å†…å­˜ï¼‰ï¼Œè¯·æ·»åŠ  jvm å‚æ•° -Xss129k
 MqttServer mqttServer = MqttServer.create()
     // é»˜è®¤ï¼š127.0.0.1
     .ip("127.0.0.1")
     // é»˜è®¤ï¼š1883
     .port(1883)
     // é»˜è®¤ä¸ºï¼š 8092ï¼ˆmqtt é»˜è®¤æœ€å¤§æ¶ˆæ¯å¤§å°ï¼‰ï¼Œä¸ºäº†é™ä½å†…å­˜å¯ä»¥å‡å°å°æ­¤å‚æ•°ï¼Œå¦‚æœæ¶ˆæ¯è¿‡å¤§ t-io ä¼šå°è¯•è§£æå¤šæ¬¡ï¼ˆå»ºè®®æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè€Œå®šï¼‰
     .readBufferSize(512)
     // æ¶ˆæ¯ç›‘å¬
     .messageListener((clientId, topic, mqttQoS, payload) -> &#123;
         logger.info("clientId:&#123;&#125; topic:&#123;&#125; mqttQoS:&#123;&#125; message:&#123;&#125;", clientId, topic, mqttQoS, ByteBufferUtil.toString(payload));
     &#125;)
     .debug() // å¼€å¯ t-io debug ä¿¡æ¯æ—¥å¿—
     .start();
 
 // å‘é€ç»™æŸä¸ªå®¢æˆ·ç«¯
 mqttServer.publish("clientId","/test/123", ByteBuffer.wrap("micaæœ€ç‰›çš®".getBytes()));
 
 // å‘é€ç»™æ‰€æœ‰åœ¨çº¿ç›‘å¬è¿™ä¸ª topic çš„å®¢æˆ·ç«¯
 mqttServer.publishAll("/test/123", ByteBuffer.wrap("micaæœ€ç‰›çš®".getBytes()));
 
 // åœæ­¢æœåŠ¡
 mqttServer.stop();</pre> 
<p style="margin-left:0; margin-right:0">Â </p> 
<h2 style="margin-left:0; margin-right:0"><span>ä¸ƒã€é›†ç¾¤æ¼”ç¤º</span></h2> 
<p><img height="720" src="https://oscimg.oschina.net/oscnet/up-fe9774d3ca40b1eb33efc1dc5468c33980f.png" width="1280" referrerpolicy="no-referrer"></p>
                                        </div>
                                      
</div>
            