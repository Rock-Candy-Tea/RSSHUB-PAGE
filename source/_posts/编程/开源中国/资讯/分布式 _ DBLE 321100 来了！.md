
---
title: '分布式 _ DBLE 3.21.10.0 来了！'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=3504'
author: 开源中国
comments: false
date: Mon, 22 Nov 2021 16:19:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=3504'
---

<div>   
<div class="content">
                                                                    
                                                        <p>以下对 DBLE 3.21.10.0 版本的 Release Notes 进行详细解读。</p> 
<p>文章主要分为以下四部分内容：</p> 
<ul> 
 <li>一、DBLE 项目介绍</li> 
 <li>二、新版本主要更新解读</li> 
 <li>三、完整 Release Notes</li> 
 <li>四、LTS 版本更新</li> 
</ul> 
<p style="margin-left:0; margin-right:0"><strong>一、DBLE 项目介绍</strong></p> 
<p>DBLE 是企业级开源分布式中间件，江湖人送外号 <span style="color:#108080"><strong>“MyCat Plus”</strong></span>；以其简单稳定，持续维护，良好的社区环境和广大的群众基础得到了社区的大力支持；</p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0; text-align:left"><span>DBLE 官方项目：</span></p> <pre><code><span>https://github.com/actiontech/dble</span>
</li>
<li style="text-align:left">
<p style="margin-left:0; margin-right:0"><span>DBLE 官方文档（已更新）：</span>

<p style="margin-left:0; margin-right:0"><span>https://actiontech.github.io/dble-docs-cn</span>
</li>
<li style="text-align:left">
<span>新版本 DBLE 下载地址及 Release Notes：</span>

<span>https://github.com/actiontech/dble/releases</span>
</li>
</code></pre> </li> 
</ul> 
<p><strong style="color:#333333">二、</strong><strong style="color:#333333">新版本主要功能更新解</strong><strong style="color:#333333">读</strong></p> 
<p><span style="color:#4a4a4a">本次发版 3.21.10.0 </span><span style="color:#4a4a4a">是 DBLE 今年的第三次发版。</span></p> 
<p style="color:#4a4a4a; margin-left:0; margin-right:0; text-align:left"><strong style="color:#108080"><span><span style="background-color:#ffffff">新版 DBLE 新增&重构功能 3 个，修复缺陷 7+ 个，和旧版本的不兼容项调整 0 处。</span></span></strong></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span><strong>致谢</strong></span>：</p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li><span style="color:#4a4a4a">感谢以下人士对社区的贡献：@13611582598, @mwhei , @lenovore, @jmbkeyes</span></li> 
 <li><span style="color:#4a4a4a">感谢 Github 用户提供的优质 issue，star 突破 860！</span></li> 
 <li><span style="color:#4a4a4a">感谢 QQ 群（669663113）和微信群内朋友提供的有效反馈，群用户突破千人！</span></li> 
</ul> 
<p style="margin-left:0; margin-right:0; text-align:left"><strong>主要更新：</strong></p> 
<h4 style="margin-left:0; margin-right:0; text-align:left"><span><strong><span style="color:#4a4a4a">1、支持单个 dble 脱离/回归集群</span></strong></span></h4> 
<p style="margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">在部分场合下，集群状态下的 dble 可能需要临时断开和集群中心（如zookeeper）的连接。</span></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">典型的应用场景是：集群中心需要进行升级/维护时。</span></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">在版本<3.21.10 , 唯一的方式是配置修改为单机版并重新启动 dble；需要加回来时，改会原来的配置并重启 dble 。但这对业务影响很大，通常在生产环境下难以接受。</span></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">dble提供了一个脱离集群的指令，可以在不重启的情况下，临时断开和集群中心的连接，让 dble 以一个 伪集群模式 的单实例方式运行。等运维工作结束后，还可以重新加入集群。</span></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span style="color:#000000">详情请见文档对应章节</span></p> 
<p><strong><span style="color:#4a4a4a">2、新的流量控制</span></strong></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span>在之前的 dble 版本中，当进行大文件 load 以及大结果集查询的过程中，都有可能由于数据的发送不及时造成数据在 dble 内存中堆积，当条件足够的时候甚至有可能造成 dble 服务的 OOM ，进而影响服务的稳定运行。</span></p> 
<p><span>在最初 2.20.04 中由社区开发者@ssxlulu提供了对于这部分流量控制的实现，通过连接级别的写队列长度，进行数据加载/获取的负反馈调节，从而实现在数据 load 和大结果集查询过程中的内存使用情况稳定，在此基础上，我们又做了一些改进。</span></p> 
<p><span>无论当前端连接写回客户端过慢造成积压(比如中间件和客户端之间网络不好可能会造成此现象)或者是后端已读取但未处理的 MySQL 数据积压过多（比如 dble 所在机器 cpu 性能不够），都可以停止从后侧数据库读取，减轻 dble 本身的压力。</span></p> 
<p style="margin-left:0; margin-right:0; text-align:left"><span>详情请见文档对应章节。</span></p> 
<p style="margin-left:0; margin-right:0"><strong>三、完整 Release Notes</strong></p> 
<p><strong>特性：</strong></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li>[#2866] 支持单个 dble 脱离/回归集群. 更多详细信息，请参见 doc 。</li> 
 <li>[#2844] 支持默认的分片模式 [alpha 功能]。更多详细信息，请参见doc 。</li> 
 <li>[#2845] 新的流量控制：添加后端读取水位。更多详细信息，请参见doc 。</li> 
</ul> 
<p style="margin-left:0; margin-right:0"><strong>主要缺陷修复：</strong></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li>[#11] EPollArrayWrapper.epollWait 可能导致 100% CPU。</li> 
 <li>[#2896] show @@dbInstance 命令，READ_LOAD 和 WRITE_LOAD 始终显示为 0 。</li> 
 <li>[#2747] fakeMySQLVersion 不支持 MariaDB 10.x，感谢@lenovore 报告此问题。</li> 
 <li>[#2750] 支持`add/truncate/dop partition` , 感谢@13611582598 报告此问题。</li> 
 <li>[#2611] 优化er表问题，感谢@jmbkeyes 报告错误。</li> 
 <li>[#2828] 三表join，结果可能有误，感谢@mwhei 报告 bug 。</li> 
 <li>有时复杂的查询可能会导致内存泄漏。</li> 
</ul> 
<p style="margin-left:0; margin-right:0"><strong>和旧版本的不兼容项：</strong></p> 
<p style="margin-left:0; margin-right:0">无</p> 
<p style="margin-left:0; margin-right:0"><strong>四、LTS 版本更新</strong></p> 
<p style="margin-left:0; margin-right:0"><span style="color:#4a4a4a">对于 LTS 的版本，有小版本发出，修复一些 bug：</span></p> 
<p style="margin-left:0; margin-right:0"><strong><span>3.20.07.7</span></strong></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0"><span>执行 dbGroup @@disable name ='dbGroup1'；偶现 hang 住</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>连接创建失败时，连接数统计的问题导致的连接泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>mysql 实例从 disable 到 active 状态后，dble 不可用</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>有时复杂的查询可能会导致内存泄漏</span></p> </li> 
</ul> 
<p style="margin-left:0; margin-right:0"><strong><span>3.20.10.7</span></strong></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0"><span>执行 dbGroup @@disable name ='dbGroup1'；偶现 hang 住 </span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>连接创建失败时，连接数统计的问题导致的连接泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>mysql 实例从 disable 到 active 状态后，dble 不可用</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>有时复杂的查询可能会导致内存泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>[#2873]set autocommit=true 的问题</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>9066 端口执行 show @@connection.sql 报错</span></p> </li> 
</ul> 
<p style="margin-left:0; margin-right:0"><span><strong>3.21.02.4</strong></span></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0"><span>执行 dbGroup @@disable name ='dbGroup1'；偶现 hang 住</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>连接创建失败时，连接数统计的问题导致的连接泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>mysql 实例从 disable 到 active 状态后，dble 不可用</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>有时复杂的查询可能会导致内存泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>[#2873]set autocommit=true 的问题</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>管理端口执行 show @@connection.sql 报错</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>集群环境下 dble 执行 ddl 语句 hang 住</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>show @@dbInstance 命令，READ_LOAD 和 WRITE_LOAD 始终显示为 0 </span></p> </li> 
</ul> 
<p style="margin-left:0; margin-right:0"><strong><span>3.21.06.2</span></strong></p> 
<ul style="list-style-type:square; margin-left:0; margin-right:0"> 
 <li> <p style="margin-left:0; margin-right:0"><span>执行 dbGroup @@disable name ='dbGroup1'；偶现 hang 住</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>连接创建失败时，连接数统计的问题导致的连接泄漏</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>mysql 实例从 disable 到 active 状态后，dble 不可用</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>有时复杂的查询可能会导致内存泄漏。</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>[#2873]set autocommit=true 的问题</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>管理端口执行 show @@connection.sql 报错</span></p> </li> 
 <li> <p style="margin-left:0; margin-right:0"><span>集群环境下 dble 执行 ddl 语句 hang 住</span></p> </li> 
 <li><span>show @@dbInstance 命令，READ_LOAD 和 WRITE_LOAD 始终显示为 0 </span></li> 
</ul>
                                        </div>
                                      
</div>
            