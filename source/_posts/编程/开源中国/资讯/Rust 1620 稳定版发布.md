
---
title: 'Rust 1.62.0 稳定版发布'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=8888'
author: 开源中国
comments: false
date: Sat, 02 Jul 2022 07:03:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=8888'
---

<div>   
<div class="content">
                                                                                            <p>Rust 1.62.0 稳定版现已发布，具体更新内容如下：</p> 
<h4><span style="color:#000000"><strong>cargo add</strong></span></h4> 
<p style="text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>现在可以使用<code>cargo add</code>直接从命令行添加新的依赖项。该命令支持指定功能和版本。它也可以用来修改现有的依赖项。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p style="text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>例如：</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<pre><code class="language-text">cargo add log
cargo add serde --features derive
cargo add nom@5
</code></pre> 
<p style="color:#000000; text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>有关更多信息，可参阅 </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fnightly%2Fcargo%2Fcommands%2Fcargo-add.html" target="_blank">cargo</a> <span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fnightly%2Fcargo%2Fcommands%2Fcargo-add.html" target="_blank">文件</a>。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<h4><strong><code>#[default]</code><span> </span>enum variants</strong></h4> 
<p style="color:#000000; text-align:start">如果你指定了一个默认变量，那你现在可以在枚举上使用<code>#[derive(Default)]</code>。例如，到目前为止，你必须手动为此枚举编写一个 <code>Default</code>impl：</p> 
<pre><code class="language-rust"><span style="color:#b65611">#[derive(Default)]</span>
<span><span style="color:#b854d4">enum</span> <span style="color:#6684e1">Maybe</span></span><T> &#123;
    <span style="color:#b65611">#[default]</span>
    Nothing,

    Something(T),
&#125;
</code></pre> 
<p style="color:#000000; text-align:start">到目前为止，只有"unit" 变量（没有字段的变体）才允许被标记为<code>#[default]</code>。更多信息可在该特性的 <a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Frust-lang.github.io%2Frfcs%2F3107-derive-default-enum.html" target="_blank">RFC</a><span> </span>中找到。</p> 
<h4><strong>Thinner, faster mutexes on Linux</strong></h4> 
<p style="text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>以前，<code>Mutex</code>、<code>Condvar</code>和<code>RwLock</code>由 Linux 上的 pthreads 库支持。pthreads 锁支持比 Rust API 本身更多的功能，包括运行时配置，并且被设计用于比 Rust 提供的 </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="background-color:#ffffff; color:#000000">static guarantees </span><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>更少的语言中。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>例如，mutex 的实现是 40 字节，不能移动。这迫使标准库在幕后为使用 pthreads 的平台的每个新的 mutex 分配一个 Box。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p style="text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>公告指出，Rust 的标准库现在在 Linux 上提供了这些锁的基于 futex 的原始实现，它非常轻量级并且不需要额外的分配。在 1.62.0 中，<code>Mutex</code>在 Linux 上的内部状态只需要 5 个字节，尽管这在未来的版本中可能会改变。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<p style="text-align:start"><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>这是提高 Rust 的 lock types 效率的长期努力的一部分，其中包括以前对 Windows 的改进，例如 </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="background-color:#ffffff; color:#000000">unboxing </span><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>其</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span style="background-color:#ffffff; color:#000000"> primitives</span><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Fissues%2F93740" target="_blank">可以在</a> </span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Fissues%2F93740" target="_blank">tracking issue</a> <span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>中阅读有关该工作的更多信息。</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></p> 
<h4><strong><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>Bare metal x86_64 targ</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong></h4> 
<p style="color:#000000; text-align:start">现在为<code>x86_64</code>构建无操作系统的二进制文件更加容易，例如在编写内核时。<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fbeta%2Frustc%2Fplatform-support%2Fx86_64-unknown-none.html" target="_blank"><code>x86_64-unknown-none</code>target</a><span style="background-color:#ffffff; color:#000000"><span> </span></span>已提升到 <a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Frustc%2Fplatform-support.html%23tier-2" target="_blank">Tier 2</a>，可以使用 rustup 安装。</p> 
<pre><code class="language-console">rustup target add x86_64-unknown-none
rustc --target x86_64-unknown-none my_no_std_program.rs
</code></pre> 
<p style="color:#000000; text-align:start">可以在 <a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdocs.rust-embedded.org%2Fbook%2Fintro%2Fno-std.html" target="_blank">Embedded Rust book</a> 中阅读有关使用<code>no_std</code>开发的更多信息。</p> 
<h4><span><span><strong><span><span><span><span style="color:#000000"><span><span><span><span><span><span><span><span><span><span style="background-color:#ffffff"><span><span><span>稳定的 API</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></strong></span></span></h4> 
<ul> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fprimitive.bool.html%23method.then_some" target="_blank"><code>bool::then_some</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fprimitive.f32.html%23method.total_cmp" target="_blank"><code>f32::total_cmp</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fprimitive.f64.html%23method.total_cmp" target="_blank"><code>f64::total_cmp</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fio%2Fstruct.Stdin.html%23method.lines" target="_blank"><code>Stdin::lines</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fos%2Fwindows%2Fprocess%2Ftrait.CommandExt.html%23tymethod.raw_arg" target="_blank"><code>windows::CommandExt::raw_arg</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fpanic%2Fstruct.AssertUnwindSafe.html%23impl-Default" target="_blank"><code>impl<T: Default> Default for AssertUnwindSafe<T></code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Frc%2Fstruct.Rc.html%23impl-From%253CRc%253Cstr%253E%253E" target="_blank"><code>From<Rc<str>> for Rc<[u8]></code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fsync%2Fstruct.Arc.html%23impl-From%253CArc%253Cstr%253E%253E" target="_blank"><code>From<Arc<str>> for Arc<[u8]></code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdoc.rust-lang.org%2Fstable%2Fstd%2Fos%2Fwindows%2Fffi%2Fstruct.EncodeWide.html%23impl-FusedIterator" target="_blank"><code>FusedIterator for EncodeWide</code></a></li> 
 <li><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frust-lang%2Fstdarch%2Fpull%2F1285" target="_blank">RDM intrinsics on aarch64</a></li> 
</ul> 
<p>更多详情可<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fblog.rust-lang.org%2F2022%2F06%2F30%2FRust-1.62.0.html" target="_blank">查看官方公告</a>。</p> 
<p> </p>
                                        </div>
                                      
</div>
            