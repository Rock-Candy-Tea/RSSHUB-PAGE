
---
title: 'Jetpack Compose 1.2 Beta 发布'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://oscimg.oschina.net/oscnet/up-b5a4946f12ce718be79929cb4efc72336c7.png'
author: 开源中国
comments: false
date: Sat, 14 May 2022 00:14:00 GMT
thumbnail: 'https://oscimg.oschina.net/oscnet/up-b5a4946f12ce718be79929cb4efc72336c7.png'
---

<div>   
<div class="content">
                                                                    
                                                        <p>谷歌<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fandroid-developers.googleblog.com%2F2022%2F05%2Fwhats-new-in-jetpack-compose.html" target="_blank">宣布</a>推出 Jetpack Compose 1.2 Beta，其中包含了许多功能和改进。具体更新内容如下：</p> 
<h4 style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><span style="background-color:#ffffff">文本改进</span></span></h4> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><strong><span style="color:#000000"><span style="background-color:#ffffff">字体填充</span></span></strong></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start">开发团队通过制作可自定义的参数解决了 issue tracker 中<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fissuetracker.google.com%2Fu%2F0%2Fissues%2F171394808" target="_blank">投票最多的错误之一。</a>使<code>includeFontPadding</code>成为一个可定制的参数。官方建议将此值设置为<code>false</code>，可使布局中的文本更精确地对齐。其标是最终将其设为未来版本中的默认值。当<code>includeFontPadding</code>设置为时<code>false</code>，用户可以通过设置<code>lineHeightStyle</code>参数来调整 Text composable 的行高。结合起来可以是这样的：</p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><img alt height="313" src="https://oscimg.oschina.net/oscnet/up-b5a4946f12ce718be79929cb4efc72336c7.png" width="500" referrerpolicy="no-referrer"></p> 
<pre style="margin-left:0; margin-right:0; text-align:start"><span style="color:#660066">Text</span><span style="color:#666600">(</span><span style="color:#000000">
 text </span><span style="color:#666600">=</span><span style="color:#000000"> myText</span><span style="color:#666600">,</span><span style="color:#000000">
 style </span><span style="color:#666600">=</span> <span style="color:#660066">TextStyle</span><span style="color:#666600">(</span><span style="color:#000000">
   lineHeight </span><span style="color:#666600">=</span> <span style="color:#006666">2.5</span><span style="color:#666600">.</span><span style="color:#000000">em</span><span style="color:#666600">,</span><span style="color:#000000">
   platformStyle </span><span style="color:#666600">=</span> <span style="color:#660066">PlatformTextStyle</span><span style="color:#666600">(</span><span style="color:#000000">
     includeFontPadding </span><span style="color:#666600">=</span> <span style="color:#000088">false</span>
   <span style="color:#666600">),</span><span style="color:#000000">
   lineHeightStyle </span><span style="color:#666600">=</span> <span style="color:#660066">LineHeightStyle</span><span style="color:#666600">(</span><span style="color:#000000">
     alignment </span><span style="color:#666600">=</span> <span style="color:#660066">Alignment</span><span style="color:#666600">.</span><span style="color:#660066">Center</span><span style="color:#666600">,</span><span style="color:#000000">
     trim </span><span style="color:#666600">=</span> <span style="color:#660066">Trim</span><span style="color:#666600">.</span><span style="color:#000088">None</span>
   <span style="color:#666600">)</span>
 <span style="color:#666600">)</span>
<span style="color:#666600">)</span></pre> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong>可下载字体</strong></span></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000">Compose 1.2 还在 Compose 中引入了可下载字体。你可以使用 Compose 的新 API 来异步访问 Google 字体，甚至可以定义备用字体，而无需任何复杂的设置。有了可下载字体，你可以<span style="background-color:#ffffff">保持较小的 APK 大小并改善用户的系统运行状况，因为多个应用程序可以通过提供商共享相同的字体。</span></span></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><strong><span style="color:#000000"><span style="background-color:#ffffff">文字放大镜</span></span></strong></p> 
<p style="text-align:start"><span style="color:#000000"><span style="background-color:#ffffff">Android 文本提供了一个放大镜小部件，可以更轻松地选择文本。Compose 现在支持文本放大镜。</span></span></p> 
<p style="text-align:start"><span style="color:#000000"><span style="background-color:#ffffff"><img alt height="292" src="https://oscimg.oschina.net/oscnet/up-ec9c07fa8354c7a77577167cb21c3730401.png" width="500" referrerpolicy="no-referrer"></span></span></p> 
<h4 style="margin-left:0px; margin-right:0px; text-align:start"><strong><span style="color:rgba(0, 0, 0, 0.67)"><span style="background-color:#ffffff">布局功能和改进</span></span></strong></h4> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong><span style="background-color:#ffffff">Lazy Layouts</span></strong></span></p> 
<p style="text-align:start"><span style="color:#000000"><span style="background-color:#ffffff">Lazy Layouts 继续发展，随着网格 API</span></span><span style="color:rgba(0, 0, 0, 0.67)"><span style="background-color:#ffffff"><code><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fkotlin%2Fandroidx%2Fcompose%2Ffoundation%2Flazy%2Fgrid%2Fpackage-summary%23LazyVerticalGrid%28androidx.compose.foundation.lazy.grid.GridCells%2Candroidx.compose.ui.Modifier%2Candroidx.compose.foundation.lazy.grid.LazyGridState%2Candroidx.compose.foundation.layout.PaddingValues%2Ckotlin.Boolean%2Candroidx.compose.foundation.layout.Arrangement.Vertical%2Candroidx.compose.foundation.layout.Arrangement.Horizontal%2Candroidx.compose.foundation.gestures.FlingBehavior%2Ckotlin.Boolean%2Ckotlin.Function1%29" target="_blank">LazyVerticalGrid</a></code>和<code><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fkotlin%2Fandroidx%2Fcompose%2Ffoundation%2Flazy%2Fgrid%2Fpackage-summary%23LazyHorizontalGrid%28androidx.compose.foundation.lazy.grid.GridCells%2Candroidx.compose.ui.Modifier%2Candroidx.compose.foundation.lazy.grid.LazyGridState%2Candroidx.compose.foundation.layout.PaddingValues%2Ckotlin.Boolean%2Candroidx.compose.foundation.layout.Arrangement.Horizontal%2Candroidx.compose.foundation.layout.Arrangement.Vertical%2Candroidx.compose.foundation.gestures.FlingBehavior%2Ckotlin.Boolean%2Ckotlin.Function1%29" target="_blank">LazyHorizontalGrid</a></code></span></span><span style="color:#000000"><span style="background-color:#ffffff">实验性的毕业，一个新的实验性 API 被添加，称为</span></span><span style="color:rgba(0, 0, 0, 0.67)"><span style="background-color:#ffffff"><code><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Freference%2Fkotlin%2Fandroidx%2Fcompose%2Ffoundation%2Flazy%2Flayout%2Fpackage-summary%3Fhl%3Den%23LazyLayout%28androidx.compose.foundation.lazy.layout.LazyLayoutItemsProvider%2Candroidx.compose.ui.Modifier%2Candroidx.compose.foundation.lazy.layout.LazyLayoutPrefetchState%2Ckotlin.Function2%29" target="_blank">LazyLayout</a></code></span></span><span style="color:#000000"><span style="background-color:#ffffff">，它允许你实现自己的自定义 Lazy Layouts。在 I/O 演讲中了解有关这些 API 的更多信息 </span></span><span style="color:rgba(0, 0, 0, 0.67)"><span style="background-color:#ffffff"><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fio.google%2F2022%2Fprogram%2F14bb63ef-2dd1-460a-9871-5f51ec1afec9%2F" target="_blank">Compose 中的 Lazy Layouts</a></span></span><span style="color:#000000"><span style="background-color:#ffffff">。</span></span></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong><span style="background-color:#ffffff">与 CoordinatorLayout 互操作</span></strong></span></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000">当你在视图系统中的 CoordinatorLayout 中嵌入一个滚动的 composable 时，你现在可以确保它们的滚动行为是可互操作的。这使得可折叠的工具条的设置更加容易。你可以通过将调用新的实验性的 rememberNestedScrollInteropConnection 方法的结果传递给 nestedScroll 修改器来选择这种行为。这是一个演示此新功能的</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fcs.android.com%2Fandroidx%2Fplatform%2Fframeworks%2Fsupport%2F%2B%2Fandroidx-main%3Acompose%2Fui%2Fui%2Fsamples%2Fsrc%2Fmain%2Fjava%2Fandroidx%2Fcompose%2Fui%2Fsamples%2FNestedScrollInteropSamples.kt%3Bl%3D40%3Fq%3DNestedScrollInteropSample" target="_blank">示例。</a></span></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong><span style="background-color:#ffffff">Window insets</span></strong></span></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000">Accompanist 中的插件库现在已经升级到 Compose Foundation 库，使用 WindowInsets 类。</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Fjetpack%2Fcompose%2Finterop%2Fcompose-in-existing-ui%23ime-animations" target="_blank">在关于将 Compose 与现有 UI 集成</a>的文档中阅读有关它的更多信息。</span></p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong><span style="background-color:#ffffff">Window size classes</span></strong></span></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000">为了更容易设计、开发和测试可调整大小的布局，官方发布了 Window size classes - 一组 opinionated viewport breakpoints。它们现在在一个新的库 material3-window-size-class 中以 alpha 形式提供，作为 Material 3 库集的一部分。你</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Fguide%2Ftopics%2Flarge-screens%2Fsupport-different-screen-sizes%23window_size_classes" target="_blank">可以在支持不同的 screen sizes 文档</a><span style="color:#000000">中阅读有关 size classes 的更多信息，并查看 </span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Fandroid%2Fcompose-samples%2Fcommit%2F0edb1926ac56c50a188be022c15117c07811fcdf" target="_blank">Crane 中的示例实现</a>。</span></p> 
<h4 style="margin-left:0px; margin-right:0px; text-align:start"><span style="color:#000000"><strong><span style="background-color:#ffffff">专注于性能</span></strong></span></h4> 
<p><span style="color:#000000">从 Android Studio Dolphin 开始，你可以使用 Layout Inspector 检查可组合项重组的频率。此外，Android Studio Electric Eel 现在包括一个 recomposition highlighter，这是一个用于查看哪些可组合项何时重组的视觉辅助工具。</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fandroid-developers.googleblog.com%2F2022%2F05%2Fwhats-new-in-android-studio.html" target="_blank">在 Android Studio 的新增功能</a><span style="color:#000000">博客中阅读有关此新工具的更多信息。</span></p> 
<p><span style="color:#000000"><img alt height="458" src="https://oscimg.oschina.net/oscnet/up-4d79fc446beca0dc58306b04887ee471295.png" width="500" referrerpolicy="no-referrer"></span></p> 
<p>Compose 从根本上改变了你编写 UI 的方式，因此你可以采用一些最佳实践来确保你的应用程序是高性能的。新发布的<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgoo.gle%2Fcompose-performance" target="_blank">文档页面</a>建议如何编写和配置你的 Compose 应用程序以获得最佳性能。</p> 
<p style="margin-left:0px; margin-right:0px; text-align:start"><strong><span style="color:#000000"><span style="background-color:#ffffff">新工具</span></span></strong></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000">除了改进之外，还有新的工具更新可帮助您更有效地使用 Compose。</span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fdeveloper.android.com%2Fstudio%2Fpreview" target="_blank">Android Studio Dolphi<span style="color:#000000">n</span></a><span style="color:#000000"> 现在处于 Beta 版，为 Compose 开发带来了令人兴奋的功能。除了重新合成计数之外，新工具还包括动画协调，以便你可以一次查看和浏览所有动画，以及多预览注释，以帮助你构建多种屏幕尺寸。为了使你能够更快地迭代 Android Studio Electric Eel（在 Canary 中）带来了 LiveEdit。</span></span></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000"><img alt height="327" src="https://oscimg.oschina.net/oscnet/up-2d137965f25d2eabfa1fe31be88465b721c.gif" width="500" referrerpolicy="no-referrer"></span></span></p> 
<p style="text-align:start"><strong><span style="background-color:#ffffff"><span style="color:#000000">Compose for Wear OS</span></span></strong></p> 
<p style="text-align:start"><span style="background-color:#ffffff"><span style="color:#000000">适用于 Wear OS 的 Compose 进入 Beta 版，意味着它的功能完整，API 稳定，你可以开始构建你的生产就绪的应用程序。详情可阅读 </span></span><a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgoo.gle%2Fcompose-wear-os-beta" target="_blank">blog post</a><span style="color:rgba(0, 0, 0, 0.670588235294118)">。</span></p>
                                        </div>
                                      
</div>
            