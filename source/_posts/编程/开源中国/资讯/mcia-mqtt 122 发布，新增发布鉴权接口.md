
---
title: 'mcia-mqtt 1.2.2 å‘å¸ƒï¼Œæ–°å¢å‘å¸ƒé‰´æƒæ¥å£'
categories: 
 - ç¼–ç¨‹
 - å¼€æºä¸­å›½
 - èµ„è®¯
headimg: 'https://picsum.photos/400/300?random=1315'
author: å¼€æºä¸­å›½
comments: false
date: Mon, 27 Dec 2021 12:40:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=1315'
---

<div>   
<div class="content">
                                                                                            <h2 style="text-align:start"><span>ä¸€ã€ç®€ä»‹</span></h2> 
<p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span><strong><span>mica-mqtt</span></strong></span><span> åŸºäº </span><span><strong><span>t-io</span></strong></span><span> å®ç°çš„</span><span><strong><span>ç®€å•</span></strong></span><span>ã€</span><span><strong><span>ä½å»¶è¿Ÿ</span></strong></span><span>ã€</span><span><strong><span>é«˜æ€§èƒ½</span></strong></span><span> çš„ mqtt ç‰©è”ç½‘å¼€æºç»„ä»¶ã€‚</span><span><strong><span>mica-mqtt</span></strong></span><span> æ›´åŠ æ˜“äºé›†æˆåˆ°å·²æœ‰æœåŠ¡å’ŒäºŒæ¬¡å¼€å‘ï¼Œé™ä½è‡ªç ”ç‰©è”ç½‘å¹³å°å¼€å‘æˆæœ¬ã€‚</span></p> 
<h2 style="text-align:start"><span>äºŒã€åŠŸèƒ½</span></h2> 
<ul style="margin-left:.8em; margin-right:.8em"> 
 <li style="list-style-type:none"><span>æ”¯æŒ MQTT v3.1ã€v3.1.1 ä»¥åŠ v5.0 åè®®ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ websocket mqtt å­åè®®ï¼ˆæ”¯æŒ mqtt.jsï¼‰ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ http rest apiï¼Œ</span><span><a href="https://gitee.com/596392912/mica-mqtt/blob/master/docs/http-api.md"><span>http api æ–‡æ¡£è¯¦è§</span></a></span><span>ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ MQTT client å®¢æˆ·ç«¯ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ MQTT server æœåŠ¡ç«¯ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ MQTT é—å˜±æ¶ˆæ¯ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ MQTT ä¿ç•™æ¶ˆæ¯ã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒè‡ªå®šä¹‰æ¶ˆæ¯ï¼ˆmqï¼‰å¤„ç†è½¬å‘å®ç°é›†ç¾¤ã€‚</span></li> 
 <li style="list-style-type:none"><span>MQTT å®¢æˆ·ç«¯ é˜¿é‡Œäº‘ mqtt è¿æ¥ demoã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ GraalVM ç¼–è¯‘æˆæœ¬æœºå¯æ‰§è¡Œç¨‹åºã€‚</span></li> 
 <li style="list-style-type:none"><span>æ”¯æŒ Spring boot é¡¹ç›®å¿«é€Ÿæ¥å…¥ï¼ˆmica-mqtt-spring-boot-starterï¼‰ã€‚</span></li> 
 <li style="list-style-type:none"><span>mica-mqtt-spring-boot-starter æ”¯æŒå¯¹æ¥ Prometheus + Grafanaã€‚</span></li> 
 <li style="list-style-type:none"><span>åŸºäº redis pub/sub å®ç°é›†ç¾¤ï¼Œè¯¦è§ </span><span><a href="https://gitee.com/596392912/mica-mqtt/blob/master/mica-mqtt-broker"><span>mica-mqtt-broker æ¨¡å—</span></a></span><span>ã€‚</span></li> 
</ul> 
<h2 style="text-align:start"><span>ä¸‰ã€ä½¿ç”¨åœºæ™¯</span></h2> 
<ul style="margin-left:.8em; margin-right:.8em"> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ç‰©è”ç½‘ï¼ˆäº‘ç«¯ï¼‰</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ç‰©è”ç½‘ï¼ˆè¾¹ç¼˜ç«¯ï¼‰</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ç¾¤ç»„ç±» IM</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>æ¶ˆæ¯æ¨é€</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ç®€å•æ˜“ç”¨çš„ MQTT å®¢æˆ·ç«¯</span></p> </li> 
</ul> 
<h2 style="text-align:start"><span>å››ã€æ›´æ–°è®°å½•</span></h2> 
<h3 style="text-align:start"><span>1.2.2 - 2021-12-26</span></h3> 
<ul style="margin-left:.8em; margin-right:.8em"> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt server æ·»åŠ å‘å¸ƒæƒé™æ¥å£ï¼Œæ— æƒé™ç›´æ¥æ–­å¼€è¿æ¥ï¼Œé¿å…é«˜çº§åˆ« qos é‡è¯•æµªè´¹èµ„æºã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt-broker ä¼˜åŒ–èŠ‚ç‚¹ä¿¡æ¯å­˜å‚¨</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt client é‡å¤è®¢é˜…ä¼˜åŒ–ã€‚æ„Ÿè°¢ @ä¸€ç‰‡å°é›¨æ»´</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt client æŠ½è±¡ IMqttClientSession æ¥å£ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ› ä¿®å¤é‡æ„ AbstractMqttMessageDispatcher ä¿æŒè·Ÿ mica-mqtt-broker é€»è¾‘ä¸€è‡´ gitee #I4MA6A æ„Ÿè°¢ @èƒ¡èåš</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>â¬†ï¸ mica-mqtt-example å‡çº§ log4j2 åˆ° 2.17.0</span></p> </li> 
</ul> 
<h3 style="text-align:start"><span>1.2.1 - 2021-12-11</span></h3> 
<ul style="margin-left:.8em; margin-right:.8em"> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt ä¼˜åŒ– topic åŒ¹é…ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt client disconnect ä¸å†è‡ªåŠ¨é‡è¿ gitee #I4L0WK æ„Ÿè°¢ @willianfuã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt client æ·»åŠ  retryCount é…ç½® gitee #I4L0WK æ„Ÿè°¢ @willianfuã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt-model message æ·»åŠ  json åºåˆ—åŒ–ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>âœ¨ mica-mqtt-broker é‡æ–°æ¢³ç†é€»è¾‘ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ› mica-mqtt-spring-boot-starter åœ¨ boot 2.6.x ä¸‹ bean å¾ªç¯ä¾èµ– gitee #I4LUZP æ„Ÿè°¢ @hongfeng11ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ› mica-mqtt server åŒä¸€ä¸ª clientId è¸¢å‡ºæ—¶æ¸…é™¤è€çš„ sessionã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ› mica-mqtt server é›†ç¾¤ä¸‹ä¸€ä¸ª clientId åªå…è®¸è¿æ¥åˆ°ä¸€å°æœåŠ¡å™¨ã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ› mica-mqtt client ä¿®å¤ IMqttClientConnectListener onDisconnect ç©ºæŒ‡é’ˆã€‚</span></p> </li> 
 <li> <p style="margin-left:.5rem; margin-right:0"><span>ğŸ“ mica-mqtt-model æ·»åŠ  README.md</span></p> </li> 
</ul> 
<h2 style="text-align:start"><span>äº”ã€Spring boot å¿«é€Ÿæ¥å…¥</span></h2> 
<h3 style="text-align:start"><span>5.1 æ·»åŠ ä¾èµ–</span></h3> 
<pre style="text-align:left"><span><span style="color:#117700"><</span><span style="color:#117700">dependency</span><span style="color:#117700">></span></span>
<span> Â  Â <span style="color:#117700"><</span><span style="color:#117700">groupId</span><span style="color:#117700">></span>net.dreamlu<span style="color:#117700"></</span><span style="color:#117700">groupId</span><span style="color:#117700">></span></span>
<span> Â  Â <span style="color:#117700"><</span><span style="color:#117700">artifactId</span><span style="color:#117700">></span>mica-mqtt-spring-boot-starter<span style="color:#117700"></</span><span style="color:#117700">artifactId</span><span style="color:#117700">></span></span>
<span> Â  Â <span style="color:#117700"><</span><span style="color:#117700">version</span><span style="color:#117700">></span>1.2.2<span style="color:#117700"></</span><span style="color:#117700">version</span><span style="color:#117700">></span></span>
<span><span style="color:#117700"></</span><span style="color:#117700">dependency</span><span style="color:#117700">></span></span></pre> 
<h3 style="text-align:start"><span>5.2 æœåŠ¡ç«¯é…ç½®ç¤ºä¾‹</span></h3> 
<pre style="text-align:left"><span><span style="color:#221199">mqtt</span><span style="color:#555555">:</span></span>
<span><span style="color:#221199">  server</span><span style="color:#555555">:</span></span>
<span><span style="color:#221199"> Â   enabled</span><span style="color:#555555">: </span>true Â  Â  Â  Â  Â  Â  Â  <span style="color:#aa5500"># æ˜¯å¦å¼€å¯ï¼Œé»˜è®¤ï¼štrue</span></span>
<span><span style="color:#221199"> Â   ip</span><span style="color:#555555">: </span>0.0.0.0 Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#aa5500"># æœåŠ¡ç«¯ ip é»˜è®¤ï¼š0.0.0.0</span></span>
<span><span style="color:#221199"> Â   port</span><span style="color:#555555">: </span>5883 Â  Â  Â  Â  Â  Â  Â  Â  Â <span style="color:#aa5500"># ç«¯å£ï¼Œé»˜è®¤ï¼š1883</span></span>
<span><span style="color:#221199"> Â   name</span><span style="color:#555555">: </span>Mica-Mqtt-Server Â  Â  Â <span style="color:#aa5500"># åç§°ï¼Œé»˜è®¤ï¼šMica-Mqtt-Server</span></span>
<span><span style="color:#221199"> Â   buffer-allocator</span><span style="color:#555555">: </span>HEAP Â  Â  Â <span style="color:#aa5500"># å †å†…å­˜å’Œå †å¤–å†…å­˜ï¼Œé»˜è®¤ï¼šå †å†…å­˜</span></span>
<span><span style="color:#221199"> Â   heartbeat-timeout</span><span style="color:#555555">: </span>120000 Â  <span style="color:#aa5500"># å¿ƒè·³è¶…æ—¶ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤: 1000 * 120</span></span>
<span><span style="color:#221199"> Â   read-buffer-size</span><span style="color:#555555">: </span>8092 Â  Â  Â <span style="color:#aa5500"># æ¥æ”¶æ•°æ®çš„ buffer sizeï¼Œé»˜è®¤ï¼š8092</span></span>
<span><span style="color:#221199"> Â   max-bytes-in-message</span><span style="color:#555555">: </span>8092 Â <span style="color:#aa5500"># æ¶ˆæ¯è§£ææœ€å¤§ bytes é•¿åº¦ï¼Œé»˜è®¤ï¼š8092</span></span>
<span><span style="color:#221199"> Â   debug</span><span style="color:#555555">: </span>true Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#aa5500"># å¦‚æœå¼€å¯ prometheus æŒ‡æ ‡æ”¶é›†å»ºè®®å…³é—­</span></span>
<span><span style="color:#221199"> Â   websocket-enable</span><span style="color:#555555">: </span>true Â  Â  Â <span style="color:#aa5500"># å¼€å¯ websocket å­åè®®ï¼Œé»˜è®¤å¼€å¯</span></span>
<span><span style="color:#221199"> Â   websocket-port</span><span style="color:#555555">: </span>8083 Â  Â  Â  Â <span style="color:#aa5500"># websocket ç«¯å£ï¼Œé»˜è®¤ï¼š8083</span></span></pre> 
<h3 style="text-align:start"><span>5.3 æœåŠ¡ç«¯å¯å®ç°æ¥å£ï¼ˆæ³¨å†Œæˆ Spring Bean å³å¯ï¼‰</span></h3> 
<table cellspacing="0" class="md-table" style="border-collapse:collapse; border-spacing:0px; box-sizing:border-box; break-inside:auto; cursor:text; margin:0px; overflow:auto; padding:0px; text-align:left; white-space:pre-wrap; width:800px; word-break:initial"> 
 <thead> 
  <tr> 
   <th><span><span>æ¥å£</span></span></th> 
   <th><span><span>æ˜¯å¦å¿…é¡»</span></span></th> 
   <th><span><span>è¯´æ˜</span></span></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttServerUniqueIdService</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å¦</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>ç”¨äº clientId ä¸å”¯ä¸€æ—¶ï¼Œè‡ªå®šä¹‰å®ç°å”¯ä¸€æ ‡è¯†ï¼Œåç»­æ¥å£ä½¿ç”¨å®ƒæ›¿ä»£ clientId</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttServerAuthHandler</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>æ˜¯</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>ç”¨äºæœåŠ¡ç«¯è®¤è¯</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttServerSubscribeValidator</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å¦ï¼ˆå»ºè®®å®ç°ï¼‰</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>1.1.3 æ–°å¢ï¼Œç”¨äºå¯¹å®¢æˆ·ç«¯è®¢é˜…æ ¡éªŒ</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttServerPublishPermission</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å¦ï¼ˆå»ºè®®å®ç°ï¼‰</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>1.2.2 æ–°å¢ï¼Œç”¨äºå¯¹å®¢æˆ·ç«¯å‘å¸ƒæƒé™æ ¡éªŒ</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttMessageListener</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>æ˜¯</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>æ¶ˆæ¯ç›‘å¬</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttConnectStatusListener</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>æ˜¯</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>è¿æ¥çŠ¶æ€ç›‘å¬</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttSessionManager</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å¦</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>session ç®¡ç†</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IMqttMessageStore</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>é›†ç¾¤æ˜¯ï¼Œå•æœºå¦</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>é—å˜±å’Œä¿ç•™æ¶ˆæ¯å­˜å‚¨</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>AbstractMqttMessageDispatcher</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>é›†ç¾¤æ˜¯ï¼Œå•æœºå¦</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>æ¶ˆæ¯è½¬å‘ï¼Œï¼ˆé—å˜±ã€ä¿ç•™æ¶ˆæ¯è½¬å‘ï¼‰</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>IpStatListener</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å¦</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>t-io ip çŠ¶æ€ç›‘å¬</span></span></td> 
  </tr> 
 </tbody> 
</table> 
<h3 style="text-align:start"><span>5.4 Prometheus + Grafana ç›‘æ§å¯¹æ¥</span></h3> 
<p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>å¾—ç›Šäº </span><span><strong><span>t-io</span></strong></span><span> è‰¯å¥½çš„è®¾è®¡ï¼Œç›‘æ§æŒ‡æ ‡ç›´æ¥å¯¹æ¥çš„ </span><span><strong><span>t-iostat</span></strong></span><span>ï¼Œç›®å‰æ”¯æŒä¸‹åˆ—æŒ‡æ ‡ï¼ŒåæœŸä¼šä¸æ–­å®Œå–„ã€‚</span></p> 
<table cellspacing="0" class="md-table" style="border-collapse:collapse; border-spacing:0px; box-sizing:border-box; break-inside:auto; cursor:text; margin:0px; overflow:auto; padding:0px; text-align:left; white-space:pre-wrap; width:800px; word-break:initial"> 
 <thead> 
  <tr> 
   <th><span><span>æ”¯æŒå¾—æŒ‡æ ‡</span></span></th> 
   <th><span><span>è¯´æ˜</span></span></th> 
  </tr> 
 </thead> 
 <tbody> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_connections_accepted</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å…±æ¥å—è¿‡è¿æ¥æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_connections_closed</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å…³é—­è¿‡çš„è¿æ¥æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_connections_size</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å½“å‰è¿æ¥æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_handled_packets</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²å¤„ç†æ¶ˆæ¯æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_handled_bytes</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²å¤„ç†æ¶ˆæ¯å­—èŠ‚æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_received_packets</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²æ¥æ”¶æ¶ˆæ¯æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_received_bytes</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²å¤„ç†æ¶ˆæ¯å­—èŠ‚æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_send_packets</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²å‘é€æ¶ˆæ¯æ•°</span></span></td> 
  </tr> 
  <tr> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>mqtt_messages_send_bytes</span></span></td> 
   <td style="border-color:#dfe2e5; border-style:solid; border-width:1px"><span><span>å·²å‘é€æ¶ˆæ¯å­—èŠ‚æ•°</span></span></td> 
  </tr> 
 </tbody> 
</table> 
<p style="color:#333333; margin-left:.8em; margin-right:.8em; text-align:start"><span>å…³äº </span><span><strong><span>mica-mqtt-spring-boot-starter</span></strong></span><span> æ›´å¤šè¯·æŸ¥çœ‹æ–‡æ¡£ï¼š</span><span><a href="https://gitee.com/596392912/mica-mqtt/tree/master/mica-mqtt-spring-boot-starter"><span>https://gitee.com/596392912/mica-mqtt/tree/master/mica-mqtt-spring-boot-starter</span></a></span></p> 
<h2 style="text-align:start"><span>å…­ã€æ™®é€š java é¡¹ç›®æ¥å…¥</span></h2> 
<h3 style="text-align:start"><span>6.1 maven ä¾èµ–</span></h3> 
<pre style="text-align:left"><span> <span style="color:#117700"><</span><span style="color:#117700">dependency</span><span style="color:#117700">></span></span>
<span> Â  <span style="color:#117700"><</span><span style="color:#117700">groupId</span><span style="color:#117700">></span>net.dreamlu<span style="color:#117700"></</span><span style="color:#117700">groupId</span><span style="color:#117700">></span></span>
<span> Â  <span style="color:#117700"><</span><span style="color:#117700">artifactId</span><span style="color:#117700">></span>mica-mqtt-core<span style="color:#117700"></</span><span style="color:#117700">artifactId</span><span style="color:#117700">></span></span>
<span> Â  <span style="color:#117700"><</span><span style="color:#117700">version</span><span style="color:#117700">></span>1.2.2<span style="color:#117700"></</span><span style="color:#117700">version</span><span style="color:#117700">></span></span>
<span> <span style="color:#117700"></</span><span style="color:#117700">dependency</span><span style="color:#117700">></span></span></pre> 
<h3 style="text-align:start"><span>6.2 mica-mqtt å®¢æˆ·ç«¯</span></h3> 
<pre style="text-align:left"><span> <span style="color:#aa5500">// åˆå§‹åŒ– mqtt å®¢æˆ·ç«¯</span></span>
<span> <span style="color:#000000">MqttClient</span> <span style="color:#000000">client</span> <span style="color:#981a1a">=</span> <span style="color:#000000">MqttClient</span>.<span style="color:#000000">create</span>()</span>
<span> Â  Â  .<span style="color:#000000">ip</span>(<span style="color:#aa1111">"127.0.0.1"</span>)</span>
<span> Â  Â  .<span style="color:#000000">port</span>(<span style="color:#116644">1883</span>) Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#aa5500">// é»˜è®¤ï¼š1883</span></span>
<span> Â  Â  .<span style="color:#000000">username</span>(<span style="color:#aa1111">"admin"</span>)</span>
<span> Â  Â  .<span style="color:#000000">password</span>(<span style="color:#aa1111">"123456"</span>)</span>
<span> Â  Â  .<span style="color:#000000">version</span>(<span style="color:#000000">MqttVersion</span>.<span style="color:#000000">MQTT_5</span>) Â  Â <span style="color:#aa5500">// é»˜è®¤ï¼š3_1_1</span></span>
<span> Â  Â  .<span style="color:#000000">clientId</span>(<span style="color:#aa1111">"xxxxxx"</span>) Â  Â  Â  Â  Â  Â  <span style="color:#aa5500">// é»˜è®¤ï¼šMICA-MQTT- å‰ç¼€å’Œ 36è¿›åˆ¶çš„çº³ç§’æ•°</span></span>
<span> Â  Â  .<span style="color:#000000">connect</span>(); Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span style="color:#aa5500">// è¿æ¥</span></span>
<span> </span>
<span> Â  Â  <span style="color:#aa5500">// æ¶ˆæ¯è®¢é˜…ï¼ŒåŒç±»æ–¹æ³• subxxx</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">subQos0</span>(<span style="color:#aa1111">"/test/#"</span>, (<span style="color:#000000">topic</span>, <span style="color:#000000">payload</span>) <span style="color:#981a1a">-></span> &#123;</span>
<span> Â  Â  Â  Â  <span style="color:#000000">logger</span>.<span style="color:#000000">info</span>(<span style="color:#000000">topic</span> <span style="color:#981a1a">+</span> <span style="color:#aa1111">'\t'</span> <span style="color:#981a1a">+</span> <span style="color:#000000">ByteBufferUtil</span>.<span style="color:#000000">toString</span>(<span style="color:#000000">payload</span>));</span>
<span> Â  Â  &#125;);</span>
<span> Â  Â  <span style="color:#aa5500">// å–æ¶ˆè®¢é˜…</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">unSubscribe</span>(<span style="color:#aa1111">"/test/#"</span>);</span>
<span> </span>
<span> Â  Â  <span style="color:#aa5500">// å‘é€æ¶ˆæ¯</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">publish</span>(<span style="color:#aa1111">"/test/client"</span>, <span style="color:#000000">ByteBuffer</span>.<span style="color:#000000">wrap</span>(<span style="color:#aa1111">"micaæœ€ç‰›çš®"</span>.<span style="color:#000000">getBytes</span>(<span style="color:#000000">StandardCharsets</span>.<span style="color:#000000">UTF_8</span>)));</span>
<span> </span>
<span> Â  Â  <span style="color:#aa5500">// æ–­å¼€è¿æ¥</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">disconnect</span>();</span>
<span> Â  Â  <span style="color:#aa5500">// é‡è¿</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">reconnect</span>();</span>
<span> Â  Â  <span style="color:#aa5500">// åœæ­¢</span></span>
<span> Â  Â  <span style="color:#000000">client</span>.<span style="color:#000000">stop</span>();</span></pre> 
<h3 style="text-align:start"><span>6.3 mica-mqtt æœåŠ¡ç«¯</span></h3> 
<pre style="text-align:left"><span><span style="color:#aa5500">// æ³¨æ„ï¼šä¸ºäº†èƒ½æ¥å—æ›´å¤šé“¾æ¥ï¼ˆé™ä½å†…å­˜ï¼‰ï¼Œè¯·æ·»åŠ  jvm å‚æ•° -Xss129k</span></span>
<span><span style="color:#000000">MqttServer</span> <span style="color:#000000">mqttServer</span> <span style="color:#981a1a">=</span> <span style="color:#000000">MqttServer</span>.<span style="color:#000000">create</span>()</span>
<span> Â  Â <span style="color:#aa5500">// é»˜è®¤ï¼š0.0.0.0</span></span>
<span> Â   .<span style="color:#000000">ip</span>(<span style="color:#aa1111">"0.0.0.0"</span>)</span>
<span> Â  Â <span style="color:#aa5500">// é»˜è®¤ï¼š1883</span></span>
<span> Â   .<span style="color:#000000">port</span>(<span style="color:#116644">1883</span>)</span>
<span> Â  Â <span style="color:#aa5500">// é»˜è®¤ä¸ºï¼š 8092ï¼ˆmqtt é»˜è®¤æœ€å¤§æ¶ˆæ¯å¤§å°ï¼‰ï¼Œä¸ºäº†é™ä½å†…å­˜å¯ä»¥å‡å°å°æ­¤å‚æ•°ï¼Œå¦‚æœæ¶ˆæ¯è¿‡å¤§ t-io ä¼šå°è¯•è§£æå¤šæ¬¡ï¼ˆå»ºè®®æ ¹æ®å®é™…ä¸šåŠ¡æƒ…å†µè€Œå®šï¼‰</span></span>
<span> Â   .<span style="color:#000000">readBufferSize</span>(<span style="color:#116644">512</span>)</span>
<span> Â  Â <span style="color:#aa5500">// æ¶ˆæ¯ç›‘å¬</span></span>
<span> Â   .<span style="color:#000000">messageListener</span>((<span style="color:#000000">context</span>, <span style="color:#000000">clientId</span>, <span style="color:#000000">message</span>) <span style="color:#981a1a">-></span> &#123;</span>
<span> Â  Â  Â  Â <span style="color:#000000">logger</span>.<span style="color:#000000">info</span>(<span style="color:#aa1111">"clientId:&#123;&#125; message:&#123;&#125; payload:&#123;&#125;"</span>, <span style="color:#000000">clientId</span>, <span style="color:#000000">message</span>, <span style="color:#000000">ByteBufferUtil</span>.<span style="color:#000000">toString</span>(<span style="color:#000000">message</span>.<span style="color:#000000">getPayload</span>()));</span>
<span> Â   &#125;)</span>
<span> Â   .<span style="color:#000000">debug</span>() <span style="color:#aa5500">// å¼€å¯ t-io debug ä¿¡æ¯æ—¥å¿—</span></span>
<span> Â   .<span style="color:#000000">start</span>();</span>
<span><span>â€‹</span></span>
<span><span style="color:#aa5500">// å‘é€ç»™æŸä¸ªå®¢æˆ·ç«¯</span></span>
<span><span style="color:#000000">mqttServer</span>.<span style="color:#000000">publish</span>(<span style="color:#aa1111">"clientId"</span>,<span style="color:#aa1111">"/test/123"</span>, <span style="color:#000000">ByteBuffer</span>.<span style="color:#000000">wrap</span>(<span style="color:#aa1111">"micaæœ€ç‰›çš®"</span>.<span style="color:#000000">getBytes</span>()));</span>
<span><span>â€‹</span></span>
<span><span style="color:#aa5500">// å‘é€ç»™æ‰€æœ‰åœ¨çº¿ç›‘å¬è¿™ä¸ª topic çš„å®¢æˆ·ç«¯</span></span>
<span><span style="color:#000000">mqttServer</span>.<span style="color:#000000">publishAll</span>(<span style="color:#aa1111">"/test/123"</span>, <span style="color:#000000">ByteBuffer</span>.<span style="color:#000000">wrap</span>(<span style="color:#aa1111">"micaæœ€ç‰›çš®"</span>.<span style="color:#000000">getBytes</span>()));</span>
<span><span>â€‹</span></span>
<span><span style="color:#aa5500">// åœæ­¢æœåŠ¡</span></span>
<span><span style="color:#000000">mqttServer</span>.<span style="color:#000000">stop</span>()</span>
</pre>
                                        </div>
                                      
</div>
            