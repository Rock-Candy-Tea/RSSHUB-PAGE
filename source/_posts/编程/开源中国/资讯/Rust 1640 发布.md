
---
title: 'Rust 1.64.0 发布'
categories: 
 - 编程
 - 开源中国
 - 资讯
headimg: 'https://picsum.photos/400/300?random=3255'
author: 开源中国
comments: false
date: Fri, 23 Sep 2022 08:07:00 GMT
thumbnail: 'https://picsum.photos/400/300?random=3255'
---

<div>   
<div class="content">
                                                                                            <p>Rust 团队于今天发布了 Rust 1.64.0 新版本，1.64.0 稳定版中的主要更新内容如下：</p> 
<h3>用 <code>IntoFuture</code> 增强 <code>.await</code></h3> 
<p>Rust 1.64 稳定了 <code>IntoFuture</code> 特性。<code>IntoFuture</code> 是一个类似于 <code>IntoIterator</code> 的特性，但 <code>IntoFuture</code> 不支持 <code>for ... in ...</code> 循环，而是改变了 <code>.await</code> 的工作方式。它可以等待任何可以通过 <code>IntoFuture</code> 转换为 <code>Future</code> 的东西，这可以帮助你的 API 变得更友好.</p> 
<h3><code>core</code> 和 <code>alloc</code> 中与 C 语言兼容的 FFI 类型</h3> 
<p>当调用或被 C ABI 调用时，Rust 代码可以使用 <code>c_uint</code> 或 <code>c_ulong</code> 等类型别名以在任何目标上匹配来自 C 的相应类型，而不需要特定于目标的代码或条件。</p> 
<p>以前，这些类型别名只在 <code>std</code> 中可用，所以为嵌入式目标和其他只能使用 <code>core</code> 或 <code>alloc</code> 的情况下编写的代码不能使用这些类型。</p> 
<p>Rust 1.64 现在在 <code>core::fi</code> 中提供了所有的 <code>c_*</code> 类型别名，以及用于处理 C 字符串的 <code>core::f i::CStr</code>。Rust 1.64 还提供了 <code>alloc::ffi::CString</code>，用于处理只使用 <code>alloc</code> crate 的 C 字符串。</p> 
<h3>rust-analyzer 现在可以通过 rustup 获得</h3> 
<p>rust-analyzer 现在作为 Rust 工具集的一部分被包含在其中。这使得下载和访问 rust-analyzer 更加容易，并使其在更多平台上可用。如今它可以作为一个 rustup 组件使用，可以通过以下方式安装。</p> 
<pre><code class="language-rust">rustup component add rust-analyzer
</code></pre> 
<p>此时，要运行已安装的 rustup 版本，你需要这样调用它：</p> 
<pre><code>rustup run stable rust-analyzer
</code></pre> 
<p>rustup 的下一个版本将提供一个内置的代理，这样运行可执行的 rust-analyzer 就会启动相应的版本。</p> 
<h3>Cargo 改进</h3> 
<p>当在一个 Cargo 工作空间中处理相关库或二进制 crate 的集合时，你现在可以避免 crate 之间共同的字段值的重复，如共同的版本号、仓库 URL 或 <code>rust-version</code>。这也有助于在更新 crate 时保持这些值的同步。</p> 
<p>在为多个目标进行构建时，你现在可以向 <code>cargo build</code> 传递多个 <code>--target</code> 选项，以便一次性构建所有这些目标。</p> 
<h3><strong>稳定的 API</strong></h3> 
<p>以下方法和特性的实现现在已经稳定了：</p> 
<ul> 
 <li><code>[future::IntoFuture]()</code></li> 
 <li><code>[num::NonZero*::checked_mul]()</code></li> 
 <li><code>[num::NonZero*::checked_pow]()</code></li> 
 <li><code>[num::NonZero*::saturating_mul]()</code></li> 
 <li><code>[num::NonZero*::saturating_pow]()</code></li> 
 <li><code>[num::NonZeroI*::abs]()</code></li> 
 <li><code>[num::NonZeroI*::checked_abs]()</code></li> 
 <li><code>[num::NonZeroI*::overflowing_abs]()</code></li> 
 <li><code>[num::NonZeroI*::saturating_abs]()</code></li> 
 <li><code>[num::NonZeroI*::unsigned_abs]()</code></li> 
 <li><code>[num::NonZeroI*::wrapping_abs]()</code></li> 
 <li><code>[num::NonZeroU*::checked_add]()</code></li> 
 <li><code>[num::NonZeroU*::checked_next_power_of_two]()</code></li> 
 <li><code>[num::NonZeroU*::saturating_add]()</code></li> 
 <li><code>[os::unix::process::CommandExt::process_group]()</code></li> 
 <li><code>[os::windows::fs::FileTypeExt::is_symlink_dir]()</code></li> 
 <li><code>[os::windows::fs::FileTypeExt::is_symlink_file]()</code></li> 
</ul> 
<p>这些类型以前在 <code>std::fi</code> 中是稳定的，但现在在 <code>core</code> 和 <code>alloc</code> 中也可用：</p> 
<ul> 
 <li><code>[core::ffi::CStr]()</code></li> 
 <li><code>[core::ffi::FromBytesWithNulError]()</code></li> 
 <li><code>[alloc::ffi::CString]()</code></li> 
 <li><code>[alloc::ffi::FromVecWithNulError]()</code></li> 
 <li><code>[alloc::ffi::IntoStringError]()</code></li> 
 <li><code>[alloc::ffi::NulError]()</code></li> 
</ul> 
<p>这些类型以前在 <code>std::os::raw</code> 中是稳定的，但现在在 <code>core::ffi</code> 和 <code>std::ffi</code> 中也可用</p> 
<ul> 
 <li><code>[ffi::c_char]()</code></li> 
 <li><code>[ffi::c_double]()</code></li> 
 <li><code>[ffi::c_float]()</code></li> 
 <li><code>[ffi::c_int]()</code></li> 
 <li><code>[ffi::c_long]()</code></li> 
 <li><code>[ffi::c_longlong]()</code></li> 
 <li><code>[ffi::c_schar]()</code></li> 
 <li><code>[ffi::c_short]()</code></li> 
 <li><code>[ffi::c_uchar]()</code></li> 
 <li><code>[ffi::c_uint]()</code></li> 
 <li><code>[ffi::c_ulong]()</code></li> 
 <li><code>[ffi::c_ulonglong]()</code></li> 
 <li><code>[ffi::c_ushort]()</code></li> 
</ul> 
<p>更多详情可查看：<a href="https://www.oschina.net/action/GoToLink?url=https%3A%2F%2Fgithub.com%2Frust-lang%2Frust%2Freleases%2Ftag%2F1.64.0" target="_blank">https://github.com/rust-lang/rust/releases/tag/1.64.0</a></p>
                                        </div>
                                      
</div>
            