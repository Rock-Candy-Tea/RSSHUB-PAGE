
---
title: '云原生安全开源项目汇总'
categories: 
 - 编程
 - Dockone
 - 周报
headimg: 'https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/77b1aa30f9407e5de31721266e0d5bfa.png'
author: Dockone
comments: false
date: 2021-09-10 09:08:00
thumbnail: 'https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/77b1aa30f9407e5de31721266e0d5bfa.png'
---

<div>   
<br><h3>概览</h3>云原生的发展离不开CNCF（Cloud Native Computing Foundation）的推动和支持。在CNCF众多的孵化项目中，不仅仅包含编排调度、监控分析类型项目，还包括了一系列“安全与合规”类型的项目，从而使得云原生开源生态更完整，也可以帮助采用云原生技术的企业能够降低安全风险。在本篇文章中，我们对CNCF的安全开源项目进行一下梳理。<br>
<br>根据成熟度不同，CNCF项目分为Sandbox（沙盒）、Incubating（孵化）和Graduation（毕业）三个阶段。<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210909/77b1aa30f9407e5de31721266e0d5bfa.png" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/77b1aa30f9407e5de31721266e0d5bfa.png" class="img-polaroid" title="1.png" alt="1.png" referrerpolicy="no-referrer"></a>
</div>
<br>
<em>CNCF项目成熟度等级划分</em><br>
<br>从图中可以看出，沙盒-孵化-毕业所代表的成熟度依次升高。其中，被CNCF接受并成为Sandbox项目需要至少2个TOC的Sponsor的支持。孵化项目必须提供至少三个独立的终端用户成功地使用在生产环境中的资料信息，在质量和范围方面都得到证明。而要达到毕业，则需要在孵化标准之上满足更严苛的要求，代表这是一个“跨越鸿沟”的项目。实际统计来说，目前毕业的安全开源项目也仅有两个。<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210909/8f474cdf1ca3ead9ade2e69756b21d05.jpg" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/8f474cdf1ca3ead9ade2e69756b21d05.jpg" class="img-polaroid" title="2.jpg" alt="2.jpg" referrerpolicy="no-referrer"></a>
</div>
<br>
此外还有其他开源项目，虽然没有直接托管在CNCF旗下，但也跟CNCF有密切的联系：<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210909/326dc23cb1c976b182c7856c21e38692.jpg" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/326dc23cb1c976b182c7856c21e38692.jpg" class="img-polaroid" title="3.jpg" alt="3.jpg" referrerpolicy="no-referrer"></a>
</div>
<br>
<h3>项目举例</h3>我们抽取部分典型的项目如OPA、TUF、Falco、Kube-hunter、Trivy介绍，分别涉及云原生安全的不同领域，覆盖集群安全策略管理、安全更新框架、容器运行时安全检测、集群安全扫描以及镜像扫描。<br>
<h4>OPA：Open Policy Agent</h4>OPA是一个全场景通用的轻量策略引擎（Policy Engine），它提供了声明式表达的Rego语言来描述策略，并将策略的决策offload到OPA，从而将策略的决策过程从策略的执行中解耦。OPA可适用于多种场景，比如Kubernetes、Terraform、Envoy等，以前需要使用到Policy的场景理论上都可以用OPA来做一层抽象。<br>
<br>Kubernetes中可以使用OPA充当Kubernetes准入控制器。OPA拦截发送到API服务器的API调用，并验证和/或修改它们。与原生Pod安全策略不同，OPA可以应用于任何Kubernetes资源，用户可以配置统一的OPA策略，适用于系统的不同组件，而不仅仅是Pod。<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210909/e9f181f23e262cb0000069f867ea6f7a.png" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/e9f181f23e262cb0000069f867ea6f7a.png" class="img-polaroid" title="4.png" alt="4.png" referrerpolicy="no-referrer"></a>
</div>
<br>
<em>OPA在Kubernetes中的使用场景</em><br>
<h4>TUF：The Update Framework</h4>The Update Framework（TUF）是一个安全更新框架，它是一种构建系统弹性的方法，可以抵御关键的入侵和其他可能传播恶意软件或危及存储库的攻击。TUF充分考虑到了各个环节可能出现的攻击，在提供更新功能的同时，也可以很好的保护现有程序或者是验证待更新版本的安全和可靠性。实现机制主要是提供了一套标准规范，并在各个环节中增加了更多的元数据和相关的检查，包括签名信息，文件hash，元数据签名和过期时间等。<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210909/502c87d449197c1fc00746e6792df604.png" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210909/502c87d449197c1fc00746e6792df604.png" class="img-polaroid" title="5.png" alt="5.png" referrerpolicy="no-referrer"></a>
</div>
<br>
<em>TUF于2019年从CNCF正式毕业</em><br>
<br>TUF已成为保护软件更新系统安全的行业标准，包括亚马逊在内的领先的基于云的服务提供商都在使用它，其中包括最近发布了TUF的新实现的Amazon，还有Microsoft、Google、Cloudflare、Datadog、DigitalOcean、Docker、IBM、Red Hat与VMware等。<br>
<h4>Falco</h4>Falco最初是由Sysdig创建的，后来加入CNCF孵化器，成为首个加入CNCF的运行时安全项目。Falco可以对Linux系统调用行为进行监控。Falco的主要功能如下：<br>
<ul><li>从内核运行时采集Linux系统调用</li><li>提供了一套强大的规则引擎，用于对Linux系统调用行为进行监控</li><li>当系统调用违反规则时，会触发相应的告警</li></ul><br>
<br>Falco提供了一组默认规则，可以监控内核态的异常行为。例如：<br>
<ul><li>使用setns等工具改变进程的namespace信息</li><li>对于系统目录/etc，/usr/bin，/usr/sbin的读写行为</li><li>文件Ownership、Mode的变更</li></ul><br>
<br>但事实上Falco离上生产环境还有一段距离，需要安装内核驱动，侵入式较强，虽然已支持eBPF，但其稳定性和性能还待验证。<br>
<h4>Kube-hunter</h4>Kube-hunter是一个用于Kubernetes渗透测试的开源工具。只需提供Kubernetes集群的IP或者DNS名称，Kube-hunter就会探查集群中的安全漏洞——这个过程就像是自动化的渗透测试。它有被动、主动两种模式，默认为被动模式，可以用来探测企业用户Kubernetes环境内潜在的弱点。如果切换为主动模式，则会查找其他弱点，利用发现的弱点进行进一步探索，因此在使用主动模式时也需慎重。<br>
<br>部署方面，Kube-hunter总共有3种不同使用方式：<br>
<ul><li>将Kube-hunter容器部署在集群外，指定集群的DNS、IP地址后，就能进行渗透测试。</li><li>将Kube-hunter部署在集群内特定主机运作，直接在本地环境检测、扫描。</li><li>使用Pod作为部署单位，执行Kube-hunter。</li></ul><br>
<br><h4>Trivy</h4>Trivy是一个简单而且功能完整的容器漏洞扫描工具，特别适用于持续集成。与其他几款开源的镜像扫描工具相比，Trivy在准确性、方便性和对CI的支持等方面都有优势：<br>
<ul><li>检测面很全，能检测全面的漏洞</li><li>扫描速度快，通常在10秒内完成（取决于网络和镜像大小）</li><li>Trivy是无状态的，不需要维护或准备</li><li>易于安装，使用简单，仅仅只需要指定镜像名称</li></ul><br>
<br><h3>总结</h3>受限于篇幅，本文仅挑选了部分项目进行简要介绍。有兴趣的读者可以根据每个项目后面的详情链接进行深入的学习和研究。<br>
<br>原文链接：<a href="https://mp.weixin.qq.com/s/ayLmfANKqmtlLq5LzQhZnA" rel="nofollow" target="_blank">https://mp.weixin.qq.com/s/ayLmfANKqmtlLq5LzQhZnA</a>
                                                                <div class="aw-upload-img-list">
                                                                                                                                                                                                                                                                                                                                                                                                </div>
                                
                                                                <ul class="aw-upload-file-list">
                                                                                                                                                                                                                                                                                                                                                                                                                                            </ul>
                                                              
</div>
            