
---
title: '程序员应该掌握的常用网络问题定位工具'
categories: 
 - 编程
 - Dockone
 - 周报
headimg: 'https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210506/fd039483f6f2fff6a7bad26c76b36de4.jpg'
author: Dockone
comments: false
date: 2021-05-07 00:03:36
thumbnail: 'https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210506/fd039483f6f2fff6a7bad26c76b36de4.jpg'
---

<div>   
<br>项目日常运维的过程中，经常会遇到各种奇奇怪怪的网络问题。那么排查网络问题，就成为一个合格的程序员必备技能。这里列举出一些常用的指令，用于日常工作中快速定位网络问题。<br>
<h4>ping</h4>这个是大家经常用到的一个小工具，用于检查两台服务器之间是否能够成功交换数据包。<code class="prettyprint">ping</code>指令向对方主机发送<code class="prettyprint">ICMP</code>报文。当能成功<code class="prettyprint">ping</code>通时表示两台主机之间的网络链路是畅通的。如果<code class="prettyprint">ping</code>不通，首先需要确认对方是否关停了<code class="prettyprint">ping</code>服务，如果没有关停，就需要检查双方的网络链接问题了。<br>
<h4>telnet</h4>该指令主要用于检查到对方端口的网络联通性，如果<code class="prettyprint">telnet</code>能通，一般证明<code class="prettyprint">TCP</code>三次握手已经建立成功，也就是网络层是畅通的。如果<code class="prettyprint">telnet</code>不通，需要确认对方是否已经启动相应服务端口，如果已启动，那么就要检查双方的防火墙策略等问题。<br>
<h4>ifconfig</h4><code class="prettyprint">ifconfig</code> 指令除了可以查看网卡信息外，还可以修改网络配置。比如查看网卡信息 <code class="prettyprint">ifconfig -a</code> ；启动网卡 <code class="prettyprint">ifconfig eth0 up</code> ；关停网卡 <code class="prettyprint">ifconfig eth0 down</code>等操作。<br>
<br>除了使用<code class="prettyprint">ifconfig</code> 查看及配置网卡信息外，还可以通过 <code class="prettyprint">ip link show</code> 查看网卡信息，启动网卡信息 <code class="prettyprint">ip link set down eth0</code>; 关停网卡 <code class="prettyprint">ip link set up eth1</code> 等操作。<br>
<br><blockquote><br>注意：启动关停网卡在<code class="prettyprint">SSH</code>链接的情况下，尽量不要操作。</blockquote><h4>route</h4><code class="prettyprint">route</code> 指令一般用于查看和配置服务器路由信息。比如查看路由信息 <code class="prettyprint">route -n</code> 或者 <code class="prettyprint">route -nee</code> 添加或者删除路由信息 <code class="prettyprint">route &#123;add | del &#125; -net &#123;NETWORK-ADDRESS&#125; netmask &#123;NETMASK&#125; dev &#123;INTERFACE-NAME&#125;</code> 等等。<br>
<br>同样，除了使用<code class="prettyprint">route</code>指令外也可以使用 <code class="prettyprint">ip route show</code> 查看路由信息；和 <code class="prettyprint">route -n</code> 是等效的。这里更推荐使用<code class="prettyprint">ip route</code> 命令。<br>
<h4>traceroute</h4>该指令用于查看从源地址到目的地址的路由路径。比如 <code class="prettyprint">traceroute www.baidu.com</code> 用于判断你和目标地址之间经过了哪些网络设备。<code class="prettyprint">windows</code>下是<code class="prettyprint">tracert</code><br>
<h4>netstat</h4>这个指令比较强大，也是程序员日常用的比较多的一个指令。该指令可以显示服务器的网络状态，比如，显示服务器当前所有<code class="prettyprint">socket</code>链接 <code class="prettyprint">netstat -a</code>; 显示<code class="prettyprint">UDP/TCP</code>端口的使用情况 <code class="prettyprint">netstat -apu/netstat -apt</code>; 显示网络统计信息 <code class="prettyprint">netstat -s</code>; 查看<code class="prettyprint">8080</code>端口的状态 <code class="prettyprint">netstat -anp|grep 8080</code>。<br>
<br>和<code class="prettyprint">netstat</code>等价的指令是<code class="prettyprint">ss</code>指令。<code class="prettyprint">ss -l</code> 列出所有本机已经打开的端口。<code class="prettyprint">ss -t/u -a</code> 显示所有<code class="prettyprint">tcp/udp</code>链接。查看某个链接属于哪个进程 <code class="prettyprint">ss -tp</code>。查看本地的端口状态 <code class="prettyprint">ss -t src ip:8080</code>。这里更推荐使用<code class="prettyprint">ss</code>指令。<br>
<h4>tcpdump</h4>网络抓包工具，当遇到奇怪的网络问题时，通过<code class="prettyprint">tcpdump</code>进行网络抓包，然后进行分析定位问题。根据源IP进行抓包 <code class="prettyprint">tcpdump -i eth2 src 192.168.199.100</code> 即只抓取通过<code class="prettyprint">eth2</code>这块网卡的且源地址为<code class="prettyprint">192.168.199.100</code>的网络包。当然也可以指定端口抓包，比如 <code class="prettyprint">tcpdump src port 8088</code>。总之该命令非常强大，这里不做更多的详细介绍，感兴趣的可以自行了解。<br>
<h4>nmap</h4>这是一个网络嗅探和扫描工具，做网络安全的小伙伴会比较熟悉。经常用来检查对方主机开放了哪些端口。比如查看对方主机开放了哪些端口<code class="prettyprint">nmap -PS 192.168.199.100</code>，还可以探测目标IP的操作系统 <code class="prettyprint">nmap -O 192.168.199.100</code>。总之该命令做网络安全的会用的比较多，程序员使用的会比较少一些，感兴趣的可以深入研究，该指令及其强大。<br>
<h4>总结</h4>上面提到的小工具，对于有些问题的定位，可以通过两个不同的指令达到同样的效果。比如 <code class="prettyprint">ifconfig -a</code> 和 <code class="prettyprint">ip link show</code> ； <code class="prettyprint">route -n</code> 和 <code class="prettyprint">ip route show</code>；以及<code class="prettyprint">netstat</code>和<code class="prettyprint">ss</code>。出现这样的情况是因为，<code class="prettyprint">ifconfig</code> 和 <code class="prettyprint">netstat</code>等命令来自于<code class="prettyprint">net-tools</code>工具包，而<code class="prettyprint">ip link</code> 和 <code class="prettyprint">ss</code> 等指令来自<code class="prettyprint">iproute2</code>工具包。<code class="prettyprint">net-tools</code>已经停止开发了，在很多新版的操作系统里面已经不是默认自带的工具包了，如果想使用需要单独安装。<code class="prettyprint">iproute2</code>是用来替换<code class="prettyprint">net-tools</code>的，很多新版<code class="prettyprint">linux</code>都是默认安装的。而且<code class="prettyprint">iproute2</code>包中的很多指令在功能和性能上都要比<code class="prettyprint">net-tools</code>包中提供的指令更强大。我这里从网上找了一张图片用来说明俩个工具包的指令对比。<br>
<div class="aw-upload-img-list active">
<a href="http://dockone.io/uploads/article/20210506/fd039483f6f2fff6a7bad26c76b36de4.jpg" target="_blank" data-fancybox-group="thumb" rel="lightbox"><img src="https://cors.zfour.workers.dev/?http://dockone.io/uploads/article/20210506/fd039483f6f2fff6a7bad26c76b36de4.jpg" class="img-polaroid" title="1.jpg" alt="1.jpg" referrerpolicy="no-referrer"></a>
</div>
<br>
<br>原文链接：<a href="https://mp.weixin.qq.com/s/zj4yBgi7QkWunD4mrG4p5A" rel="nofollow" target="_blank">https://mp.weixin.qq.com/s/zj4yBgi7QkWunD4mrG4p5A</a>，关注基础编程，注重经验分享及个人成长。
                                                                <div class="aw-upload-img-list">
                                                                                                                                </div>
                                
                                                                <ul class="aw-upload-file-list">
                                                                                                                                            </ul>
                                                              
</div>
            