
---
title: """""""""'从公司分红看股票价值（基本面）'"""""""""
categories: 
    - 社交媒体
    - 知乎 - 用户文章
author: 知乎 - 用户文章
comments: false
date: Mon, 19 Jan 1970 15:26:26 GMT
thumbnail: 'https://pic3.zhimg.com/v2-f58f2ab38b4c69ff38634a35423fd3be_b.jpg'
---

<div>   
<blockquote> 在二级市场，投资者除股价变动外，仅有的额外收益就是股票分红。所以这里将股票分红定义为股票价值的基本面。<br> 本文利用2016-11-14到2018-01-12这段时间的股票走势来说明：购买分红高的股票等待分红比存银行定期收益要高；同时证实了股票市场鱼龙混杂的情况（存在很多垃圾并喜炒作垃圾）。</blockquote><h2><b>1. 数据获取</b></h2><p>本来我以为调一调库就完事儿了，没想到<code>tushare</code>的分红接口居然需要300积分，让我不得不自己写了个爬虫。这里使用了同花顺的数据：</p><div class="highlight"><pre><code class="language-python"><span class="kn">import</span> <span class="nn">urllib.error</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="n">hds</span><span class="o">=</span><span class="p">[</span>
    <span class="p">&#123;</span><span class="s1">'User-Agent'</span><span class="p">:</span> <span class="s1">'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US; rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6'</span><span class="p">&#125;,</span>
<span class="p">]</span> <span class="c1"># 这个自己添加</span>

<span class="k">def</span> <span class="nf">get_dividend</span><span class="p">(</span><span class="n">code</span><span class="p">):</span>
    <span class="s1">'''
</span><span class="s1">    code: 股票的6位数代码
</span><span class="s1">    '''</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">'http://stockpage.10jqka.com.cn/&#123;&#125;/bonus/#bonuslist'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    
    <span class="c1"># 获取当前url资源</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">hds</span><span class="p">))</span>
        <span class="n">source_code</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">request</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">plain_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">source_code</span><span class="p">,</span> <span class="s1">'utf-8'</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">,</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">URLError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="c1"># 提取bonus_table</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">plain_text</span><span class="p">,</span> <span class="s2">"lxml"</span><span class="p">)</span>
    <span class="n">bonus_table</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'table'</span><span class="p">,</span> <span class="p">&#123;</span><span class="s1">'id'</span><span class="p">:</span> <span class="s1">'bonus_table'</span><span class="p">&#125;)</span>
    <span class="k">if</span> <span class="n">bonus_table</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="n">table_header</span> <span class="o">=</span> <span class="n">bonus_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'thead'</span><span class="p">)</span>
    <span class="n">table_body</span> <span class="o">=</span> <span class="n">bonus_table</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'tbody'</span><span class="p">)</span>
    
    <span class="c1"># 获取table的列名和数据内容</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">cname</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">table_header</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">'th'</span><span class="p">)]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
      <span class="p">[</span><span class="n">coldata</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">coldata</span> <span class="ow">in</span> <span class="n">coldata</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">'td'</span><span class="p">)]</span> \
      <span class="k">for</span> <span class="n">coldata</span> <span class="ow">in</span> <span class="n">table_body</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">'tr'</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="c1"># 生成DataFrame</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AssertionError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">),</span> <span class="n">columns</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">d</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">None</span>

    <span class="k">return</span> <span class="n">df</span>


<span class="n">dividend_frame</span> <span class="o">=</span> <span class="n">get_dividend</span><span class="p">(</span><span class="s1">'000001'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dividend_frame</span><span class="p">[[</span><span class="s1">'报告期'</span><span class="p">,</span> <span class="s1">'实施日期'</span><span class="p">,</span> <span class="s1">'分红方案说明'</span><span class="p">,</span> <span class="s1">'股息率'</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span></code></pre></div><p>运行结果大致如下：</p><figure data-size="normal"><noscript><img src="https://pic3.zhimg.com/v2-f58f2ab38b4c69ff38634a35423fd3be_b.jpg" data-size="normal" data-rawwidth="1642" data-rawheight="338" class="origin_image zh-lightbox-thumb" width="1642" data-original="https://pic3.zhimg.com/v2-f58f2ab38b4c69ff38634a35423fd3be_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1642' height='338'></svg>" data-size="normal" data-rawwidth="1642" data-rawheight="338" class="origin_image zh-lightbox-thumb lazy" width="1642" data-original="https://pic3.zhimg.com/v2-f58f2ab38b4c69ff38634a35423fd3be_r.jpg" data-actualsrc="https://pic3.zhimg.com/v2-f58f2ab38b4c69ff38634a35423fd3be_b.jpg" referrerpolicy="no-referrer"><figcaption>分红爬取结果</figcaption></figure><p>现在有了获取某一公司历史分红的方法，还差获取深沪两市的所有股票代码的接口，比较幸运的是可以调库:)</p><div class="highlight"><pre><code class="language-python3"><span class="kn">import</span> <span class="nn">tushare</span> <span class="k">as</span> <span class="nn">ts</span>
<span class="n">stock_code_list</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_stock_basics</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span></code></pre></div><p>由此，我们就比较容易获取到深沪所有公司分红情况数据了：</p><div class="highlight"><pre><code class="language-python3"><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tushare</span> <span class="k">as</span> <span class="nn">ts</span>

<span class="n">path</span> <span class="o">=</span> <span class="s1">'./data'</span>
<span class="n">stock_code_list</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_stock_basics</span><span class="p">()</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># confirm the path exists</span>
<span class="n">dividend_path</span> <span class="o">=</span> <span class="s1">'</span><span class="si">&#123;&#125;</span><span class="s1">/dividend_data'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dividend_path</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">dividend_path</span><span class="p">)</span>

<span class="c1"># save the dividend data</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">stock_code_list</span><span class="p">:</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">*</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># 可根据情况调整时间间隔</span>
    <span class="n">dividend_frame</span> <span class="o">=</span> <span class="n">get_dividend</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">dividend_frame</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">dividend_frame</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">'</span><span class="si">&#123;&#125;</span><span class="s1">/</span><span class="si">&#123;&#125;</span><span class="s1">.csv'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dividend_path</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code></pre></div><p>至此，基本数据全部获取并保存完毕。</p><h2><b>2. 数据处理与分析</b></h2><p>同花顺分红页面中有股息率指标，这帮我节省了很多工作。</p><blockquote>股息率：是股息与股票价格之间的比率。</blockquote><p>通过统计各公司17年年报股息率分布得到下图，不难看出很少有公司股息率超过3%。而从历年统计数据来看，我国平均通货膨胀率在8%左右，达到这个收益率的股票仅有四支——方大特钢(10.80%)、哈药股份(9.98%)、三钢闽光(9.15%)、华联控股(8.26%)。分析到这里已经可以下一个结论：股票的长期持有收益不在分红上。</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-50312aa8eb07a1df37ddefcf63267289_b.jpg" data-size="normal" data-rawwidth="1200" data-rawheight="912" class="origin_image zh-lightbox-thumb" width="1200" data-original="https://pic2.zhimg.com/v2-50312aa8eb07a1df37ddefcf63267289_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1200' height='912'></svg>" data-size="normal" data-rawwidth="1200" data-rawheight="912" class="origin_image zh-lightbox-thumb lazy" width="1200" data-original="https://pic2.zhimg.com/v2-50312aa8eb07a1df37ddefcf63267289_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-50312aa8eb07a1df37ddefcf63267289_b.jpg" referrerpolicy="no-referrer"><figcaption>17年各公司股息率直方图</figcaption></figure><blockquote>股票的价格是未来现金流的折现，未来现金流包括分红和将股票卖出的收入，但未来将股票卖出的价格又是来自于未来的未来的分红和未来的未来将股票卖出的收入，如此循环下去直到公司停业清算。</blockquote><p>上面引用可以用一句话总结：股票收入仅来自分红和股票卖出。又因股票长期持有收益不在分红上，那么可以得出结论：股票长期持有收益在股票卖出收入（也就是股票价格）上。</p><p>换一句话说，在一段时间内股票价格的年化增长率代表了股票的大部分价值。考虑到股票价格波动较大问题我们需要取一个相对平缓的时间段来测试。由下图对比选择了2016-11-14到2018-01-12这个时间段来计算股票价格的年化增长率。</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-8d341ce12dab966ae94aa3e3417a844b_b.jpg" data-size="normal" data-rawwidth="1284" data-rawheight="782" class="origin_image zh-lightbox-thumb" width="1284" data-original="https://pic4.zhimg.com/v2-8d341ce12dab966ae94aa3e3417a844b_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1284' height='782'></svg>" data-size="normal" data-rawwidth="1284" data-rawheight="782" class="origin_image zh-lightbox-thumb lazy" width="1284" data-original="https://pic4.zhimg.com/v2-8d341ce12dab966ae94aa3e3417a844b_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-8d341ce12dab966ae94aa3e3417a844b_b.jpg" referrerpolicy="no-referrer"><figcaption>上证指数分布</figcaption></figure><p>现在我们并没有股票的历史数据，经过一番挣扎选择了之前使用过的<code>tushare</code>。调用很简单：</p><div class="highlight"><pre><code class="language-python3"><span class="n">history_frame</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_hist_data</span><span class="p">(</span><span class="n">stock_code</span><span class="p">)</span></code></pre></div><p>在剔除2016-11-14前未上市的公司以后，最后统计出的结果让人难过。沪市平均年化增长率为-19.3%，但的确存在股价翻倍的故事。统计得出你大概有3.3%的几率获得50%以上的收益，有12.2%的几率获得10%以上的收益，有17.4%的几率获得正收益。</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-a03ef94ef7a3210e87e21722b2b40370_b.jpg" data-size="normal" data-rawwidth="1172" data-rawheight="888" class="origin_image zh-lightbox-thumb" width="1172" data-original="https://pic1.zhimg.com/v2-a03ef94ef7a3210e87e21722b2b40370_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1172' height='888'></svg>" data-size="normal" data-rawwidth="1172" data-rawheight="888" class="origin_image zh-lightbox-thumb lazy" width="1172" data-original="https://pic1.zhimg.com/v2-a03ef94ef7a3210e87e21722b2b40370_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-a03ef94ef7a3210e87e21722b2b40370_b.jpg" referrerpolicy="no-referrer"><figcaption>growth_rate分布直方图</figcaption></figure><p>个人暂且认为是A股劣质股票过多的缘故，故对股息率做排序后的如下结果：</p><figure data-size="normal"><noscript><img src="https://pic4.zhimg.com/v2-54e61e87b5020dbbf302b3895af83727_b.jpg" data-size="normal" data-rawwidth="1620" data-rawheight="800" class="origin_image zh-lightbox-thumb" width="1620" data-original="https://pic4.zhimg.com/v2-54e61e87b5020dbbf302b3895af83727_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1620' height='800'></svg>" data-size="normal" data-rawwidth="1620" data-rawheight="800" class="origin_image zh-lightbox-thumb lazy" width="1620" data-original="https://pic4.zhimg.com/v2-54e61e87b5020dbbf302b3895af83727_r.jpg" data-actualsrc="https://pic4.zhimg.com/v2-54e61e87b5020dbbf302b3895af83727_b.jpg" referrerpolicy="no-referrer"><figcaption>股息率对年化增长率的影响</figcaption></figure><p>股息率大于4%的股票平均年化增长率变为正。正收益可能性在45%左右，获得50%以上收益的可能性也从3.8%增加到了5.7%。这个结果很有意思，银行定期利率都在4%左右。有办法通过风险搏取更高的收益，股市才是合理的存在。</p><p>股息率大于0的股票年化增长率前6名：</p><figure data-size="normal"><noscript><img src="https://pic2.zhimg.com/v2-6055f67a7177266862f483e842de2b31_b.jpg" data-size="normal" data-rawwidth="1616" data-rawheight="360" class="origin_image zh-lightbox-thumb" width="1616" data-original="https://pic2.zhimg.com/v2-6055f67a7177266862f483e842de2b31_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1616' height='360'></svg>" data-size="normal" data-rawwidth="1616" data-rawheight="360" class="origin_image zh-lightbox-thumb lazy" width="1616" data-original="https://pic2.zhimg.com/v2-6055f67a7177266862f483e842de2b31_r.jpg" data-actualsrc="https://pic2.zhimg.com/v2-6055f67a7177266862f483e842de2b31_b.jpg" referrerpolicy="no-referrer"><figcaption>股息率大于0的股票年化增长率前6名</figcaption></figure><p>股息率大于4%的股票年化增长率前6名：</p><figure data-size="normal"><noscript><img src="https://pic1.zhimg.com/v2-a650709b1563c48242cf27a9b3c5bb7c_b.jpg" data-size="normal" data-rawwidth="1618" data-rawheight="402" class="origin_image zh-lightbox-thumb" width="1618" data-original="https://pic1.zhimg.com/v2-a650709b1563c48242cf27a9b3c5bb7c_r.jpg"/></noscript><img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='1618' height='402'></svg>" data-size="normal" data-rawwidth="1618" data-rawheight="402" class="origin_image zh-lightbox-thumb lazy" width="1618" data-original="https://pic1.zhimg.com/v2-a650709b1563c48242cf27a9b3c5bb7c_r.jpg" data-actualsrc="https://pic1.zhimg.com/v2-a650709b1563c48242cf27a9b3c5bb7c_b.jpg" referrerpolicy="no-referrer"><figcaption>股息率大于4%的股票年化增长率前6名</figcaption></figure><p></p>  
</div>
            