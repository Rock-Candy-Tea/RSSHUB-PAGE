
---
title: 'Excel如何產生隨機亂數(random number)？'
categories: 
    - 博客
    - Google Sites - 文章更新
author: Google Sites - 文章更新
comments: false
date: Mon, 22 Mar 2021 07:10:37 GMT
thumbnail: ''
---

<div>   
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><span style="font-size:13.3333px;line-height:21.3333px"><div><b>簡介</b></div><div>隨機亂數(random number)在數學、財務學、賭博上的用途相當廣泛。</div><div>懂得在Excel產生隨機亂數可以為自己建構的模型作測試。</div><div style="font-weight:bold"><br></div></span></div><div><span style="font-size:13.3333px;line-height:21.3333px"><b>函数</b></span></div>在Excel中的任何儲存格中輸入<font color="#0000ff"><b>=rand()</b></font>便可以產生0與1之間的變數(大於0且小於1)。<div><br><div>如果想<span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">隨機</span><span style="line-height:1.6;font-size:10pt;background-color:transparent">產生指定範圍內的整數(例如1至100之間的整數)，可以使用</span><b style="line-height:1.6;font-size:10pt;background-color:transparent"><font color="#0000ff">=RANDBETWEEN(數字下限,</font><span style="color:rgb(0,0,255);font-size:13.3333px;line-height:21.3333px;background-color:transparent">數字</span><font color="#0000ff" style="line-height:1.6;font-size:10pt;background-color:transparent">上限)</font></b><span style="line-height:1.6;font-size:10pt;background-color:transparent">。</span></div><div><div>如果是Excel 2003的用家，可以在任何儲存格輸入<b><font color="#0000ff">=int((<span style="font-size:10pt;line-height:1.6;background-color:transparent"><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">數字</span><font style="line-height:1.6;font-size:10pt;background-color:transparent">上限</font></span> - <span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span> + 1) * Rand() + <span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span>)</font></b>來隨機產生<span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">指定範圍內的整數。</span></div></div></div><div><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent"><br></span></div><div><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">如果想產生指定範圍的隨機亂數，但不限於整數 (例如2至5之間的任何實數)，可以使用</span><font color="#0000ff"><b><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">=RAND()*(</span><span style="font-size:13.3333px;line-height:21.3333px"><span style="font-size:10pt;line-height:1.6;background-color:transparent"><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">數字</span><font style="line-height:1.6;font-size:10pt;background-color:transparent">上限</font></span></span><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">-</span><span style="font-size:13.3333px;line-height:21.3333px"><span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span></span><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">)+</span><span style="font-size:13.3333px;line-height:21.3333px"><span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span></span></b></font><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">。</span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">得到出的數字便是數字上限與數字下限之間的任何數(包括小數)。</span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px"><br></span></div><div><div style="font-size:13.3333px;line-height:21.3333px"><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent"><b>例子</b></span></div><div style="font-size:13.3333px;line-height:21.3333px"><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent"><div>如果某個儲存格有60%的機會顯示「Win」，有40%的機會顯示「Lose」。</div><div>在儲存格輸入<b><font color="#0000ff">=if(rand()>0.4,"Win","Lose")</font></b>便可以做到這個效果。</div></span></div></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px"><br></span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px"><b>注意</b></span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">使用RAND</span><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">函数產生的隨機亂數會工作表重算時更新，按下F9、公開活頁簿或更改任何儲存格便可以使工作表重新計算。</span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">有關重新計算的設定可以到<b><font color="#0000ff">檔案 > 選項 > 公式 > 活頁簿計算</font></b>自行設定，一般建議選擇「自動」。</span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px"><br></span></div><div><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px"><b>VBA</b></span></div><div><span style="font-size:13.3333px;line-height:21.3333px">在寫VBA的時候，可以使用<font color="#0000ff"><b>rnd</b></font>來產生</span><span style="background-color:transparent;font-size:13.3333px;line-height:21.3333px">隨機亂數。</span></div><div><span style="font-size:13.3333px;line-height:21.3333px">例如想在儲存格A1寫入</span><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">隨機亂數，可以使用<b><font color="#0000ff">Range("A1") = rnd</font></b>。</span></div><div><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">值得留意的是VBA沒有RANDBETWEEN的功能，用家可以使用</span><b style="font-size:13.3333px;line-height:21.3333px;background-color:transparent"><font color="#0000ff">int((<span style="font-size:10pt;line-height:1.6;background-color:transparent"><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">數字</span><font style="line-height:1.6;font-size:10pt;background-color:transparent">上限</font></span> - <span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span> + 1) * Rnd + <span style="font-size:10pt;line-height:1.6;background-color:transparent">數字下限</span>)</font></b><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent">取而代之。</span></div><div><span style="font-size:13.3333px;line-height:21.3333px;background-color:transparent"><br></span></div><div><br></div></div></td></tr></tbody></table>
  
</div>
            